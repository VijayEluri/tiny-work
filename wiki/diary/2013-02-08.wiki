[[diary|日誌]]
%toc 2013-02-08

= 代数的な形式級数 =
買っておいたstanleyの本
<a name='stanley-2'>
[[http://www.cambridge.org/us/knowledge/isbn/item1167618|Enumerative Combinatrics Volume 2]]
</a>
の六章を読み始める。しばらく掛かりそうだ。
１巻の方は筆者のホームページからダウンロードできる。
<a name='stanley-1'>
[[http://www-math.mit.edu/~rstan/ec/|Enumerative Combinatrics Volume 1]]
</a>

多項式の種類を表す名前と記号を整理しておく。$K$を体とする。

|               | 自然数のべき         | 整数のべき                                   | 有理数のべき                                                                    |
|---------------|----------------------|----------------------------------------------|---------------------------------------------------------------------------------|
| <b>有限和</b> | 多項式　 $K\blr{x}$  | Laurent多項式 $K\plr{x}:=K\blr{x}[x^{-1}]$   | Puiseux多項式 $K\clr{x}:=K\plr{x}\blr{x^{\frac{1}{2}},x^{\frac{1}{3}},\dots}$   |
| <b>無限和</b> | 形式級数 $K\bblr{x}$ | Laurent級数　 $K\pplr{x}:=K\bblr{x}[x^{-1}]$ | Puiseux級数　 $K\cclr{x}:=K\pplr{x}\blr{x^{\frac{1}{2}},x^{\frac{1}{3}},\dots}$ |

表の左から右へは代数拡大、上から下へは有限和から無限和へと集合を拡大している。
Laurent級数でもべきの下限は有限に抑えられていることに注意する。
ある$m\in\sizen$があって$x^{-m}\sum_{n\in\sizen}f_nx^n$という形をしている。

形式級数の操作を表す記号を整理しておく。
* $f\in K\bblr{x}$とは、$fx=\sum_{n\in\sizen}f_nx^n$と書けるとする。
* $(f+g)x:=(fx)+(gx)$、$(f\cdot g)x:=(fx)(gx)$、$(f\circ g)x:=fgx$という記号を使う。
* $\dlr{f,n}$を$x^n$の係数を取り出す操作とする。

== 形式級数 ==
<a href='#stanley-1'>1.1 数え上げ組合せ論て何？</a>

<a href='#stanley-1'>教科書</a>で扱う形式級数は単に多項式を拡張したものではない。
例えば、次の二つの級数はどちらも$\exp(1+x)$のTayler展開ではあるが、
片方は$\bfC\bblr{x}$の元になっていて、
もう片方は$\bfC\bblr{x}$の元になっていない。
{{$
\sum_{n\in\bfN} \frac{ex^n}{n!}\in\fukuso\bblr{x} \quad\text{but}\quad 
\sum_{n\in\bfN} \frac{(1 + x)^n}{n!}\not\in\fukuso\bblr{x}
}}$
そのココロは、係数体$K$の性質に深く関わらないことにある。
上の例では、$e=\sum_{n\in\sizen}1/n!$という式を知らないと、
二つの級数が同一になることはわからない。
一般には、体で無限和を許すためには、完備化の操作が必要になる。
この教科書では、係数体の完備化について知らなくてもできる範囲で議論する。
つまり、係数体の有限和のみを使って議論する。

一方、形式級数自体は、形式級数の次数を使って完備化している。
形式級数の次数は次の写像
$\deg_\bot: K\bblr{x}\to\plra{\sizen\cup\set{\infty}}$
によって与えられる。
{{$
\deg_\bot f := \begin{cases}
	\infty, &\text{ iff } f = 0 \\
	\op{argmin}_{n\in\sizen} \dlr{f, n}\neq 0, &\text{ otherwise } \\
\end{cases} \quad\text{for all } f\in K\bblr{x}
}}$
$\deg_\bot$は$\blr{f,n}\neq0$となる最小の$n$を与える関数である。
$\deg_\bot$は次の式を満たす。
{{$%split%
\deg_\bot(f+g) &\ge \min(\deg_\bot f,\; \deg_\bot g) \\
\deg_\bot(f\cdot g) &= \deg_\bot f + \deg_\bot g \\
}}$
一つ目の式の不等号は、
* $fx=1+x,\; g=-1+x$とすると、$\deg_\bot f=\deg_\bot g=0$だが、$\deg_\bot(f+g)=1$となる
といった状況を反映している。
$\deg_\bot(f - g)=n$なら、$f$と$g$は$0..(n-1)$次の係数が一致していて、
$g$は次ののように書ける。
{{$
gx = f_0 + \cdots + f_{n-1}x^{n-1} + g_nx^n + g_{n+1}x^{n+1} + \cdots
\quad\text{and}\quad f_n\neq g_n
}}$

任意の$f\in K\bblr{x}$と$n\in\sizen$に対して$(f)_\bot^n\subseteq K\bblr{x}$
を次のように定義すると、
{{$
(f)_\bot^n := \set{g\in K\bblr{x}\mid n\le\deg_\bot(f,g)}
}}$
部分集合の可算な降下列が次のように得られる。
{{$
K\bblr{x}=(f)_\bot^0\supseteq (f)_\bot^1\supseteq\cdots\supseteq 
(f)_\bot^\infty=set{f}
}}$
例えば、標数$2$の体$\sei_2$を係数体として、$f=1+x$を考えると、次の降下列になる。
{{$
(f)_\bot^0=\sei_2\bblr{x}
\supset (f)_\bot^1=\set{1+f_1x^1+\cdots}
\supset (f)_\bot^2=\set{1+x+f_2x^2+\cdots}
\supset (f)_\bot^3=\set{1+x+f_3x^3+\cdots}
\supset \cdots 
\supset (f)_\bot^\infty=\set{1+x}
}}$

== 代数的な生成関数 ==
<a href='#stanley-2'>6.1 代数的生成関数</a>

* D-有限$\impliedby$代数的$\impliedby$有理的
* 代数的な形式級数
	* $\eta\in K\bblr{x}$が代数的 $\xiff{\dfn}$
		ある$d\in\sizen$と$P_0,\dots,P_d\in K\blr{x}$があって、
		次のことが成り立つ。
		* $P_0=P_1=\cdots=P_d=0$でない。
		* $P_0+P_1\eta+\cdots+P_d\eta^d=0$となる。
	* $\eta\in K\bblr{x}$の代数的次数が$d$ $\xiff{\dfn}$
		上記の条件が成り立つ最小の$d$
* <a name='eg-1'>代数的な形式級数の例</a>:
	$\frac{1}{\sqrt{1-4x}}=\sum_{n=0}^\infty\binom{2n}{n}x^n$
	* カタラン数が
	$\frac{1-\sqrt{1-4x}}{2x}=\sum_{n=0}^\infty\frac{1}{n+1}\binom{2n}{n}x$
	で与えられることを知っているから、両辺に$x$を掛けてから$x$で微分すると、
	上記の式が得られる。
	* <a href='#stanley-2'>二巻</a>では問題1.4と書かれているが、
	<a href='#stanley-1'>二版の一巻</a>では問題1.8となっている。
	* 右辺を$\eta x$とおくと、$(1 - 4x)(\eta x)^2 - 1 = 0$となって、
	$\eta$が代数的になる。
	* $K$の標数が$2$の時は、$\eta x=1$となる。
		* $1\le n$で$\binom{2n}{n}$は偶数となるから、$\eta$の一次以上の項は$0$になる。
		したがって、この時は$\eta$の代数的次数は$1$となる。
	* $K$の標数が$2$以外の時は、$\eta$の代数的次数は$2$となるのは、
	<a href='#stanley-2'>教科書</a>のとおり。
* $K\bblr{x}$は局所領域で、$x$は極大イデアルを生成する。
	* この呪文は、$K\bblr{x}$は、そのままでほぼ体になっていて、
	$x$の逆元$x^{-1}$を付け加えると正真正銘の体となると言っている。
	* $f\in K\bblr{x}$が$f_0:=\dlr{f,0}\neq0$ならば、
	$f^{-1}=\frac{1}{f_0}\frac{1}{1 + \frac{f-f_0}{f_0}}=\frac{1}{f_0}\plra{\frac{f-f_0}{f_0}}^*$
	となって、$\dlra{\frac{f-f_0}{f_0},0}=0$だから、$f^{-1}\in K\bblr{x}$となる。
	（ノートの命題:形式級数の収束その三を見よ。）
	このことを指して、$K\bblr{x}$がほぼ体と言っている。
* $K\pplr{x}:=K\bblr{x}\blr{x^{-1}}$を$K\bblr{x}$に$x^{-1}$を付け加えた体とする。
	* 体で考えたい理由は、$\dlr{f,0}\neq0$という条件を外したいことと、
	複素数上の代数式との類似という動機がある。
	<a href='#galois'>ガロア理論の応用</a>が効く。
	* $K\pplr{x}$の解析での対応はLaurent展開になる。
	一方、$K\bblr{x}$はTayler展開に対応する。
	* $K\pplr{x}$をLaurent級数ということにする。
* 代数的なLaurent級数
	* $\eta\in K\pplr{x}$が代数的 $\xiff{\dfn}$
		ある$d\in\sizen$と$P_0,\dots,P_d\in K\plr{x}$があって、
		次のことが成り立つ。
		* $P_0=P_1=\cdots=P_d=0$でない。
		* $P_0+P_1\eta+\cdots+P_d\eta^d=0$となる。
		<a name='irreducible'>既約多項式</a>
	* $\eta\in K\pplr{x}$の代数的次数が$d$ $\xiff{\dfn}$
		上記の条件が成り立つ最小の$d$
* <a name='galois'>ガロア理論入門</a>p.29から
	* 最高次数の係数が$1$の既約多項式をモニックという。
	* $\eta\in K\pplr{x}$が$K\plr{x}$を代数的、$d$をその次数、
	$F\in K\plr{x}\blr{\xi}$をその既約なモニックとする。
		* $G\in K\plr{x}\blr{\xi}$が$G\eta=0$となるならば、$G$は$F$で割り切れる。
			* 証明: $\deg_{K\blr{x}}R<d$となる$R\in K\plr{x}\blr{\xi}$と、
			ある$Q\in K\plr{x}\blr{\xi}$を用いて、$G=QF+R$と書ける。
			仮定から$R\eta=0$となるが、$F$が既約であることに反する。
		* したがって、既約なモニックは一意に定まる。
* $\eta\in K\pplr{x}$が$K\plr{x}$で代数的で、$F\in K\plr{x}\blr{\xi}$をその既約多項式とすると、
	$F$の各係数の分母の公倍数を$F$に書けると、$K\blr{x}\blr{\xi}$の多項式となる。
	したがって、$\eta\in K\bblr{x}\subseteq K\pplr{x}$となっていれば、
	$\eta$は$K\blr{x}$で代数的となる。
	つまり、集合同型$K_{\op{alg}}\bblr{x}=K_{\op{alg}}\pplr{x}\cap K\bblr{x}$が成り立つ。
* <a href='#eg-1'>代数的な形式級数の例</a>$(1 - 4x)(\eta x)^2 - 1$
	* 体$L$上の二次式$fx=a+bx+x^2=\plra{x+\frac{b}{2}}^2-\frac{b^2-4a}{4}$
		* $L$の標数$2$とすると、$2$の倍数で割れないから、平方完成ができない。
		* $L$の標数が$2$でないとする。
			判別式$b^2-4a$が$L$の中で二乗になっていれば、$f$は$L$で既約でない。
			判別式が$L$の中で二乗になっていなければ、$f$は既約になる。
	* $K$の標数が$2$でなければ、判別式$4(1-4x)$の多項式次数は$1$だから、
		判別式は$K\blr{x}$の中で二乗にならない。したがって、
	$(1 - 4x)(\eta x)^2 - 1$は$K\plr{x}$の既約多項式となる。
	* $K\pplr{x}$上の２次の代数式$F$を考える。$F$の判別式は$K\plr{x}$の元になる。
		判別式の次数が奇数であれば、判別式が$K\pplr{x}$の元の二乗になることはないので、
		$F$は$K\plr{x}$上で既約となる。
* Puiseux級数はLaurent級数に分数べきを付け加えたもの。
	$K\cclr{x}:=K\pplr{x}[x^{\frac{1}{2}},x^{\frac{1}{3}},\dots]$
* Puiseux級数$K\cclr{x}$はLaurent級数$K\pplr{x}$の代数拡大になっている。
	* 拡大体: $K\pplr{x}$が$K\cclr{x}$の部分体
	* 代数的: 任意の$\eta\in K\cclr{x}$に対して、
	次の性質を満たす$P_0,\dots,P_n\in K\pplr{x}$が存在する。
		* $P_0=\cdots=P_n=0$でない。
		* $P_0+P_1\eta+\cdots+P_n\eta^n=0$となる。
* $K$が代数的閉体かつ標数が$0$であれば、Puiseux級数$K\cclr{x}$は代数的閉体になる。
	* Laurent級数$K\pplr{x}$が代数的閉体となることは言えない。例えば、
	$P\in\pplr{x}$に対して$\eta^2=P$となる解$\eta$が$K\pplr{x}$に存在することは保証されない。
* 体の拡大の種類
	* 拡大: 部分体$K\subseteq L$となるとき、$L$は$K$の拡大体という。
	* 代数的拡大: 体の拡大$K\subseteq L$で、$L$の任意の元$y$に対して、
	$y$を根とする$K$係数の多項式が存在する。
	{{$
	\sei\subset\bun\text{は代数的拡大である}\quad\because\quad
	\frac{m}{n}\in\bun\implies n\frac{m}{n} = m
	}}$
	* 代数的閉包: 体の拡大$K\subseteq L$で、$L$は$K$の代数的拡大かつ、
	$L$は代数閉体である。
	* $L$を体とする。任意の$L$係数の多項式のすべての根が$L$の元になるとき、
	$L$を代数的閉体という。
	{{$
	\sei\subset\bun\text{は代数的閉包でない}\quad\because\quad
	x^2 = 2 \implies x\not\in\bun
	}}$
		* $\sei_2$は代数的閉体とならない。$\sei_2$の元を$\set{0,1}$と書くと、
		$x(x-1)+1$は$x$に$0$を代入しても$1$を代入してもにならない。
		* 同様の議論で、有限体$F$は代数的閉体とならない。$F=\set{a_1,\dots,a_n}$
		を有限体とすると、$(x-a_1)\cdots(x-a_n)+1$は$F$に根を持たない。

== 非可換な形式級数 ==
$K$を体、$A$を有限集合とする。
$A^*:=\plr{\coprod_{n\in\bfN}A,m_0,1_\clW}$を$A$から生成される自由モノイド、
$K\blr{A}$を$A$の元を不定元とする$K$上の多項式全体のつくる集合、
$K\bblr{A}$を$A$の元を不定元とする$K$上の形式級数全体のつくる集合とする。
$K\blr{A}$と$K\blr{A}$の違いは、$K\blr{A}$は有限和しか許さず、
$K\bblr{A}$は無限和を許すことである。

$K\bblr{A}$について線形な写像$\blr{-,-}:K\bblr{A}\times A^*\to K$を次のように定義し、
{{$
\blr{w_1,w_2} := \is{w_1=w_2} \quad\text{for all } w_1,w_2\in A^*
}}$
畳み込みによって、$K\bblr{A}$に二項演算$+$と$\cdot$を次のように定義する。
{{$%split%
\blr{f+g,w} &:= \blr{f,w} + \blr{g,w}
&\quad\text{for all } f,g\in K\bblr{A},\; w\in A^* \\
\blr{f\cdot g,w} &:= \blr{f,w}\blr{g,w}
&\quad\text{for all } f,g\in K\bblr{A},\; w\in A^* \\
}}$
すると、次のことが成り立つ。
* $+$は$0\in K$への定数写像を単位元とする可換な積となる。
* $\cdot$は$1\in K$へ定数写像を単位元とする可換な積となる。
* $+$を加法、$\cdot$を乗法とする分配則を満たし、
	$(K\bblr{A},+,\cdot)$は可換な環となる。
* $K$への定数写像と$K$を同一視すると、
	$(K\bblr{A},+,\cdot)$は$K$上の可換な代数となる。
以降、二項演算$\cdot$は省略して、単に$fg:=f\cdot g$と書く。
また、'内積'$\blr{-,-}$の定義域を$K\bblr{A}\otimes K\blr{A}$へ双線型に拡張する。

$A^*$の文字列の連結$m_0$の畳み込みより、余積$m_0^\trn:K\bblr{A}\to K\bblr{A}\otimes K\bblr{A}$とその余単位射$\epsilon_0:K\bblr{A}\to K$を次のように定義することができる。
{{$%split%
\blr{m_0^\trn f,x_1\otimes x_2} &:= \blr{f,m_0(x_1\otimes x_2)}
&\quad\text{for all } f\in K\blr{\blr{A}},\; x_1,x_2\in K\blr{A} \\
\epsilon_0 f &:= \blr{f,1_\clW}
&\quad\text{for all } f\in K\blr{\blr{A}} \\
}}$
ここで、テンソル積同士の内積は次のように定義する。
{{$
\blr{f\otimes g,x\otimes y} := \blr{f,x}\blr{g,y}
\quad\text{for all } f,g\in K\blr{\blr{A}},\; x,y\in K\blr{A} \\
}}$
$m_0^\trn$を文字列で表すと次のようになる。
{{$
m_0^\trn w = \sum_{w_1,w_2\in A^*} \is{w_1w_2=w}
w_1\otimes w_2 \quad\text{for all } w\in A^*
}}$
また、$K\bblr{A}$の積$m_0$を次のように定義できるが、
{{$
\blr{m_0(f\otimes g),x} := \blr{f\otimes g,m_0^\trn x}
\quad\text{for all } f,g\in K\bblr{A},\; x\in K\blr{A}
}}$
$\blr{m_0(f\otimes g),-}:K\blr{A}\to K$の定義域は$A^*$に収まりきらずに、
$K\blr{A}$を定義域にする必要があることに注意する。

$K\bblr{A}$は、何も付け足さなくてもそのままで、ほぼ体になっている。
{{$
f_0 := \epsilon_0f \neq 0 \implies \left\{\begin{split}
	f^{-1} &:= \frac{1}{f_0}\sum_{n\in\bfN}
		\plra{\frac{f_0-f}{f_0}}^n \in K\bblr{A} \\
	\blr{ff^{-1},w} &= 1 = \blr{f^{-1}f,w}
		\quad\text{for all } w\in A^*
\end{split}\right.
}}$
$K\bblr{A}$に$a\in A$の逆元$a^{-1}$を付け足したものを$K\bblr{A}\blr{A^{-1}}$と書くと、
$\epsilon_0f\neq0$という制限が外れて、$K\bblr{A}\blr{A^{-1}}$は体になる。

=== 一変数の場合 ===
文字集合がシングルトン$A:=\set{a}$の場合は、べきを表すの二項演算$*$を次のように定義できる。
{{$
a^m*a^n := a^{mn} \quad\text{for all } m,n\in\bfN
}}$
$(A^*,m,m_*)$は、通常の加法と乗法による自然数のつくる半環と同型になる。

作用素$(-)_+,(-)_*:\bfN\to\cat{Set}(A^*,A^*)$を次のように定義すると、
{{$%split%
(m)_+a^n &:= a^{m+n} &\quad\text{for all } m,n\in\bfN \\
(m)_*a^n &:= a^{mn} &\quad\text{for all } m,n\in\bfN \\
}}$
次の交換関係が成り立つ。
{{$
(m)_*(n)_+ = (mn)_+(m)_* \quad\text{for all } m,n\in\bfN
}}$
この交換関係は、自然数の分配則を作用素の形で表している。
また、余積$m_*^\trn:K\bblr{A}\to K\bblr{A}\otimes K\bblr{A}$は次のようになり、
{{$
m_*^\trn a^n = \sum_{r,s\in\bfN} \is{rs=n}
a^r\otimes a^s \quad\text{for all } n\in\bfN
}}$
自然数の因数分解に対応する。
