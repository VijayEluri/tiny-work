\begingroup %{
	\newcommand{\W}{\mycal{W}}
	\newcommand{\T}{\mycal{T}}
	\newcommand{\End}{\myop{End}}
	\newcommand{\Map}{\myop{Map}}
	\newcommand{\Lin}{\mathcal{L}}
	\newcommand{\Hol}{\mathcal{H}}
	\newcommand{\Aut}{\myop{Aut}}
	\newcommand{\Mat}{\myop{Mat}}
	%
	\newcommand{\id}{\myop{id}}
	\newcommand{\tran}{\mathbf{t}}
	\newcommand{\dfn}{\,\myop{def}\,}
	\newcommand{\xiff}[2][]{\xLongleftrightarrow[#1]{#2}}
	\newcommand{\tr}{\myop{tr}}
	%
	\newcommand{\mvec}[2]{\begin{matrix}{#1}\\{#2}\end{matrix}}
	\newcommand{\pvec}[2]{\begin{pmatrix}{#1}\\{#2}\end{pmatrix}}
	\newcommand{\bvec}[2]{\begin{bmatrix}{#1}\\{#2}\end{bmatrix}}
	\newcommand{\what}{\widehat}
	\newcommand{\even}{\myop{even}}
	\newcommand{\lieso}{\myop{so}}
	\newcommand{\frk}[1]{\ensuremath{\mathfrak{#1}}}
	\newcommand{\ad}{\myop{ad}}
	\newcommand{\Ad}{\myop{Ad}}
	\newcommand{\Cn}{\myop{Cn}}
	\newcommand{\lhdeq}{\trianglelefteq}
	\newcommand{\rhdeq}{\trianglerighteq}
	\newcommand{\dup}{\ensuremath{\myop{dup}\,}}
	\newcommand{\syou}[2]{\ensuremath{\left[\frac{#1}{#2}\right]}}
	%
	\newcommand{\xytree}{\xymatrix@R=4pt@C=1pt}
	\newcommand{\sen}{\ar@{-}}
	%
	{\setlength\arraycolsep{2pt}
	%
\section{スタックマシン}\label{s1:スタックマシン} %{
\begingroup %{
	\newcommand{\Drop}{\myop{Drop}}
	\newcommand{\Copy}{\myop{Copy}}
	\newcommand{\Rot}{\myop{Rot}}
	\newcommand{\Prot}{\myop{pRot}}
	\newcommand{\Tuck}{\myop{Tuck}}

\subsection{Shannonの修論}\label{s2:Shannonの修論} %{
	\cite{shannon2006}のノート。

	スタックマシンは遅いと言われている。von Neumannアーキテクチャに比べて、
	スタックマシンはプロセッサとメモリの間で大量のデータを転送することに
	起因するらしい\footnote{
		von Neumannアーキテクチャとは？
	}。スタックマシンで大量のデータ転送が発生するのは、コンパイラが賢くない
	せいで、コンパイラが十分賢ければ、スタックマシンでも大量のデータ転送が
	必要ならないということを\cite{shannon2006}は主張している。

	\cite{shannon2006}では、スタックマシンでの基本的なスタック操作を次の
	ようにまとめている。
	\begin{equation*}\begin{array}{rclcl}
		\Drop_{-3} &:& \young(\cdots abcd) &\mapsto& \young(\cdots acd) \\
		\Copy_{-3} &:& \young(\cdots abcd) &\mapsto& \young(\cdots abcdb) \\
		\Rot_{-3} &:& \young(\cdots abcd) &\mapsto& \young(\cdots acdb) \\
		\Prot_{-3} &:& \young(\cdots abcd) &\mapsto& \young(\cdots adbc) \\
		\Tuck_{-3} &:& \young(\cdots abcd) &\mapsto& \young(\cdots adbcd) \\
	\end{array}\end{equation*}
	実行速度を無視すれば、サイズ$n$のスタックの要素の置換の集合は対称群$S_n$
	となり、循環置換$\Rot_1$と互換$\Rot_{-2}$から生成される。また、スタック
	の伸長は$\Copy_{-1}$、収縮は$\Drop_{-1}$で表される。したがって、上記に挙
	げたすべてのスタック操作は$\Rot_1,\;\Rot_{-2},\;\Copy_{-1},\;\Drop_{-1}$
	の四つの操作から生成される。

	スタックマシンは、'深さ'と'マニピュレータ数'という言葉で分類することが
	できるそうだ。表\ref{tbl:スタックマシンの分類}は、代表的なスタックマシン
	の'深さ'と'マニピュレータ数'を書いている。この表中のB5000とは、最初の
	スタックマシンの一つで'Burrough B5000'という商品名らしい。UFOとは、
	\cite{shannon2006}で目的とするスタックマシンである。
	'深さ'と'マニピュレータ数'とは何かは、おいおいわかると信じて先に進む。

	\begin{table}[htbp] %{
		\begin{center}\begin{tabular}{rcc} \hline
			マシン & 深さ & マニピュレータ数 \\ \hline
			B5000 & 3 & 4 \\
			Forth VM & 3 & 9 \\
			Java VM & 4 & 9 \\
			UFO & 4 & 16 \\
		\end{tabular}\end{center}
		\caption{スタックマシンの分類}\label{tbl:スタックマシンの分類}
	\end{table} %}

	\cite{shannon2006}ではスタックを次の５つの領域に分類している。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[e-stack] 式評価領域
		\item[p-stack] パラメーター領域
		\item[l-stack] 局所領域
		\item[x-stack] 転送領域
		\item[その他]
	\end{description} %}
	単一のスタックを５つの領域に分類するなどケチケチせずに、５つのスタックを
	用意すればよいと思うが、スタックマシンを直にハードウェアで実装する際の
	コストに関係するのだろう。式評価領域
	\begin{equation*}\begin{array}{rr||r|r|}
		\myop{get-local} & a & a \\
		\myop{get-local} & b & a & b \\
		\myop{multiplies} & & a * b \\
		\myop{integer} & 4 & a * b & 4 \\
		\myop{plus} & & a * b + 4 \\
		\myop{set-local} & y \\
	\end{array}\end{equation*}
%s2:Shannonの修論}
\subsection{Lua-5}\label{s2:Lua-5} %{
	Lua-5では、スタック内でのcopy/rotateによる無駄なコピーを排除するために、
	スタックをランダムアクセスできるようにしている。そして、ランダムアクセス
	できるスタックをレジスターと言っている。
%s2:Lua-5}
\endgroup %}
%s1:スタックマシン}
\section{Diffie-Hellmannのカギ共有}\label{s1:Diffie-Hellmannのカギ共有} %{
	Diffie-Hellmannのカギ共有は、可換半群$A=(A,*,1)$の元$a,b,c$を用いて、
	次の図で表すことができる。
	\begin{equation*}\xymatrix{
		\text{person }\alpha & \text{common} & \text{person }\beta \\
		a\in A \ar[d] & c\in A \ar[ld] \ar[rd] & b\in A \ar[d] \\
		\ar[d] \ar[rrd]^(0.2){a*c} & & \ar[d] \ar[lld]_(0.2){b*c} \\
		a*(b*c) & & b*(a*c) \\
	}\end{equation*}
	この図にある要素には次のような名称が与えられている。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[公開アルゴリズム] 可換半群$A$
		\item[公開カギ] $c\in A$
		\item[秘密カギ] $a,b\in A$
		\item[共有カギ] $a*b*c\in A$ \\
		$A$が可換半群だから、$a*(b*c)=b*(a*c)$となり、$\alpha$と$\beta$で
		カギ$a*b*c$を共有できる。
		\item[交換カギ] $c*a,c*b\in A$ \\
		交換カギ$a*c$と$b*c$の両方が盗まれた場合でも、共有カギ$a*b*c$を
		計算することが困難であれば、共有カギを秘密にすることができる。
	\end{description} %}
	$A$が群であった場合は、公開カギ$c$の逆元$c^{-1}$が予め計算されてしまう
	ので、共有鍵を秘密にすることができなくなる。
	\begin{equation*}\begin{split}
		a = c^{-1}*a*c \quad\text{for all }a,c\in A
	\end{split}\end{equation*}
	幸か不幸か、計算しやすいものは群になることが多い。
	そこで、$A$の作用域を持ち込んで交換カギから秘密カギの逆元を計算できなく
	する。集合$C$を可換半群$A$の作用域として、$A$の$C$への作用$\rhd$で書く。
	\begin{equation*}\begin{split}
		a\rhd b\rhd c = (a*b)\rhd c \quad\text{for all } a,b\in A,\; c\in C
	\end{split}\end{equation*}
	カギ交換のプロトコルは次のような図で表される。
	\begin{equation*}\xymatrix{
		\text{person }\alpha & \text{common} & \text{person }\beta \\
		a\in A \ar[d] & c\in C \ar[ld] \ar[rd] & b\in A \ar[d] \\
		\ar[d] \ar[rrd]^(0.2){a\rhd c} & & \ar[d] \ar[lld]_(0.2){b\rhd c} \\
		a\rhd b\rhd c & & b\rhd a\rhd c \\
	}\end{equation*}
	この場合、交換カギから秘密カギを求めるアルゴリズムは次のように定式化する
	ことができる。
	\begin{equation*}\begin{split}
		\text{for given } c,d\in C 
		\text{ find } a\in A \text{ such that } d = a\rhd c
	\end{split}\end{equation*}
	この処理が困難なことが保証されていれば、$A$として簡単な半群を使うことが
	できる。
	$C$を$\sei/p\sei$、$A$を$\sizen$として、$\rhd$を$k\rhd n=n^k\mod p$
	としたものが、Diffie-Hellmannのオリジナルらしい。この場合でも、
	公開カギ$c$の逆数$c^{-1}$を用いると、$c^{-a}c^a=1\mod p$となり、
	交換カギ$c^a$に対して$c^{-1}$を$a$回掛けると秘密カギ$a$がわかってしまう。
	秘密カギが$\sei_p$上に一様分布しているとすると、秘密カギを見つける手数
	は$p$程度になる。
	\begin{equation}\label{eq:離散対数問題}\begin{split}
		\text{for given } c,d\in\sei/p\sei 
		\text{ find } a\in\sizen \text{ such that } d = c^a\mod p
	\end{split}\end{equation}
	この問題を効率良く解く方法を見つけることを離散対数問題というらしい。

	Wikipediaによると、RSAとは離散対数問題の困難さを利用した暗号化の方法で
	ある。Diffie-HellmannのオリジナルとRSAの両者共に離散対数問題の困難さを
	利用しているために、両者は混同されがちだが、その目的は異なる。
	$n\in N$をパラメーター、$A_n$を$N$でパラメトライズされたカギとなる群、
	$M$を平文とし、暗号化を作用$\rhd_n:A_n\times M\to M$で定義する。
	そして、次のようなプロトコルによって、暗号化を定義したものがRSAである。
	\begin{equation*}\xymatrix{
		\text{person }\alpha & \text{person }\beta \\
		a,a_n^{-1}\in A_n \ar[d] & m\in M \ar[dd] \\
		\ar[dd] \ar[rd]^{a,n} & & \\
		& \ar[ld]_{a\rhd_n m} \\
		a_n^{-1}\rhd_n a\rhd_n m & \\
	}\end{equation*}
	暗号化のカギ$a$から復号化のカギ$a_n^{-1}$がバレなければ、$\beta$から
	$\alpha$へ送信される平文の秘匿性が保たれる。この場合は、暗号化の頑強性を
	群の逆元を求める難しさに帰着させている。
	\begin{equation*}\begin{split}
		p,q\text{が素数} \implies (m^a\bmod n)^b\bmod n = m \quad\text{where }
		n := pq \\
		\quad\text{for all } m<pq,\quad ab=1\mod (p-1)(q-1)
	\end{split}\end{equation*}
%s1:Diffie-Hellmannのカギ共有}
\section{Galois理論}\label{s1:Galois理論} %{
	教科書\cite{artin1959}のノートを書く。
\subsection{体論}\label{s2:体論} %{
	体について成り立つ基本的な事柄を述べる。
	この節では、体という場合は自明な体は除外するものとする。自明な体とは
	$0$だけからなる体のことである。
\subsubsection{拡大体}\label{s3:拡大体} %{
	\begin{minipage}{0.9\hsize}{\small
		部分体$K\subset E$が与えられたとき、$K$に元$\alpha\in E$を追加して
		体$K(\alpha)$をつくる。$K(\alpha)$を$K$上のベクトル空間として見て、
		線形代数を体$K(\alpha)$を調べる道具として利用できるようにする。
	}\end{minipage}\medskip

	拡大体という言葉は部分体の逆として定義される。
	$K\subseteq E$を部分体とすると、$E$は$K$の拡大体となる。
	体$E$とその部分体$K\subseteq E$に対して、$K$と$\alpha\in E$
	によって生成される体を$K(\alpha)$と書く。
	\begin{equation*}\begin{split}
		K(\alpha) := \text{field of generated by }K\cup\set{\alpha}
		\quad\text{for all } \alpha\in E
	\end{split}\end{equation*}
	$K\subseteq K(\alpha)\subseteq E$という包含関係が成り立つ。
	定義から、$K(\alpha)$は$K$と$\alpha\in E$を含む最小の体となる。
	また、$K(\alpha)$は、乗法を忘れることで、$K$上のベクトル空間として
	見ることもできる。このとき、$K(\alpha)$の$K$上のベクトル空間としての
	次元を$|K(\alpha)/K|$と書く。

	有理数体$\bun$を複素数体$\fukuso$の元で拡大する例を見てみる。

	\begin{example}[拡大体その一]\label{eg:拡大体その一} %{
		$\bun(\sqrt{2})$を考える。ベクトル空間$V$を次のように定義する。
		\begin{equation*}\begin{split}
			V := \set{a + b\sqrt{2}\bou a,b\in\bun}
		\end{split}\end{equation*}
		$V$に乗法を$\fukuso$の乗法で定義する。すると、次の式から$V$は乗法で
		閉じているから$V$は代数となる。
		\begin{equation*}\begin{split}
			(a + b\sqrt{2})(c + d\sqrt{2}) = (ac + 2bd) + (ad + bc)\sqrt{2}
			\quad\text{for all } a,b,c,d\in\bun
		\end{split}\end{equation*}
		さらに、次の式から、任意の$\theta\neq0\in\bun(\sqrt{2})$に対して
		乗法の逆元$\theta^{-1}\in\bun(\sqrt{2})$が唯一つ定まるから、
		$V$は体となることがわかる。
		\begin{equation*}\begin{array}{rcll}
			(a + b\sqrt{2})(c + d\sqrt{2}) = 1
			&\implies& \begin{pmatrix}
				b & a \\ a & 2b
			\end{pmatrix}\begin{pmatrix}
				c \\ d
			\end{pmatrix} = \begin{pmatrix}
				0 \\ 1
			\end{pmatrix} \\
			&\implies& \begin{pmatrix}
				c \\ d
			\end{pmatrix} = \cfrac{1}{a^2 - 2b^2}\begin{pmatrix}
				a \\ -b
			\end{pmatrix} & \lcomment{$a,b\in\bun\implies a^2\neq 2b^2$} \\
			&\implies& (a + b\sqrt{2})^{-1} = \cfrac{a - b\sqrt{2}}{a^2 - 2b^2}
			& \quad\text{for all } a,b\in\bun
		\end{array}\end{equation*}
		したがって、$\fukuso$の乗法によってベクトル空間$V$に乗法を定義した
		ものが、体$\bun(\sqrt{2})$になることがわかる。
	\end{example} %eg:拡大体その一}

	\begin{example}[拡大体その二]\label{eg:拡大体その二} %{
		$\bun(\sqrt{2},\sqrt{3})$を考える。ベクトル空間$V$を次のように定義
		すると、$\bun(\sqrt{2})$と同様にして、$\fukuso$の乗法によって$V$に乗法
		を定義したものが$\bun(\sqrt{2})(\sqrt{3})$になることがわかる。
		\begin{equation*}\begin{split}
			V := \set{a + b\sqrt{3}\bou a,b\in\bun(\sqrt{2})}
		\end{split}\end{equation*}
		また、ベクトル空間$W$を次のように定義しても同様である。
		\begin{equation*}\begin{split}
			W := \set{a + b\sqrt{2}\bou a,b\in\bun(\sqrt{3})}
		\end{split}\end{equation*}
		つまり、$\bun$に元を追加する順番に依らず、同一の体
		$\bun(\sqrt{2})(\sqrt{3})=\bun(\sqrt{3})(\sqrt{2})$が得られる。
		この体を$\bun(\sqrt{2},\sqrt{3})$と書く。
		体$\bun(\sqrt{2},\sqrt{3})$を
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $\bun$上のベクトル空間として見ると、基底系は
			$\set{1,\sqrt{2},\sqrt{3},\sqrt{6}}$で与えられ、
			\item $\bun(\sqrt{2})$上のベクトル空間として見ると、基底系は
			$\set{1,\sqrt{3}}$で与えられるから、
		\end{itemize} %}
		拡大体の次元について次の式が成り立つ。
		\begin{equation*}\begin{split}
			\left|\frac{\bun(\sqrt{2},\sqrt{3})}{\bun}\right|
			= \left|\frac{\bun(\sqrt{2},\sqrt{3})}{\bun(\sqrt{3})}\right|
			\left|\frac{\bun(\sqrt{3})}{\bun}\right|
			= \left|\frac{\bun(\sqrt{2},\sqrt{3})}{\bun(\sqrt{2})}\right|
			\left|\frac{\bun(\sqrt{2})}{\bun}\right|
		\end{split}\end{equation*}
	\end{example} %eg:拡大体その二}

	\begin{example}[拡大体その三]\label{eg:拡大体その三} %{
		$\omega$を$1$の三乗根とする。
		\begin{equation*}\begin{split}
			\omega := \exp{\frac{2\pi i}{3}} = \frac{-1 + \sqrt{3}i}{2}
		\end{split}\end{equation*}
		$\bun(\omega)$は$\omega$を含む$\bun$の最小拡大体で、
		$\omega\in\bun(\sqrt{3}i)$となるから、
		$\bun(\omega)\subseteq\bun(\sqrt{3}i)$が成り立つ。一方、
		$\omega\in\bun(\sqrt{3}i)$は$\sqrt{3}i$を含む$\bun$の最小拡大体で、
		$\sqrt{3}i=2+2\omega\in\bun(\omega)$となるから、
		$\bun(\sqrt{3}i)\subseteq\bun(\omega)$が成り立つ。したがって、
		$\bun(\omega)=\bun(\sqrt{3}i)$となることがわかる。
		同様にして、$\bun(\omega^2)=\bun(\sqrt{3}i)$となることがわかる。
		つまり、次の式が成り立つ。
		\begin{equation*}\begin{split}
			\bun(\omega) = \bun(\sqrt{3}i) = \bun(\omega^2)
		\end{split}\end{equation*}
		これは、多項式$(x-\omega)(x-\omega^2)=x^2+x+1\in\bun[x]$と
		その根による拡大体$\bun(\omega)$とが関係していることを示している。
	\end{example} %eg:拡大体その三}

	\begin{example}[拡大体その四]\label{eg:拡大体その四} %{
		$n$を$3$以上の自然数として$n$乗根$\omega=\exp(2\pi i/n)$による
		整数の拡大体$\sei(\omega)$を考える。$\omega$は次の式を満たす。
		\begin{equation*}\begin{split}
			\omega^n &= 1 \\
			(x - \omega)(x - \omega^2)\cdots(x - \omega^{n-1}) 
			&= x^0 + x^1 +\cdots+ x^{n-1} \\
		\end{split}\end{equation*}
		一つ目の式から$\sei(\omega)$は集合$\set{\omega^i\bou i=0..(n-1)}$に
		よって張られることがわかり、$|\sei(\omega)|\le n$となることがわかる。
		また、二つ目の式から$\omega+\omega^2+\cdots+\omega^{n-1}=1$となり、
		$|\sei(\omega)|\le n-1$となることがわかる。
		また、$n$が素数でなければ、$2$以上の自然数$p$と$q$で$n=pq$と書くことが
		できる。このとき、$x^n-1=(x^p)^q-1=(x^p-1)(1+x^p+\cdots+x^{p(q-1)})$
		と書けて、$|\sei(\omega)|\le p-1$となることがわかる。
		したがって、$\omega$による拡大体の次元の上限が次のように得られる。
		\begin{equation*}\begin{split}
			|\sei(\omega)| \le (\text{$n$を割り切る$2$以上の最小の素数}) - 1
		\end{split}\end{equation*}
	\end{example} %eg:拡大体その四}

	\begin{proposition}[次元のチェイン則]\label{prop:次元のチェイン則} %{
		任意の拡大体$A\subseteq B\subseteq C$に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			A\subseteq B\subseteq C \implies \left|\frac{C}{A}\right|
			= \left|\frac{C}{B}\right|\left|\frac{B}{A}\right|
		\end{split}\end{equation*}
	\end{proposition} %prop:次元のチェイン則}
	\begin{proof} %{
		$B$と$C$をそれぞれ$A$と$B$上のベクトル空間として次のように表した時、
		\begin{alignat*}{2}
			B &= A(\beta_1,\beta_2,\dots),&\quad \beta_1,\beta_2,\dots\in B \\
			C &= B(\gamma_1,\gamma_2,\dots),&\quad \gamma_1,\gamma_2,\dots\in C
		\end{alignat*}
		集合$\set{\beta_i\gamma_j\in C}$が$A$上のベクトル空間$C$の基底系
		となることが言えればよい。次の式から$\set{\beta_i\gamma_j\in C}$が
		$A$上で線形独立となることがわかる。
		\begin{alignat*}{3}
			\sum_{ij}a_{ij}\beta_i\gamma_j = 0
			&\implies \sum_{i}a_{ij}\beta_i = 0 &\;\text{for all } j
			&\quad \because \set{\gamma_j}\text{は$B$上で線形独立} \\
			&\implies a_{ij} &\;\text{for all } i,j
			&\quad \because \set{\beta_i}\text{は$A$上で線形独立}
		\end{alignat*}
		したがって、$|C/A|\ge|C/B||B/A|$となることがわかる。この式の右辺の
		うち一つでも無限大になっていれば、命題が成り立つことがわかる。
		$|C/B|$と$|B/A|$が共に有限の場合を考える。
		
		任意の$c\in C$はある$b_j\in B$があって$c=\sum_jb_j\gamma_j$と書くこと
		ができる。また、任意の$j$に対してある$a_{ij}\in A$があって
		$b_j=\sum_ib_i\beta_i$と書くことができる。したがって、
		$c=\sum_{ij}a_{ij}\beta_i\gamma_j$となり、任意の$C$の元は
		$\set{\beta_i\gamma_j\in C}$の$A$上の線型結合で書くことができることが
		わかる。したがって、$|C/A|\le|C/B||B/A|$となることがわかる。

		以上より$|C/A|=|C/B||B/A|$となり命題が証明された。
	\end{proof} %}
%s3:拡大体}
\subsubsection{多項式}\label{s3:多項式} %{
	\begin{minipage}{0.9\hsize}{\small
	既約な多項式を定義する。既約な多項式は素数に対応するものである。
	係数体が複素数以外では、与えられた多項式が規約かどうかを判定することは
	難しい。整数上の多項式に対して、既約かどうかを判定するための道具にも
	触れる。
	}\end{minipage}\medskip

	$K$を体とし、$K$上の多項式全体のつくる集合を$K[x]$と書く。
	$K$の加法と乗法によって$K[x]$を$K$上のベクトル空間としてみる。
	さらに、$K[x]$に乗法を次のように定義すると$K[x]$は代数となる。
	\begin{equation*}\begin{split}
		x^mx^n := x^{m+n} \quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}
	このようにして定義された代数$K[x]$を上の多項式環という。
	多項式$f\in K[x]$の冪の最高の値を$f$の次数といい、$\deg f$と書く。
	\begin{equation*}\begin{split}
		f = a_0 + a_1x + \cdots + a_nx^n \implies \deg f = n
	\end{split}\end{equation*}

	\begin{proposition}[多項式の剰余]\label{prop:多項式の剰余} %{
		$K$を体、$K[x]$を上の多項式環とする。任意の$f\in K[x]$と
		$g\neq0\in K[x]$に対して、次の式を満たす$q,r\in K[x]$が唯一つ定まる。
		\begin{equation*}\begin{split}
			f = qg + r \And \deg r < \deg g
		\end{split}\end{equation*}
	\end{proposition} %prop:多項式の剰余}
	\begin{proof} %{
		命題の$q,r\in K[x]$が存在することと、それが一意であることの二つに分けて
		証明する。

		まず、命題の$q,r\in K[x]$が存在することを証明する。
		$\deg f < \deg g$のときは、$q=0,\; r=f$とすれば、$f=qg+r$となる。
		したがって、$\deg f\le \deg g$となる場合を考える。
		多項式の最高次数の単項式を取り出す操作を$\mu:K[x]\to K[x]$とする。
		\begin{equation*}\begin{split}
			a_n\neq 0\in K[x] \implies \mu(a_0+a_1x +\cdots+ a_nx^n) = a_nx^n
		\end{split}\end{equation*}
		次のような多項式$F_0,F_1,\dots$を用いて$f$の次数を下げていくと、
		\begin{alignat*}{2}
			F_0 &= f \\
			F_1 &= F_0 - \frac{\mu F_0}{\mu g} g, &\quad &\deg h_1< (\deg F_0) \\
			F_2 &= F_1 - \frac{\mu F_1}{\mu g} g, &\quad &\deg h_2< (\deg F_1) \\
			\cdots
		\end{alignat*}
		ある$0\le k\le (\deg f)-(\deg g)$があって次のようになる。
		\begin{equation*}\begin{split}
			\deg F_{k+1}< \deg g\le \deg F_k\le \deg f
		\end{split}\end{equation*}
		したがって、$f$は次のように書けて、
		\begin{equation*}\begin{split}
			f = Qg + F_{k+1},\quad
			Q = \frac{\mu F_0}{\mu g} + \frac{\mu F_1}{\mu g}
				+\cdots+ \frac{\mu F_k}{\mu g}
		\end{split}\end{equation*}
		$Q,F_{k+1}$が命題の$q,r$となることがわかる。

		次に命題の条件を満たす$q,r\in K[x]$が一意であることを証明する。
		\begin{alignat*}{2}
			f &= qg + r, &\quad \deg r\le \deg g \\
			f &= Qg + R, &\quad \deg R\le \deg g
		\end{alignat*}
		とすると、$(Q-q)g=R-r$となるが、$Q\neq q$ならば、
		左辺の次数は$\deg g$以上で、右辺の次数は$\deg g$より小さくなる。
		これは矛盾である。したがって、$Q=q$となる必要があるが、
		そのときは$R=r$となる。したがって、命題の条件を満たす$q,r\in K[x]$が
		一意であることがわかる。
	\end{proof} %}

	この命題の$q$を$g$を$f$で割った商、$r$を$g$を$f$で割った余りという。
	また、二つの多項式$f,g\in K[x]$の関係を次のように定義する。
	\begin{equation*}\begin{split}
		\text{$f$は$g$を割り切る} &\xiff{\dfn} \exists\; q\in K[x] 
			\text{ such that } g = qf \\
		\text{$f$は$g$は互いに素} &\xiff{\dfn} 
		\text{$f$と$g$を共に割り切る多項式は定数のみ}
	\end{split}\end{equation*}
	自然数の場合と同様に最大公約多項式を定義できるが、
	多項式の場合、$f$が$g$を割り切れば、任意の$a\neq0\in K[x]$を掛けた
	$af$も$g$を割り切るから、最大公約多項式$\gcd:K[x]\times K[x]\to K[x]$を
	最高次の係数が$1$になる多項式に固定する。
	\begin{equation*}\begin{split}
		\gcd(f,g) = a_0 + a_1 +\cdots+ a_{m-1}x^{m-1} + x^m
	\end{split}\end{equation*}

	Bezoutの恒等式\ref{prop:Bezoutの恒等式}を多項式の場合に持ってくる。
	命題\ref{prop:Bezoutの恒等式}の絶対値$|-|:\sei\to\sizen$のところを
	$\deg:K[x]\to\sizen$に変えれば、多項式に対して同様に証明できる。

	\begin{proposition}[Bezoutの恒等式（多項式）]\label{prop:Bezoutの恒等式（多項式）} %{
		$0$でない$f,g\in K[x]$を互いに素とすると、$fF+gG=1$となる$F,G\in K[x]$
		が、$(F,G)\mapsto(F-g,G+f)$の不定性を除いて唯一つ定まる。
	\end{proposition} %prop:Bezoutの恒等式（多項式）}
	\begin{proof} %{
		部分空間$V\subseteq K[x]$を次のように定義し、
		\begin{equation*}\begin{split}
			V := \set{fa + gb\in K[x]\bou a,b\in K[x]}
		\end{split}\end{equation*}
		$n$を$V$の$0$でない多項式の最小の次数とする。
		$V$の定義より、$n\le\min(\deg f,\deg g)$となることがわかる。

		$h=F_0f+G_0g\in V$を$\deg h=n$となる多項式とする。
		$f$を$h$で割ると、$f=Fh+r$となる$F\in K[x]$と$\deg r<n$となる
		$r\in K[x]$が唯一つ定まるが、$r=f(1-FF_0)-gG_0\in V$となり、
		$r=0$となるとき以外は$h$の定義と矛盾する。したがって、$r=0$となり、
		$f=Fh$と書かれることになる。同様に$g$を$h$で割ると、
		$g=Gh$となる$G\in K[x]$が唯一つ定まることがわかる。
		\begin{equation*}\begin{split}
			\exists\; F,G\in K[x] \text{ such that } f = Fh,\; g = Gh
		\end{split}\end{equation*}
		$h$が定数でない場合は、$f$と$g$が互いに素であることに矛盾するから、
		$h$は定数でなければならないことがわかる。$h$の定義より、$h$は$0$で
		ないから、$h$は$0$でない定数となる。したがって、$h^{-1}(F_0f+G_0g)=1$
		となり、$F_0/h,G_0/h$が命題の$F,G$となる。

		$F_i,G_i\in K[x]\;(i=1,2)$が共に$fF_i+gG_i=1$を満たせば、
		$f(F_1-F_2)+g(G_1-G_2)=0$となり、命題の不定性が成り立つことがわかる。
	\end{proof} %}

	多項式の可約と既約を次のように定義する。
	\begin{equation*}\begin{split}
		f\in K[x]\text{が可約}
		& \xiff{\dfn} \exists\; g_1,g_2\in K[x] \text{ such that } f = g_1g_2 
			\text{ with } 0 < \deg g_i \\
		f\in K[x]\text{が既約}
		& \xiff{\dfn} 0 < \deg f \text{かつ可約でない} \\
	\end{split}\end{equation*}
	多項式の可約や既約という言葉は、次数$2$以上の多項式に対してのみ実質的な
	意味を持つ。次数が$1$の多項式はすべて既約である。
	
	多項式の既約性は多項式の根と関係している。次の式から、任意の体$K$で次数
	が$1$の多項式は必ず$K$に根を持つことがわかる。
	\begin{equation*}\begin{split}
		a + bx = 0,\quad b\neq 0 \implies \begin{cases}
			x = 0, &\text{ iff } a = 0 \\
			x = - \cfrac{a}{b}, &\text{ otherwise } \\
		\end{cases} \quad\text{for all } a,b\in K
	\end{split}\end{equation*}
	また、$f\in K[x]$は$a\in K$を根に持つとする。$f=q(x-a)+b$となる
	$q\in K[x]$と$b\in K$が唯一つ定まるが（命題\ref{prop:多項式の剰余}）、
	$0=fa=b$だから、$f=q(x-a)$となる。したがって、次数が$2$以上の既約多項式
	は$K$に根を持たないことがわかる。

	次の命題は整数上の多項式が既約かどうかを判定するのに役に立つ。

	\begin{proposition}[Gaussの補題]\label{prop:Gaussの補題} %{
		$f\in\sei[x]$がある$g,h\in\bun[x]$で$f=gh$と書けるならば、
		ある$G,H\in\sei[x]$で$f=GH$と書くことができる。
	\end{proposition} %prop:Gaussの補題}
	\begin{proof} %{
		$g,h\in\bun[x]$で$f=gh$と書けたとする。$g$と$h$それぞれに対して、
		まず係数の分母の最小公倍数を括りだしてすべての係数を整数にして、
		次に係数の最大公約数を括りだして次のようにする。
		\begin{equation*}\begin{split}
			g = \frac{a}{b} G,\quad h = \frac{c}{d} H
			\quad\text{where } a,b,c,d\in\sei,\; G,H\in\sei[x]
		\end{split}\end{equation*}
		$G$と$H$はそれぞれ係数の最大公約数は$1$になる。
		仮定から$bdf=acGH$と書けるが、$GH$の係数の最大公約数は$1$だから、
		$ac$は$hd$の倍数となる。したがって、$e\in\sei$を$ac=bde$とすると、
		$f=eGH$となり、命題が成り立つことがわかる。
	\end{proof} %}

	この命題の証明から、整数上の多項式で互いに素になる
	（係数の最大公約数が$1$になる）もの全体は乗法に関して閉じていることが
	わかる。
	\begin{equation*}\begin{split}
		\left\{\begin{split}
			\text{$f$の係数は互いに素} \\
			\text{$g$の係数は互いに素} \\
		\end{split}\right. \implies \text{$fg$の係数は互いに素}
		\quad\text{for all } f,g\in\sei[x]
	\end{split}\end{equation*}
	$0$でない整数上の多項式で係数が互いに素になるものを原始多項式という。
	原始多項式同士の乗法は原始多項式になる。

	さらに、整数上の多項式では次の命題が成り立つ。

	\begin{proposition}[係数の約数]\label{prop:係数の約数} %{
		$g,h\in\sei[x]$として、
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $gh$のすべての係数が素数$p$で割り切れ、
			\item $gh$の定数項が$p^2$で割り切れないならば、
		\end{itemize} %}
		$g$または$h$のすべての係数は$p$で割り切れる。
	\end{proposition} %prop:係数の約数}
	\begin{proof} %{
		$g,h$を次のようにおくと、
		\begin{equation*}\begin{split}
			g = g_0 + g_1x + \cdots + g_mx^m,\quad
			h = h_0 + h_1x + \cdots + h_nx^n
		\end{split}\end{equation*}
		$gh$の各係数$f_i$は次のようになる。
		\begin{equation*}\begin{split}
			f_0 &= g_0h_0 \\ 
			f_1 &= g_0h_1 + g_1h_0 \\ 
			\cdots \\
			f_{m+n} &= g_mh_n \\ 
		\end{split}\end{equation*}
		$f_0$が$p$で割り切れ、$p^2$で割り切れないためには、
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $g_0$が$p$で割り切れ、$h_0$が$p$で割り切れないか、
			\item $g_0$が$p$で割り切れず、$h_0$が$p$で割り切れる
		\end{itemize} %}
		かのどちらかになる。ここでは、$g_0$が$p$で割り切れて$h_0$が$p$で
		割り切れないとする。すると、$f_1$が$p$で割り切れるためには、
		$g_1$が$p$で割り切れなければならない。
		さらに、$f_2$が$p$で割り切れるためには、$g_2$が$p$で割り切れなければ
		ならない。このようにして$f^m$まで続けていくと、$g$のすべての係数が
		$p$で割り切れなければならないことが示される。
	\end{proof} %}

	次の命題は上記の命題とほぼ同じ内容だが、最高次の係数が$1$となっている
	多項式に対して、その多項式が既約かどうかを判定するのに有効である。

	\begin{proposition}[Eisensteinの判定法]\label{prop:Eisensteinの判定法} %{
		次数が$2$以上の整数上の多項式$f$を次のようにおく。
		\begin{equation*}\begin{split}
			f = f_0 + f_1x + \cdots + f_nx^n
		\end{split}\end{equation*}
		ある素数$p$が存在して、係数$f_i$が次の条件を満たす時、
		$f$は整数上で既約になる。
		\begin{enumerate}\setlength{\itemsep}{-1mm} %{
			\item $a_n$が$p$で割り切れない。
			\item $a_0,a_1,\dots,a_{n-1}$が$p$で割り切れる。
			\item $a_0$が$p^2$で割り切れない。
		\end{enumerate} %}
	\end{proposition} %prop:Eisensteinの判定法}
	\begin{proof} %{
		命題の$f$が可約だとすると、ある次数の$1$が以上の整数上の多項式$g,h$で
		$f=gh$と書ける。すると、命題\ref{prop:係数の約数}の証明と同じように
		して、$g$または$h$の係数がすべて$p$で割り切れることが示される。
		ここで、$m:=\max(\deg g, \deg h)$とすると、$m<n$となり、
		命題\ref{prop:係数の約数}の証明では、係数$f_m$までのチェックで$g$
		または$f$の係数が$p$で割り切れることが示されることに注意する。
		したがって、$f$の係数すべてが$p$で割り切れることになり、命題の仮定に
		矛盾する。
	\end{proof} %}

	\begin{example}[多項式の根その一]\label{eg:多項式の根その一} %{
		剰余体$\sei_7:=\sei/7\sei$上の多項式の根を考える。
		$\sei_7$の積表は次のようになる。
		\begin{equation*}\begin{array}{r|rrrrrr}
			& 2 & 3 & 4 & 5 & 6 \\\hline
			2 & 4 & 6 & 1 & 3 & 5 \\
			3 & & 2 & 5 & 1 & 4 \\
			4 & & & 2 & 6 & 3 \\
			5 & & & & 4 & 2 \\
			6 & & & & & 1 \\
		\end{array}\end{equation*}
		積表を用いると次のように多項式の根が求まる。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $3x-4$ \\
			根は$x=3^{-1}\cdot4=5\cdot4=6$となる。
			\item $x^2+x+1$ \\
			$x^2+x+1=(x^3-1)/(x-1)$だから、$x^3=1$となる$1$以外の
			数が根となる。積表から$2$と$4$が根となることがわかる。
			\item $x^2-3$ \\
			積表から$\sei_7$に根はないことがわかる。
		\end{itemize} %}
	\end{example} %eg:多項式の根その一}

	\begin{example}[既約な多項式その二]\label{eg:既約な多項式その二} %{
		有理数体上の多項式の既約性を考える。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $x^3-3$ \\
			Eisensteinの判定法で割る素数を$3$とすれば、この多項式が既約である
			ことがわかる。
			\item $x^4-8x^2+2$ \\
			Eisensteinの判定法で割る素数を$2$とすれば、この多項式が既約である
			ことがわかる。
			\item $x^4+x^3+x^2+x+1$ \\
			$fx=x^4+x^3+x^2+x+1$とすると、$fx=(x^5-1)/(x-1)$となるが、
			$x=y+1$とすると、$fx=y^4+5y^3+10y^2+10y+5$となる。
			$Fy=y^4+5y^3+10y^2+10y+5$として、Eisensteinの判定法で割る素数を
			$5$とすれば、$F$が既約であることがわかる。ここで、$f$が既約でない
			とすると、$f=gh$となる次数が$1$以上の整数上の多項式$g,h$が存在
			するが、そのとき、$f(y+1)=(g(y+1))(h(y+1))=Fy$となり、
			$Fy$が$g(y+1)$と$h(y+1)$の二つの次数が$1$以上の整数上の多項式の
			乗法で書かれることになる。これは、$F$が既約であることに矛盾する。
			したがって、$f$は既約になることがわかる。
		\end{itemize} %}
	\end{example} %eg:既約な多項式その二}

	この最後の例\ref{eg:既約な多項式その二}では、$K[x]$の自己代数同型射で、
	既約な多項式は既約な多項式へ写像されることを使っている。
	\begin{proof} %{
		$f\in K[x]$を既約、$\phi\in\Aut K[x]$とする。$\phi f=GH$と次数が
		$1$以上の$G,H\in K[x]$で書かれたとすると、$f=(\phi^{-1}G)(\phi^{-1}H)$
		となり、$f$が既約であることに矛盾する。
		したがって、$\phi f$も既約である。
	\end{proof} %}
%s3:多項式}
\subsubsection{代数的要素}\label{s3:代数的要素} %{
	\begin{minipage}{0.9\hsize}{\small
		部分体$K\subset E$に$\alpha\in E$を追加した拡大体$K(\alpha)$に対して、
		$K[x]$から$K(\alpha)$への代数射を構成する。このとき、$\alpha$を根に
		もつ$K$上の既約多項式が重要な役割を果たす。
	}\end{minipage}\medskip

	$K\subset E$を体、$K[x]$を$K$上の多項式環とする。$\alpha\in E$に対して
	$f\alpha=0$となる$f\in K[x]$が存在するとき、$\alpha$を$K$上で代数的
	という。

	$\alpha$が$K$上で代数的とする。このとき、$f\alpha$となる$f\in K[x]$で
	最低の次数を持つものを選び出して、その最高次数の係数が$1$になるように
	$f$に$K$の元を掛ける。
	\begin{equation*}\begin{split}
		f\alpha = 0,\quad f = f_0 + f_1x +\cdots+ f_{n-1}x^{n-1} + x^n
	\end{split}\end{equation*}
	すると次の性質が成り立つ。
	\begin{enumerate}\setlength{\itemsep}{-1mm} %{
		\item\label{enum:乗法の因子その一} $g\alpha=0$となる$g\in K[x]$は
		$f$を乗法の因子に持つ。
		\item\label{enum:既約その一} $f$は既約になる。
		\item\label{enum:一意その一} $f$は一意に定まる。
	\end{enumerate} %}
	\begin{proof} %{
		$g\in K[x]$を$g\alpha=0$とすると、$g=qf+r$かつ$\deg r<\deg f$となる
		$q,r\in K[x]$が一意に定まる。$0=g\alpha=r\alpha$より、$r\neq 0$
		とすると、$r$が$f$よりも次数の小さい$r\alpha=0$となる多項式となり、
		$f$の定義に矛盾する。したがって、$r=0$となり、$g=qf$となる。
		したがって、性質\ref{enum:乗法の因子その一}と\ref{enum:一意その一}
		が成り立つことが示される。
		また、$f=gh$となる次数が$1$以上の$g,h\in K[x]$が存在すれば、$g\alpha=0$
		または$h\alpha=0$となるから、$f$の定義に矛盾する。したがって、$f$が
		既約であることがわかり、性質\ref{enum:既約その一}が成り立つことが
		示される。
	\end{proof} %}
	このような$f$を$\alpha$の最小多項式という。

	$\alpha\in E$が$K$上で代数的、$f$を$\alpha$の最小多項式として、
	部分集合$K_\alpha\subseteq E$を次のように定義する。
	\begin{equation*}\begin{split}
		K_\alpha := \set{g\alpha\in E\bou g\in K[x] \text{ and } \deg g<\deg f}
	\end{split}\end{equation*}
	$K_\alpha$の元は$\alpha^0,\dots,\alpha^{\deg f-1}$の$K$-線型結合で
	書くことができるから、$K$は拡大体$K(\alpha)$の部分集合となっている。
	$K_\alpha$は$E$の加法で閉じていて、$K$の乗法がスカラー積となるから、
	ベクトル空間となる。また、$g\alpha,h\alpha\in K_\alpha$とすると、
	$K[x]$で$gh=qf+r$かつ$\deg r<\deg f$となる$q,r\in K[x]$が唯一つ定まり、
	$(g\alpha)(h\alpha)=r\alpha\in K_\alpha$となる。
	したがって、$K_\alpha$は$E$の乗法で閉じているから、代数となることが
	わかる。以下で、$K_\alpha$が体になることを証明する。
	$K_\alpha$が体になることが示されれば、定義より$K(\alpha)$は$K$と
	$\alpha$を含む最小の体だから$K_\alpha=K(\alpha)$となることがわかる。

	$K_\alpha$を$K[x]$に持ってくることを考える。
	多項式に$\alpha$を代入する操作を$\pi_\alpha$と書き、$m$を$K[x]$と$E$の
	通常の乗法とすると、次の可換図が成り立つことがわかる。
	\begin{equation*}\xymatrix{
		K[x]\otimes K[x] \ar[r]^m \ar[d]^{\pi_\alpha\otimes\pi_\alpha} 
			& K[x] \ar[d]^{\pi_\alpha} \\
		K_\alpha\otimes K_\alpha \ar[r]^m & K_\alpha \\
	}\end{equation*}
	$f$の性質\ref{enum:乗法の因子その一}から、$f$で生成される次の部分代数
	$(f)\subseteq K[x]$が、$(f)=\ker\pi_\alpha$となることがわかる。
	\begin{equation*}\begin{split}
		(f) := \set{qf\in K[x]\bou q\in K[x]}
	\end{split}\end{equation*}
	したがって、$K$-代数同型$K[x]/(f)\simeq K_\alpha$が成り立つ。
	$K[x]/(f)$が体になることを証明できれば、代数同型により$K_\alpha$が
	体になることが証明される。

	$K$-代数射$\pi_f:K[x]\to K[x]/(f)$を$K$-代数同型
	$\pi_fK[x]\simeq K_\alpha$が成り立つように定義する。
	$\pi_f$は$f$で割った余りをとる操作である。
	$\pi_f$の作用を$K[x]$の基底系$x^m$に対して書くと次のようになる。
	\begin{alignat*}{2}
		\pi_f x^m &:= x^m &\quad& \text{iff } m < n \\
		\pi_f x^{n+p} :&= \pi\bigl(\overbrace{x^p\underbrace{
				(x^n - fx)}_{(n-1)\text{次以下}}}^{(n+p-1)\text{次以下}}\bigr)
		&\quad& \text{for all } p\in\sizen
	\end{alignat*}

	$g\in K[x]$が$\pi g\neq 0$となるならば、$f$と$g$は互いに素になる。
	したがって、命題\ref{prop:互いに素な多項式}より、
	$fF+gG=1$となる$F,G\in K[x]$が存在する。
	この式に対して$f$ので割った余りをとると、$(\pi g)(\pi G)=1$となり、
	$\pi g$の逆元が$\pi G$となることがわかる。
	よって、$K[x]/(f)$が体になることがわかる。式で書くと次のようになる。
	\begin{equation*}\begin{split}
		K(\alpha)=K_\alpha\simeq K[x]/(f)
	\end{split}\end{equation*}

	$K[x]/(f)$が体になることは、教科書\cite{artin1959}にあるように、
	線形代数を使っても証明することができる。ここで、$f\in K[x]$は次数$n$の
	既約多項式とする。$V$を次数が$n-1$以下の$K[x]$の部分空間とする。
	$\pi_f:V\to K[x]/(f)$はベクトル空間として同型射となるから、
	任意の$g\neq0\in V$と$h\in V$に対して、$\pi_f(gG)=\pi_fh$となる$G\in V$
	が存在することが言えれば、$K[x]/(f)$が体になることが言える。
	$G$と$h$を次のようにおく。
	\begin{equation*}\begin{split}
		G = G_0 + G_1x +\cdots+ G_{n-1}x^{n-1},\quad
		h = h_0 + h_1x +\cdots+ h_{n-1}x^{n-1}
	\end{split}\end{equation*}
	すると、式$\pi_f(gG)=\pi_fh=h$は次のような行列で書くことができる。
	\begin{equation*}\begin{split}
		\begin{pmatrix}
			g_{00} & g_{10} &\cdots& g_{(n-1)0} \\
			g_{01} & g_{11} &\cdots& g_{(n-1)1} \\
			\vdots & \vdots &\cdots& \vdots \\
			g_{0(n-1)} & g_{1(n-1)} &\cdots& g_{(n-1)(n-1)} \\
		\end{pmatrix}\begin{pmatrix}
			G_0 \\ G_1 \\ \vdots \\ G_{n-1}
		\end{pmatrix} = \begin{pmatrix}
			h_0 \\ h_1 \\ \vdots \\ h_{n-1}
		\end{pmatrix} \quad\text{where} \\
		\pi_f(x^ig) = g_{i0} + g_{i1}x +\cdots+ g_{i(n-1)}x^{n-1}
		\quad\text{for all } i=0,\dots,n-1
	\end{split}\end{equation*}
	この式の左辺の行列を$\what{g}$と書くと、$\what{g}$が正則となることが
	証明できればよい。$\what{g}\what{\xi}=0$となる$\what{\xi}\in K^{n-1}$が
	$0$だけとなることが言えれば、$\what{g}$が正則となることが言える。
	$\what{\xi}\in K^{n-1}$に対して、$\xi\in V$を次のようにおくと、
	\begin{equation*}\begin{split}
		\xi := \begin{pmatrix}
			1 & x &\dots& x^{n-1}
		\end{pmatrix}\what{\xi} 
		= \what{\xi}_0 + \what{\xi}_1x +\cdots+ \what{\xi}_{n-1}x^{n-1}
	\end{split}\end{equation*}
	次の式が成り立つが、
	\begin{equation*}\begin{split}
		\what{g}\what{\xi} = 0 \implies \pi_f(g\xi) = 0
		\implies g\xi\in \ker\pi_f
	\end{split}\end{equation*}
	$g$と$\xi$は次数が$n-1$以下の多項式なので、その積$g\xi$が$f$で割り切れる
	ことはない。したがって、$\what{g}\what{\xi}$ならば$\what{\xi}=0$
	となることがわかる。よって、任意の$g\neq0\in V$に対して行列
	$\what{g}$が正則になることがわかり、$K[x]/(f)$が体になることがわかる。

	次の命題によって、$K$上の既約多項式$f$が与えられれば、
	$f$の根よる体の拡大は根の選び方に依らないことがわかる。

	\begin{proposition}[根の選び方]\label{prop:根の選び方} %{
		部分体$K\subseteq E$とし、$\alpha\in E$を$K$上で代数的とする。
		$f$を$\alpha$の最小多項式とすると、$|K(\alpha)/K|=\deg f$となり、
		任意の$f$の根$\beta$に対して、代数同型$K(\alpha)\simeq K(\beta)$が
		成り立つ。
	\end{proposition} %prop:根の選び方}
	\begin{proof} %{
		上記の議論より、$|K(\alpha)/K|=|K[x]/(f)|=\deg f$となることがわかる。
		また、任意の$f$の根$\beta$に対して、$f$は$\beta$の最小多項式になる。
		そうでなければ、$f$が既約であることに矛盾する。したがって、
		代数同型$K(\alpha)\simeq K[x]/(f)\simeq K(\beta)$が成り立つ。
	\end{proof} %}

	次の命題は代数学の基本定理に相当するものである。

	\begin{proposition}[Kroneckerの定理]\label{prop:Kroneckerの定理} %{
		$K$を体、$g\in K[x]$を定数でない多項式とすると、拡大体$E\supseteq K$
		で$g$が$E$に根を持つものが存在する。
	\end{proposition} %prop:Kroneckerの定理}
	\begin{proof} %{
		$g$の既約因子$h$をとって、$K[x]/(h)$を作ればよい。
	\end{proof} %}

	本題とは外れるが、教科書\cite{artin1959}の演習問題を命題の形で書いて
	おく。

	\begin{proposition}[有理数の自己同型射]\label{prop:有理数の自己同型射} %{
		有理数体の自己代数同型射は恒等射だけである。
	\end{proposition} %prop:有理数の自己同型射}
	\begin{proof} %{
		まず、$\sigma$を有理数体の自己代数射として、次の式を証明する。
		\begin{equation}\label{eq:分数の自己同型その一}\begin{split}
			\sigma q = q(\sigma 1) \quad\text{for all } q\in\bun
		\end{split}\end{equation}

		自然数に対して次の式が成り立ち、
		\begin{equation*}\begin{split}
			\sigma n = \underbrace{(\sigma1) +\cdots+ (\sigma1)}_{\text{$n$}個} 
			= n(\sigma1)\quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		次の式から、
		\begin{equation*}\begin{split}
			n(\sigma\frac{m}{n}) = \underbrace{
				(\sigma\frac{m}{n}) +\cdots+ (\sigma\frac{m}{n})}_{\text{$n$}個}
				= \sigma m \quad\text{for all } m\in\sizen,\; n\in\sizen_+
		\end{split}\end{equation*}
		自然数について成り立つ結果を使うと、次の式が導かれる。
		\begin{equation*}\begin{split}
			\sigma\frac{m}{n} = \frac{m}{n}(\sigma1)
			\quad\text{for all } m\in\sizen,\; n\in\sizen_+
		\end{split}\end{equation*}
		したがって、$\sigma0=2(\sigma0)$より、$\sigma0=0$となるから、
		任意の$q\in\bun$に対して$\sigma(-q)=-\sigma q=-q(\sigma1)$が
		成り立ち、式\ref{eq:分数の自己同型その一}が成り立つことがわかる。

		ここで、$\sigma$を自己同型射とすると、
		$\sigma1=(\sigma1)^2$より、$\sigma1=0$または$\sigma1=1$となるが、
		$\sigma1=0$ならば、$\sigma$は自己同型でなくなるから、$\sigma1=1$
		となることがわかる。したがって、命題が成り立つことがわかる。
	\end{proof} %}

	\begin{proposition}[実数の自己同型]\label{prop:実数の自己同型} %{
		実数体の自己代数同型射は恒等射だけである。
	\end{proposition} %prop:実数の自己同型}
	\begin{proof} %{
		$\sigma$を実数体の$1:1$の自己代数射とする\footnote{
			$K$上の代数$A,B$の代数射$\sigma:A\to B$が次の性質を満たせば、
			\begin{equation*}\begin{split}
				\sigma a = 0\implies a = 0 \quad\text{for all } a\in A
			\end{split}\end{equation*}
			$\sigma$は$1:1$になる。なぜなら、$\sigma a_1=\sigma a_2$ならば、
			$\sigma(a_1-a_2)=0$となり、$a_1=a_2$となる。
			また、$A$が体の場合は、$a\neq0$で$\sigma a=0$となる$a\in A$が存在
			すれば、$\sigma b=\sigma(aa^{-1}b)=0(\sigma(a^{-1}b))=0$となり、
			$\sigma A=0$となってしまう。
		}。すると、任意の$0<a\in\jitu$に対して$\sigma a=(\sigma\sqrt{a})^2>0$
		となる。したがって、任意の$a<b\in\jitu$に対して
		$\sigma b-\sigma a=(\sigma\sqrt{b-a})^2>0$となり、
		次の式が成り立つことがわかる。
		\begin{equation}\label{eq:実数の自己同型その一}\begin{split}
			a<b \implies \sigma a< \sigma b \quad\text{for all } a,b\in\jitu
		\end{split}\end{equation}

		ここで、$\sigma$を自己同型射として、背理法を使って命題を証明する。
		$a<\sigma a$となる$a\in\jitu$があったとする。すると、$a<q<\sigma a$
		となる有理数$q$が存在する（実数の定義）。$a<q$に対して
		式\ref{eq:実数の自己同型その一}を使うと、$\sigma a<\sigma q$となるが、
		有理数は$\sigma$で不変だから（命題\label{prop:有理数の自己同型射}）、
		$\sigma a<q$となり、$q$の定義とと照らし合わせると、
		$\sigma a<q<\sigma a$となって、$q$の定義と矛盾する。
		$\sigma a<a$となる$a\in\jitu$があった場合も同様である。
		したがって、$\sigma$は恒等射となる。
	\end{proof} %}
%s3:代数的要素}
\subsubsection{分解体}\label{s3:分解体} %{
	\begin{minipage}{0.9\hsize}{\small
		$x^2+1\in\bun[x]$は次の二つの方法で既約因子に分解される。
		一つ目の方法は、抽象的に$\alpha^2+1=0$となる元を考えて、拡大体
		$\bun(\alpha)$で$x^2+1=(x-\alpha)(x+\alpha)$と既約因子に分解する。
		二つ目の方法は、$\beta:=(\exp i\pi/2)\in\fukuso$として、$\fukuso$で
		$x^2+1=(x-\beta)(x+\beta)$と既約因子に分解する。
		この二つの拡大体$\bun(\alpha)$と$\bun(\beta)$が代数同型となることを
		示す。
	}\end{minipage}\medskip

	部分体$K\subseteq E$とし、$p\in K[x]$を既約とは限らない多項式とする。
	$p$のすべての根$\alpha_1,\dots,\alpha_r$が$E$に含まれれば、$K$の拡大体
	$K(\alpha_1,\dots,\alpha_r)$を$K$上の$p$の分解体、または単に、
	$p$の分解体という。
	
	部分体$K\subset E$かつ$K\subset E'$とし、$p\in K[x]$のすべての根
	$\alpha_1,\dots,\alpha_r$が$E$にも$E'$にも含まれるとする。
	この時、$E$内での$p$の分解体$B$と、$E'$内での$p$の分解体$B'$は
	同じものになるだろうか？教科書\cite{artin1959}ではこの問に対して、
	体の同型射$\phi:K\simeq K'$が与えられたとき、それを多項式環の同型射
	$\phi:K[x]\simeq K'[x]$に持って行き、既約な$f\in K[x]$に対して
	同型射$\phi_*:K[x]/(f)\simeq K'[x]/(\phi f)$が存在することを導き出して、
	分解体が代数同型を除いて一意に定まると答えている。
	可換図で書くと次のようになることを示している。
	\begin{equation*}\begin{split}
		\xymatrix{
			K \ar[d]_{\phi}^{\simeq} \\
			K' \\
		}\quad\xymatrix@C+4ex{
			K[x] \ar[d]_{\phi}^{\simeq} \ar[r]^{-/(f)} 
				& K[x]/(f) \ar@{.>}[d]_{\phi_*}^{\simeq} \\
			K'[x] \ar[r]^{-/(\phi f)} & K'[x]/(\phi f) \\
		}
	\end{split}\end{equation*}

	教科書\cite{artin1959}では、分解体が（同型を除いて）一意であることに
	ついて面白い見方をしている。代数学の基本定理を用いると、定数でない任意の
	複素数上の多項式は一次の多項式に分解することが保証されるので、
	複素数内で分解体を構成することができる。ここで行ったような既約多項式を
	使って構成した分解体と、代数学の基本定理により構成した分解体が代数同型
	になることを保証するのが、分解体の一意性になっている。

	分解体の次元を考えてみる。$n$次多項式$f\in K[x]$を$K$上で既約とする。
	拡大体$E\supset K$で$f=(x-\alpha_1)\cdots(x-\alpha_n)$と
	分解できたとすると、$f$が$n$次多項式だから、$|K(\alpha_1)/K|=n$となる。
	残りの$g:=f/(x-\alpha_1)=(x-\alpha_2)\cdots(x-\alpha_n)$が$K(\alpha_1)$上
	で既約であれば、$g$が$n-1$次多項式だから、
	$|K(\alpha_1,\alpha_2)/K(\alpha_1)|=n-1$となる。このようにしていくと、
	$f$の分解体$B$の次元は$|B/K|\le n!$となることがわかる。
	式で書くと次のようになる。
	\begin{equation*}\begin{split}
		p\in K[x] \implies |B/K| \le (\deg p)! 
		\quad\text{where $B$ is a splitting field of $p$}
	\end{split}\end{equation*}

	部分体$K\subseteq E$、$f\in K[x]$で次数が$n$とする。
	$f$の根はすべて$E$内にあり、$fx=(x-\alpha_1)\cdots(x-\alpha_n)$
	と$E$上で分解されるとする。$D:=\prod_{i<j}(\alpha_i-\alpha_j)^2\in E$
	を$f$の判別式という。判別式が$0$ならば$f$が重根をもつことがわかるが、
	判別式はそれ以外の情報も与えてくれる。

	二次式$f=x^2+bx+c$の場合は、$f$の判別式を$D$とすると、$f=(x+b/2)^2-D$
	となり、$x^2-D$が既約なら$f$が既約となることがわかる。

	三次式$f=x^3+bx^2+cx+d$の場合は、$x^3+bx^2=(x+b/3)^3-(b^2/3)x-(b^3/9)$
	より、二次の項を消去した$f=x^3+px+q$という形に変形できる。
	$f$の根を$\alpha,\beta,\gamma$とすると、根と係数の関係は次のようになる。
	\begin{equation*}\begin{split}
		\alpha + \beta + \gamma = 0,\quad
		\alpha\beta + \beta\gamma + \gamma\alpha = p,\quad
		\alpha\beta\gamma = -q
	\end{split}\end{equation*}
	また、$f$の判別式を$D$とすると次のようになるが、
	\begin{equation*}\begin{split}
		fx &= (x-\alpha)(gx) \\
		gx &= (x-\beta)(x-\gamma) 
			= \left(x - \frac{\beta + \gamma}{2}\right)^2 
				- \left(\frac{\beta - \gamma}{2}\right)^2 \\
			&= \left(x - \frac{\beta + \gamma}{2}\right)^2
				+ \frac{D}{4(\alpha-\beta)^2(\alpha-\gamma)^2}
	\end{split}\end{equation*}
	根と係数の関係を使うと次の式が得られて、
	\begin{alignat*}{2}
		(\alpha-\beta)(\alpha-\gamma)
		&= \alpha^2 - (\beta + \gamma)\alpha + \beta\gamma \\
		&= \alpha^2 - 2(\beta + \gamma)\alpha + p 
		&\quad&\because\; \alpha\beta + \beta\gamma + \gamma\alpha = p \\
		&= 3\alpha^2 + p
		&\quad&\because\; \alpha + \beta + \gamma = 0
	\end{alignat*}
	次のように、$f$を$\alpha$と$D$だけで書くことができる。
	\begin{equation*}\begin{split}
		fx = (x - \alpha)(gx),\quad
		gx = \left(x + \frac{\alpha}{2}\right)^2 
			+ \frac{D}{4(3\alpha^2 + p)^2}
	\end{split}\end{equation*}
	したがって、$f$を体$K$上の既約多項式だとすると、$\alpha\not\in K$となり、
	$2(3\alpha^2 + p)\in K(\alpha)$に注意すると、$f$の分解体$B$は、
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $\sqrt{D}\in K(\alpha)$の場合は、$B=K(\alpha)$となり、
		$|B/K|=3$となり、
		\item $\sqrt{D}\not\in K(\alpha)$の場合は、$K(\alpha,\sqrt{D})$となり、
		$|B/K|=|K(\alpha,\sqrt{D})/K(\alpha)||K(\alpha)/K|=6$となる
	\end{itemize} %}
	ことがわかる。最後に判別式を係数$p$と$q$で表しておく。
	根と係数の関係から$D$は次のようになるが、
	\begin{alignat*}{2}
		D &= (\alpha-\beta)^2(\beta-\gamma)^2(\gamma - \alpha)^2 \\
		&= - (\alpha-\beta)(\alpha-\gamma)(\beta-\beta)(\beta-\alpha)
			(\gamma-\beta)(\gamma-\alpha) \\
		&= -(3\alpha^2 + p)(3\beta^2 + p)(3\gamma^2 + p) \\
		&= - p^3 - 3(\alpha^2 + \beta^2 + \gamma^2)p^2
		- 9(\alpha^2\beta^2 + \beta^2\gamma^2 + \gamma^2\alpha^2)p
		- 27\alpha^2\beta^2\gamma^2
	\end{alignat*}
	次の式を使うと、
	\begin{equation*}\begin{array}{rclcl}
		\alpha^2 + \beta^2 + \gamma^2 &=& (\alpha + \beta + \gamma)^2
			- 2(\alpha\beta + \beta\gamma + \gamma\alpha) &=& -2p \\
		\alpha^2\beta^2 + \beta^2\gamma^2 + \gamma^2\alpha^2 
		&=& (\alpha\beta + \beta\gamma + \gamma\alpha)^2
			- 2\alpha\beta\gamma(\alpha + \beta + \gamma) &=& p^2
	\end{array}\end{equation*}
	$D=-4p^3-27q^2$となることがわかる。

	\begin{example}[分解体その一]\label{eg:分解体その一} %{
		有理数上の既約多項式$f:=x^3-2$を考える。
		$\omega=\exp(2\pi i/3)$とすると、複素数上で$f=(x-2^{\frac{1}{3}})
		(x-2^{\frac{1}{3}}\omega)(x-2^{\frac{1}{3}\omega^2})$と分解できる。
		$f$は$3$次の$\bun$上の既約多項式だから、
		$|\bun(2^{\frac{1}{2}})/\bun|=3$となる。
		$f$の残りの因子$g:=(x-2^{\frac{1}{3}}\omega)(x-2^{\frac{1}{3}\omega^2})
		=x^2-2^{\frac{1}{3}}+2^{\frac{2}{3}}$は$\bun(2^{\frac{1}{2}})$上の
		既約多項式となり、$\bun(2^{\frac{1}{2}},\omega)$で$g$は可約となる。
		$g$は$2$次の$\bun(2^{\frac{1}{2}})$上の既約多項式だから、
		$|\bun(2^{\frac{1}{2}},\omega)/\bun(2^{\frac{1}{2}}|=2$となる。
		したがって、$f$の分解体は$B:=\bun(2^{\frac{1}{2}},\omega)$となり、
		その次元は$|B/\bun|=|\bun(2^{\frac{1}{2}})/\bun|
		|\bun(2^{\frac{1}{2}},\omega)/\bun(2^{\frac{1}{2}}|=6$となる。
	\end{example} %eg:分解体その一}
%s3:分解体}
\subsubsection{群指標}\label{s3:群指標} %{
	\begin{minipage}{0.9\hsize}{\small
	体$E$の自己同型射の組$\sigma_1,\dots,\sigma_n\in\Aut E$が群$G$をつくる
	場合、$G$の作用で不変になる$E$の元全体の集合は部分体$K$となる。
	$K$を$G$の不変体という。$|G|\le|E/K|$となることが命題
	\ref{prop:Artinの工夫}により導かれる。
	}\end{minipage}\medskip

	$K$を体、$G$を群とする。写像$\sigma:G\to K$が
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $K$の乗法について準同型となり、
		\item 任意の$x\in G$に対して$\sigma x\neq0$となるとき、
	\end{itemize} %}
	$\sigma$を$K$における$G$の指標という。

	指標の定義での二つ目の条件$\sigma x\neq0,\;\forall\; x\in G$は、
	ある$x\in G$で$\sigma x=0$となると、任意の$y\in G$で
	$\sigma y=(\sigma x)(\sigma(x^{-1}y))=0$となってしまうからである。

	\begin{proposition}[指標の独立性]\label{prop:指標の独立性} %{
		$K$を体、$G$を群とする。相異なる指標$G\to K$は線形独立となる。
		つまり、$\sigma_1,\dots,\sigma_n:G\to N$を相異なる指標とすると、
		次の式が成り立つ。
		\begin{equation*}\begin{split}
			a_1\sigma_1 +\cdots+ a_n\sigma_n = 0 \iff a_1 =\cdots= a_n = 0
		\end{split}\end{equation*}
	\end{proposition} %prop:指標の独立性}
	\begin{proof} %{
		指標の数についての帰納法で示す。指標の定義より$a\sigma=0\iff a=0$
		となることがわかる。ある$n\in\sizen_+$で命題が成り立つとする。
		ある$a_i\in K$で$a_1\sigma_1+\cdots+a_{n+1}\sigma_{n+1}=0$となる
		とすると、任意の$x,y\in G$で次の二つの式が成り立つ。
		\begin{equation*}\begin{split}
			a_1(\sigma_1x)(\sigma_1y)+a_2(\sigma_2x)(\sigma_2y)
				+\cdots+a_{n+1}(\sigma_{n+1}x)(\sigma_{n+1}y) &= 0 \\
			a_1(\sigma_{n+1}x)(\sigma_1y)+a_2(\sigma_{n+1}x)(\sigma_2y)
				+\cdots+a_{n+1}(\sigma_{n+1}x)(\sigma_{n+1}y) &= 0 \\
		\end{split}\end{equation*}
		一つ目の式は積$xy\in G$に$a_1\sigma_1+\cdots+a_{n+1}\sigma_{n+1}$を
		作用させたもの、二つ目の式は$y$に
		$a_1\sigma_1+\cdots+a_{n+1}\sigma_{n+1}$を作用させた後に$\sigma_{n+1}x$
		を掛けたものである。二つの式の差をとると次のようになるが、
		\begin{equation*}\begin{split}
			a_1b_1\sigma_1 + a_2b_2\sigma_2 +\cdots+ + a_nb_n\sigma_n = 0
			\quad\text{where } b_i := (\sigma_ix) - (\sigma_{n+1}x)
		\end{split}\end{equation*}
		帰納法の仮定より、$a_1b_1=\cdots=a_nb_n=0$となる。一方、
		$\sigma_1\neq\sigma_{n+1}$だから、ある$x\in G$で
		$\sigma_1x\neq\sigma_{n+1}x$となるから$a_1=0$となる。
		したがって、$a_2\sigma_2+\cdots+a_{n+1}\sigma_{n+1}=0$となるが、
		帰納法の仮定より、$a_2=\cdots=a_{n+1}=0$となり、
		命題が$n+1$でも成り立つことがわかる。
	\end{proof} %}

	この命題の証明には体の逆元の存在を使っていないので、体を代数に変えても
	そのまま成り立つ。この命題から次の命題が導かれる。

	\begin{proposition}[同型射の独立性]\label{prop:同型射の独立性} %{
		体$E$から体$E'$への相異なる同型射は線形独立である。
	\end{proposition} %prop:同型射の独立性}
	\begin{proof} %{
		$E,E'$が自明でない体なので、$E$から$E'$への同型射を$E$の乗法群
		$E_\times:=E-\set{0}$に制限したものは指標となる。
		相異なる同型射$\sigma_1,\dots,\sigma_n:E\to E$が
		$E_\times$で互いに線形独立ならば、$E$でも互いに線形独立となる。
	\end{proof} %}

	体の同型射$\sigma_1,\dots,\sigma_n:E\to E'$に対して、
	$\sigma_1\alpha=\cdots=\sigma_n\alpha$となる$\alpha\in E$を
	$\sigma_1,\dots,\sigma_n$の不変元という。不変元の集合は部分体となる。

	\begin{proposition}[不変体]\label{prop:不変体} %{
		体の同型射$\sigma_1,\dots,\sigma_n:E\to E'$の不変元の集合は$E$の
		部分体となる。この部分体を$\sigma_1,\dots,\sigma_n$の不変体という。
	\end{proposition} %prop:不変体}
	\begin{proof} %{
		任意の$\alpha,\beta\in E$と$i,j=1,\dots,n$に対して次の式が
		成り立つから、
		\begin{equation*}\begin{array}{rclclcl}
			\sigma_i(\alpha + \beta) &=& \sigma_i\alpha + \sigma_i\beta
			&=& \sigma_j\alpha + \sigma_j\beta &=& \sigma_j(\alpha + \beta) \\
			\sigma_i(\alpha\beta) &=& (\sigma_i\alpha)(\sigma_i\beta)
			&=& (\sigma_j\alpha)(\sigma_j\beta) &=& \sigma_j(\alpha\beta) \\
		\end{array}\end{equation*}
		$\sigma_1,\dots,\sigma_n$の不変元の集合は$E$の部分体となる。
	\end{proof} %}

	\begin{proposition}[Artinの工夫]\label{prop:Artinの工夫} %{
		$E,\;E'$を体とする。相異なる同型射$\sigma_1,\dots,\sigma_n$の不変体を
		$K$とすると、$n\le|E/K|$となる。
	\end{proposition} %prop:Artinの工夫}
	\begin{proof} %{
		$r<n$、$\omega_1,\dots,\omega_r$をベクトル空間$E/K$の基底系とする。
		\begin{equation*}\begin{split}
			\begin{pmatrix}
				\sigma_1\omega_1 & \sigma_1\omega_1 &\cdots& \sigma_n\omega_1 \\
				\sigma_1\omega_2 & \sigma_1\omega_2 &\cdots& \sigma_n\omega_2 \\
				\vdots & \vdots &\cdots& \vdots \\
				\sigma_1\omega_r & \sigma_1\omega_r &\cdots& \sigma_n\omega_r \\
			\end{pmatrix}\begin{pmatrix}
				x_1 \\ x_2 \\ \vdots \\ x_n
			\end{pmatrix} = 0
		\end{split}\end{equation*}
		$r<n$より、この式は自明でない解$x_1,\dots,x_n$を持つ。
		$\alpha\in E$と$a_1,\dots,a_r\in K$が
		$\alpha=a_1\omega_1+\cdots+a_r\omega_r$となるとする。すると、
		次の式が得られる。
		\begin{equation*}\begin{split}
			\begin{pmatrix}
				\sigma_1(a_1\omega_1) & \sigma_1(a_1\omega_1) 
					&\cdots& \sigma_n(a_1\omega_1) \\
				\sigma_1(a_2\omega_2) & \sigma_1(a_2\omega_2) 
					&\cdots& \sigma_n(a_2\omega_2) \\
				\vdots & \vdots &\cdots& \vdots \\
				\sigma_1(a_r\omega_r) & \sigma_1(a_r\omega_r) 
					&\cdots& \sigma_n(a_r\omega_r) \\
			\end{pmatrix}\begin{pmatrix}
				x_1 \\ x_2 \\ \vdots \\ x_n
			\end{pmatrix} = 0
		\end{split}\end{equation*}
		この式の和をとると次のようになる。
		\begin{equation*}\begin{split}
			(\sigma_1\alpha)x_1 + (\sigma_2\alpha)x_2
			+\cdots+ (\sigma_n\alpha)x_n = 0
		\end{split}\end{equation*}
		$x_1,\dots,x_n$は自明でないから、$\sigma_1,\dots,\sigma_n$が線形独立
		であることに矛盾する。
	\end{proof} %}

	\begin{example}[拡大体の次元その一]\label{eg:拡大体の次元その一} %{
		$1$の$3$乗根を$\omega:=\exp(2\pi i/3)$とする。
		複素単位の反転$\sigma:i\mapsto -i$は
		体$\bun(\omega)$の自己同型射になるが、$|\bun(\omega)/\bun|=2$
		となることに注意すると、命題\ref{prop:Artinの工夫}から$\bun(\omega)$
		の自己同型射は$\sigma$と恒等射だけになることがわかる。
	\end{example} %eg:拡大体の次元その一}

	\begin{example}[不変体その一]\label{eg:不変体その一} %{
		$k$を標数$0$の体、$k(x)$を$k$上の有理関数体とする。
		次の自己代数射$\sigma\in\End_kk(x)$は、
		\begin{equation*}\begin{split}
			\sigma x = \frac{1}{1-x}
		\end{split}\end{equation*}
		$2$次の巡回群の生成元となる。
		\begin{equation*}\begin{split}
			\sigma x = \frac{1}{1-x}
			,\quad \sigma \frac{1}{1-x} = \frac{x-1}{x}
			,\quad \sigma \frac{x-1}{x} = x
		\end{split}\end{equation*}
		したがって、$\sigma$は$k(x)$の自己同型射となることがわかる。
		$\braket{\sigma}:=\set{\id,\sigma,\sigma^2}$を$\sigma$から生成される
		自己同型射のつくる群、$k\braket{\sigma}$を$\braket{\sigma}$の群環と
		する。$\id+\sigma+\sigma^2\in k\braket{\sigma}$を定数でない多項式に
		作用させると、$\braket{\sigma}$の不変元が得られる。
		例えば次のようになる。
		\begin{equation*}\begin{split}
			I_\sigma := (\id+\sigma+\sigma^2)x = \frac{x^3-3x+1}{x(x-1)}
		\end{split}\end{equation*}
		命題\ref{prop:Artinの工夫}から$3\le|k(x)/k(I_\sigma)|$となることが
		わかる。
		一方、$I_\sigma$の定義より、$x^3-3x+1=I_\sigma x(x-1)$が成り立つから、
		任意の$k$を係数にもつの多項式は、$k(I_\sigma)$を係数に持つ$2$次の
		多項式に書き直すことができる。したがって、$|k(x)/k(I_\sigma)|\le 3$
		となる。以上より、次の式が成り立つことがわかる。
		\begin{equation*}\begin{split}
			|k(x)/k(I_\sigma)| = 3
		\end{split}\end{equation*}
	\end{example} %eg:不変体その一}

	\begin{example}[不変体その二]\label{eg:不変体その二} %{
		$k$を標数$0$の体、$k(x)$を$k$上の有理関数体とする。
		$\tau\in\End_kk(x)$を次のように定義する。
		\begin{equation*}\begin{split}
			\tau x = \frac{1}{x}
		\end{split}\end{equation*}
		すると、$\tau^2=\id$となり、$\tau$は互換$\braket{\tau}:=\set{\id,\tau}$
		の生成元となる。直前の例\ref{eg:不変体その一}と同様にして、
		$\braket{\tau}$の不変元$I_\tau\in k(x)$が次のように求まる。
		\begin{equation*}\begin{split}
			I_\tau := (\id+\tau)x = \frac{x+1}{x}
		\end{split}\end{equation*}
		また、$x+1=I_\tau x$から$2\le|k(x)/k(I_\tau)|\le2$となり、
		次の式が成り立つことがわかる。
		\begin{equation*}\begin{split}
			|k(x)/k(I_\tau)|=2
		\end{split}\end{equation*}

		直前の例\ref{eg:不変体その一}と合わせると、$\sigma$と$\tau$で生成される
		群$\braket{\sigma,\tau}$は$3$次対称群と同型になる。
		\begin{equation*}\begin{split}
			\begin{array}{rcccl}
				\tau\sigma x &=& \cfrac{x}{x-1} &=& \sigma^2\tau x \\
				\sigma\tau x &=& 1-x &=& \tau\sigma^2 x \\
			\end{array}
			\implies \tau\sigma\tau = \sigma^2
		\end{split}\end{equation*}
		したがって、$\braket{\sigma,\tau}$の不変体を$K$とすると、$|k(x)/K|=6$
		となることがわかる。今まで方法で$K/k$の基底系を求めようとすると、
		$(\id+\tau)(\id+\sigma+\sigma^2)x=3\in k$となってしまう。
		\begin{equation*}\begin{array}{ccccccc}
			&& \braket{\sigma,\tau} &\supset& \braket{\sigma} &\supset& \mybf{1} \\
			k &\subset& k(?) &\subset& k(I_\sigma) &\subset& k(x)
		\end{array}\end{equation*}
		一つの答えは\cite{artin1959}p.41にあるが、その答えを導き出す方法を
		見つけることは宿題としておく。
	\end{example} %eg:不変体その二}
%s3:群指標}
\subsubsection{対称式}\label{s3:対称式} %{
	\begin{minipage}{0.9\hsize}{\small
	前節の命題\ref{prop:Artinの工夫}を有理多項式体$E:=k(x_1,\dots,x_n)$に
	適用する。$E$への$n$次対称群$S_n$の作用を不定元$x_1,\dots,x_n$の置換で
	定義すると、$S_n$の不変体$K$が、$E$の基本対称式$a_1,\dots,a_n\in E$:
	\begin{equation*}\begin{split}
		(t-x_1)\cdots(t-x_n) = a_n + a_{n-1}t +\cdots+ a_1t^{n-1} + t^n
	\end{split}\end{equation*}
	を用いて、$K=k(a_1,\dots,a_n)$と与えられることを導く。
	}\end{minipage}\medskip

	\begin{proposition}[対称式]\label{prop:対称式} %{
		$k$を体、$E:=k(x_1,\dots,x_n)$を$x_1,\dots,x_n$を不定元とする$k$上の
		有理多項式体とする。$a_1,\dots,a_n\in E$を次の多項式$f\in E[t]$で
		定義し、
		\begin{equation*}\begin{split}
			ft &:= (t - x_1)\cdots(t - x_n) \\
				&= a_n +\cdots+ a_1t^{n-1} + t^n \\
		\end{split}\end{equation*}
		部分体$S\subseteq E$を$S:=k(a_1,\dots,a_n)$と定義する。
		このとき、$|E/S|=n!$となる。
	\end{proposition} %prop:対称式}
	\begin{proof} %{
		$n$次対称群$S_n$から$\End_kE$への写像$\what{-}:S_n\to\End_kE$を
		次のように定義する。
		\begin{equation*}\begin{split}
			\what{\sigma}x_i := x_{\sigma i} \quad\text{for all } i=1,\dots,n
			,\; \sigma\in S_n
		\end{split}\end{equation*}
		$\what{S_n}$は不定元$x_1,\dots,x_n$の入れ替えだから、$\what{-}$は$1:1$
		になる。したがって、$\what{S_n}$の不変体を$K$とすると、
		命題\ref{prop:Artinの工夫}から、$n!\le|E/K|$となる。
		また、命題の$a_1,\dots,a_n$はそれぞれ$\what{S_n}$の作用で不変となる。
		\begin{equation*}\begin{split}
			\what{\sigma}a_i = a_i \quad\text{for all } i=1,\dots,n
			,\; \sigma\in S_n
		\end{split}\end{equation*}
		したがって、$S\subseteq K$となる。次の式から、
		\begin{equation*}\begin{split}
			\left\{\begin{split}
				S\subseteq K\subseteq E \\
				n!\le|E/K|
			\end{split}\right. \implies n!\le|E/K|\le|E/S|
		\end{split}\end{equation*}
		$|E/S|\le n!$が成り立つことが示されれば、命題が成り立つことが示される。
		以下で、$|E/S|\le n!$が成り立つことを示す。

		次のように、$S$に不定元を付け足していって、
		\begin{equation*}\begin{split}
			S_n:=S,\quad S_{n-1}:=S_n(x_n),\dots,\quad S_0:=S_1(x_1)
		\end{split}\end{equation*}
		次の部分体の系列をつくる。
		\begin{equation*}\begin{split}
			S=S_n\subseteq S_{n-1}\subseteq\cdots\subseteq S_0=E
		\end{split}\end{equation*}
		この系列の各$i=1,\dots,n$で$|S_{i-1}/S_i|\le i$が成り立つことが
		示されれば、次の式から$|E/S|\le n!$となることがわかる。
		\begin{equation*}\begin{split}
			|S_{i-1}/S_i|\le i \quad\text{for all } i=1,\dots,n \\
			\implies |E/S|=|S_0/S_1|\cdots|S_{n-1}/S_n|\le n!
		\end{split}\end{equation*}
		まず、$(t-x_1)\cdots(t-x_n)$は$S_n$上の$n$次多項式で、
		根$x_n\in S_n$を持つ。したがって、$|S_{n-1}/S_n|\le n$となる。
		次に、$(t-x_1)\cdots(t-x_{n-1})$は$S_{n-1}$上の$n-1$次多項式で、
		根$x_{n-1}\in S_{n-2}$を持つ。したがって、$|S_{n-2}/S_{n-1}|\le n-1$
		となる。このようして続けていくと次のようになる。
		\begin{alignat*}{3}
			F_nt &:= (t-x_1)\cdots(t-x_n) &\;\in\;& S_n[t] 
				&\quad& \text{根$x_n\in S_{n-1}$を持つ} \\
			F_{n-1}t &:= (t-x_1)\cdots(t-x_{n-1}) &\;\in\;& S_{n-1}[t]
				&\quad& \text{根$x_{n-1}\in S_{n-2}$を持つ} \\
			\vdots \\
			F_2t &:= (t-x_1)(t-x_2) &\;\in\;& S_2[t]
				&\quad& \text{根$x_2\in S_1$を持つ} \\
			F_1t &:= (t-x_1) &\;\in\;& S_1[t]
		\end{alignat*}
		各$i=1,\dots,n$で$F_it\in S_i[t]$は$i$次多項式で、根$x_i\in S_{i+1}$
		を持つから、$Fx_i=0$となり、$x_i^i$が$i-1$次多項式で書くことができる。
		したがって、$|S_{i+1}/S_i|\le i$となる。
	\end{proof} %}

	この命題の、有理多項式体$E:=k(x_1,\dots,x_n)$上の次の多項式$f\in E[t]$
	の係数$a_1,\dots,a_n\in E$を$E$の基本対称式という。
	\begin{equation*}\begin{split}
		(t-x_1)\cdots(t-x_n) = a_n + a_{n-1}t +\cdots+ a_1t^{n-1} + t^n
	\end{split}\end{equation*}
	$k$に基本対称式を追加して作った$k$の拡大体$K:=k(a_1,\dots,a_n)$は、
	不定元$x_1,\dots,x_n$の置換について$E$の不変体となる。そして、
	ベクトル空間$E/K$は、次の形の単項式を基底系として持つ$n!$次元ベクトル空間
	となる。
	\begin{equation*}\begin{split}
		x_1^{p_1}x_2^{p_2}\cdots x_n^{p_n}
		\quad\text{where } 0\le p_i\le i-1
	\end{split}\end{equation*}
%s3:対称式}
%s2:体論}
\subsection{自然数と整数}\label{s2:自然数と整数} %{
	\begin{proposition}[Euclidの互除法]\label{prop:Euclidの互除法} %{
		$n>m>0$となる任意の自然数$m,n$に対して、次の式を満たす$q,r\in\sizen$が
		唯一つ定まり、
		\begin{equation*}\begin{split}
			n = qm + r,\quad r < m
		\end{split}\end{equation*}
		次の式が成り立つ。
		\begin{equation*}\begin{split}
			\gcd(n,m) = \begin{cases}
				m, &\text{ iff } r = 0 \\
				\gcd(m,r), &\text{ otherwise } \\
			\end{cases}
		\end{split}\end{equation*}
	\end{proposition} %prop:Euclidの互除法}
	\begin{proof} %{
		$r\neq0$のとき、$\gcd(n,m)=\gcd(m,r)$となることを証明する。
		$n=qm+r$の両辺を$\gcd(m,r)$で剰余をとると、$n$が$\gcd(m,r)$で割り切れる
		ことがわかる。また、$m$も$\gcd(m,r)$で割り切れるから次の式が成り立つ。
		\begin{equation*}\begin{split}
			n,m\in \gcd(m,r)\sizen \implies \gcd(n,m)\in \gcd(m,r)\sizen
		\end{split}\end{equation*}
		$n=qm+r$の両辺を$\gcd(n,m)$で剰余をとると、$r$が$\gcd(n,m)$で
		割り切れることがわかる。また、$m$も$\gcd(n,m)$で割り切れるから
		次の式が成り立つ。
		\begin{equation*}\begin{split}
			m,r\in \gcd(n,m)\sizen \implies \gcd(m,r)\in \gcd(n,m)\sizen
		\end{split}\end{equation*}
		以上より、
		$\gcd(n,m)\sizen\subseteq\gcd(m,r)\sizen\subseteq\gcd(n,m)\sizen$
		となり、命題が成り立つことがわかる。
	\end{proof} %}

	この命題から、$n>m>0$となる自然数$m,n$の最大公約数は次のような
	自然数の減少列から求めることができる。
	\begin{equation}\label{eq:Euclidの互除法その一}\begin{split}
		n_0=n > n_1=m > n_2 > \cdots > n_N=\gcd(n,m) > n_{N+1}=0 \\
		n_{i+2} = n_i \bmod n_{i+1} \quad\text{for all } i=0,\dots,N-1
	\end{split}\end{equation}
	この手続きを商$q_i$も含めて書くと次のようになる。
	\begin{equation}\label{eq:Euclidの互除法その二}\left\{\begin{split}
		n_0 &= q_1n_1 + n_2 \\
		n_1 &= q_2n_2 + n_3 \\
		\cdots \\
		n_{N-2} &= q_{N-1}n_{N-1} + n_N \\
		n_{N-1} &= q_Nn_N + 0 \\
	\end{split}\right.\iff\left\{\begin{split}
		n_2 &= n_0 - q_1n_1 \\
		n_3 &= n_2 - q_2n_2 \\
		\cdots \\
		n_N &= n_{N-2} - q_{N-1}n_{N-1} \\
		0 &= n_{N-1} - q_Nn_N \\
	\end{split}\right.\end{equation}
	右側の式の右辺は$q_i$を係数とする$m$と$n$の線型結合で書かれること
	がわかる。したがって、$n_N=\gcd(n,m)$となるから、次の式を満たす
	$x,y\in\sei$が存在することがわかる。
	\begin{equation*}\begin{split}
		mx + ny = \gcd(n,m)
	\end{split}\end{equation*}
	このような$x,y\in\sei$は唯一には定まらない。
	$X,Y\in\sei$を$mX+nY=\gcd(n,m)$とすると次の式が成り立つ。
	\begin{equation}\label{eq:Euclidの互除法その三}\begin{split}
		mx + ny = mX + nY &\implies m(x-X) + n(y-Y) = 0 \\
		&\implies \pvec{X}{Y} = \pvec{x}{y} + z\pvec{-n}{m}
		\quad\text{for all } z\in\sei
	\end{split}\end{equation}
	したがって、$(x,y)\mapsto(x-nz,y+mz)$の不定性を除いて$mx+ny=\gcd(x,y)$
	となる$x,y\in\sei$は一意に定まることがわかる。
	$m$と$n$が互いに素になる場合を命題の形で書いておく。

	\begin{proposition}[Bezoutの恒等式]\label{prop:Bezoutの恒等式} %{
		$a,b\in\sizen_+$を互いに素とすると、$ax+by=1$となる$x,y\in\sei$
		が次の不定性を除いて唯一つ定まる。
		\begin{equation*}\begin{split}
			(x,y)\mapsto(x-bz,x+az) \quad\text{for all } z\in\sei
		\end{split}\end{equation*}
	\end{proposition} %prop:Bezoutの恒等式}
	\begin{proof} %{
		$x,y$が存在することの証明をWikipediaから借用する。
		$X,Y$を次の式を満たす整数とする。
		\begin{equation*}\begin{split}
			aX+bY := \min_{x,y\in\sei_\times} |ax+by|
			,\quad \sei_\times := \sei - \set{0}
		\end{split}\end{equation*}
		$c=aX+bY$とおくと$c\in\sizen$となる。$a$を$c$で割ると、
		$a=Ac+r$となる$A\in\sizen$と、$r<c$となる$r\in\sizen$が唯一つ定まるが、
		$r=a(1-AX)-bAY<c\in\sizen$となり、$c$の定義より$r=0$となる。
		したがって、$a=Ac$と書かれることになる。同様に$b$を$c$で割ると、
		$b=Bc$となる$B\in\sizen$が唯一つ定まる。
		\begin{equation*}\begin{split}
			\exists\; A,B\in\sizen \text{ such that } a = Ac,\; b = Bc
		\end{split}\end{equation*}
		$c$が$1$でない場合は、$a$と$b$が互いに素であることに矛盾するから、
		$c=1$でなければならない。したがって、$aX+bY=1$となり、$X,Y$が命題の
		$x,y$となる。

		$x,y$が命題の不定性を除いて一意に定まることは
		式\eqref{eq:Euclidの互除法その三}からわかる。
	\end{proof} %}

	この命題は素数$p$が与えられたとき、体$\sei_p:=\sei/p\sei$で逆数を
	求めるときなどに役に立つ。
	\begin{alignat*}{2}
		m\in\sei_p &\implies mx + py = 1 &\quad& \text{(in $\sei$)} \\
		&\implies m(x\bmod p) = 1 &\quad& \text{(in $\sei_p$)}
	\end{alignat*}

	$a,b\in\sizen_+$に対して次の式を満たす$x,y\in\sei$を求める手続きを
	考える。
	\begin{equation*}\begin{split}
		ax + by = \gcd(a,b)
	\end{split}\end{equation*}
	二次元ベクトル$N=\in\sizen^2$と$X_0,X_1\in\sei^2$を次のように定義し、
	\begin{equation*}\begin{split}
		N := (a,b)^\tran,\quad \left\{\begin{split}
			a \ge b &\implies X_0 := (1,0)^\tran,\quad X_1 := (0,1)^\tran \\
			\text{else} &\implies X_0 := (0,1)^\tran,\quad X_1 := (1,0)^\tran \\
		\end{split}\right. \\
	\end{split}\end{equation*}
	漸化式\eqref{eq:Euclidの互除法その一}を次のように書き直す。
	\begin{alignat*}{2}
		n_i &= N^\tran X_i &\quad &\text{for all } i=0,\dots,N+1 \\
		X_{i+2} &= X_i - \syou{n_i}{n_{i+1}} X_{i+1}
		&\quad &\text{for all } i = 0,\dots,N-1
	\end{alignat*}
	ここで、$X_2,\dots,X_{N+1}\in\sei^2$は上記の式で定まる二次元ベクトルで、
	整数の割り算$p/q$の整数部分を$[p/q]$と書いている。
	$n_N=\gcd(n,m)$となり、$X_N$が求める$x,y$となる。
	また、$n_{N+1}=0$となり、$N^\tran X_{N+1}=0$という手続きの終了条件を
	与える。内積$N^\tran X_i\in\sizen$の
	減少列\eqref{eq:Euclidの互除法その一}によって、
	この手続きが有限回で終了する保証が与えられる。
	\begin{equation*}\begin{split}
		\left\{\begin{split}
			a = b &\implies n_0 = n_1 > n_2=0 \\
			\text{else} &\implies n_0 > n_1 > n_2 > \cdots > n_N > n_{N+1}=0 \\
		\end{split}\right. \\
		n_0 = \max(a, b),\quad n_1 = \min(a,b),\quad n_N = \gcd(a,b) \\
		n_{i+2} = n_i \bmod n_{i+1} \quad\text{for all } i=0,\dots,N-1
	\end{split}\end{equation*}
	この手続きをプログラミングしやすい形にまとめると次のようになる。

	\begin{procedure}[Euclidの互除法]\label{proc:Euclidの互除法} %{
		与えられた$a,b\in\sizen_+$となる自然数に対して、$ax+by=\gcd(a,b)$となる
		$x,y\in\sei$を返す。
		\begin{enumerate}\setlength{\itemsep}{-1mm} %{
			\item\label{item:Euclidの互除法の初期化}
			$N:= (a,b)^\tran\in\sizen^2$と定義し、$X_0,X_1\in\sei^2$を
			次のように定義する。
			\begin{itemize}\setlength{\itemsep}{-1mm} %{
				\item $a\ge b$なら、$X_0 := (1,0)^\tran,\quad X_1 := (0,1)^\tran$
				\item それ以外なら、$X_0 := (0,1)^\tran,\quad X_1 := (1,0)^\tran$
			\end{itemize} %}
			\item\label{item:Euclidの互除法の繰り返し} 
			$R\in\sei^2$を次のように定義する。
			\begin{equation*}\begin{split}
				R := X_0 - \syou{N^\tran X_0}{N^\tran X_1} X_1
			\end{split}\end{equation*}
			\begin{itemize}\setlength{\itemsep}{-1mm} %{
				\item $N^\tran R=0$なら、$X_1$を返す。
				\item それ以外なら、$X_0=X_1,\;X_1=R$と再定義して
				\ref{item:Euclidの互除法の繰り返し}に行く。
			\end{itemize} %}
		\end{enumerate} %}
	\end{procedure} %proc:Euclidの互除法}

	Bezoutの恒等式\ref{prop:Bezoutの恒等式}は三つ以上の自然数の最大公約数
	を求める手続きに容易に拡張できる。

	\begin{proposition}[Bezoutの恒等式その二]\label{prop:Bezoutの恒等式その二} %{
		$n$を$2$以上の自然数とし、$a_1,\dots,a_n\in\sizen_+$を互いに素とする。
		このとき、ベクトル$a:=(a_1,\dots,a_n)\in\sizen_+^n$とおくと、
		$a^\tran x=1$となるベクトル$x\in\sei^n$が$x\mapsto x+\ker a^\tran$
		の不定性を除き唯一つ定まる。
	\end{proposition} %prop:Bezoutの恒等式その二}
	\begin{proof} %{
		$X_1,\dots,X_n$を次の式を満たす整数とする。
		\begin{equation*}\begin{split}
			a_1X_1 +\cdots+ a_nX_n := \min_{x_1,\dots,x_n\in\sei_\times} 
			|a_1x_1+\cdots+a_nx_n|,\quad \sei_\times := \sei - \set{0}
		\end{split}\end{equation*}
		$c=a_1X_1+\cdots+a_nX_n$とおくと$c\in\sizen$となる。
		$a_1$を$c$で割ると、$a_1=A_1c+r$となる$A\in\sizen$と、
		$r<c$となる$r\in\sizen$が唯一つ定まるが、
		$r=a_1(1-A_1X_1)-a_2A_1X_2-\cdots-a_nA_1X_n<c\in\sizen$となり、
		$c$の定義より$r=0$となる。
		したがって、$a_1=A_1c$と書かれることになる。同様に$a_i,\; i=2,\dots,n$
		を$c$で割ると、$a_i=A_ic$となる$A_i\in\sizen$が唯一つ定まる。
		\begin{equation*}\begin{split}
			\exists\; A_1,\dots,A_n\in\sizen \text{ such that } a_i = A_ic
		\end{split}\end{equation*}
		$c$が$1$でない場合は、$a_1,\dots,a_n$が互いに素であることに矛盾する
		から、$c=1$でなければならない。したがって、$a_1X_1+\cdots+a_nX_n=1$
		となり、$X_1,\dots,X_n$が命題の$x_1,\dots,x_n$となる。

		$a$を命題のベクトルとし、$x\in\sei^n$と$X\in\sei^n$が共に、
		$a^\tran x=1=a^\tran X$を満たすとすると、$a^\tran(x-X)=0$となり、
		$x-X\in\ker a^\tran$となるから、命題の$x\in\sei^n$の不定性があること
		がわかる。
	\end{proof} %}

	この命題から、$2\le n\in\sizen$として、$a\in\sizen_+^n$に対して、
	$a^\tran x=\gcd a$となる$x\in\sei^n$は$\ker a^\tran$の不定性を除いて
	唯一つ定まる。ここで、$\gcd:\sizen_+^n\to\sizen_+$はベクトルの$n$個の
	成分の最大公約数とする。
	
	$a^\tran x=\gcd a$となる$x\in\sei^n$を求める手続きを$n=3$の場合に
	スケッチしてみる。最大公約数は次の式を満たす\footnote{
		$\gcd:\sizen_+\times\sizen_+\to\sizen_+$は
		可換かつべき等な積となり、$1\in\sizen_+$をゼロ元として持つ。
		\begin{alignat*}{3}
				\text{結合的} &\quad& \gcd(\gcd\times\id) &= \gcd(\id\times\gcd) \\
				\text{べき等} &\quad& \gcd(a,a) &= a &\quad &\text{for all }a\in\sizen_+ \\
				\text{ゼロ元} &\quad& \gcd(1,a) &= 1 &\quad &\text{for all }a\in\sizen_+
		\end{alignat*}
	}。
	\begin{equation*}\begin{split}
		\gcd(\gcd\times\id)(a_1,a_2,a_3) = \gcd(a_1,a_2,a_3) = 
		\gcd(\id\times\gcd)(a_1,a_2,a_3) \\
		\quad\text{for all } a_1,a_2,a_3\in\sizen_+
	\end{split}\end{equation*}
	この性質を使って、$a_1,a_2,a_3\in\sizen_+$に対して、一組ずつ最大公約数
	を求めていくと次のようになる。
	\begin{equation*}\begin{split}
		\myop{euclid}(a_1,a_2) &= (x_1,x_2) \\
		\myop{euclid}(a_1x_1+a_2x_2,a_3) &= (y_1,y_2) \\
		\myop{merge}(x_1,x_2,y_1,y_2) &= (x_1y_1,x_2y_1,y_2) \\
	\end{split}\end{equation*}
	$\myop{euclid}:(a,b)\mapsto(x,y)$が$ax+by=\gcd(a,b)$となる$x,y\in\sei$
	を求める操作で、最後の\myop{merge}した結果が求める整数の組になる。
%s2:自然数と整数}
%s1:Galois理論}

\section{Eular法}\label{s1:Eular法} %{
\subsection{微分方程式の例}\label{s2:微分方程式の例} %{
	簡単なモデルを使って、Brzozowski微分による微分方程式の摂動計算を、
	通常の微分による微分方程式と対比させながら調べてみる。

\subsubsection{お題}\label{s3:お題} %{
	$\fukuso[t]$を多項式環とし、$\partial$を$t$についての通常の微分、
	$\delta$を$t$についてのBrzozowski微分とする。
	\begin{equation}\label{eq:Brzozowski微分の定義その一}\begin{split}
		\partial t^m := \jump{1\le m} mt^{m-1},\quad
		\delta t^m := \jump{1\le m} t^{m-1}
	\end{split}\end{equation}
	そして、次の二つの微分方程式を考える。
	\begin{equation*}\begin{split}
		\partial x_t = x_t^2,\quad \delta y_t = y_t^2 \\
	\end{split}\end{equation*}
	この二つの微分方程式の解は簡単に求まり次のようになる\footnote{
		この解の形から初期値$x_0$と$y_0$を$1$に正規化してしまった方が
		よいかもしれない。少なくとも数値計算の場合は、このように正規化
		した方が単純になる。問題は、オートマトンを作成する場合にこのような
		正規化が役に立つかどうかである。多項式環の係数が一般の代数の場合、
		初期値に中心が含まれる場合は、そのままオートマトンを作成すると
		空遷移が含まれてしまう。現状、作成してしまったオートマトンから
		空遷移を取り除く簡便な処方箋がないために、オートマトンを作成する段階
		で空遷移を取り除かなくてはならない。初期値を正規化してしまうと、
		その部分の処理を忘れた理論をつくることになる。
	}。
	\begin{equation*}\begin{split}
		x_t = \frac{x_0}{1 - x_0t},\quad 
		y_t = \begin{cases}
			0, &\text{ iff } y_0 = 0 \\
			\cfrac{1 - \sqrt{1 - 4ty_0}}{2t}, &\text{ otherwise } \\
		\end{cases}
	\end{split}\end{equation*}
	$x_0,y_0\in\fukuso$はそれぞれ$t=0$の初期値である。
	Brzozowski微分の方は、初期値の値よって解が異なってくる。
	$y_0\neq0$の場合はCatalan数$C_n$の生成関数になる。
	\begin{equation*}\begin{split}
		\frac{y_t}{y_0} = \sum_{n\in\sizen} C_n(ty_0)^n
		,\quad C_n := \frac{1}{n+1}\binom{2n}{n}
	\end{split}\end{equation*}
	$y_0=0$の場合は$y_t$は$0$にとどまり続ける\footnote{
		任意の$n\in\sizen$に対して$\delta y_t=y_t^{n+1}$の解は、
		$\lim_{t\to0}y_t=y_0^{n+1}$だから、初期値$y_0$が$0$ならば$y_t=0$となる
		ことがわかる。また、微分方程式の解が一意に定まることから、代数方程式
		$y_t=1+ty_t^{n+1}$の$n+1$個ある解で、$t=0$で正則な解は唯一つ定まるの
		ではないかと予想される。
	}。したがって、以下では$y_0\neq0$と仮定する\footnote{
		BNFによる文法定義において、$X=aX=aaa\cdots$のような有限長の文字列に
		決してマッチしない文法を、微分方程式の初期値が$0$でないという条件で
		排除することができる。微分方程式の初期値が$0$の場合は、意味のある解
		が得られない。このことは、モノイドから群を分数によって構成する方法を
		思い起こさせる（Grothendieckの構成方法）。
		分数によって群を構成する場合、$x/0$という分数は定義できるが、その場合、
		出来上がった群は自明な群になってしまう。一方、なんとなく分数を定義して
		おいて、後から大小関係に照らし合わせると、$x/0$は無限大になっている
		ことがわかる。
	}。
%s3:お題}
\subsubsection{Eular法}\label{s3:Eular法} %{
	微分方程式の解$x_t,y_t$を次の形に級数展開して、
	\begin{equation*}\begin{split}
		x_t = \sum_{n\in\sizen} \frac{t^n}{n!}x_n,\quad 
		y_t = \sum_{n\in\sizen} t^ny_n
	\end{split}\end{equation*}
	元の微分方程式に代入すると、次の漸化式を得る。
	\begin{equation}\label{eq:係数の漸化式その一}\begin{split}
		x_{m+1} = \sum_{r=0}^m \binom{m}{r}x_rx_{m-r}
		,\quad y_{m+1} = \sum_{r=0}^m y_ry_{m-r}
	\end{split}\end{equation}
	$m$を$\fukuso$の通常の積、$\dup$を次のように定義された重複化の操作とし、
	\begin{equation*}\begin{split}
		\dup f:=f\otimes f \quad\text{for all } f\in\fukuso[t]
		\quad\text{線形写像ではない}
	\end{split}\end{equation*}
	$\gamma_\partial$と$\gamma_\delta$を次のように係数の添字を一つ移動する
	写像とし、
	\begin{equation*}\begin{split}
		\gamma_\partial x_m := x_{m+1},\quad \gamma_\delta y_m := y_{m+1}
	\end{split}\end{equation*}
	任意の初期値に対して次の式が成り立つ。
	\begin{equation*}\begin{split}
		\gamma_\partial^{m+1}
		= m(\gamma_\partial\otimes\id + \id\otimes\gamma_\partial)^m\dup
		,\quad\gamma_\delta^{m+1}
		= \sum_{r=0}^m m(\gamma_\delta^r\otimes\gamma_\delta^{m-r})\dup
	\end{split}\end{equation*}

	通常の微分については、$\Delta\gamma_\partial$を次のように定義すると、
	\begin{equation}\label{eq:微分の場合その一}\begin{split}
		\Delta\gamma_\partial := 
		= \gamma_\partial\otimes\id + \id\otimes\gamma_\partial
		\implies \gamma_\partial^{m+1} &= m(\Delta\gamma_\partial)^m\dup
	\end{split}\end{equation}
	次のような手順で、$x_0$から順に解の係数$x_n$が求まる。
	\begin{equation*}\xymatrix{
		x_0 \ar@{|->}[dr]_\dup \ar@{|->}[r]^{\gamma_\partial}
		& x_1 \ar@{|->}[r]^{\gamma_\partial} 
		& x_2 \ar@{|->}[r]^{\gamma_\partial} 
		& x_3 \ar@{|->}[r]^{\gamma_\partial} 
		& \cdots \\
		& \dup x_0 \ar@{|->}[u]_m \ar@{|->}[r]^{\Delta\gamma_\partial}
		& (\Delta\gamma_\partial)\dup x_0 \ar@{|->}[u]_m
			\ar@{|->}[r]^{\Delta\gamma_\partial}
		& (\Delta\gamma_\partial)^2\dup x_0 \ar@{|->}[u]_m
			\ar@{|->}[r]^{\Delta\gamma_\partial}
		& \cdots \\
	}\end{equation*}
	これはEular法による微分方程式の解の求め方の一例である。

	一方、Brzozowski微分の方は、一見、$
		\gamma_\delta^{m+1} = m(\Delta\gamma_\delta)^m\dup
	$となる$\Delta\gamma_\delta$がなさそうに見える。
	このような$\Delta\gamma_\delta$がないと、$
		m^{-1}x_m\mapsto m^{-1}x_{m+1}
	$の操作で次数$m$に依存した操作を強いられる。
	しかし、Brzozowski微分の場合も、$p_0$を$p_0:y_m\mapsto\jump{m=0}y_m$
	と定義し、$\Delta\gamma_\delta$を次のように定義すると、
	\begin{equation*}\begin{split}
		\Delta\gamma_\delta = \gamma_\delta\otimes\id 
		+ p_0\otimes\gamma_\delta
	\end{split}\end{equation*}
	次の式が成り立つから、
	\begin{equation*}\begin{split}
		(\Delta\gamma_\delta)^m = \gamma_\delta^m\otimes\id 
		+ \sum_{r=0}^{m-1}\gamma_\delta^r p_0\otimes\gamma_\delta^{m-r}
	\end{split}\end{equation*}
	やはり、通常の微分の場合と同じ形をした次の式が得られる。
	\begin{equation*}\begin{split}
		\gamma_\delta^{m+1} &= m(\Delta\gamma_\delta)^m\dup
	\end{split}\end{equation*}
	したがって、Brzozoswki微分の場合も通常の微分と同じ手順で解の係数
	を順次求めることができることがわかる。

	Brzozowski微分の場合は、通常の微分に比べて複雑になっている理由は、
	Brzozowski微分が時間の並進に対して不変になっていないことに起因する。
	定数$c\in\fukuso$として、時間の並進$t\mapsto(t+c)$に対して、二つの微分は
	それぞれ次のように振る舞う。
	\begin{equation*}\begin{split}
		\partial(t+c)^m = \jump{1\le m} m(t+c)^{m-1}
		,\quad \delta(t+c)^m = \sum_{r=0}^{m-1} \binom{m}{r+1}c^{m-r-1}t^r
	\end{split}\end{equation*}
	Brzozowski微分と通常の微分の振る舞いの違いは、
	Brzozowski微分が時間と通常の微分を使って次のように書けることからも
	理解できる。
	\begin{equation*}\begin{split}
		\delta = \frac{1}{1 + t\partial}\partial
		\implies \frac{1}{1 + (t-c)\partial}\partial
		= \sum_{r\in\sizen}\frac{c^r}{1 + t\partial}\partial^{r+1}
	\end{split}\end{equation*}

	係数のシフト$\Delta\gamma_\partial$と$\Delta\gamma_\delta$は、微分と
	積との交換関係によって定まっている。
	\begin{equation*}\begin{split}
		\partial m = m(\partial\otimes\id + \id\otimes\partial),\quad
		\delta m = m(\delta\otimes\id + \pi_0\otimes\delta)
	\end{split}\end{equation*}
	ここで、$\pi_0:t^m\mapsto\jump{m=0}t^m$と定義している。そして、
	$\lim_{t=0}m=m(\lim_{t=0}\otimes\lim_{t=0})$に注意すると、
	Eular法は次のように書けることがわかる。
	\begin{equation}\label{eq:Eular法その一}\begin{split}
		x_t\in\ker(\partial - m\dup)
		&\implies x_t\in\ker\bigl(
			\partial^{m+1} - m(\Delta\partial)^m\dup\bigr) \\
		&\implies \lim_{t=0}\partial^{m+1}x_t 
			= \lim_{t=0}m(\Delta\partial)^m\dup x_t \\
	\end{split}\end{equation}
	最後の式が解の係数の漸化式に対応する。Brzozowski微分の場合も同じである。
%s3:Eular法}
\subsubsection{解の積分表示}\label{s3:解の積分表示} %{
	積分を使って微分方程式の解を形式的に表してみる。
	$\partial^{-1}$と$\delta^{-1}$を次のように定義する。
	\begin{equation*}\begin{split}
		\partial^{-1}t^m = (m+1)^{-1}t^{m+1},\quad \delta^{-1}t^m = t^{m+1}
	\end{split}\end{equation*}
	すると、$\pi_+:t^m\mapsto\jump{1\le m}t^m$として、次の式が成り立ち、
	\begin{alignat*}{2}
		\partial\partial^{-1} &= 1, &\quad \partial^{-1}\partial &= \pi_+ \\
		\delta\delta^{-1} &= 1, &\quad \delta^{-1}\delta &= \pi_+
	\end{alignat*}
	微分方程式の解を次のように書くことができる。
	\begin{equation*}\begin{split}
		x_t = x_0 + \partial^{-1} m(x_t\otimes x_t),\quad
		y_t = y_0 + \delta^{-1} m(y_t\otimes y_t)
	\end{split}\end{equation*}

	ここで、$\partial^{-1}$および$\delta^{-1}$とRota-Baxter作用素との関連を
	調べてみる。$\partial^{-1}$と$\delta^{-1}$の部分積分を計算すると
	次のようになる。
	\begin{equation*}\begin{array}{rclcl}
		\pi_+m(\partial^{-1}\otimes\partial^{-1})
		&=& \partial^{-1}\partial m(\partial^{-1}\otimes\partial^{-1})
		&=& \partial^{-1}m(\partial^{-1}\otimes\id + \id\otimes\partial^{-1}) \\
		\pi_+m(\delta^{-1}\otimes\delta^{-1})
		&=& \delta^{-1}\delta m(\delta^{-1}\otimes\delta^{-1})
		&=& \delta^{-1}m(\id\otimes\delta^{-1}) \\
	\end{array}\end{equation*}
	$\pi_+m(\partial^{-1}\otimes\partial^{-1})
	= m(\partial^{-1}\otimes\partial^{-1})$に注意すると、
	$\partial^{-1}$は重み$0$のRota-Baxter作用素になるのに対して、
	$\delta^{-1}$はRota-Baxter作用素にはならないように思われる。
	しかし、$\delta^{-1}m=m(\id\otimes\delta^{-1})$が成り立つから、
	$\delta^{-1}$は重み$-1$のRota-Baxter作用素になることがわかる。
	\begin{equation*}\begin{array}{rcll}
		m(\partial^{-1}\otimes\partial^{-1})
		&= \partial^{-1}m(\partial^{-1}\otimes\id + \id\otimes\partial^{-1}) \\
		m(\delta^{-1}\otimes\delta^{-1}) + \delta^{-1}m
		&= \delta^{-1}m(\delta^{-1}\otimes\id + \id\otimes\delta^{-1})
	\end{array}\end{equation*}
	一般に、重み$\lambda$のRota-Baxter作用素$P$は、
	積の記号$m$を省略して書くと、次の性質（Spitzerの恒等式）を満たす
	\cite{GuoIntro}。
	\begin{equation}\label{eq:Spitzerの恒等式その一}\begin{split}
		b = 1 + P(ba) \implies 
		\left\{\begin{split}
			b &= \exp\bigl(P\frac{1}{\lambda}\ln(1 + \lambda a)\bigr) \\
			\exp\bigl(P\frac{1}{\lambda}\ln(1 + \lambda a)\bigr)
			&= \sum_{n\in\sizen} \underbrace{P(P(\cdots(Pa)\cdots)a)a}_{n}
		\end{split}\right.
	\end{split}\end{equation}
	ここで、重みが$0$と$-1$の場合は次のようになっている。
	\begin{equation*}\begin{split}
		\frac{1}{1 - Pa} = (Pa)^* \xfrom{\lambda=-1}
		\exp\bigl(P\frac{1}{\lambda}\ln(1 + \lambda a)\bigr)
		\xto{\lambda=0} \exp(Pa)
	\end{split}\end{equation*}
	この結果は、$\partial^{-1}$または$\delta^{-1}$の一階微分方程式であれば、
	微分方程式の右辺に依らずに成り立つ結果である。

	今考えている微分方程式の解にSpitzerの恒等式を適用すると、
	次の式が得られる。
	\begin{equation*}\begin{split}
		x_t = \exp(\partial^{-1}x_t)x_0,\quad y_t = (\delta^{-1}y_t)^*y_0
	\end{split}\end{equation*}
	この式は解の対称性を表している。明示的に書くと次のようになる。
	\begin{equation*}\begin{split}
		\frac{x_0}{1-x_0t} = \exp\left(\int_0^tds\frac{x_0}{1-x_0s}\right)x_0
		,\quad \frac{1 - \sqrt{1 - 4ty_0}}{2t} 
		= \frac{y_0}{1 - t\cfrac{1 - \sqrt{1 - 4ty_0}}{2t}}
	\end{split}\end{equation*}
	Spitzerの恒等式\eqref{eq:Spitzerの恒等式その一}は$a$と$b$が非可換でも
	成り立ち、形式言語理論における左再帰の消去と全く同じ形をしている。
	両者は同じものだろう。
%s3:解の積分表示}
%s2:微分方程式の例}
\subsection{Fock空間}\label{s2:Fock空間} %{
	Eular法での係数比較を微分を用いて書くと式\eqref{eq:Eular法その一}のように
	なる。同じことをFock空間を用いて書くと次のように書ける。
	\begin{equation*}\begin{split}
		\bra{t}\eta^\dag\ket{x} = \braket{t|x}\braket{t|x}
		\implies \bra{0}(\eta^\dag)^{m+1}\ket{x} = \sum_{r=0}^m
			\bra{0}(\eta^\dag)^r\ket{x}\bra{0}(\eta^\dag)^{m-r}\ket{x}
	\end{split}\end{equation*}
%s2:Fock空間}
%s1:Eular法}
\section{一変数シャッフル積}\label{s1:一変数シャッフル積} %{
	一変数だけの場合のq-シャッフル積を調べる。一変数だけの場合は、積や余積
	の係数だけが問題になる。

\subsection{積と余積}\label{s2:積と余積} %{
	多項式環$\fukuso[t]$上のq-シャッフル積$m_q:=\mybiop{\shuffle_q}$を
	次のように定義する。
	\begin{align*}
		t^{m+1}\shuffle_qt^{n+1}
		&:= t(t^m\shuffle_qt^{n+1} + q^{m+1}t^{m+1}\shuffle_qt^n)
		& \text{for all }m,n\in\sizen \\
		t^{m}\shuffle_q1 &:= t^m = 1\shuffle_qt^{m}
		& \text{for all } m\in\sizen
	\end{align*}
	そして、q-自然数$(n)_q$を次のように定義する。
	\begin{equation*}\begin{split}
		(n)_q := \frac{1-q^n}{1-q} \quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	このq-自然数の定義はLie環の量子変形で使われるq-自然数と異なる定義になって
	いるが、ほぼ同じ\footnote{
		Lie群の量子変形の場合、次のように定義されたものをq-整数という。
		\begin{equation*}\begin{split}
			[n]_q := \frac{q^n-q^{-n}}{q-q^{-1}} \quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		この定義では、$[-n]_q=-[n]_q$となり、$[n]_1=n$となり、$[n]_0$は
		$n=0$以外は$\pm\infty$の入り混じった不定値となる。
	}性質を満たす。
	\begin{equation*}\begin{split}
		(m + n)_q &= (m)_q + q^m(n)_q \\
		(mn)_q &= (m)_q(n)_{q^m} 
	\end{split}
		 \quad\text{for all } m,n\in\sizen
	\end{equation*}
	q-階乗とq-二項係数を次のように定義する。
	\begin{align*}
		(0)_q^! &:= 1 \\
		(n)_q^! &:= (n)_q(n-1)_q\cdots(0)_q 
			& \text{for all } n\in\sizen \\
		\binom{m+n}{m}_q &:= \frac{(m+n)_q^!}{(m)_q^!(n)_q^!} 
			& \text{for all } m,n\in\sizen
	\end{align*}
	すると、次の式が成り立つ。
	\begin{equation}\label{eq:シャッフル積その一}\begin{split}
		t^m\shuffle_q t^n = \binom{m+n}{m}_qt^{m+n}
		\quad\text{for all } m,n\in\sizen
	\end{split}\end{equation}
	\begin{proof} %{
		シャッフル積の定義から、$c_{mn}$を$t$を含まない$q$の多項式として、
		$t^m\shuffle_qt^n=c_{mn}t^{m+n}$と書けることがわかる。定義から直接
		計算することで$m+n\le1$の場合に命題が成り立つことがわかる。
		\begin{align*}
			t^0\shuffle_qt^0 = \frac{(0)_q^!}{(0)_q^!(0)_q^!} 
			= \binom{0}{0}_q,\quad
			t^1\shuffle_qt^0 = t^0\shuffle_qt^1
			= \frac{(1)_q^!}{(0)_q^!(1)_q^!} = \binom{1}{0}_q
		\end{align*}
		$1\le N\in\sizen$として、すべての$m+n\le N$で命題が成り立つ仮定する。
		すると、$m,n\in\sizen$を$m+n+1=N$として、q-シャッフル積の定義と
		帰納法の仮定から、次の式が成り立つ。
		\begin{equation*}\begin{split}
			t^{m+1}\shuffle_qt^{n+1} 
			&= t(t^m\shuffle_qt^{n+1} + q^{m+1}t^{m+1}\shuffle_qt^n) \\
			&= t\left(\binom{m+n+1}{m}_q + q^{m+1}\binom{m+n+1}{m+1}_q\right) \\
		\end{split}\end{equation*}
		ここで、q-二項係数について次の式が成り立つから、
		\begin{equation*}\begin{split}
			\binom{m+n+1}{m}_q + q^{m+1}\binom{m+n+1}{m+1}_q
			&= \binom{m+n+1}{m}_q
				\left(1 + q^{m+1}\frac{(n+1)_q}{(m+1)_q}\right) \\
			&= \binom{m+n+1}{m}_q\frac{(m+n+2)_q}{(m+1)_q} \\
			&= \binom{m+n+2}{m+1}_q \\
		\end{split}\end{equation*}
		次の式が成り立つことがわかる。
		\begin{equation*}\begin{split}
			t^{m+1}\shuffle_qt^{n+1} = \binom{m+n+2}{m+1}_q \\
		\end{split}\end{equation*}
		したがって、帰納法の仮定が$N+1$の時も成り立つことがわかる。
	\end{proof} %}
	この命題から、一変数q-シャッフル積は可換になることがわかる（当然？）。
	\begin{equation*}\begin{split}
		t^m\shuffle_qt^n = t^n\shuffle_qt^m \quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}

	q-シャッフル積と代数的に双対な余積$\Delta_q$を次の式によって定義する。
	\begin{equation*}\begin{split}
		\Delta_qt = t\otimes1 + 1\otimes t
	\end{split}\end{equation*}
	すると、式\eqref{eq:シャッフル積その一}を使うと、$\Delta_q$は次のように
	なることがわかる。
	\begin{equation}\label{eq:シャッフル積その二}\begin{split}
		\Delta_qt^m = \sum_{i=0}^m \binom{m}{i}\binom{m}{i}_q^{-1} 
		t^i\otimes t^{m-i}
		\quad\text{for all } m\in\sizen
	\end{split}\end{equation}
	通常の二項係数を分子、q-二項係数を分母とする分数が係数となっている。
	二項係数及びq-二項係数の対称性から、$\Delta_q$は余可換になることが
	わかる。

	今の場合、$m_q$は可換、$\Delta_q$は余可換になるが、それは変数が一つしか
	ないからであり、非可換な変数が二つ以上ある場合は、$m_q$は非可換、
	$\Delta_q$は非余可換になる。

	合成$m_q\Delta_q$は次のような簡単な形で書けるのに対して、
	\begin{equation}\label{eq:mDeltaその一}\begin{split}
		m_q\Delta_qt^m = (2t)^m \quad\text{for all } m\in\sizen
	\end{split}\end{equation}
	合成$\Delta_qm_q$は次のように簡単な形に落ちない。
	\begin{equation*}\begin{split}
		\Delta_qm_q(t^m\otimes t^n) = \binom{m+n}{m}_q\sum_{i=0}^{m+n} 
		\binom{m+n}{i}\binom{m+n}{i}_q^{-1} t^i\otimes t^{m+n-i} \\
		\quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}
	Fock空間での$\Delta_qm_q$の行列要素の計算は後述\eqref{eq:Deltamその一}
	する。
%s2:積と余積}
\subsection{作用素}\label{s2:作用素} %{
	微分と積分を定義しよう。
	ここでは、内積を用いて微分と積分を定義するので、自由ボゾン
	$\eta,\eta^\dag$を用いてそれらを定義することにする。
	自由ボゾンは次の交換関係と真空で定義される。
	\begin{equation*}\begin{split}
		\eta^\dag\eta = 1,\quad \bra{0}\eta = 0 = \eta^\dag\ket{0}
	\end{split}\end{equation*}
	特に断らない限り$\ket{m}$や$\bra{m}$は粒子数状態
	\begin{equation*}\begin{split}
		\ket{m} := \eta^m\ket{0},\quad \bra{m} := \bra{0}(\eta^\dag)^m
		\quad\text{for all } m\in\sizen
	\end{split}\end{equation*}
	を表すことにする。集合$\set{\ket{m}\bou m\in\sizen}$で張られるベクトルを
	$V$、その双対空間を$V^\dag$と書く。線形写像$-^\dag:V\to V^\dag$を
	$-^\dag:\eta\mapsto\eta^\dag$と定義すると、$-^\dag$は代数反準同型
	となり、任意の$n\in\sizen$に対して$(\eta^n)^\dag=(\eta^\dag)^n$となる。

	Fock空間$V$から多項式環$\fukuso[t]$へはコヒーレント状態を用いて変換する
	ことができる。
	\begin{equation*}\begin{split}
		\braket{0|(t\eta^\dag)^*|m} = t^m 
		\quad\text{for all } n\in\sizen,\; t\in\fukuso
	\end{split}\end{equation*}
	コヒーレント状態を次のように書く事にする。
	\begin{equation*}\begin{split}
		\ket{t}_0 := (t\eta)^*\ket{0},\quad \bra{t}_0 := \bra{0}(t\eta^\dag)^*
		\quad\text{for all } t\in\fukuso
	\end{split}\end{equation*}
	コヒーレント状態が準同型になるように、$V$に積$m_q$と余積$\Delta_q$を
	定義しよう。
	\begin{equation*}\xymatrix{
		V\otimes V \ar[d]^{\bra{t}_0\otimes\bra{t}_0} \ar[r]^{m_q} 
			& V \ar[d]^{\bra{t}_0} \\
		\fukuso[t]\otimes \fukuso[t] \ar[r]^{m_q} & \fukuso[t]
	},\quad\xymatrix{
		V\otimes V \ar[d]^{\bra{t}_0\otimes\bra{t}_0} 
			& V \ar[d]^{\bra{t}_0} \ar[l]_{\Delta_q} \\
		\fukuso[t]\otimes \fukuso[t] & \fukuso[t] \ar[l]^{\Delta_q}
	}\end{equation*}
	多項式のq-シャッフル積\eqref{eq:シャッフル積その一}とその双対余積
	\eqref{eq:シャッフル積その二}から、$V$の$m_q$と$\Delta_q$は次のように
	定義すればよいことがわかる。
	\begin{alignat}{2}\label{eq:シャッフル積その三}
		m_q\ket{m}\otimes\ket{n} &= \binom{m+n}{m}_q\ket{m+n}
		& \quad\text{for all } m,n\in\sizen \\
		\Delta_q\ket{m} &= \sum_{r=0}^m \binom{m}{r}\binom{m}{r}_q^{-1} 
			\ket{r}\otimes\ket{m-r}
		& \quad\text{for all } m\in\sizen
	\end{alignat}
	双対空間$V^\dag$への作用を計算すると次のようになる。
	\begin{alignat}{2}\label{eq:シャッフル積その四}
		\bra{m}m_q &= \sum_{r=0}^m \binom{m}{r}_q \bra{r}\otimes\bra{m-r}
		& \quad\text{for all } m\in\sizen \\
		\bra{m}\otimes\bra{n}\Delta_q &= \binom{m+n}{m}\binom{m+n}{m}_q^{-1} 
			\bra{m+n} & \quad\text{for all } m\in\sizen
	\end{alignat}
	ここでは、写像$V\to\fukuso[t]$を固定して$V$にq-シャッフル積を導入したが、
	他にもある導入する方法はある。例えば、$V$の余積を固定して、畳み込みに
	よって$V^\dag$に積を導入してもよい。

	$\eta_q,\eta_q^\Delta\in\End V$を次のように定義する。
	\begin{equation}\begin{split}\label{eq:生成元の定義}
		\eta_qf &:= m_q\ket{1}\otimes f \\
		\bra{1}\otimes f^\dag\Delta_q &:= f^\dag\eta_q^\Delta
	\end{split}
		\quad\text{for all } f\in V
	\end{equation}
	成分で書くと、任意の$n\in\sizen$に対して次のようになり、
	\begin{alignat}{2}\label{eq:生成元の作用その一}
		\eta_q\ket{n} &= (n+1)_q\ket{n+1}
		,&\quad \bra{n}\eta_q &= \jump{1\le n} (n)_q\bra{n-1} \\
		\bra{n}\eta_q^\Delta &= \frac{n+1}{(n+1)_q}\bra{n+1}
		,&\quad \eta_q^\Delta\ket{n} &= \jump{1\le n} \frac{n}{(n)_q}\ket{n-1}
	\end{alignat}
	任意の$m,n\in\sizen$に対して次のようになる。
	\begin{equation}\label{eq:生成元の作用その二}\begin{split}
		\eta_q^m\ket{n} &= \binom{m+n}{n}_q\ket{m+n} \\
		\bra{n}(\eta_q^\Delta)^m &= \binom{m+n}{n}\binom{m+n}{n}_q^{-1}
			\bra{m+n} \\
		\bra{n}\eta_q^m &= \jump{m\le n} \binom{n}{m}_q\bra{n-m} \\
		(\eta_q^\Delta)^m\ket{n} &= \jump{m\le n} 
			\binom{n}{m}\binom{n}{m}_q^{-1}\ket{n-m}
	\end{split}\end{equation}
	したがって、積と余積を粒子数状態で表すことができる。
	\begin{equation}\label{eq:作用素で表した積と余積その一}\begin{split}
		m_q &= \sum_{m,n\in\sizen} \eta_q^m\ket{n}\bra{m}\otimes\bra{n} \\
		\Delta_q &= \sum_{m,n\in\sizen} 
			\ket{m}\otimes\ket{n}\bra{n}(\eta_q^\Delta)^m \\
	\end{split}\end{equation}
	また、$\eta_q$と$\eta_q^\Delta$の定義から、次の正準交換関係が得られ、
	\begin{equation}\label{eq:正準交換関係その一}\begin{split}
		\eta_q^\Delta\eta_q = \eta_q\eta_q^\Delta + \id
	\end{split}\end{equation}
	正準交換関係と式\eqref{eq:作用素で表した積と余積その一}から、
	次のLeibnitz則に似た次の式が得られる。
	\begin{equation}\label{eq:ライプニッツ則その一}\begin{split}
		\eta_q^\Delta m_q
		& = m_q(\eta_0^\Delta\otimes\id + \id\otimes\eta_q^\Delta) \\
		\Delta_q\eta_q
		& = (\eta_q\otimes\id + \id\otimes\eta_1)\Delta_q \\
	\end{split}\end{equation}
	$\eta_q^\Delta m_q$の交換関係には$\eta_0^\Delta$、
	$\Delta_q\eta_q$の交換関係には$\eta_1$が入ってくることに注意する。

	ここで、$m_q\Delta_q$と$\Delta_qm_q$を計算しておく。まず、$m_q\Delta_q$
	から計算する。式\eqref{eq:生成元の作用その二}から、次の計算が得られて、
	\begin{equation*}\begin{split}
		\eta_q^m(\eta_q^\Delta)^m\ket{n} = \jump{m\le n}\binom{n}{m}\ket{n}
		\quad\text{for all }m,n\in\sizen
	\end{split}\end{equation*}
	$m_q\Delta_q$が次のように求まる。
	\begin{equation}\label{eq:mDeltaその二}\begin{split}
		m_q\Delta_q = \sum_{m\in\sizen} \eta_q^m(\eta_q^\Delta)^m = 2^N
	\end{split}\end{equation}
	ここで、$N$は粒子数を勘定する作用素で次のように定義される。
	\begin{equation}\label{eq:粒子数演算子その一}\begin{split}
		N := \sum_{n\in\sizen} n\ket{n}\bra{n} = \eta_q\eta_q^\Delta
	\end{split}\end{equation}
	この$N$のことを粒子数演算子ということにする。粒子数演算子を用いると、
	$\eta_q$と$\eta_q^\Delta$の交換関係\eqref{eq:正準交換関係その一}は
	次のように書ける。
	\begin{equation}\label{eq:正準交換関係その二}\begin{split}
		\eta_q^\Delta\eta_q = N + 1
	\end{split}\end{equation}
	$N$を$\eta_q$と$\eta_q^\Delta$で表した場合でも$q$には依存しない。
	ここで求めた結果は多項式に対して求めた結果\eqref{eq:mDeltaその一}
	に一致する。次に、$\Delta_qm_q$を計算する。粒子数状態での行列要素は
	次のように書ける。
	\begin{equation*}\begin{split}
		\Delta_qm_q &= \sum_{m,n,r,s\in\sizen}
			\ket{m}\otimes\ket{n}C_{mn}^{rs}\bra{r}\otimes\bra{s} \\
		C_{mn}^{rs} &:= \bra{n}(\eta_q^\Delta)^m\eta_q^r\ket{s} \\
	\end{split}\end{equation*}
	正準交換関係\eqref{eq:正準交換関係その二}から、次の式が成り立つ。
	\begin{equation*}\begin{split}
		(\eta_q^\Delta)^m\eta_q^m &= \binom{N+m}{N} \\
		\binom{N+m}{N} &:= (N+m)(N+m-1)\cdots(N+1) \\
	\end{split}
		\quad\text{for all } m\in\sizen
	\end{equation*}
	この式を使って場合分けによって行列要素$C_{mn}^{rs}$を求める。
	\begin{equation*}\begin{split}
		C_{mn}^{rs} = \begin{cases}
			\jump{m+n=r+s}\binom{n+r}{n}\binom{s}{m-r}\binom{s}{m-r}_q^{-1}
				, &\text{ iff } m\ge r \\
			\jump{m+n=r+s}\binom{n+m}{n}\binom{s}{r-m}\binom{s}{r-m}_q^{-1}
				, &\text{ otherwise } \\
		\end{cases}
	\end{split}\end{equation*}
	場合分けをまとめると次のように書ける。
	\begin{equation}\label{eq:Deltamその一}\begin{split}
		\Delta_qm_q &= \sum_{m,n,r,s\in\sizen}
			\ket{m}\otimes\ket{n}C_{mn}^{rs}\bra{r}\otimes\bra{s} \\
		C_{mn}^{rs} &:= \bra{n}(\eta_q^\Delta)^m\eta_q^r\ket{s} 
			= \jump{m+n=r+s}D_{mn}^{rs} \\
		D_{mn}^{rs} &:= \binom{n+\max(m,r)}{n}
			\binom{s}{|m-r|}\binom{s}{|m-r|}_q^{-1}
	\end{split}\end{equation}
	この式には、リー環$sl_2$のテンソル積表現を既約分解するときに現れる係数、
	最大値$max(*,*)$と差$|*-*|$、が現れるている。どこにでも現れそうな関数
	なので、表現の既約分解と関係するかどうかわからないが、もしかすると、
	q-Weyl代数のテンソル積表現を既約分解に関わっているのかもしれない。
	既にq-Weyl代数の既約表現は分類されていて、
	論文\cite{2012arXiv1203.1959H}から辿ることができる。

	$I_q$と$I_q^\Delta$を次のように定義すると、$\eta_q=\eta I_q$と
	$\eta_q^\Delta=I_q^\Delta\eta^\dag$と書くことができる。
	\begin{alignat}{2}\label{eq:Iの定義その一}
		I_q &:= \sum_{n\in\sizen} (n+1)_q\ket{n}\bra{n} &&= (N+1)_q \\
		I_q^\Delta &:= \sum_{n\in\sizen} \frac{n+1}{(n+1)_q}\ket{n}\bra{n}
		&&= \frac{N+1}{(N+1)_q}
	\end{alignat}
	$I_q$と$I_q^\Delta$は共に正則なエルミート作用素である。
	$q=0$でも$I_q\neq I_q^\Delta$となることに注意する。
	$I_q$と$I_q^\Delta$は次のように異なる$q$でそれぞれ可換になる。
	\begin{equation*}\begin{split}
		I_pI_q = I_qI_p,\quad I_p^\Delta I_q^\Delta = I_q^\Delta I_p^\Delta
		,\quad I_pI_q^\Delta = I_q^\Delta I_p
	\end{split}\end{equation*}
	$I_q$は$\eta$と$\eta^\dag$で書き直すことができる。
	\begin{equation}\label{eq:Iqその一}\begin{split}
		I_q &= \left\{\begin{matrix}
			& ( & 1 & & & & & ) & \ket{0}\bra{0} \\
			+ & ( & 1 & + & q & & & ) & \ket{1}\bra{1} \\
			+ & ( & 1 & + & q & + & q^2 & ) & \ket{2}\bra{2} \\
			+ & \cdots \\
		\end{matrix}\right. \\
		&= \sum_{n\in\sizen} \biggl(\ket{n}\bra{n} + q\ket{n+1}\bra{n+1} 
			+ q^2\ket{n+2}\bra{n+2} + \cdots\biggr) \\
		&= \sum_{n\in\sizen} q^n\eta^n(\eta^\dag)^n \\
	\end{split}\end{equation}
	ここで、最後にまとめ上げるところで次の式を使った。
	\begin{equation*}\begin{split}
		\eta^n(\eta^\dag)^n = \sum_{m\in\sizen}\ket{m+n}\bra{m+n}
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	式\eqref{eq:Iqその一}を使うと、$I_q$に対してKleeneスターに似た
	次の式が得られる。
	\begin{equation*}\begin{split}
		I_q = \id + q\eta I_q\eta^\dag
	\end{split}\end{equation*}
	$I_q$と$I_q^\Delta$の定義\eqref{eq:Iの定義その一}より、
	次の交換関係が得られる。
	\begin{equation*}\begin{split}
		I_q^\Delta I_q = N + 1 = I_q^\Delta I_q
	\end{split}\end{equation*}
	$N+1$は正則なエルミート作用素で$I_q$及び$I_q^\Delta$と可換だから、
	$I_q$と$I_q^\Delta$は次のように互いに逆になっていることがわかる。
	\begin{equation*}\begin{split}
		I_q^{-1} = (N+1)^{-1}I_q^\Delta,\quad (I_q^\Delta)^{-1} = (N+1)^{-1}I_q
	\end{split}\end{equation*}
	特に、$\eta_q$の左逆元と$\eta_q^\Delta$の右逆元が次のように与えられる。
	\begin{equation*}\begin{array}{rcl}
		\eta_q &\text{の左逆元}\quad& (N+1)^{-1}\eta_q^\Delta \\
		\eta_q^\Delta &\text{の右逆元}\quad& \eta_q(N+1)^{-1} \\
	\end{array}\end{equation*}

	\begin{todo}[指数写像]\label{todo:指数写像} %{
		対応$\ket{n}\to t^n$を定義しないと、多項式との対応は意味ないかも
		しれない。
	\end{todo} %todo:指数写像}
	$q=0$とすると、次のように通常の多項式の演算と対応がつく。
	\begin{equation*}\begin{array}{rclcrcrcrcl}
		&\quad&  &&\text{多項式} &\quad& \text{作用素} &\quad& 
			&& \text{Fock空間} \\
		\text{掛け算} && f_t &\mapsto& tf_t && \eta_0 && \ket{m} 
			&\mapsto& \ket{m+1} \\
		\text{割り算} && f_t &\mapsto& \frac{1}{t}\int_0^tds\partial_sf_s 
			&& (N+1)^{-1}\eta_0^\Delta
			&& \ket{m} &\mapsto& \jump{1\le m}\ket{m-1} \\
		\text{微分} && f_t &\mapsto& \partial_tf && \eta_0^\Delta 
			&& \ket{m} &\mapsto& \jump{1\le m}m\ket{m-1} \\
		\text{積分} && f_t &\mapsto& \int_0^tdsf_s && \eta_0(N+1)^{-1} 
			&& \ket{m} &\mapsto& (m+1)^{-1}\ket{m+1} \\
	\end{array}\end{equation*}
	ここで、掛け算、割り算と書いているところは、正確には多項式の係数を
	シフトする操作である。表が横長になってしまうので、掛け算、割り算と
	書いている。この表の割り算のところは、多項式に定数が含まれていると、
	単純に変数$t$で割ってしまうと多項式からはみ出て有理多項式になってしまう。
	それを防ぐために$\int_0^tds\partial_s$で定数項を除去している。

\subsubsection{Rota-Baxter作用素}\label{s3:Rota-Baxter作用素} %{
	Rota-Baxter作用素は部分積分を代数化したものとして見ることができる。
	次の積分について成り立つ式から、
	\begin{equation*}\begin{split}
		\int_0^tds\partial_sm\left(\int_0^sdr\otimes\int_0^sds\right)
		= \int_0^tdsm\left(\id\otimes\int_0^sdr+\int_0^sdr\otimes\id\right)
	\end{split}\end{equation*}
	左辺の被積分関数が$s=0$で$0$になることに注意すると次の式が得られる。
	\begin{equation*}\begin{split}
		m\left(\int_0^tdt\otimes\int_0^tdt\right)
		= \int_0^tdsm\left(\id\otimes\int_0^sdr+\int_0^sdr\otimes\id\right)
	\end{split}\end{equation*}
	ここで、線形写像$P\in\End\fukuso[t]$を次のように定義すると、
	\begin{equation*}\begin{split}
		P: f_t\mapsto \int_0^tds f_s
	\end{split}\end{equation*}
	$P$に関する次の式が得られる。
	\begin{equation*}\begin{split}
		m(P\otimes P) = Pm(\id\otimes P + P\otimes\id)
	\end{split}\end{equation*}
	この式は積分作用素$P$が重み$0$のRota-Baxter作用素になっていることを
	示している\cite{GuoIntro}。
%s3:Rota-Baxter作用素}
%s2:作用素}
	\begin{todo}[ここまで]\label{todo:ここまで} %{
	\end{todo} %todo:ここまで}

	まず、$\fukuso[t]$の作用素$[t]_q\in\End\fukuso[t]$を次のように
	定義する。
	\begin{equation*}\begin{split}
		[t]_qf = t\shuffle_qf \quad\text{for all } f\in\fukuso[t]
	\end{split}\end{equation*}
	q-シャッフル積を省略して書いただけである。
	次に、$\fukuso[t]$の双対空間$\fukuso[t^\tran]$を次の式で定義する。
	\begin{equation*}\begin{split}
		(t^\tran)^mt^n := \jump{m = n} \quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}
	同じ記号を使って、線形写像$-^\tran:\fukuso[t]\to\fukuso[t^\tran]$を
	次のように定義する。
	\begin{equation*}\begin{split}
		(t^m)^\tran := (t^\tran)^m \quad\text{for all } m\in\sizen
	\end{split}\end{equation*}
	微分作用素$[t]_q^\tran\in\End\fukuso[t]$を次のように定義する。
	\begin{equation*}\begin{split}
		([t]_qf)^\tran g = f^\tran [t]_q^\tran g
		\quad\text{for all } f,g\in\fukuso[t]
	\end{split}\end{equation*}
	$[t]_q^\tran$を恒等写像$\id=\sum_{n\in\sizen}t^n(t^\tran)^n$を使って
	計算すると次のようになる。
	\begin{equation*}\begin{split}
		[t]_q^\tran t^n = \jump{1\le n} (n)_qt^{n-1}
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	したがって、との交換関係は次のようになる。
	\begin{equation*}\begin{split}
		[t]_q^\tran[t]_q = 
	\end{split}\end{equation*}

	テンソル積の同型$V\otimes\fukuso\simeq V\simeq \fukuso\otimes V$
	を$\simeq_\fukuso$と書くことにして、$m_q:=-\shuffle_q-$と$\Delta_q$の
	転置をそれぞれ次のように定義する。
	\begin{equation*}\begin{split}
		\bigl(f\otimes g\bigr)^\tran m_q^\tran h
		&\simeq_\fukuso \bigl(m_q(f\otimes g)\bigr)^\tran h \\
		\bigl(f\bigr)^\tran \Delta_q^\tran(g\otimes h)
		&\simeq_\fukuso \bigl(\Delta_qf\bigr)^\tran (g\otimes h) \\
	\end{split}
	\quad\text{for all } f,g,h\in\fukuso[t]
	\end{equation*}
%s1:一変数シャッフル積}

\section{保留}\label{s1:保留} %{
	次の微分方程式を考えてみる。
	\begin{equation*}\begin{split}
		x_t = x_0 + \int_0^t dsv(x_s) 
		= \lim_{x=x_0}\bigl(\exp(tv_x\partial_x)\bigl)x
	\end{split}\end{equation*}
	$\exp$の部分はLie群となる。$v$が多項式の場合は、$\exp$の肩の部分は
	Virasoro代数で書ける。特に、$v$が二次式の場合、$\exp$の肩の部分は
	$sl_2(\jitu)$となる。微分方程式で成り立つ次のような図式をパーサー
	に持って行くことを考えたい。
	\begin{equation*}\begin{split}
		\text{微分方程式} \to \text{Lie代数}
	\end{split}\end{equation*}
	微分方程式でこの図式が成り立つカギは微分のチェイン則にある。
	\begin{equation*}\begin{split}
		\frac{\partial}{\partial t}
		= \frac{\partial x_t}{\partial t}\frac{\partial}{\partial x_t}
		= v(x_t)\frac{\partial}{\partial x_t}
	\end{split}\end{equation*}
	微分作用素と積分作用素をq-シャッフル積を用いて代数方程式に翻訳してみる。

	$\jitu[t]$を実数上の多項式環とする。不定元$t$を基底として考えているのか、
	作用素として考えているのかをはっきりさせるため、$\jitu[t]$をFock空間
	$(V,V^\dag)$で表すことにする。
	\begin{equation*}\begin{split}
		\ket{m} := \eta^m\ket{0},\quad
		\bra{m} := \bra{0}(\eta^\dag)^m \quad\text{for all } m\in\sizen \\
		\eta^\dag\eta = 1
		\implies \braket{m|n} = \jump{m = n} \quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}
	元の$\jitu[t]$は次のようにして得られる。
	\begin{equation*}\begin{split}
		f_t = \bra{0}(t\eta^\dag)^*f_\eta\ket{0}
		\quad\text{for all } f_t\in\jitu[t]
	\end{split}\end{equation*}

	$q\in\jitu$として、q-シャッフル積の作用素版$[\eta]_q\in\End V$を
	次のように定義する。
	\begin{equation}\label{q-シャッフル積の定義}\begin{split}
		[\eta]_q\eta\ket{m} = (m+1)_q\ket{m+1} \quad\text{for all } m\in\sizen
	\end{split}\end{equation}
	ここで、$(m)_q$を次のように定義する。
	\begin{equation*}\begin{split}
		(m)_q := \frac{1 - q^m}{1 - q} \quad\text{for all } m\in\sizen
	\end{split}\end{equation*}
	$(m)_q$は$q\to0,1$の極限で次のようになり、
	\begin{equation*}\begin{split}
		(m)_0 = 1,\quad (m)_1 = m \quad\text{for all } m\in\sizen
	\end{split}\end{equation*}
	$(-)_q:\sizen\to\sizen$は次のように半環準同型に似たものとなっている。
	\begin{equation}\label{eq:q-自然数}\begin{array}{rcll}
		(m + n)_q &=& (m)_q + q^m(n)_q & \quad\text{for all } m,n\in\sizen \\
		(mn)_q &=& (m)_q(n)_{q^m} & \quad\text{for all } m,n\in\sizen \\
	\end{array}\end{equation}

	作用素$I_q$を次のように定義すると、
	\begin{equation*}\begin{split}
		I_q := \sum_{n\in\sizen} (n+1)_q\ket{n}\bra{n}
	\end{split}\end{equation*}
	$\eta I_q$は$[\eta]_q$の定義式\eqref{q-シャッフル積の定義}を満たす。
	次の式を使うと、
	\begin{equation*}\begin{split}
		\eta^n(\eta^\dag)^n = \sum_{m\in\sizen}\ket{m+n}\bra{m+n}
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	$I_q$を次のように展開して$\eta$と$\eta^\dag$で書き直すことができる。
	\begin{equation*}\begin{split}
		I_q &= \left\{\begin{matrix}
			& ( & 1 & & & & & ) & \ket{0}\bra{0} \\
			+ & ( & 1 & + & q & & & ) & \ket{1}\bra{1} \\
			+ & ( & 1 & + & q & + & q^2 & ) & \ket{2}\bra{2} \\
			+ & \cdots \\
		\end{matrix}\right. \\
		&= \sum_{n\in\sizen} \biggl(\ket{n}\bra{n} + q\ket{n+1}\bra{n+1} 
			+ q^2\ket{n+2}\bra{n+2} + \cdots\biggr) \\
		&= \sum_{n\in\sizen} q^n\eta^n(\eta^\dag)^n \\
	\end{split}\end{equation*}
	まとめると$I_q$は次のようになる。
	\begin{equation}\label{eq:Iの定義}\begin{split}
		I_q := \sum_{n\in\sizen} q^n\eta^n(\eta^\dag)^n
		= \sum_{n\in\sizen} (n+1)_q\ket{n}\bra{n}
	\end{split}\end{equation}
	$I_q$はKleeneスターに似た次の式を満たす。
	\begin{equation}\label{eq:Kleeneスターに似た式}\begin{split}
		I_q = 1 + q\eta I_q\eta^\dag
	\end{split}\end{equation}
	$I_p$と$I_q$は可換だから、次の交換関係が得られる。
	\begin{equation*}\begin{split}
		(I_p\eta^\dag)(\eta I_q) = I_pI_q = I_qI_p = (I_q\eta^\dag)(I_p\eta)
		\quad\text{for all } p,q\in\jitu
	\end{split}\end{equation*}
	さらに、式\eqref{eq:Kleeneスターに似た式}を使うと、次の式が得られ、
	\begin{equation*}\begin{split}
		I_pI_q = 1 + \eta\bigl(pI_p + qI_q + pqI_pI_q\bigr)\eta^\dag
		\quad\text{for all } p,q\in\jitu
	\end{split}\end{equation*}
	次の交換関係が得られる。
	\begin{equation*}\begin{split}
		(I_p\eta^\dag)(\eta I_q) = 1 + \eta\bigl(pI_p+qI_q\bigr)\eta^\dag
			+ pq(\eta I_q)(I_p\eta^\dag) \quad\text{for all } p,q\in\jitu
	\end{split}\end{equation*}
	次のように$(p,q)$が$(1,0)$または$(0,1)$の時のみLeibnitz則が現れる。
	\begin{equation*}\begin{array}{lcrcl}
		(0,0) &\quad& \eta^\dag\eta &=& 1 \\
		(1,1) &\quad& (I_1\eta^\dag)(\eta I_1) &=& 1 + 2\eta I_1\eta^\dag 
			+ (\eta I_1)(I_1\eta^\dag) \\
		(0,1) &\quad& \eta^\dag(\eta I_1) &=& 1 + (\eta I_1)\eta^\dag \\
		(1,0) &\quad& (I_1\eta^\dag)\eta &=& 1 + \eta(I_1\eta^\dag) \\
	\end{array}\end{equation*}

	以降、誤解の恐れがない場合は、$\eta_q:=\eta I_q$、
	$\eta_q^\dag:=I_q\eta^\dag$と略記する。
	今興味があるのは次の交換関係である。
	\begin{equation*}\begin{split}
		\eta_q^\dag\eta = 1 + q\eta\eta_q^\dag
	\end{split}\end{equation*}
	この交換関係を$\eta$の任意のべき乗に一般化すると次のようになる。
	\begin{equation*}\begin{split}
		\eta_q^\dag\eta^n = \jump{1\le n}(n)_q\eta^{n-1} + q^n\eta^n\eta_q^\dag
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	$S_q\in\End V$を次のように定義し、
	\begin{equation*}\begin{split}
		S_q\ket{n} := q^n\ket{n} \quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	$V$の積$m$を次のように定義すると、
	\begin{equation*}\begin{split}
		m\ket{n_1}\otimes\ket{n_2} = \ket{n_1+n_2}
		\quad\text{for all } n_1,n_2\in\sizen
	\end{split}\end{equation*}
	$\eta_q^\dag$は次の式を満たす。
	\begin{equation}\label{eq:擬似ライプニッツ則}\begin{split}
		\eta_q^\dag m = m(\eta_q^\dag\otimes\id + S_q\otimes\eta_q^\dag)
	\end{split}\end{equation}
	$S_q$は$\eta$の定数倍に相当する。
	$q=0,1$とき、式\eqref{eq:擬似ライプニッツ則}は馴染みの深いものになって
	いる。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $q=0$のときは、$\eta_q^\dag$はBrzozowski微分になる。
		$S_0$は定数項（$\eta^0$の係数）を取り出す操作になる。
		\item $q=1$のときは、$\eta_q^\dag$は通常の微分になり、
		式\eqref{eq:擬似ライプニッツ則}は通常のライプニッツ則となる。
		$S_1$は恒等写像となる。
	\end{itemize} %}

	多項式の合成を定義しよう。任意の$f,g\in\fukuso[t]$に対して、
	$\set{f_n,g_n\in\fukuso\bou n\in\sizen}$を次のようにおいて、
	\begin{equation*}\begin{split}
		ft := \sum_{n\in\sizen} f_nt^n,\quad gt := \sum_{n\in\sizen} g_nt^n
	\end{split}\end{equation*}
	$\ket{f\circ g}$を次のように定義する。
	\begin{equation*}\begin{split}
		\ket{f\circ g} := \sum_{n\in\sizen} f_n(g\eta)^n\ket{0}
	\end{split}\end{equation*}
	$\ket{f\circ g}$は通常の多項式の合成となっている。
	$v\in\fukuso[t]$を$v0=0$となる定数項がない多項式として、
	次の微分方程式を考える。
	\begin{equation*}\begin{split}
		\eta_q^\dag\ket{x} = \ket{v\circ x},\quad \ket{0}\ket{x} = x_0
	\end{split}\end{equation*}
	この微分方程式の形式解$\ket{x}$は、$I_q$の逆元$I_q^{-1}$を用いて、
	\begin{equation*}\begin{split}
		I_q^{-1} = \sum_{n\in\sizen} (n+1)_q^{-1}\ket{n}\bra{n}
	\end{split}\end{equation*}
	次のように書くことができる。
	\begin{equation*}\begin{split}
		\ket{x} = x_0\ket{0} + (\eta I_q^{-1})\ket{v\circ x}
	\end{split}\end{equation*}

	\begin{note}[テイラー展開]\label{note:テイラー展開} %{
		次の微分方程式を考える。
		\begin{equation*}\begin{split}
			x_t = a + \int_0^tds bx_scx_sd
		\end{split}\end{equation*}
		$a,b,c,d$は互いに非可換とする。この微分方程式の解$x_t$を次のように
		級数展開して、
		\begin{equation*}\begin{split}
			x_t = \sum_{n\in\sizen} \frac{t^n}{n!} x_n
		\end{split}\end{equation*}
		元の微分方程式に代入して各$t^n$の係数が等しいとすると、
		次の式が得られる。
		\begin{equation*}\begin{split}
			x_{n+1} = \sum_{p=0}^n \binom{n}{p} bx_pcx_{n-p}d
			\quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		$x_n$を三次までは次のようになる。
		\begin{equation*}\begin{split}
			x_1 &= bx_0cx_0d \\
			x_2 &= bx_1cx_0d + bx_0cx_1d \\
			x_3 &= bx_2cx_0d + 2bx_1cx_1d + bx_0cx_2d \\
		\end{split}\end{equation*}
		$A:=\set{a,b,c,d}$、$V:=\fukuso\W A$とし、$x$を不定元として、
		線形写像$\gamma_x:V[x]\to V[x]$を$x_n=\lim_{x=x_0}\gamma_x^nx$
		となるように定義すると、次のようになる。
		\begin{equation*}\begin{array}{rcll}
			\gamma_x(w_1w_2) &=& (\gamma_xw_1)w_2 + w_1(\gamma_xw_2)
				& \quad\text{for all } w_1,w_2\in\W(A\cup\set{x}) \\
			\gamma_xz &=& \jump{z = x} bxcxd
				& \quad\text{for all } z\in(A\cup\set{x}) \\
		\end{array}\end{equation*}
		文字列$x$から始めて、文字列の中の$x$を１つずつ$bxcxd$に置き換えて
		いって、$x=x_0$とおけば、微分方程式の形式解の係数$x_n$が求まる。
		$\gamma_x^nx$を三次まで見ると次のようになる。
		\begin{equation*}\begin{split}
			\gamma_xx &= bxcxd \\
			\gamma_x^2x &= b(\gamma_xx)cxd + bxc(\gamma_xx)d \\
			\gamma_x^3x &= b(\gamma^2 x)cxd + 2b(\gamma_xx)c(\gamma_xx)d 
				+ bxc(\gamma_x^2x)d \\
		\end{split}\end{equation*}
		したがって、$\exp$について成り立つ次の式を用いると、
		\begin{equation*}\begin{split}
			e^{tz} = 1 + z\int_0^tds e^{sz}
		\end{split}\end{equation*}
		微分方程式の形式解$x_t$は次のように書くことができる。
		\begin{equation*}\begin{split}
			x_t = \sum_{n\in\sizen} \frac{t^n\gamma_x^n}{n!}x
			= \exp(t\gamma_x)x \implies x_t = x + \int_0^tds \gamma_xx_s
		\end{split}\end{equation*}

		一方、次の代数方程式を考える。
		\begin{equation*}\begin{split}
			y_t = a + tby_tcy_td
		\end{split}\end{equation*}
		この代数方程式の解$y_t$を次のように級数展開して、
		\begin{equation*}\begin{split}
			y_t = \sum_{n\in\sizen} y_n
		\end{split}\end{equation*}
		元の代数方程式に代入して各$t^n$の係数が等しいとすると、
		次の式が得られる。
		\begin{equation*}\begin{split}
			y_{n+1} = \sum_{p=0}^n by_pcy_{n-p}d \quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		$y_n$を三次までは次のようになる。
		\begin{equation*}\begin{split}
			y_1 &= by_0cy_0d \\
			y_2 &= by_1cy_0d + by_0cy_1d \\
			y_3 &= by_2cy_0d + by_1cy_1d + by_0cy_2d \\
		\end{split}\end{equation*}

		Lie微分が得られるか否かは微分演算子と右辺の時間の積に拠っているように
		思える。時刻$t$についてシャッフル積$\shuffle$を次にように定義し、
		\begin{equation*}\begin{split}
			t^m\shuffle t^n = \binom{m+n}{n}t^{m+n}
			\quad\text{for all } m,n\in\sizen
		\end{split}\end{equation*}
		次のように下線で時刻$t$に関するシャッフル積を表して、
		\begin{equation*}\begin{split}
			\underbrace{t^mw_1t^n}_\shuffle := (t^m\shuffle t^n)w_1
		\end{split}\end{equation*}
		微分方程式と代数方程式を次のように定義すると、
		\begin{equation*}\begin{split}
			x_t = a + \int_0^tds \underbrace{bx_scx_sd}_\shuffle,\quad
			y_t = a + \underbrace{tby_tcy_td}_\shuffle
		\end{split}\end{equation*}
		今度は、微分方程式と代数方程式の立場が逆転して、
		形式解を表すLie微分が、微分方程式については得られず、
		代数方程式について得られる。形式解を表すLie微分を導く過程で、
		時刻に関する微分作用素とベクトル場の中での時刻の積の代数的な双対関係を
		使っているものと思われる。

		until

		各係数$y_n$に因子$n$が掛かるところを除いて、微分方程式の場合と全く同じ
		形になる。$y:=y_0$とおいて、$\gamma$を使って書き直すと次のようになる。
		\begin{equation*}\begin{split}
			y_1 &= \gamma_yy \\
			\frac{1}{2}y_2 &= \gamma_y^2y \\
			\frac{1}{3!}y_3 &= b(\gamma^2y)cyd + b(\gamma y)c(\gamma y)d 
				+ byc(\gamma^2y)d \\
		\end{split}\end{equation*}
		$(1/3!)y_3$は$\gamma_y^3y$ではない。
		\begin{equation*}\begin{split}
			\gamma_y^3 
			&= b(\gamma^2y)cyd + 2b(\gamma y)c(\gamma y)d + byc(\gamma^2y)d \\
			&\neq b(\gamma^2y)cyd + b(\gamma y)c(\gamma y)d + byc(\gamma^2y)d \\
		\end{split}\end{equation*}
		微分方程式と代数方程式を同じように扱う方法の一つとして、余積を用いる
		方法があるだろう。集合$A=\set{b,c,d}$、代数$V=\fukuso\W A$として、
		多項式$V[x]$上に二項演算$\beta$を次のように定義して、
		\begin{equation*}\begin{split}
			\beta(w_1\otimes w_2) = bw_1cw_2d
			\quad\text{for all }w_1,w_2\in\W(A\cup\set{x})
		\end{split}\end{equation*}
		$\gamma$で生成される$\End V[x]$の部分空間に余積$\Delta_0$と$\Delta_1$を
		次のように定義すると、
		\begin{equation*}\begin{split}
			\Delta_0\gamma_x^n = \sum_{p=0}^n \gamma_x^p\otimes\gamma_x^{n-p}
			,\quad \Delta_1\gamma_x^n = \sum_{p=0}^n 
				\binom{n}{p}\gamma_x^p\otimes\gamma_x^{n-p}
		\end{split}\end{equation*}
		微分方程式の形式解$x_n$と代数方程式の形式解$y_n$はそれぞれ次のように
		書くことができる。
		\begin{equation*}\begin{split}
			x_{n+1} = \beta(\Delta_1\gamma_x^n)(x\otimes x),\quad 
			\frac{1}{(n+1)!}y_{n+1} = \beta(\Delta_0\gamma_y^n)(y\otimes y)
		\end{split}\end{equation*}
		この式を用いると、次の式を使って、
		\begin{equation*}\begin{split}
			\Delta_0z^* = z^*\otimes z^*,\quad \Delta_1e^z = e^z\otimes e^z
		\end{split}\end{equation*}
		それぞれの形式解は次のようになる。
		\begin{equation*}\begin{split}
			x_t &= x + \beta(e^{t\gamma_x}\otimes e^{t\gamma_x})(x\otimes x) \\
			y_t &= y + \beta\bigl((t\gamma_y)^*\otimes(t\gamma_y)^*\bigr)(x\otimes x) \\
		\end{split}\end{equation*}

		$\delta_x$を次のようにおくと、$\gamma_x=\beta\delta_x$と書ける。
		\begin{equation*}\begin{array}{rcll}
			\delta_x(w_1w_2) &=& (\delta w_1)w_2 + w_1(\delta w_2)
				& \quad\text{for all } w_1,w_2\in\W(A\cup\set{x}) \\
			\delta_xz &=& \jump{z = x} z\otimes z
				& \quad\text{for all } z\in(A\cup\set{x}) \\
		\end{array}\end{equation*}

		kokomade

		したがって、微分方程式と代数方程式の形式解を$\gamma$を使って
		書くと次のようになる。
		\begin{equation*}\begin{array}{rclclcl}
			x_t &=& \sum_{n\in\sizen}\cfrac{(t\gamma_x)^n}{n!}x
			&=& e^{t\gamma_x}x &\implies& x_t = x + \int_0^tds bx_scx_sd \\
			y_t &=& \sum_{n\in\sizen}(t\gamma_y)^ny
			&=& (t\gamma_y)^*y &\implies& y_t = y + tby_tcy_td \\
		\end{array}\end{equation*}
	\end{note} %note:テイラー展開}

	\begin{todo}[ここまで]\label{todo:ここまで} %{
	\end{todo} %todo:ここまで}

	$q=1$のとき、式\eqref{eq:擬似ライプニッツ則}は微分のチェイン則を
	導き出す。非線形写像$\gamma:V\to V\times V$を次のように定義し、
	\begin{equation*}\begin{split}
		\gamma\ket{f} := \ket{f}\times\ket{f} \quad\text{for all }\ket{f}\in V
	\end{split}\end{equation*}
	$\tau$を直積からテンソル積への標準的な写像とすると、
	次のようにしてチェイン則が得られる。
	\begin{equation*}\begin{array}{rcll}
		\eta_1^\dag\ket{f^2} &=& \eta_1^\dag m\tau\gamma\ket{f} \\
		 &=& m(\eta_1^\dag\otimes\id + \id\otimes\eta_1^\dag)\tau\gamma\ket{f} 
		 	& \lcomment{using Leibnitz rule} \\
		 &=& 2m(\eta_1^\dag\otimes\id)\tau\gamma\ket{f} 
		 	& \lcomment{symmetrized by $\gamma$} \\
	\end{array}\end{equation*}
	このチェイン則の導出を一般の$q$に対して適用すると次のようになる。
	\begin{equation*}\begin{array}{rcll}
		\eta_q^\dag\ket{f^2} &=& \eta_q^\dag m\tau\gamma\ket{f} \\
		 &=& m(\eta_q^\dag\otimes\id + S_q\otimes\eta_q^\dag)\tau\gamma\ket{f} 
		 	& \lcomment{using Leibnitz rule} \\
		 &=& m\bigl(\eta_q^\dag\otimes(\id + S_q)\bigr)\tau\gamma\ket{f} 
		 	& \lcomment{symmetrized by $\gamma$} \\
	\end{array}\end{equation*}
	さらに、$3$乗に対して適用すると次のようになる。
	\begin{equation*}\begin{array}{rcll}
		\eta_q^\dag\ket{f^3} 
		&=& \eta_q^\dag m(m\otimes\id)\tau(\gamma\times\id)\gamma\ket{f} \\
		&=& m(m\otimes\id)(\eta_q^\dag\otimes S_q^{(2)})
			\tau(\gamma\times\id)\gamma\ket{f}  \\
	\end{array}\end{equation*}
	ここで、$S_q^{(2)}$は次のように定義した。
	\begin{equation*}\begin{split}
		S_q^{(2)} = \id\otimes\id + S_q\otimes\id + S_q\otimes S_q
	\end{split}\end{equation*}
	$S_q^{(2)}$を一般化すると次のようになるだろう。
	\begin{equation*}\begin{split}
		S_q^{(n+1)} = S_q^{(n)}\otimes\id + S_q^{\otimes(n+1)}
	\end{split}\end{equation*}
	このチェイン則を単項式に適用してみると次のようになる。
	\begin{equation*}\begin{split}
		\eta_q^\dag\ket{mn} = \jump{1\le mn}(n)_q(m)_{q^n}\ket{mn-1}
		\quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}
	一方、$\eta_q^\dag\ket{(m+1)n}$をそのまま計算すると次のようになる。
	\begin{equation*}\begin{split}
		\eta_q^\dag\ket{mn} = \jump{1\le mn}(mn)_q\ket{mn-1}
		\quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}
	両者の計算結果が等しいことは$(n)_q$について成り立つ式\eqref{eq:q-自然数}
	からわかる。

	面倒なことをしなくても、多項式の合成を計算して次の式（合ってる？）を
	導きだせばよい。
	\begin{equation*}\begin{split}
		fx = \sum_{n\in\sizen} f_nx^n,\quad gx = \sum_{n\in\sizen} g_nx^n
		,\quad \ket{f} := (f\eta)\ket{0}
		,\quad \ket{f\circ g} := (fg\eta)\ket{0} \\
		\implies \eta_q^\dag\ket{f\circ g}
		= g_q\ket{f},\quad g_q := \sum_{n\in\sizen_+} 
		(n)_qg_{n}\eta^{n-1}\eta_{q^n}^\dag
	\end{split}\end{equation*}
	$g_q$がベクトル場となる。

	\begin{note}[微分方程式]\label{note:微分方程式} %{
		任意の$q\in\jitu$と$n\in\sizen$に対して$0<(n + 1)_q$だから、
		$I_q$の逆元$I_q^{-1}$が定義できて次のようになる。
		\begin{equation*}\begin{split}
			I_q^{-1} = \sum_{n\in\sizen} (n + 1)_q^{-1}\ket{n}\bra{n}
		\end{split}\end{equation*}
		$I_q\eta^\dag$を微分作用素だと思うと、積分作用素は$\eta I_q^{-1}$
		で与えられる。
		\begin{equation*}\begin{split}
			(I_q\eta^\dag)(\eta I_q^{-1}) = 1
		\end{split}\end{equation*}
		積分作用素を用いると、微分方程式の形式解が次のように得られる。
		\begin{equation*}\begin{split}
			(I_q\eta^\dag)\ket{x} = v\ket{x}
			\implies \ket{x} = c\ket{0} + (\eta I_q^{-1})v\ket{x}
		\end{split}\end{equation*}
		多項式環$\jitu[t]$上のq-微分$(\partial_t)_q$とq-積分$(dt)_q$を
		次のように定義すると、
		\begin{equation*}\begin{split}
			(\partial_t)_qt^n = \jump{1\le n}(n)_pt^{n-1},\quad
			(dt)_qt^n = (n+1)_p^{-1}t^{n+1} \quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		コヒーレント状態を用いて、フォック空間上の微分と積分は多項式環上の
		微分と積分にそのまま翻訳される。
		$\bra{t}$をコヒーレント状態$\bra{t}:=\bra{0}(t\eta^\dag)^*$とすると、
		次の式が成り立ち、
		\begin{equation*}\begin{split}
			\bra{t}I_q\eta^\dag\ket{n} = (\partial_t)_q t^n,\quad
			\bra{t}\eta I_q\ket{n} = (dt)_q t^n
			\quad\text{for all } t\in\jitu,\; n\in\sizen
		\end{split}\end{equation*}
		フォック空間上の微分方程式の形式解は次のように多項式環上の微分方程式の
		形式解に翻訳される。
		\begin{equation*}\begin{split}
			(\partial_t)_q\braket{t|x} = \bra{t}v\ket{x}
			\implies \braket{t|x} = c + (dt)_q\bra{t}v\ket{x}
		\end{split}\end{equation*}
	\end{note} %note:微分方程式}
	\begin{note}[q-シャッフル積と$I_q$の関係]
	\label{note:q-シャッフル積と$I_q$の関係} %{
		文字集合をシングルトンから有限集合に一般化した場合に、$I_q$に相当する
		作用素が得られるだろうか？
		$A$を有限集合して、線形写像$S:\fukuso A\times\fukuso\to\End\fukuso\W A$
		を次のように定義する。
		\begin{equation*}\begin{split}
			S_qa = \sum_{w\in \W A}q^{|w|}waw^\dag
			\quad\text{for all } a\in A,\; q\in\fukuso
		\end{split}\end{equation*}
		すると、$\ket{w}:=w\ket{0}$として、q-シャッフル積が得られる。
		\begin{equation*}\begin{split}
			S_q(a)\ket{w} = \ket{a\shuffle_qw}
			\quad\text{for all } a\in A,\; w\in \W A,\; q\in\fukuso
		\end{split}\end{equation*}
		$S_q$もKleeneスターに似た次の式を満たす。
		\begin{equation*}\begin{split}
			S_qa = a + q\sum_{b\in A}b(S_qa)b^\dag \quad\text{for all } a\in A
		\end{split}\end{equation*}
		この式はq-シャッフル積を定義する漸化式の特別な場合となっている。
		\begin{equation*}\begin{split}
			(S_qa)\ket{bw} = a\ket{bw} + qb(S_qa)\ket{w}
			\quad\text{for all } a,b\in A,\; w\in\W A \\
			\sim \ket{(aw)\shuffle_q(bx)}
			= a\ket{w\shuffle_q(bx)} + b\ket{(aw)\shuffle_qx}
			\quad\text{for all } a,b\in A,\; w,x\in\W A \\
		\end{split}\end{equation*}
		$S_q$は文字列の連結$m$を使って次のようにも書くことができる。
		\begin{equation*}\begin{split}
			S_qa &= m(J_q\otimes a)m^\dag \quad\text{for all } a\in A
			\quad\text{where } J_q := \sum_{w\in\W A} q^{|w|}\ket{w}\bra{w}
		\end{split}\end{equation*}
	\end{note} %note:q-シャッフル積と$I_q$の関係}
\subsection{sl2}\label{s2:sl2} %{
	$L_n\;(n=0,1,2)$を次のようにおくと、
	\begin{equation*}\begin{split}
		L_n = z^n\partial_z \quad\text{for all } n=0,1,2
	\end{split}\end{equation*}
	次の交換関係が得られて、$V=\set{L_n\bou n=0,1,2}$が代数となるこがわかる。
	\begin{equation*}\begin{split}
		[L_0,L_1] = L_0,\quad [L_1,L_2] = L_2,\quad [L_0,L_2] = 2L_1
	\end{split}\end{equation*}
	$L_\pm,H$を次のようにおくと、
	\begin{equation*}\begin{split}
		L_+ := iL_2,\quad L_- := iL_0,\quad H := 2L_1 
	\end{split}\end{equation*}
	交換関係が次のようになって、$V$は$sl_2$と同じLie代数の構造を持つこと
	がわかる。
	\begin{equation*}\begin{split}
		[H,L_\pm] = \pm2L_\pm,\quad [L_+,L_-] = H
	\end{split}\end{equation*}
%s2:sl2}
%s1:保留}
\section{Lie代数}\label{s1:Lie代数} %{
\subsection{群}\label{s2:群} %{

	部分群$H\subseteq G$が正規部分群の場合、次のようにして、
	剰余類の間に積$m$を定義することができる\footnote{
		部分群が正規部分群でなくても、このようにして積を定義することはできる
		が、代表元のとり方に依存してくる。
	}。
	\begin{equation*}\begin{split}
		m(g_1H,g_2H) := (g_1g_2)H
	\end{split}\end{equation*}
	$m$の定義は剰余類の代表元のとり方に依らず、
	\begin{equation*}\begin{split}
		g_1H = g_2H \implies g_1gH = g_2gH \quad\text{for all } g_1,g_2,g\in G
	\end{split}\end{equation*}
	$H$を単位元とする群になる。この群を正規部分群$H$による商群といい、
	$G/H$と書く。

	\begin{definition}[可解群]\label{def:可解群} %{
		群$G$が次のような有限な長さの部分群の列を持ち、
		\begin{equation*}\begin{split}
			G = G_0 \supset G_1 \supset\cdots\supset G_n = \mybf{1}
		\end{split}\end{equation*}
		すべての$i=0,\dots,n-1$で、
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $G_{i+1}$が$G_i$の正規部分群となり、
			\item $G_i/G_{i+1}$がアーベル群となる
		\end{itemize} %}
		とき、$G$を可解群という。
	\end{definition} %def:可解群}

\subsubsection{二次三角行列}\label{s3:二次三角行列} %{
	$T_2$を可逆な$2$次三角行列全体の作る集合とする。
	\begin{equation*}\begin{split}
		T_2 := \Set{\begin{pmatrix}
			a & c \\ 0 & b
		\end{pmatrix}\bou a,b\in\fukuso_\times,\; c\in\fukuso}
	\end{split}\end{equation*}
	ここで、$\fukuso_\times$を$\fukuso$から$0$を除いた集合とする。
	$T_2$は通常の行列の積について群となる。
	\begin{equation*}\begin{split}
		\begin{pmatrix}
			a_1 & c_1 \\ 0 & b_1
		\end{pmatrix}\begin{pmatrix}
			a_2 & c_2 \\ 0 & b_2
		\end{pmatrix} = \begin{pmatrix}
			a_1a_2 & a_1c_2+c_1b_2 \\ 0 & b_1b_2
		\end{pmatrix}
	\end{split}\end{equation*}
	逆元は次のように具体的に求まる。
	\begin{equation*}\begin{split}
		\begin{pmatrix}
			a & c \\ 0 & b
		\end{pmatrix}^{-1} = \frac{1}{ab}\begin{pmatrix}
			b & -c \\ 0 & a
		\end{pmatrix}
	\end{split}\end{equation*}
	これを用いると、$T_2$の共役変換は対角成分を変えないことがわかる。
	\begin{equation*}\begin{split}
		g^{-1} \begin{pmatrix}
			a & * \\ 0 & b
		\end{pmatrix}g = \begin{pmatrix}
			a & * \\ 0 & b
		\end{pmatrix} \quad\text{for all } g\in T_2
		,\; a,b\in \fukuso_\times
	\end{split}\end{equation*}
	したがって、$T_2$の交換子群$DT_2$は対角成分が$1$となる三角行列からなる
	ことがわかる。
	\begin{equation*}\begin{split}
		DT_2 := \Set{\begin{pmatrix}
			1 & c \\ 0 & 1 \end{pmatrix}\bou c\in\fukuso}
	\end{split}\end{equation*}
	さらに、$DT_2$の共役変換は次のようになり、
	\begin{equation*}\begin{split}
		\begin{pmatrix}
			1 & a \\ 0 & 1
		\end{pmatrix}^{-1}\begin{pmatrix}
			1 & b \\ 0 & 1
		\end{pmatrix}\begin{pmatrix}
			1 & a \\ 0 & 1
		\end{pmatrix} = \begin{pmatrix}
			1 & b \\ 0 & 1
		\end{pmatrix} \quad\text{for all } a,b\in\fukuso
	\end{split}\end{equation*}
	$DT_2$の交換子群$D^2T_2$は単位元だけからなる自明な群となる。
	\begin{equation*}\begin{split}
		g_1^{-1}g_2^{-1}g_1g_2 = 1 \quad\text{for all } g_1,g_2\in DT_2
	\end{split}\end{equation*}
	したがって、次の部分群の列が成り立ち、$T_2$は可解群となることがわかる。
	\begin{equation*}\begin{split}
		T_2 = D^0T_2\supset DT_2\supset D^2T_2 = \mybf{1}
	\end{split}\end{equation*}
%s3:二次三角行列}
%s2:群}
%s1:Lie代数}
\section{統計モデル}\label{s1:統計モデル} %{
\subsection{一次元モデル}\label{s2:一次元モデル} %{
	まず、最も簡単なモデルの一つであるIsingモデルをおさらいしておく。

\subsubsection{Isingモデル}\label{s3:Isingモデル} %{
	次のようなモデルを考えて、
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 頂点数が$N$の一定間隔の一次元格子上で考える。
		\item 格子上にスピン$\pm1$を割り当てる。
		\item 周期境界条件を課す。
		\item 格子上のスピンの隣接相互作用$k$を考える。
		\item 外部磁場$h$を入れる。
	\end{itemize} %}
	分配関数$Z(k,h,N)$を次のように定義する。
	\begin{equation*}\begin{split}
		Z(k,h,N) &= \sum_{s_0,\dots,s_{N-1}=\pm1} 
			\exp\left(\sum_{i=0}^{N-1}(ks_is_{i+1}+hs_i)\right) \\
	\end{split}\end{equation*}
	ここで、$\exp(ks_is_{i+1}+hs_i)$はBoltzmann重率と呼ばれる量で、
	格子の頂点一つ辺りのエネルギーを指数の肩に乗せたものになっている。
	スピン-スピン相互作用に相当する$k$の項はマイナスの符号がついた方が
	物理的に自然だが、記法の便宜上逆符号で書いている。
	任意の$s,t=\pm1$に対して$W(s,t)$を次のように定義すると、
	\begin{equation*}\begin{split}
		W(s,t) := \exp\bigl(kst + h\frac{s+t}{2}\bigr)
	\end{split}\end{equation*}
	分配関数は$Z(k,h,N)=\tr W^N$と書くことができる。
	$W$はBoltzmann重率を外部磁場$h$の項について対称化したもので、
	次のようになる。
	\begin{equation}\label{eq:転送行列その一}\begin{split}
		W = \begin{pmatrix}
			W(1,1) & W(1,-1) \\ W(-1,1) & W(-1,-1) \\
		\end{pmatrix} = \begin{pmatrix}
			\exp(k+h) & \exp(-k) \\ \exp(-k) & \exp(k-h) \\
		\end{pmatrix}
	\end{split}\end{equation}
	$W$は実対称行列なので、その固有値はすべて実数になる。
	$\lambda_\pm$を$W$の固有値で$\lambda_-\le\lambda_+$とすると、
	一頂点当たりの自由エネルギーが次のように計算できる。
	\begin{equation*}\begin{split}
		F(k,h) &:= -\lim_{N\to\infty}\frac{1}{N}\ln Z(k,h,N) \\
		&= -\lim_{N\to\infty}\frac{1}{N}\ln\tr W^n
		= -\lim_{N\to\infty}\frac{1}{N}\ln (\lambda_+^N + \lambda_-^N)
		= -\ln\lambda_+
	\end{split}\end{equation*}
	$W$の固有値$\lambda_\pm$は次のようになる。
	\begin{equation}\label{eq:転送行列の固有値その一}\begin{split}
		\lambda_\pm &= \frac{\tr W \pm \sqrt{(\tr W)^2 - 4(\det W)}}{2} \\
		&= e^k(\cosh e^h) \pm \sqrt{e^{2k}(\sinh e^h)^2 + e^{-2k}} \\
	\end{split}\end{equation}

	自由エネルギー$F$を外部磁場$h$で微分したものはスピンの向きの期待値
	$\braket{s}$となる。
	\begin{equation*}\begin{split}
		\braket{s} &= -\frac{\partial F}{\partial h}(k,h)
		= -\frac{\partial\ln\lambda_+}{\partial h}(k,h) \\
		&= -\frac{1}{\lambda_+} \left( e^k(\sinh e^h) 
			+ \frac{e^{2k}(\cosh e^h)(\sinh e^h)}
			{\sqrt{e^{2k}(\sinh e^h)^2 + e^{-2k}}} \right) \\
	\end{split}\end{equation*}
	外部磁場のない状態$h=0$で$\braket{s}\neq0$となれば、それは磁石となる。
	つまり、自発的対称性の破れが起きることになる。一次元Isingモデルでは
	$\lim_{h\to0}\braket{s}=0$となり、磁石にはならない。

	ボルツマン重率$W$はは空間$\pm1$に住む粒子が遷移確率$W$に
	したがって移動していくという描像をとることができる。
	絵にすると次のようになる。
	\begin{equation*}\xymatrix@C=6em{
		s_0 \ar[r]^{W(s_0,s_1)} & s_1 \ar[r]^{W(s_1,s_2)} 
		& \cdots \ar[r]^{W(s_{N-2},s_{N-1})}
		& s_{N-1} \ar@(u,u)[lll]_{W(s_{N-1},s_0)} \\
	}\end{equation*}
	この意味でボルツマン重率$W$を転送行列ということもある。

	格子の間隔が一定でなくても同様の議論が成り立ちそうに思うが、
	そうは問屋が下ろさない。$W$で$k$と$h$を明示的に次のように書いて、
	\begin{equation*}\begin{split}
		W(k,h) = e^k\bvec{e^h}{e^{-h}} + e^{-k}\sigma
		,\quad \bvec{a}{b} := \begin{pmatrix}
			a & 0 \\ 0 & b
		\end{pmatrix},\quad \sigma := \begin{pmatrix}
			0 & 1 \\ 1 & 0
		\end{pmatrix}
	\end{split}\end{equation*}
	$W(k_1,h)$と$W(k_2,h)$のLie括弧を計算すると次のようになり、
	\begin{equation*}\begin{split}
		\bigl[W(k_1,h),W(k_2,h)\bigr] 
		&= (e^{k_1-k_2} - e^{k_2-k_1})\left[\bvec{e^h}{e^{-h}},\sigma\right] \\
		&= (e^{k_1-k_2} - e^{k_2-k_1})(e^h - e^{-h})\bvec{1}{-1}\sigma \\
	\end{split}\end{equation*}
	$k_1=k_2$または$h=0$でない限り、$W(k_1,h)$と$W(k_2,h)$は同時に対角化する
	ことができないことがわかる。
%s3:Isingモデル}
%s2:一次元モデル}
%s1:統計モデル}

\section{三次元回転}\label{s1:三次元回転} %{
	$\lieso(3)$の既約表現とテンソル積表現の既約分解について書く。

\subsection{既約表現の構成}\label{s2:既約表現の構成} %{
	$\lieso(3)$の既約表現を列挙することを考える。

	$\lieso(3)$の生成子$\set{M_i\bou i=1,2,3}$を次の交換関係によって
	定義する。
	\begin{equation*}\begin{split}
		[M_i,M_j] = i\sum_{k=1}^3E_{ijk}M_k \quad\text{for all } i,j=1,2,3
	\end{split}\end{equation*}
	$M_\pm=M_1\pm iM_2$と定義すると、交換関係は次のように書ける。
	\begin{equation}\label{eq:交換関係その一}\begin{split}
		[M_+,M_-] = 2M_3,\quad [M_3,M_\pm] = \pm M_\pm
	\end{split}\end{equation}
	全角運動量$M^2$を次のように定義すると、
	\begin{equation*}\begin{split}
		M^2 := \sum_{i=1}^3 M_i^2
	\end{split}\end{equation*}
	$M^2$と各$M_i$は可換になる。
	\begin{equation*}\begin{split}
		[M_i,M^2] &= \sum_{j=1}^3 [M_i,M_j^2]
		= \sum_{j=1}^3 \bigl(M_j[M_i,M_j] + [M_i,M_j]M_j\bigr) \\
		& = i\sum_{j,k=1}^3 E_{ijk}\bigl(M_jM_k + M_kM_j\bigr) = 0
	\end{split}\end{equation*}
	したがって、$M^2$と$M_3$は同時に対角化可能となる。
	また、交換関係\eqref{eq:交換関係その一}から、$M_\pm$を$M_3$の固有値に
	対する昇降演算子としてフォック空間を構成することができる。
	$M^2$の固有値$l$と$M_3$の固有値$m$に属する固有ベクトルを$\ket{l,m}$と
	書き、その双対ベクトルを$\bra{l,m}$と書くことにする。
	\begin{equation*}\begin{split}
		M^2\ket{l,m} = l\ket{l,m},\quad M_3\ket{l,m} = m\ket{l,m} \\ 
		\braket{l_1,m_1\bou l_2,m_2} = \jump{l_1=l_2}\jump{m_1=m_2}
	\end{split}\end{equation*}
	$M^2$と各$M_i$と可換だから、次のベクトルによって張られるベクトル空間
	は$\lieso(3)$の作用に対して閉じている。
	\begin{equation*}\begin{split}
		\ket{l,m + n}\propto M_+^n\ket{l,m},\quad
		\ket{l,m - n}\propto M_-^n\ket{l,m} \quad\text{where } n\in\sizen
	\end{split}\end{equation*}

	$M_3$の固有値の範囲を調べる。次の式により、
	\begin{equation*}\begin{split}
		M_1^2 + M_2^2 &= \frac{1}{2}(M_+M_- + M_-M_+) \\
		M_1^2 - M_2^2 &= \frac{1}{2}(M_+M_+ + M_-M_-) \\
	\end{split}\end{equation*}
	$M^2$は次のように書ける。
	\begin{equation*}\begin{split}
		M^2 = \frac{1}{2}(M_+M_- + M_-M_+) + M_3^2
	\end{split}\end{equation*}
	この式の対角成分をとると、次の不等式が成り立つことがわかる。
	\begin{equation*}\begin{split}
		l = \frac{1}{2}\biggl(
			\bigl|M_-\ket{l,m}\bigr|^2 + \bigl|M_+\ket{l,m}\bigr|^2\biggr) + m^2
		&\implies l\ge m^2 \\
		&\iff -\sqrt{l} \le m \le \sqrt{l} \\
	\end{split}\end{equation*}
	$M^2$の固有値$l$を一つ決めて、$m$の上限を$m_l^{\max}$、
	下限を$m_l^{\min}$とすると、それらの固有ベクトルに対する昇降演算子
	の作用が次のように定まる。
	\begin{equation}\label{eq:上限と下限その一}\begin{split}
		M_+\ket{l,m_l^{\max}} = 0 = M_-\ket{l,m_l^{\min}}
	\end{split}\end{equation}
	ここで、次の式を使うと、
	\begin{equation}\label{昇降演算子のノルムその一}\begin{split}
		M_-M_+ = M^2 - M_3(M_3 + 1),\quad M_+M_- = M^2 - M_3(M_3 - 1)
	\end{split}\end{equation}
	式\eqref{eq:上限と下限その一}から次の式が導かれる。
	\begin{equation*}\begin{split}
		& l - m_l^{\max}(m_l^{\max} + 1) = 0 = l - m_l^{\min}(m_l^{\min} - 1) \\
		& \implies (m_l^{\max})^2 - (m_l^{\min})^2 + m_l^{\max} + m_l^{\min} = 0 \\
		& \iff  (m_l^{\max} + m_l^{\min})(m_l^{\max} - m_l^{\min} + 1) = 0 \\
	\end{split}\end{equation*}
	仮定から$m_l^{\min}\le m_l^{\max}$だから、この式が成り立つのは
	$m_l^{\max}+m_l^{\min}=0$となるときだけである。そして、
	$m_l^{\max}-m_l^{\min}\in\sizen$となるから、$M_3$の取りうる固有値は次の
	ようになる。
	\begin{equation*}\begin{array}{rrrrrrr}
		m_l^{\max} - m_l^{\min} & 0 & 1 & 2 & 3 & \cdots \\
		m_l^{\min} & 0 & -\frac{1}{2} & -1 & -\frac{3}{2} \\
		m_l^{\max} & 0 & \frac{1}{2} & 1 & \frac{3}{2} \\
	\end{array}\end{equation*}
	半自然数$\sizen/2=\set{0,\frac{1}{2},1,\frac{3}{2},\dots}$を
	用いると次のように書ける。
	\begin{equation*}\begin{split}
		m_l^{\min} = -j,\quad m_l^{\max} = j \quad\text{for all } j\in\sizen/2
	\end{split}\end{equation*}
	そして、$l$と$j$の関係は次のように求まる。
	\begin{equation*}\begin{split}
		l = m_l^{\max}(m_l^{\max} + 1) = j(j+1)
	\end{split}\end{equation*}
	以上をまとめると、次のように$M^2$と$M_3$の固有状態が得られた。
	\begin{equation*}\begin{split}
		M^2\ket{j,m} = j(j+1)\ket{j,m},\quad M_2\ket{j,m} = m\ket{j,m} \\
		\text{for all } j\in \sizen/2,\;
		m\in \set{-j, -j + 1,\dots, j - 1, j}
	\end{split}\end{equation*}
	また、式\eqref{昇降演算子のノルムその一}を使うと次のようになるから、
	\begin{equation*}\begin{split}
		\bigl|M_+\ket{j,m}\bigr|^2 = j(j+1) - m(m+1)
		,\quad \bigl|M_-\ket{j,m}\bigr|^2 = j(j+1) - m(m-1)
	\end{split}\end{equation*}
	昇降演算子の規格化因子は次のようになることがわかる。
	\begin{equation*}\begin{array}{rcll}
		M_+\ket{j,m} &=& \sqrt{j(j+1) - m(m + 1)}\;\ket{j,m+1}
			&\quad\text{for all } -j\le m< j \\
		M_-\ket{j,m} &=& \sqrt{j(j+1) - m(m - 1)}\;\ket{j,m-1}
			&\quad\text{for all } -j< m\le j \\
	\end{array}\end{equation*}
%s2:既約表現の構成}
\subsection{既約表現のテンソル積}\label{s2:既約表現のテンソル積} %{
	$\lieso(3)$の既約表現のテンソル積を既約表現の直和に分解することを考える。

	$\lieso(3)$に余積$\Delta$を次のように定義する。
	\begin{equation*}\begin{array}{rcll}
		\Delta 1 &=& 1\otimes 1 \\
		\Delta M_i &=& M_i\otimes1 + 1\otimes M_i
			&\quad\text{for all } i = 1,2,3 \\
		\Delta(M_{i_1}\cdots M_{i_n}) 
			&=& (\Delta M_{i_1})\cdots(\Delta M_{i_n})
			&\quad\text{for all } i_1,\dots,i_n = 1,2,3 \\
	\end{array}\end{equation*}
	すると，次の式が成り立ち、
	\begin{equation*}\begin{split}
		[\Delta M_i, \Delta M_j] = i\sum_{k=1}^3 E_{ijk}\Delta M_k
		\quad\text{for all } i,j = 1,2,3
	\end{split}\end{equation*}
	余積$\Delta$はLie代数準同型射となる。
	この余積を用いてテンソル積への表現を定義する。
	表現$(\rho_1,V_1)$と$(\rho_2,V_2)$のテンソル積への表現
	$\rho_1*\rho_2:\lieso(3)\to \End_\fukuso(V_1\otimes V_2)$を次のように
	定義する。
	\begin{equation*}\begin{split}
		(\rho_1*\rho_2)M_i := (\rho_1\otimes\rho_2)\Delta M_i
	\end{split}\end{equation*}
	以下の表現の準同型射$\rho$は省略して書く。

	前節の議論から、$\lieso(3)$の既約表現は半自然数を用いてパラメトライズ
	することができることがわかるので、任意の$j\in\sizen/2$に対して
	$M^2$の固有値が$j(j+1)$となる既約な表現空間を$V_j$と書くことにする。
	\begin{equation*}\begin{split}
		V_j = \myop{span} \set{\ket{j,m}\bou m=-j,-j+1,\dots,j-1,j}
	\end{split}\end{equation*}
	一般には、既約な表現空間のテンソル積によって作られる空間$V_j\otimes V_k$
	は既約ではない。$V_j\otimes V_k$を既約表現の直和に分解することを考える。
	
	ここで、テンソル積の記述を簡略化するための記法を定義しておく。
	$V_j$のベクトルで$M_3$の固有値$m$に属する固有ベクトルを単に$\ket{m}$
	と書くことにする。
	\begin{equation*}\begin{split}
		\ket{m}\in V_j \xiff{\dfn} \ket{j,m}
	\end{split}\end{equation*}
	また、この節では次の命題を使う。

	\begin{proposition}[最高ウィエイトによる部分既約表現]
	\label{prop:最高ウィエイトによる部分既約表現} %{
		$(\myspace,V)$を$\lieso(3)$のユニタリ表現とする。$u\in V$が
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $u\neq 0$かつ、
			\item $M_+u=0$かつ、
			\item ある$m\in\sizen$があって、$M_3u=mu$となる
		\end{itemize} %}
		とき、
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $u$は$M^2$の固有値$m(m+1)$を持ち、
			\item $\set{M_-^ku\bou k=0,1,\dots,2m}$で張られるベクトル空間は
			$M^2$の固有値が$m(m+1)$となる$\lieso(3)$の既約表現$V_m$と
			線形同型となる。
			\begin{equation*}\begin{split}
				V_m\simeq \myop{span}_\fukuso\set{u, M_-u,\dots, M_-^{2m}u}
			\end{split}\end{equation*}
		\end{itemize} %}
	\end{proposition} %prop:最高ウィエイトによる部分既約表現}
	\begin{proof} %{
		$u\in V$を命題の条件を満たすベクトルとし、
		ベクトルの集合$M_-^*u:=\set{M_-^ku\bou k=0,1,\dots,2m}$とする。
		$M^2$を'正規積'の形あらわした次の式を使うと、
		\begin{equation}\label{eq:二乗の正規積その一}\begin{split}
			M^2 = M_3(M_3 + 1) + M_-M_+ \\
		\end{split}\end{equation}
		$M^2u=m(m+1)u$となり、$u$が$M^2$の固有値$m(m+1)$を持つことがわかる。
		さらに、$M_-$と$M^2$は可換だから、$M_-^*u$の元はすべて$M^2$の固有値
		$m(m+1)$を持つことがわかる。
		そして、任意の$p\in\sizen$に対して次の式が成り立つから、
		\begin{equation*}\begin{split}
			M_-^{p+1}u = 0 \implies M_+M_-^{p+1}u = (2m - p)(p + 1)M_-^pu = 0
		\end{split}\end{equation*}
		$M_-^*u$に$0$が含まれないことがわかり、$M_-^pu$は$M_3$の固有値$m-p$
		を持つから、$M_-^*u$の元は互いに直交する。
		したがって、$M_-^*u$で張られるベクトル空間$\fukuso M_-^*u$の次元は
		$2m+1$となり、$V_m$の次元と一致する。そして、$M_-^*u$の定義より、
		$\fukuso M_-^*u$は$\lieso(3)$の既約表現となっているから、
		命題が成り立つことがわかる。
	\end{proof} %}

\subsubsection{(1/2,1/2)の場合}\label{s3:(1/2,1/2)の場合} %{
	$V_{1/2}\otimes V_{1/2}$の直和分解を考える。
	$V_{1/2}\otimes V_{1/2}$の標準的な基底系を、
	$M_3$の固有値だけを書いて
	$(m,n):=\ket{m}\otimes\ket{n}\in V_{1/2}\otimes V_{1/2}$として、
	$M_3$の固有値ごとに並べると、次のようになる。
	\begin{equation*}\begin{array}{rcrr}
		M_3 &\quad& \text{基底} \\
		1 &\quad& (\frac{1}{2},\frac{1}{2}) \\
		0 &\quad& (-\frac{1}{2},\frac{1}{2}) & (\frac{1}{2},-\frac{1}{2}) \\
		-1 &\quad& (-\frac{1}{2},-\frac{1}{2}) \\
	\end{array}\end{equation*}
	$M_3$の固有値が最も大きな基底$(1/2,1/2)$を$u1$と書くと、
	\begin{equation*}\begin{split}
		u1 := \ket{\frac{1}{2}}\otimes\ket{\frac{1}{2}}
	\end{split}\end{equation*}
	$(\Delta M_+)u1=0$となるから、
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{u1,M_-u1,M_-^2u1}$は、既約表現$V_1$の基底系を
	与えることがわかる。また、標準的な基底系の中で残る一つを$u0$とおき、
	次のように定義すると、
	\begin{equation*}\begin{split}
		u0 &:= \ket{-\frac{1}{2}}\otimes\ket{\frac{1}{2}}
			- \ket{\frac{1}{2}}\otimes\ket{-\frac{1}{2}} \\
	\end{split}\end{equation*}
	$\Delta M_\pm u0=0$となるから、やはり
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	シングルトン$\set{u0}$は既約表現$V_0$の基底系を与えることがわかる。
	以上より、次の直和分解が成り立つことがわかる。
	\begin{equation*}\begin{split}
		V_{\frac{1}{2}}\otimes V_{\frac{1}{2}} \simeq V_1\oplus V_0
	\end{split}\end{equation*}
%s3:(1/2,1/2)の場合}
\subsubsection{(1,1/2)の場合}\label{s3:(1,1/2)の場合} %{
	$V_1\otimes V_{1/2}$の直和分解を考える。
	$V_1\otimes V_{1/2}$の標準的な基底系を、
	$M_3$の固有値だけを書いて
	$(m,n):=\ket{m}\otimes\ket{n}\in V_1\otimes V_{1/2}$として、
	$M_3$の固有値ごとに並べると、次のようになる。
	\begin{equation*}\begin{array}{rcrr}
		M_3 &\quad& \text{基底} \\
		\frac{3}{2} &\quad& (1,\frac{1}{2}) \\
		\frac{1}{2} &\quad& (0,\frac{1}{2}) & (1,-\frac{1}{2}) \\
		- \frac{1}{2} &\quad& (-1,\frac{1}{2}) & (0,-\frac{1}{2}) \\
		-\frac{3}{2} &\quad& (-1,-\frac{1}{2}) \\
	\end{array}\end{equation*}
	$M_3$の固有値が最も大きな基底$(1,1/2)$を$u(3/2)$と書くと、
	\begin{equation*}\begin{split}
		u\frac{3}{2} := \ket{1}\otimes\ket{\frac{1}{2}}
	\end{split}\end{equation*}
	$(\Delta M_+)u(3/2)=0$となるから、
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{M_-^pu(3/2)\bou p=0,1,\dots,3}$は、
	既約表現$V_{3/2}$の基底系を与えることがわかる。
	また、$M_3=1/2$の標準基底系で残る一つのベクトルを$u(1/2)$とおき、
	$(\Delta M_-)u(3/2)$と直交するように定義すると、
	\begin{equation*}\begin{split}
		u\frac{1}{2} &:= \ket{0}\otimes\ket{\frac{1}{2}}
			- \sqrt{2}\ket{1}\otimes\ket{-\frac{1}{2}} \\
	\end{split}\end{equation*}
	$(\Delta M_+)u(1/2)=0$となるから、やはり
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{u(1/2),M_-u(1/2)}$は既約表現$V_{1/2}$の
	基底系を与えることがわかる。
	以上より、次の直和分解が成り立つことがわかる。
	\begin{equation*}\begin{split}
		V_1\otimes V_{\frac{1}{2}} \simeq V_{\frac{2}{2}}\oplus V_{\frac{1}{2}}
	\end{split}\end{equation*}
%s3:(1,1/2)の場合}
\subsubsection{(3/2,1/2)の場合}\label{s3:(3/2,1/2)の場合} %{
	$V_{3/2}\otimes V_{1/2}$の直和分解を考える。
	$V_{3/2}\otimes V_{1/2}$の標準的な基底系を、
	$M_3$の固有値だけを書いて
	$(m,n):=\ket{m}\otimes\ket{n}\in V_{3/2}\otimes V_{1/2}$として、
	$M_3$の固有値ごとに並べると、次のようになる。
	\begin{equation*}\begin{array}{rcrr}
		M_3 &\quad& \text{基底} \\
		2 &\quad& (\frac{3}{2},\frac{1}{2}) \\
		1 &\quad& (\frac{1}{2},\frac{1}{2}) & (\frac{3}{2},-\frac{1}{2}) \\
		0 &\quad& (-\frac{1}{2},\frac{1}{2}) & (\frac{1}{2},-\frac{1}{2}) \\
		-1 &\quad& (-\frac{3}{2},\frac{1}{2}) & (-\frac{1}{2},-\frac{1}{2}) \\
		- 2 &\quad& (-\frac{3}{2},-\frac{1}{2}) \\
	\end{array}\end{equation*}
	$M_3$の固有値が最も大きな基底$(3/2,1/2)$を$u2$と書くと、
	\begin{equation*}\begin{split}
		u2 := \ket{\frac{3}{2}}\otimes\ket{\frac{1}{2}}
	\end{split}\end{equation*}
	$(\Delta M_+)u2=0$となるから、
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{M_-^pu(3/2)\bou p=0,1,\dots,4}$は、
	既約表現$V_2$の基底系を与えることがわかる。
	また、$M_3=1/2$の標準基底系で残る一つのベクトルを$u1$とおき、
	$(\Delta M_-)u2$と直交するように定義すると、
	\begin{equation*}\begin{split}
		u1 &:= \ket{\frac{1}{2}}\otimes\ket{\frac{1}{2}}
			- \sqrt{3}\ket{\frac{3}{2}}\otimes\ket{-\frac{1}{2}} \\
	\end{split}\end{equation*}
	$(\Delta M_+)u1=0$となるから、やはり
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{u1,M_-u1,M_-^2u1}$は既約表現$V_1$の
	基底系を与えることがわかる。
	以上より、次の直和分解が成り立つことがわかる。
	\begin{equation*}\begin{split}
		V_{\frac{3}{2}}\otimes V_{\frac{1}{2}} \simeq V_2\oplus V_1
	\end{split}\end{equation*}
%s3:(3/2,1/2)の場合}
\subsubsection{(j,k)の場合}\label{s3:(j,k)の場合} %{
	$j,k\in\sizen/2$とする。$\dim(V_j\otimes V_j)=(2j+1)(2k-1)$となるが、
	$V_j\otimes V_j$の標準基底系を$M_3$の固有値ごとに縦に並べると、
	次のような台形になる。
	\begin{equation*}\xymatrix@R=1ex@C=1ex{
		& & & \circ & \cdots & \circ & & & \\
		& & & \vdots & \vdots & \vdots & & & \\
		& \circ & & \circ & \cdots & \circ & & \circ & \\
		\circ & \circ & & \circ & \cdots & \circ & & \circ & \circ \\
		j + k & j + k - 1 & \cdots & |j - k| & \cdots 
			& - |j - k| & \cdots & - (j + k - 1) & - (j + k) \\
	}\end{equation*}
	ここで、$|j-k|=\max(j,k)-\min(j,k)$となることに注意すると、
	図の$|j-k|$の意味がわかる。
	そして、$M_3=j+k$から順に、$\ker M_+$の元を一つ選び出して、
	それに$M_-$を掛けていって、次の図のようなベクトルの系列を作る。
	\begin{equation*}\xymatrix@R=1ex@C=1ex{
		& & & \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} & \circ \\
		& & & \vdots & \vdots & \vdots & & & \\
		& \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} 
			& \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} & \circ \ar[r]^{M_-} 
			& \cdots \ar[r]^{M_-} & \circ \\
		\circ \ar[r]^{M_-} & \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} 
			& \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} & \circ \ar[r]^{M_-} 
			& \cdots \ar[r]^{M_-} & \circ \ar[r]^{M_-} & \circ \\
		j + k & j + k - 1 & \cdots & |j - k| & \cdots 
			& - |j - k| & \cdots & - (j + k - 1) & - (j + k) \\
	}\end{equation*}
	すると、命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	次の直和分解が得られる。
	\begin{equation*}\begin{split}
		V_j\otimes V_k \simeq V_{j+k}\oplus V_{j+k-1}\oplus\cdots\oplus
			V_{|j-k|}
	\end{split}\end{equation*}

	ここで、$M_3$の固有値ごとに$\ker M_+$の元を一つ選び出す方法だが、
	教科書\cite{bk:jinbo.ryousigun}の方法を書いておく。
	$p\in\sizen/2$を$1\le p\le (j+k)-|j-k|=2\min(j,k)$となる半自然数とする。
	$u(j+k-p)\in V_j\otimes V_k$を$M_3$の固有値$j+k-p$を持ち、
	$(\Delta M_+)u(j+k-p)=0$となるベクトルとする。$u(j+k-p)$は未定係数
	$c_i\in\fukuso$を用いて次のように書くことができる。
	\begin{equation*}\begin{split}
		u(j+k-p) = \sum_{i=0}^p c_i\ket{j-i}\otimes\ket{k-p+i}
	\end{split}\end{equation*}
	$(\Delta M_+)u(j+k-p)=0$となるためには次の式を満たす必要がある。
	\begin{equation*}\begin{split}
		0 &= (\Delta M_+)u(j+k-p) \\
		&= \sum_{i=0}^{p-1}\bigl(c_{i+1}d^j_{j-i-1} + c_id^k_{k-p+i}\bigr)
			\ket{j-i}\otimes\ket{k-p+i+1} \\
		d^j_m &:= \braket{j,m+1|M_+|j,m} \\
	\end{split}\end{equation*}
	この条件は未定係数に対する漸化式になる。
	\begin{equation*}\begin{array}{rcll}
		c_{i+1} &=& - \cfrac{\braket{k,k-p+i+1|M_+|k,k-p+i}}
			{\braket{j,j-i|M_+|j,j-i-1}} c_i \\
		&=& - \left(\cfrac{(p-i)(2k-p+i+1)}{(i+1)(2j-i)}\right)^{\frac{1}{2}}
			c_i &\quad\text{for all } i=0,1,\dots,p-1
	\end{array}\end{equation*}
	そして、$c_0$と適当に選べば、例えば$c_0=1$、$u(j+k-p)$が一つ定まる。

	ここに書いた方法で最高ウィエイトベクトルを選び出すと次のようになる。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $j=1/2,\;k=1/2$の場合
		\begin{equation*}\begin{split}
			u1 = \ket{\frac{1}{2}}\otimes\ket{\frac{1}{2}},\quad
			u0 = \ket{\frac{1}{2}}\otimes\ket{-\frac{1}{2}}
				- \ket{-\frac{1}{2}}\otimes\ket{\frac{1}{2}}
		\end{split}\end{equation*}
		%
		\item $j=1,\;k=1/2$の場合
		\begin{equation*}\begin{split}
			u\frac{3}{2} = \ket{1}\otimes\ket{\frac{1}{2}},\quad
			u\frac{1}{2} = \ket{1}\otimes\ket{-\frac{1}{2}}
				- \frac{1}{\sqrt{2}}\ket{0}\otimes\ket{\frac{1}{2}}
		\end{split}\end{equation*}
		%
		\item $j=3/2,\;k=1/2$の場合
		\begin{equation*}\begin{split}
			u2 = \ket{\frac{3}{2}}\otimes\ket{\frac{1}{2}},\quad
			u1 = \ket{\frac{3}{2}}\otimes\ket{-\frac{1}{2}}
				- \frac{1}{\sqrt{3}}\ket{\frac{1}{2}}\otimes\ket{\frac{1}{2}}
		\end{split}\end{equation*}
	\end{itemize} %}
%s3:(j,k)の場合}
%s2:既約表現のテンソル積}
	\begin{note}[似た者同士]\label{note:似た者同士} %{
		$\lieso(3,\jitu)$と$su(2)$と$sl(2,\fukuso)$は似た者同士である。
		具体的にLie代数準同型を示すこと。
	\end{note} %note:似た者同士}
%s1:三次元回転}

\section{二次方程式の正級数解}\label{s1:二次方程式の正級数解} %{
	この節では次のような便宜を用いる。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[係数] $R=(R,+,0,\myspace,1)$を標数$0$の可換半体とする。
		ここで、半体とは次の集合とする。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item 分配則を満たす可換な加法$+$と乗法$\myspace$が定義されている。
			\item 加法と乗法はそれぞれ単位元$0$と$1$を持つ。
			\item $0$以外の元は乗法の逆元を持つ。
		\end{itemize} %}
		加算集合$A$に対して$RA$を自由半ベクトル空間とする。
		\begin{equation*}\begin{split}
			RA := \set{f:A\to R
				\bou fa \neq 0 \quad\text{for only finitely many } a\in A}
		\end{split}\end{equation*}
		%
		\item[半環] 単位的環から加法の逆元が存在すること仮定しないものを半環
		ということにする。半体は半環で$0$以外の元に対して乗法の逆元が存在する
		ことが保証されたものである。加群の係数を半環に置き換えたものを半加群
		ということにする。そして、半加群$V$上の集合$X$を基底とする自由半加群を
		$VX$と書く事にする。また、半加群に乗法が定義されたものを半代数という
		ことにする。
		%
		\item[フォック空間] $H_*:=\set{\eta_n\bou n\in\sizen_+}$を可算集合、
		$H_*^\tran=\set{\eta_{-n}\bou n\in\sizen_+}$を$RH$の双対空間の基底
		とする。
		\begin{equation*}\begin{split}
			\eta_{-m}\eta_n = \jump{m=n} \quad\text{for all } m,n\in\sizen_+
		\end{split}\end{equation*}
		$V$を$R$上の半代数とし、文字列$\W H_*$から生成される$V$上の自由半加群を
		$V\W H_*$と書く。そして、$V\W H_*$の自己線形写像全体のつくる
		$V$-半加群を$\mycal{H}_*:=\End_RV\W H_*$と書く事にする。$\mycal{H}_*$
		の元は$R$の元とは可換だが、一般には$V$の元とは非可換であることに
		注意する。また、はじめの$n$個の元だけからなる$H_*$の部分集合を
		$H_n:=\set{\eta_1,\dots,\eta_n}$と書くことにする。そして、$H_n$の
		自己線形写像全体のつくる$V$-半加群を$\mycal{H}_n$と書く事にする。
		特に、$\eta_1$だけからなる場合は、$H:=H_1$、$\mycal{H}:=\mycal{H}$と
		書き、$\eta_\pm:=\eta_{\pm1}$と書くこともある。
	\end{description} %}

	次の代数方程式について、
	\begin{equation}\label{eq:求める二次式}\begin{split}
		x = a + bxcxd \quad\text{where } a,b,c,d\in V
	\end{split}\end{equation}
	次の性質を満たす解を求めることを考える。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item この式にパラメーター$t\in R$を次のように入れたとき、
		\begin{equation*}\begin{split}
			x_t = a + tbx_tcx_td
		\end{split}\end{equation*}
		$t=0$で正則になり、$x_t=\sum_{n\in\sizen}x_nt^n$としたとき、
		すべての係数$x_n$が文字集合$\set{a,b,c,d}$の自然数を係数とする
		多項式で与えられる。
	\end{itemize} %}
	$x_t$の摂動係数$x_n$は次の漸化式を満たす。
	\begin{equation}\label{eq:求める漸化式}\begin{split}
		x_0 = a,\quad x_{n+1} = \sum_{p=0}^n bx_{n-p}cx_pd
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation}
	この解を\eqref{eq:求める二次式}の正級数解ということにする。

	代数方程式\eqref{eq:求める二次式}の正級数解$x$をオートマトンを使って
	解くことを考える。次のセルオートマトンが$x$に対応すると思われる。
	\begin{equation}\label{eq:二次式のセルオートマトンその一}\xymatrix@C=1ex{
		& (+,0) & (-,0) & (+,1) & (-,1) & (+,2) & (-,2) & (+,3) & (-,3) \\
		0 & \circ \ar[r]^a \ar[d]^b & \circ & \circ \ar[r]^a  \ar[drr]^b 
			& \circ & \circ \ar[r]^a & \circ & \circ \ar[r]^a & \circ  \\
		1 & \circ \ar[r]^a \ar[d]^b & \circ \ar[r]^c 
			& \circ \ar[r]^a \ar[drr]^b & \circ \ar[ull]_d
			& \circ \ar[r]^a & \circ \ar[r]^c & \circ \ar[r]^a
			& \circ \ar[ullll]_d \\
		2 & \circ \ar[r]^a & \circ \ar[r]^c & \circ \ar[r]^a 
			& \circ \ar[ull]_d
			& \circ \ar[r]^a & \circ \ar[r]^c & \circ \ar[r]^a
			& \circ \ar[ullll]_d 
	}\end{equation}
	遷移のパターンを考慮して水平方向の格子を偶奇で直和分解している。
	$+$が偶数番目、$-$が奇数番目の水平方向の座標を表す。
	可能な遷移を書くと任意の$m,n\in\sizen$に対して次のようになる。
	\begin{equation}\label{eq:二次式のセルオートマトンその二}\begin{array}{rcrcl}
		a &:& (+, m, n) &\mapsto& (-, m, n) \\
		c &:& (-, 2m, n + 1) &\mapsto& (+, 2m + 1, n + 1) \\
		b &:& (+, m, n) &\mapsto& (+, 2m, n + 1) \\
		d &:& (-, 2m + 1, n + 1) &\mapsto& (-, m, n) \\
	\end{array}\end{equation}
	$(+,0,0)$を始点、$(-,0,0)$を終点とするすべての経路を足し上げれば正級数解
	$x$が得られると予想される。二次元格子を次のように表して、
	\begin{equation*}\begin{split}
		\bra{m}\otimes\bra{n}
		,\quad \ket{m}\otimes\ket{n}
		,\quad \begin{pmatrix}
			+ & -
		\end{pmatrix},\quad\begin{pmatrix}
			+ \\ -
		\end{pmatrix}
	\end{split}\end{equation*}
	このセルオートマトンを$2\times2$行列の形で書くと次のようになる。
	\begin{equation}\label{eq:セルオートマトンでの真空期待値}\begin{split}
		x = m_V\bra{0}\otimes\bra{0}\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b\beta & a \\
			c\gamma & d\delta
		\end{pmatrix}^*\begin{pmatrix}
			0 \\ 1
		\end{pmatrix}\ket{0}\otimes\ket{0} \\
	\end{split}\end{equation}
	ここで、$m_V$は$V$の積とし、$\beta,\gamma,\delta$を次のように定義する。
	\begin{equation*}\begin{array}{rclrcl}
		\gamma &=& C\eta_-\otimes\eta_+\eta_-,
			&\quad C &=& \sum_{m\in\sizen}\ket{2m}\bra{2m} \\
		\beta &=& B_-\otimes\eta_-,
			&\quad B_- &=& \sum_{m\in\sizen}\ket{m}\bra{2m} \\
		\delta &=& \eta_+B_+\otimes\eta_+,
			&\quad B_+ &=& \sum_{m\in\sizen}\ket{2m}\bra{m} \\
	\end{array}\end{equation*}
	そして、$\eta_\pm$は自然数を$\pm1$する演算子で任意の$m\in\sizen$に対して
	次のように定義する。
	\begin{equation*}\begin{split}
		\eta_- = \sum_{m\in\sizen}\ket{m}\bra{m+1}
		,\quad \eta_+ = \sum_{m\in\sizen}\ket{m+1}\bra{m}
	\end{split}\end{equation*}
	$\zeta_{\pm1}$と$\zeta_{\pm}2$を次のようにおくと、
	\begin{equation*}\begin{array}{rclcrcl}
		\zeta_{-1} &:=& \beta, &\quad& \zeta_1 &:=& \zeta_{-1}^\tran \\
		\zeta_2 &:=& \gamma, &\quad& \zeta_{-2} &:=& \zeta_2^\tran \\
	\end{array}\end{equation*}
	$\gamma=\zeta_1\zeta_{-2}$と書け、次の交換関係と、
	\begin{equation}\label{eq:セルオートマトンでの交換関係}\begin{split}
		\zeta_{-i}\zeta_j &= \jump{i=j} \quad\text{for } i,j = 1,2
	\end{split}\end{equation}
	次の真空への作用が成り立つ。
	\begin{equation}\label{eq:セルオートマトンでの基底状態}\begin{array}{rclcrcl}
		\zeta_{-i}\ket{0}\otimes\ket{0} &=& 0 
			&=& \bra{0}\otimes\bra{0}\zeta_i  \\
		\zeta_{i}\ket{0}\otimes\ket{0} &\neq& 0 
		&\neq& \bra{0}\otimes\bra{0}\zeta_{-i} \\
	\end{array}
		\quad\text{for } i,j = 1,2
	\end{equation}
	したがって、$\set{\zeta_{\pm 1},\zeta_{\pm 2}}$から生成される$R$上の代数を
	$\mycal{H}_2'$、$\set{\eta_{\pm 1},\eta_{\pm 2}}$から生成される$R$上の
	代数を$\mycal{H}_2$とすると、代数同型$\mycal{H}_2'\simeq\mycal{H}_2$が
	成り立つことが予想される。そして予想が成り立つと、
	$H_2'=\set{\zeta_1,\zeta_2}$として、
	作用\eqref{eq:セルオートマトンでの基底状態}から、$\mycal{H}_2'$の表現空間
	、$R\W H_2'\ket{0}\otimes\ket{0}$、はフォック空間$R\W H$に$R$-線形同型
	となっていることが帰結される。代数同型$\mycal{H}_2'\simeq\mycal{H}_2$が
	成り立つことを言うためには、$R$上の代数$R\W H_2'$が自由代数になっている
	ことを示す必要がある。$R\W H_2'$が自由代数になっていることが示されれば、
	$\mycal{H}_2'$の任意の元は次のような正規積の形で書かれるので、
	\begin{equation*}\begin{split}
		\zeta_{i_1}\cdots\zeta_{i_m}\zeta_{-j_1}\cdots\zeta_{-j_n}
		\quad\text{where } i_1,\dots,i_m,j_1,\dots,j_n = 1,2
	\end{split}\end{equation*}
	$\mycal{H}_2'$が$\mycal{H}_2$と代数同型になることがわかる。

	$\zeta_i$は次のようになっているから、
	\begin{equation*}\begin{split}
		\zeta_1 = B_+\otimes\eta_+,\quad \zeta_2 = \eta_+B_+\otimes\eta_+
		,\quad B_+ = \sum_{m\in\sizen}\ket{2m}\bra{m}
	\end{split}\end{equation*}
	任意の$\W H'$の元は次のように表される。
	\begin{equation*}\begin{split}
		\zeta_{i_1}\cdots\zeta_{i_n}
		= \biggl((\eta_+)^{i_1-1}B_+\cdots(\eta_+)^{i_n-1}B_+\biggr)
		\otimes\eta_+^n
	\end{split}\end{equation*}
	テンソル積の二項目$\eta_+^n$から次の式が成り立つことがわかる。
	\begin{equation*}\begin{split}
		\zeta_{i_1}\cdots\zeta_{i_m} = \zeta_{j_1}\cdots\zeta_{j_n}
		\implies m = n
	\end{split}\end{equation*}
	したがって、テンソル積の一項目が線形独立であることが示されればよい。
	任意の$i_1,\dots,i_n,j_1,\dots,j_n=1,2$に対して次の式が成り立つが、
	\begin{equation*}\begin{split}
		& (\eta_+)^{i_1-1}B_+\cdots(\eta_+)^{i_n-1}B_+
			= (\eta_+)^{j_1-1}B_+\cdots(\eta_+)^{j_n-1}B_+ \\
		& \implies (\eta_+)^{i_1-1}B_+\cdots(\eta_+)^{i_n-1}B_+\ket{m}
			= (\eta_+)^{j_1-1}B_+\cdots(\eta_+)^{j_n-1}B_+\ket{m} \\
		& \quad\text{for all } m\in\sizen \\
	\end{split}\end{equation*}
	$\ket{m'}=(\eta_+)^{i_1-1}B_+\cdots(\eta_+)^{i_n-1}B_+\ket{m}$として、
	$m'$が偶数であれば$i_1=j_1=1$、$m'$が奇数であれば$i_1=j_1=2$となることが
	わかる。よって、帰納法を使うことにより、すべての$p=1,2,\dots,n$に対して
	$i_p=j_p$となることがわかる。よって、$R\W H_2$の元
	\begin{equation*}\begin{split}
		1,\; \zeta_i,\; \zeta_i\zeta_j,\;\dots,\;
		\zeta_{i_1}\cdots\zeta_{i_n},\;\dots
	\end{split}\end{equation*}
	が互いに$R$-線形独立となることがわかる。以上より、$R\W H_2'$が自由代数
	となっていることが示された。

	まとめると、$1:1$の代数射$\phi:\mycal{H}_2\to\mycal{H}\otimes\mycal{H}$が
	次のように与えられ、
	\begin{equation}\label{eq:一対一の代数射その一}\begin{split}
		\phi\eta_1 = B_+\otimes\eta_+,\quad
		\phi\eta_2 = \eta_+B_+\otimes\eta_+,\quad
		\phi f^\tran = (\phi f)^\tran \quad\text{for all } f\in \mycal{H}_2
	\end{split}\end{equation}
	代数方程式\eqref{eq:求める二次式}の正級数解が次のように与えられたこと
	になる。
	\begin{equation}\label{eq:二次式の正級数解その一}\begin{split}
		x = \bra{0}\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b\eta_{-1} & a \\
			c\eta_1\eta_{-2} & d\eta_2
		\end{pmatrix}^*\begin{pmatrix}
			0 \\ 1
		\end{pmatrix}\ket{0} \\
	\end{split}\end{equation}
	そして、セルオートマトン\eqref{eq:二次式のセルオートマトンその一}は
	次のスタックオートマトンと等しいことがわかる。
	\begin{equation}\label{eq:二次式のスタックオートマトンその一}\xymatrix{
		*++[o][F-]{+} \ar@(ul,dl)_{b\eta_{-1}} \ar@/_1ex/[r]_a
		& *++[o][F-]{-} \ar@(dr,ur)_{d\eta_{2}} \ar@/_1ex/[l]_{c\eta_1\eta_{-2}}
	}\end{equation}
	真空期待値\eqref{eq:二次式の正級数解その一}
	またはスタックオートマトン\eqref{eq:二次式のスタックオートマトンその一}
	が代数方程式\eqref{eq:求める二次式}の正級数解になっていることを代数的に
	証明しておく。

	\begin{proposition}[二次式の正級数解]\label{prop:二次式の正級数解} %{
		$\mycal{H}_2$の真空期待値\eqref{eq:二次式の正級数解その一}は
		代数方程式\eqref{eq:求める二次式}の正級数解となる。
		\begin{equation*}\begin{split}
			x = \bra{0}\begin{pmatrix}
				1 & 0
			\end{pmatrix}\begin{pmatrix}
				b\eta_{-1} & a \\
				c\eta_1\eta_{-2} & d\eta_2
			\end{pmatrix}^*\begin{pmatrix}
				0 \\ 1
			\end{pmatrix}\ket{0} \implies x = a + bxcxd
		\end{split}\end{equation*}
	\end{proposition} %prop:二次式の正級数解}
	\begin{proof} %{
		命題の左辺が右辺の式を満たすことを示す。まず、二次元行列のKleeneスター
		を展開する。二次元行列$M,M_0,M_1,\sigma$を次のようにおく。
		\begin{equation*}\begin{split}
			M := \begin{pmatrix}
				b\eta_{-1} & a \\
				c\eta_1\eta_{-2} & d\eta_2
			\end{pmatrix} = M_0 + M_1\sigma \\
			M_0 := \bvec{b\eta_{-1}}{d\eta_2}
			,\quad M_1 := \bvec{a}{c\eta_1\eta_{-2}}
			,\quad \sigma := \begin{pmatrix}
				0 & 1 \\ 1 & 0
			\end{pmatrix}
		\end{split}\end{equation*}
		ここで、$[\lambda_1,\lambda_2]^\tran$は成分が$\lambda_1,\lambda_2$の
		二次元対角行列を表す。$M^*$を次のように展開して、
		\begin{equation*}\begin{split}
			M^* = (M_0^*M_1\sigma)^*M_0^*
		\end{split}\end{equation*}
		$(1,0)$と$(0,1)^\tran$で挟むと次のようになることがわかる。
		\begin{equation*}\begin{split}
			\begin{pmatrix}
				1 & 0
			\end{pmatrix}M^*\begin{pmatrix}
				0 \\ 1
			\end{pmatrix} &= \begin{pmatrix}
				1 & 0
			\end{pmatrix}(M_0^*M_1\sigma M_0^*M_1\sigma)^*M_0^*M_1\sigma M_0^*
			\begin{pmatrix}
				0 \\ 1
			\end{pmatrix} \\
			&= \bigl((b\eta_{-1}^*)a(d\eta_2)^*c\eta_1\eta_{-2}\bigr)^*
			(b\eta_{-1}^*)a(d\eta_2)^*
		\end{split}\end{equation*}
		これを$\ket{0}$に作用させたものを$\ket{X}$、Kleeneスターの中を$T$
		と書く。
		\begin{equation*}\begin{split}
			\ket{X} := T^*a\ket{d:2},\quad
			T := (b\eta_{-1}^*)a(d\eta_2)^*c\eta_1\eta_{-2}
		\end{split}\end{equation*}
		ここで、$\ket{d:2}:=(d\eta_2)^*\ket{0}$としている。$\braket{0|X}$
		が命題の左辺の値になる。$T$を正規積の形に書き直すと次のようになる。
		\begin{equation*}\begin{split}
			T = T_1 + T_{-1},\quad
			T_1 := a(d\eta_2)^*c\eta_1\eta_{-2},\quad
			T_{-1} := (b\eta_{-1})^*bac\eta_{-2}
		\end{split}\end{equation*}
		$T_{\pm1}$を一般化して線形写像$T_\pm:V\to\mycal{H}_2$を次のように定義
		すると、
		\begin{equation*}\begin{split}
			T_+f := f(d\eta_2)^*c\eta_1\eta_{-2},\quad
			T_-f := (b\eta_{-1})^*bfc\eta_{-2}
		\end{split}\end{equation*}
		$T_\pm$は次の代数を満たし、
		\begin{equation*}\begin{split}
			(T_-f)(T_+g) = T_+(bfcgd) + T_-(bfcgd)
			\quad\text{for all } f,g\in V
		\end{split}\end{equation*}
		$T_-$は$\ket{d:2}$を固有状態に持つ。
		\begin{equation*}\begin{split}
			(T_-f)g\ket{d:2} = bfcgd\ket{d:2} \quad\text{for all } f,g\in V
		\end{split}\end{equation*}
		$T_{\pm1}$は$T_\pm a$と書くことができる。
		$T_\pm$の代数から$V$の二項演算$\odot$を
		\begin{equation*}\begin{split}
			f\odot g = bfcgd \quad\text{for all } f,g\in V
		\end{split}\end{equation*}
		とおき、$x$を代数方程式\eqref{eq:求める二次式}の正級数解とすると、
		\begin{equation*}\begin{split}
			x = \sum_{n\in\sizen} x_n,\quad
			x_0 = a,\quad x_{n+1} = \sum_{p=0}^n x_p\odot x_{n-p}
			\quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		命題\eqref{prop:ベクトル空間から代数}から、次の式が成り立つことが
		わかる。
		\begin{equation*}\begin{split}
			T^* = (T_+x)^*(T_-x)^*
		\end{split}\end{equation*}
		この式から次の式が得られる。
		\begin{equation*}\begin{split}
			\braket{0|X} &= \bra{0}(T_-x)^*a\ket{d:2} \\
			&= \bra{0}(bxc\eta_{-2})^*a(d\eta_2)\ket{0} \\
		\end{split}\end{equation*}
		この式は代数方程式$x=a+bxcxd$を次のように等しい。
		\begin{equation*}\begin{split}
			x = a+bxcxd = \sum_{n\in\sizen} (bxc)^nad^n
			= \bra{0}(bxc\eta_-)^*a(d\eta_+)^*\ket{0}
		\end{split}\end{equation*}
		したがって、命題が成り立つことが示された。
	\end{proof} %}

	この命題で、一般の半体$R$では命題の逆$\Leftarrow$は成り立たないことに
	注意する。例えば、$R$が複素数の場合、$x=1+tx^2$という二次方程式は
	$x=\frac{1\pm\sqrt{1-4t}}{2t}$と二つの解を持つが、命題が与える解は
	$x=\frac{1-\sqrt{1-4t}}{2t}$の方だけになっている。

	\begin{proposition}[ベクトル空間から代数]\label{prop:ベクトル空間から代数} %{
		$A$をベクトル空間、$B$を代数とする。$\odot$を$A$の線形とは限らない
		二項演算とし、$\phi_\pm:A\to B$を次の性質を満たす線形写像とする。
		\begin{equation*}\begin{split}
			(\phi_-x)(\phi_+y) = (\phi_+ + \phi_-)(x\odot y)
			\quad\text{for all } x,y\in A
		\end{split}\end{equation*}
		このとき、$\alpha:A\times\sizen_+\to A$を任意の$x\in A$に対して
		次のように定義し、
		\begin{equation*}\begin{array}{rcll}
			\alpha_1x &=& x \\
			\alpha_2x &=& x\odot x \\
			\alpha_3x &=& (x\odot x)\odot x + x\odot(x\odot x) \\
			\cdots \\
			\alpha_{n+1}x &=& \sum_{p=1}^n (\alpha_px)\odot(\alpha_{n+1-p}x)
			& \quad\text{for all } n\in\sizen_+
		\end{array}\end{equation*}
		写像$\psi_\pm:A\times\fukuso\to B$を次のように定義すると、
		\begin{equation*}\begin{split}
			\psi_\pm(x,z) = \sum_{n\in\sizen_+}(\phi_\pm\alpha_nx)z^n
			\quad\text{for all } x\in A,\; z\in\fukuso
		\end{split}\end{equation*}
		任意の$n\in\sizen$に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			(\phi_+x + \phi_-x)^n &= \frac{1}{2\pi i} \oint \frac{dz}{z^{n+1}} 
				\bigl(\psi_+(x,z)\bigr)^*\bigl(\psi_-(x,z)\bigr)^* \\
		\end{split}\end{equation*}
	\end{proposition} %prop:ベクトル空間から代数}
	\begin{proof} %{
		命題の複素積分は$z$の冪を抜き出しているだけだから、
		フォック空間$\mycal{H}$を使って証明する。$\psi_{\pm}$と$\phi_{\pm n}$
		を次のように定義し、
		\begin{equation*}\begin{split}
			\psi_\pm := \sum_{n\in\sizen_+}\phi_{\pm n}\eta_+^n
			,\quad \phi_{\pm n} := \phi_\pm\alpha_nx
			\quad\text{for all } n\in\sizen_+
		\end{split}\end{equation*}
		任意の$n\in\sizen$に対して次の式が成り立つことを
		帰納法を使って証明する。
		\begin{equation}\label{eq:証明すべき式その一}\begin{split}
			(\phi_1 + \phi_{-1})^n = \bra{n}\psi_+^*\psi_-^*\ket{0}
		\end{split}\end{equation}
		ここで、任意の$n\in\sizen$に対して$\bra{n}:=\bra{0}\eta_-^n$とする。
		$n=0,1$でこの式が成り立つことは明らかである。
		ある$N\in\sizen_+$でこの式が成り立つと仮定する。
		次の式が成り立っていれば、$n=N+1$でも式\eqref{eq:証明すべき式その一}
		が成り立っていることがわかる。
		\begin{equation}\label{eq:証明すべき式その二}\begin{split}
			\bra{N+1}\psi_+^*\psi_-^*\ket{0}
			= (\phi_1 + \phi_{-1})\bra{N}\psi_+^*\psi_-^*\ket{0}
		\end{split}\end{equation}
		任意の$n\in\sizen$に対して次の式が成り立つことを使って、
		\begin{equation}\label{eq:像の漸化式その一}\begin{split}
			\phi_{n+1} + \phi_{-(n+1)} = \sum_{p=1}^n\phi_{-p}\phi_{n+1-p}
		\end{split}\end{equation}
		$\phi_{-1}\psi_+^*\psi_-^*$を$\eta_+^p\cdots$という形になるように
		$p=N+1$まで計算\ref{note:計算の途中経過その一}すると次のようになる。
		\begin{equation*}\begin{split}
			\phi_{-1}\psi_+^*\psi_-^*
			&= \biggl(\phi_{-1} + \phi_{-2}\eta_+ +\cdots+ \phi_{-(N+1)}\eta_+^N
				\biggr)\psi_-^* \\
			&\; + \biggl(\phi_2\eta_+ + \phi_3\eta_+^2
				+\cdots+ \phi_{N+1}\eta_+^N\biggr)\psi_+^*\psi_-^*  \\
			&\; + \phi_{-(N+1)}\eta_+^N\psi_+^+\psi_-^* \\
			&\; + \sum_{n=1}^\infty \biggl(\phi_{-1}\phi_{n+N} 
				+ \phi_{-2}\phi_{n+N-1} +\cdots+ \phi_{-N}\phi_{n+1}\biggr)
				\eta_+^{n+N}\psi_+^*\psi_-^* \\
		\end{split}\end{equation*}
		この計算を用いると次の式が得られる。
		\begin{equation*}\begin{split}
			(\phi_1 + \phi_{-1})\bra{N}\psi_+^*\psi_-^*\ket{0}
			&= \bra{N}\biggl(\phi_{-1} + \phi_{-2}\eta_+
				+\cdots+ \phi_{-(N+1)}\eta_+^N\biggr)\psi_-^*\ket{0} \\
			&\; + \bra{N}\biggl(\phi_1 + \phi_2\eta_+
				+\cdots+ \phi_{N+1}\eta_+^N\biggr)\psi_-^*\ket{0} \\
			&= \bra{N+1}\psi_-^+\ket{0}
				+ \bra{N+1}\psi_+^+\psi_-^*\ket{0} \\
		\end{split}\end{equation*}
		ここで次の式が成り立つことに注意すると、
		\begin{equation*}\begin{split}
			\bra{N+1}\psi_+^*\psi_-^*\ket{0} &= \bra{N+1}\psi_-^*\ket{0}
				+ \bra{N+1}\psi_+^+\psi_-^*\ket{0} \\
			&= \bra{N+1}\psi_-^+\ket{0} + \bra{N+1}\psi_+^+\psi_-^*\ket{0} \\
		\end{split}\end{equation*}
		次の式が成り立つことがわかり、$n=N+1$でも
		式\eqref{eq:証明すべき式その一}が成り立つことが示される。
		\begin{equation*}\begin{split}
			(\phi_1 + \phi_{-1})\bra{N}\psi_+^*\psi_-^*\ket{0}
			= \bra{N+1}\psi_+^*\psi_-^*\ket{0}
		\end{split}\end{equation*}
	\end{proof} %}

	\begin{note}[計算の途中経過その一]\label{note:計算の途中経過その一} %{
	証明中で用いた計算の途中経過を書いておく。
		\begin{equation*}\begin{split}
			\phi_{-1}\psi_+^*\psi_-^*
			&= \phi_{-1}\psi_-^* + \phi_{-1}\psi_+^+\psi_-^* \\
			&= \phi_{-1}\psi_-^* + \phi_2\eta_+\psi_+^*\psi_-^*
				+ \phi_{-2}\eta_+\psi_+^*\psi_-^* + \sum_{n=2}^\infty
				\phi_{-1}\phi_n\eta_+^n \psi_+^*\psi_-^* \\
			&= \biggl(\phi_{-1} + \phi_{-2}\eta_+\biggr)\psi_-^* 
				+ \biggl(\phi_2\eta_+ + \phi_3\eta_+^2\biggr)\psi_+^*\psi_-^* 
				+ \phi_{-3}\eta_+^2\psi_+^*\psi_-^* \\
			&\; + \sum_{n=1}^\infty \biggl(
				\phi_{-1}\phi_{n+2} + \phi_{-2}\phi_{n+1}\biggr)\eta_+^{n+2}
				\psi_+^*\psi_-^* \\
			&= \cdots \\
			&= \biggl(\phi_{-1} + \phi_{-2}\eta_+ +\cdots+ \phi_{-N}\eta_+^{N-1}
				\biggr)\psi_-^* \\
			&\; + \biggl(\phi_2\eta_+ + \phi_3\eta_+^2
				+\cdots+ \phi_{N+1}\eta_+^N\biggr)\psi_+^*\psi_-^*  \\
			&\; + \phi_{-(N+1)}\eta_+^N\psi_+^*\psi_-^* \\
			&\; + \sum_{n=1}^\infty \biggl(\phi_{-1}\phi_{n+N} 
				+ \phi_{-2}\phi_{n+N-1} +\cdots+ \phi_{-N}\phi_{n+1}\biggr)
				\eta_+^{n+N}\psi_+^*\psi_-^* \\
			&= \biggl(\phi_{-1} + \phi_{-2}\eta_+ +\cdots+ \phi_{-(N+1)}\eta_+^N
				\biggr)\psi_-^* \\
			&\; + \biggl(\phi_2\eta_+ + \phi_3\eta_+^2
				+\cdots+ \phi_{N+1}\eta_+^N\biggr)\psi_+^*\psi_-^*  \\
			&\; + \phi_{-(N+1)}\eta_+^N\psi_+^+\psi_-^* \\
			&\; + \sum_{n=1}^\infty \biggl(\phi_{-1}\phi_{n+N} 
				+ \phi_{-2}\phi_{n+N-1} +\cdots+ \phi_{-N}\phi_{n+1}\biggr)
				\eta_+^{n+N}\psi_+^*\psi_-^* \\
		\end{split}\end{equation*}
	\end{note} %note:計算の途中経過その一}

	この命題の二項演算$\odot$が積の場合、命題の中で定義した$\alpha_n$は
	べき乗にCatalan数を掛けたものになる。
	\begin{equation*}\begin{array}{rcll}
		\alpha_nx &=& C_nx^{n+1} &\quad\text{for all } x\in A,\; n\in\sizen \\
		C_n &=& \frac{1}{n+1}\binom{2n}{n} &\quad\text{for all } n\in\sizen \\
	\end{array}\end{equation*}
	したがって次の命題が成り立つ。

	\begin{proposition}[代数から代数]\label{prop:代数から代数} %{
		$A$と$B$を代数とする。$\phi_\pm:A\to B$を次の性質を満たす線形写像
		とする。
		\begin{equation*}\begin{split}
			(\phi_-x)(\phi_+y) = (\phi_+ + \phi_-)(xy)
			\quad\text{for all } x,y\in A
		\end{split}\end{equation*}
		このとき、写像$\psi_\pm:A\times\fukuso\to B$を次のように定義すると、
		\begin{equation*}\begin{array}{rcll}
			\psi_\pm(x,z) &=& \sum_{n\in\sizen_+} C_n(\phi_\pm x^n)z^n
			& \quad\text{for all } x\in A,\; z\in\fukuso \\
			C_n &=& \frac{1}{n+1}\binom{2n}{n} &\quad\text{for all } n\in\sizen \\
		\end{array}\end{equation*}
		任意の$n\in\sizen$に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			(\phi_+x + \phi_-x)^n &= \frac{1}{2\pi i} \oint \frac{dz}{z^{n+1}} 
				\bigl(\psi_+(x,z)\bigr)^*\bigl(\psi_-(x,z)\bigr)^* \\
		\end{split}\end{equation*}
	\end{proposition} %prop:代数から代数}

	幾つか残っている課題を書いておく。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[Yang-Baxter] Yang-Baxter方程式の効用は代数$A$の表現$(\rho_i,V_i)$
		が与えられた時、$R$-行列$R\in A\otimes A$から次の表現のintertwiner
		$\phi:V_1\otimes V_2\to V_2\otimes V_1$を作ることができる点にある。
		\begin{equation*}\begin{split}
			\xymatrix{
				V_1\otimes V_2 \ar[r]^\phi \ar[d]^{(\rho_1\otimes\rho_2)\Delta a} 
				& V_2\otimes V_1 \ar[d]^{(\rho_1\otimes\rho_2)\Delta a} \\ 
				V_1\otimes V_2 \ar[r]^\phi & V_2\otimes V_1 \\ 
			} \quad\text{for all } a\in A
		\end{split}\end{equation*}
		$\phi$は$R$から次のようにして作られ、
		\begin{equation*}\begin{array}{rcll}
			\phi &=& \sigma_{12}\bigl((\rho_1\otimes\rho_2)R\bigr) \\
		\end{array}\end{equation*}
		$R$は次の性質を満たす$A\otimes A$の可逆な元として定義される。
		\begin{equation*}\begin{array}{rcll}
			\sigma_{12}\Delta a &=& R(\Delta a)R^{-1}
			&\quad\text{for all } a\in A \\
			(\Delta\otimes\id)R &=& R_{13}R_{23} \\
			(\id\otimes\Delta)R &=& R_{13}R_{12} \\
		\end{array}\end{equation*}
		ここで、$\sigma_{ij}$はテンソル積の$i$番目と$j$番目の成分を交換する
		作用で、$R_{ij}$は$R=\sum a_i\otimes b_j$とすると次のように定義される。
		\begin{equation*}\begin{split}
			R_{12} = \sum a_i\otimes b_i\otimes \id
			,\quad R_{23} = \sum \id\otimes a_i\otimes b_i
			,\quad R_{13} = \sum a_i\otimes \id\otimes b_i
		\end{split}\end{equation*}
		大事なことは$R$が表現$\rho_i$とは独立に定義されていることである。
		$A$の代数構造からのみ$R$-行列が定義され、それを用いると任意の表現の
		間のintertwinerを作ることができる。$R$-行列が求まらなければ絵に描いた餅
		だが、多くの代数で$R$-行列が求められている。
		Diffie-Hellmanの鍵交換プロトコルを思い出す。
		%
		\item[Lyndon単語] Lie環の量子変形からみでLyndon単語が出てくることがある
		ので、Lyndon単語とはなんぞやということを書いておく。文字$A$から生成
		される単語の集合$\W A$で、文字の位置を巡回させた違いを無視したものを
		Lyndon単語という。式で書くと$\W A$に次の同値関係を定義してその商
		$\W A/\sim$をとったものをLyndon単語（の集合）という。
		\begin{equation*}\begin{split}
			[a_1a_2\cdots a_m] \sim [a_2a_3\cdots a_ma_1]
		\end{split}\end{equation*}
		%
		\item[インデックス言語] 半整数の遷移を使うとインデックス言語を
		セルオートマトンで表現できるかもしれない。例えば、
		$x=a+\sum_{n\in\sizen_+}b^nac^nad^n$というインデックス言語は次の
		ようなセルオートマトンで表すことができる。
		\begin{equation*}\xymatrix@C=1ex{
			& (0,0) & (1/2,0) & (1,0) & (0,1) & (1/2,1) & (1,1) \\
			0 & \circ \ar[rr]^a \ar[d]^b & & \\
			1 & \circ \ar[r]^a \ar[d]^b & \circ \ar[r]^c & \circ \ar[r]^a 
			& \circ \ar[ul]_d \\
			2 & \circ \ar[r]^a \ar[d]^b & \circ \ar[r]^c & \circ \ar[r]^c 
			& \circ \ar[r]^a & \circ \ar[ul]_d \\
			3 & & & & & & \ar[ul]_d \\
		}\end{equation*}
		形式言語と３次元多様体の基本群との関係を論じている論文
		\cite{gilman1996}を思い出す。中身はさっぱりわからんが。
		%
		\item[セルオートマトン] $a$の遷移に射影
		$\pi_0:=1-\sum_{n\in\sizen_+}(\eta_n\eta_{-n}$
		が必要になる気がする。例えば、$x=a+bxxd$という文法の場合、
		射影$\pi_0$がないと、水平方向の周期を$2$とすることができない。
		%
		\item[Yang-Baxter] 命題の証明の中に可積分系での箱玉モデルとよく似た
		構造が現れている。もともとがセルオートマトンとから出発しているので
		当然といえば当然かもしれないが、正規積への描き直しがYang盤を使って
		行うことができるところなどに似た構造があるように思える。現在のところ
		妄想に過ぎないが考えてみる価値はあると思う。
		Rota-Baxter代数に関する論文\cite{aguiar2000}にしたがって、Rota-Baxter
		代数とYang-Baxter方程式との関係を書いておく。
		$A$を代数とし、線形写像$\phi_{ij}:A^{\otimes2}\to A^{\otimes3}$を
		次のように定義し、
		\begin{equation*}\begin{split}
			\phi_{12}(u\otimes v) &= u\otimes v\otimes \id \\
			\phi_{13}(u\otimes v) &= u\otimes \id\otimes v \\
			\phi_{23}(u\otimes v) &= \id\ u\otimes v \\
		\end{split}
			\quad\text{for all } u,v\in A
		\end{equation*}
		線形写像$\phi_{ij}:A^{\otimes2}\to A^{\otimes3}$を次のように定義する。
		\begin{equation*}\begin{split}
			\phi t
			= (\phi_{13}t)(\phi_{12}t) - (\phi_{12}t)(\phi_{23}t)
			+ (\phi_{23}t)(\phi_{13}t)
			\quad\text{for all } t\in A\otimes A
		\end{split}\end{equation*}
		$\phi r=0$を結合的Yang-Baxter方程式、$r\in A^{\otimes2}$をその解という。
		%
		\item[集合] 命題\ref{prop:ベクトル空間から代数}のベクトル空間$A$を集合に
		変えても同様の定理が成り立つはずである。ただし、$A$がベクトル空間
		でないと、$x\in A$に対してべき乗$x^{\otimes n}$が簡潔に表現することが
		できない。$x^{\otimes n}$の代わりに漸化式\eqref{eq:像の漸化式その一}
		によって$\phi_{\pm n}$を定義してしまえばよいかも。
		ただし、漸化式\eqref{eq:像の漸化式その一}から和$\phi_n+\phi_{-n}$を
		定めることはできるが、個々の$\phi_{\pm n}$を定めることはできない。
		この点を考えなくてはならない。
		%
		\item[命題は間違っている] $V$を複素数としたとき命題は次のように
		修正する必要がある。
		\begin{equation*}\begin{split}
			\left\{\begin{split}
				x_t &= \ket{0}(tT)^*a\ket{d:2} \\
				T &= (b\eta_{-1}^*)a(d\eta_2)^*c\eta_1\eta_{-2} \\
			\end{split}\right. \And |t| < \frac{1}{4} \\
			\implies x_t = a + tbx_tcx_td
		\end{split}\end{equation*}
		左辺の真空期待値が無条件に右辺の多項式の正級数解になるわけではない。
		多分命題は
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $V$を複素数上の代数に限定して、
			\item $V$の完備化を仮定して、
		\end{itemize} %}
		次のように修正されるべきだろう。
		\begin{equation*}\begin{split}
			\left\{\begin{split}
				x_t &= \ket{0}(tT)^*a\ket{d:2} \\
				T &= (b\eta_{-1}^*)a(d\eta_2)^*c\eta_1\eta_{-2} \\
			\end{split}\right. \implies \exists\; t\in\fukuso \text{ such that }
			x_t = a + tbx_tcx_td
		\end{split}\end{equation*}
		$\implies$ $V$上の形式級数環$V[[t]]$を考えて$V[t]$から$V$への写像を
		文法によって定義する。例えば、$V[[t]]$から$V$への写像を次のように
		定義する。
		\begin{equation*}\begin{split}
			x_t = a + bx_tcx_td \quad\text{where }a,b,c,d\in 
		\end{split}\end{equation*}
		完備化をしないと形式級数環$V[[t]]$は定義できないかもしれないが、
		級数が収束することを気にすることなく議論を進めることができるのでは
		ないだろうか。
		%
		\item[サブセット構成法] 代数方程式$x=a+bxcxd$を一次近似して
		$y=a+b(\xi_{-1}a\xi_1)c(\xi_{-2}a\xi_2)d$という代数方程式を考える。
		ここで、$\xi_{\pm i}$は$V$の元と非可換な文字とする。
		%
		\item[変形] 対称的な形にすると次のようになり、
		\begin{equation*}\begin{split}
			T_+f = fd(d\eta_2)^*\eta_1,\quad 
			T_-f = \eta_{-2}(b\eta_{-1})^*bf
		\end{split}\end{equation*}
		次の式を満たす。
		\begin{equation*}\begin{split}
			(T_-f)c(T_+g) = (T_+ + T_-)(bfcgd)
		\end{split}\end{equation*}
		そして、$T_\pm$の中のKleeneスターを$n$で打ち切ったものを$[T_\pm]_n$
		とすると、
		\begin{equation*}\begin{split}
			[T_+]_nf = fd\frac{1 - (d\eta_2)^{n+1}}{1 - d\eta_2}\eta_1,\quad 
			[T_-]_nf = \eta_{-2}\frac{1 - (b\eta_{-1})^{n+1}}{1 - b\eta_{-1}}bf
		\end{split}\end{equation*}
		次の式を満たす。
		\begin{equation*}\begin{split}
			([T_-]_{m+1}f)c([T_+]_{n+1}g) &= ([T_-]_m + [T_+]_n)(bfcgd) \\
			([T_-]_{m+1}f)c([T_+]_0g) &= [T_-]_m(bfcgd) \\
			([T_-]_0f)c([T_+]_{n+1}g) &= [T_+]_n(bfcgd) \\
			([T_-]_0f)c([T_+]_0g) &= 0 \\
		\end{split}\end{equation*}
		Kleeneスターの打ち切り$n$を変形パラメーターとして$T_\pm$から元の
		線形な式を得られないものだろうか？
		%
		\item[組み合わせの数] 二次式ですべての係数が$1$の場合（$x=1+x^2$）、
		摂動計算はCatalan数を与えるだけである。Catalan数のような組み合わせの
		数に興味がない場合は、$x=1+x^2$の効果を抜き出してしまいたい。
		\begin{equation*}\begin{array}{rcll}
			x &=& a + bxcxd,&\quad x = \sum_{n\in\sizen} x_n \\
			k &=& 1 + k^2,&\quad k = \sum_{n\in\sizen} k_n \\
		\end{array}\end{equation*}
		とした場合、$\sum_{n\in\sizen}x_n/k_n$はどのような代数方程式を満たす
		だろうか？
		%
		\item[カウンターオートマトン] 二次元セルオートマトン
		\eqref{eq:二次式のセルオートマトンその一}
		\eqref{eq:二次式のセルオートマトンその二}
		\eqref{eq:セルオートマトンでの真空期待値}
		をプログラムで実装すると、二つのカウンターを持ったカウンターオートマトン
		として実装することができる（$\mycal{H}\otimes\mycal{H}$）。
		一方、スタックを用いたオートマトン\eqref{eq:二次式の正級数解その一}
		をプログラムで実装すると、二つの文字を要素として持つ一つのスタックとして
		実装することができる（$\mycal{H}_2$）。このことを数学的にみたものが、
		$1:1$の代数射\eqref{eq:一対一の代数射その一}とその表現空間の$1:1$対応
		になっている。そこで問題：
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item 二次式の場合と同様に、多項式$x=a+bx^nd$$n$に対して、
			文字のカウンターオートマトンと$n$文字を要素とするスタックオートマトン
			との対応をつけることは可能か？
		\end{itemize} %}
		%
		\item[空遷移] パーシングの話での空遷移を一般の代数の話に持って行くと
		代数の中心となるだろう。したがって、係数$a,b,c,d$に代数の中心が含まれて
		いる場合を考えればよいだろう。$a,b,c$がそれぞれ$1$の場合の
		二次元セルオートマトンを考えれば次のようになるだろう。
		\begin{equation*}\begin{array}{ccc}
			b = 1 & d = 1 & c = 1 \\
			\xymatrix@R=4ex@C=4ex{
				\circ \ar[r]^a & \circ \ar[d]^c \\
				& \circ \ar[r]^a & \circ \ar[d]^c\ar[ul]_d \\
				& & & \ar[ul]_d \\
			} & \xymatrix@R=4ex@C=4ex{
				\circ \ar[d]^b \ar[r]^a & \circ \\
				\circ \ar[r]^a \ar[d]^b & \circ \ar[ul]_c \\
				& \ar[ul]_c \\
			} & \xymatrix@R=4ex@C=4ex{
				\circ \ar[d]^b \ar[r]^a & \circ \\
				\circ \ar[r]^a \ar[d]^b & \circ \ar[r]^a \ar[drr]^b 
					& \circ \ar[ul]_d \\
				& & \ar[ul]_d & & & \ar[ulll]_d \\
			}
		\end{array}\end{equation*}
		サブセット構成法を用いてこのセルオートマトンもしくはスタックオートマトン
		を構成できないだろうか？
		%
		\item[摂動] Dyck言語$x_t=a+tbx_t^2d$の摂動展開
		$x_t=\sum_{n\in\sizen}t^nx_n$は$x_{n+1}=\sum_{p=0}^nbx_{n-p}x_pd$
		という漸化式を満たす。摂動係数$x_n$を自然数から半代数$V$への写像の像
		と思うと、自然数の余積
		$m_\sizen^\tran\ket{n}=\sum_{p=0}^n\ket{n-p}\otimes\ket{p}$と
		インクリメント$\eta_+\ket{n}=\ket{n+1}$を用いて、漸化式は
		$x\eta_+=\beta(x\otimes x)m_\sizen^\tran$と書くことができる。
		ここで、$\beta(f\otimes g)=bfgd$とする。可換図で書くと次のように
		表される。
		\begin{equation*}\xymatrix@C=6em{
			\sum_{p=0}^n \ket{n-p}\otimes\ket{p} \ar@{|->}[d]^{x\otimes x}
				& \ket{n} \ar@{|->}[l]_{m_\sizen^\tran} \ar@{|->}[d]^{x\eta_+} \\
			\sum_{p=0}^n x_{n-p}\otimes x_{p} \ar@{|->}[r]^\beta & x_{n+1} \\
		}\end{equation*}
		%
		\item[優先順位] 代数方程式$x=a+xcx$の正級数解はCatalan数$C_n$を用いて
		$x=\sum_{n\in\sizen}C_n(ac)^na$と書ける。Catalan数が出てくる起源は
		二項演算$f\odot g=fcg$を適用していく方法の和にある。例えば、次のように
		なっている。
		\begin{equation*}\begin{split}
			C_1(ac)a &= a\odot a \\
			C_2(ac)^2a &= (a\odot a)\odot a + a\odot(a\odot a) \\
			C_3(ac)^3a &= ((a\odot a)\odot a)\odot a 
				+ (a\odot(a\odot a))\odot a \\
			&\; + (a\odot a)\odot(a\odot a) \\
			&\; + a\odot(a\odot(a\odot a))
				+ a\odot((a\odot a)\odot a) \\
		\end{split}\end{equation*}
		ここで、二項演算$\odot$を$(a\odot a)\odot a=0$と変更すると、
		次のように変更される。
		\begin{equation*}\begin{split}
			(ac)a &= a\odot a \\
			(ac)^2a &= a\odot(a\odot a) \\
			(ac)^3a &= a\odot(a\odot(a\odot a)) \\
		\end{split}\end{equation*}
		パーシングの場面で考えると、パース結果の木構造が次のように絞られることに
		対応する。
		\begin{equation*}\begin{split}
			\xymatrix@R=2ex@C=2ex{
				& & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] & c & a \\
				a & c & a
			} + \xymatrix@R=2ex@C=2ex{
				& & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& a & c & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& & a & c & a
			} \xmapsto{(aca)ca=0} \xymatrix@R=2ex@C=2ex{
				& & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& a & c & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& & a & c & a
			}
		\end{split}\end{equation*}
		確率$\mu_1+\mu_2=1,\;\nu_1+\cdots+\nu_5=1$を導入して考えると
		次のようになるだろう。
		\begin{equation*}\begin{split}
			(ac)a &= a\odot a \\
			(ac)^2a &= \mu_1(a\odot a)\odot a + \mu_2a\odot(a\odot a) \\
			(ac)^3a &= \nu_1((a\odot a)\odot a)\odot a 
				+ \nu_2(a\odot(a\odot a))\odot a \\
			&\; + \nu_3(a\odot a)\odot(a\odot a) \\
			&\; + \nu_4{2}a\odot(a\odot(a\odot a))
				+ \nu_5a\odot((a\odot a)\odot a) \\
		\end{split}\end{equation*}
		確率変数$\mu_i,\nu_i,\dots$を決める都合の良い方法はないだろうか？
		一つの方法として、$x=a+xcx$をパースした結果を二分木としてみた場合、
		左の降りていくときは$\mu_1$、右の降りていくときは$\mu_2$とすると、
		次のようになる。
		\begin{equation*}\begin{split}
			(ac)a &= a\odot a \\
			(ac)^2a &= \mu_1(a\odot a)\odot a + \mu_2a\odot(a\odot a) \\
			(ac)^3a &= (\mu_1^3)((a\odot a)\odot a)\odot a 
				+ (\mu_1^2\mu_2)(a\odot(a\odot a))\odot a \\
			&\; + 2(\mu_1\mu_2)(a\odot a)\odot(a\odot a) \\
			&\; + (\mu_2^3){2}a\odot(a\odot(a\odot a))
				+ (\mu_1\mu_2^2)a\odot((a\odot a)\odot a) \\
		\end{split}\end{equation*}
		%
		\item[一般化] 命題を一般化する方法は幾つかあるだろうが、その一つとして、
		次のように写像$\phi: R\W A[x]\to R\W A$を定義して、
		\begin{equation*}\begin{split}
			\phi: f \mapsto x \text{ such that } x = 1 + fx
		\end{split}\end{equation*}
		$\phi$によって$R\W A[x]$の代数構造がどのように移されるかを調べる方法
		があると思う。
		\begin{equation*}\begin{split}
			(\phi f)\times (\phi g) &\mapsto \phi(f + g) \\
			(\phi f)\times (\phi g) &\mapsto \phi(fg) \\
		\end{split}\end{equation*}
		%
		\item[完備化] 命題の証明の中で無限長の文字列が$0$になるということを
		使いまくっている。このことを正当化するためには、$R\W A$において完備化
		をしておく必要がある。完備化は一意でないために、形式級数を扱う場合、
		完備化の方法によって計算結果が変わってくる。したがって、どのように完備化
		したかを明示する必要がある。
		%
		\item[冪等半体] パーシングの場合、係数$R$については$0$かそれ以外かにしか
		興味がない。したがって、$R$を冪等半体として取り扱うことになる。
		そして、$R$が冪等半体の場合には単に係数の処理が簡単になるというだけで
		なく、フォック空間が不必要になることがある。例えば、
		代数方程式$x=a+xcx$は$R$が一般の半体の場合には次のようになるが、
		\begin{equation*}\begin{split}
			x &= a + ac\Braket{\eta_{-1}^*\biggl(ac\bigl(
				\eta_2^*\eta_1+\eta_{-2}\eta_{-1}^*\bigr)\biggr)^*\eta_2^*}a \\
		\end{split}\end{equation*}
		$R$が冪等半体の場合には次のようになる。
		\begin{equation*}\begin{split}
			x &= (ac)^*a
		\end{split}\end{equation*}
		$R$が一般の半体の場合にはCatalan数$C_n$を与えるために真空期待値
		\begin{equation*}\begin{split}
			C_{n+1} = \Braket{\eta_{-1}^*\biggl(ac\bigl(
				\eta_2^*\eta_1+\eta_{-2}\eta_{-1}^*\bigr)\biggr)^n\eta_2^*}
		\end{split}\end{equation*}
		の計算が必要になるが、$R$が冪等半体の場合にはこの計算が不必要になる。
		パーシングに適用した場合、真空期待値の計算は実行時におけるスタックの
		プッシュ/ポップ操作に対応するので、真空期待値の計算はなるべく避けたい。
		そのために、冪等半体の場合にのみ成り立つ特殊事情について考察する必要
		がある。（Max-Plus？）
		%
		\item[空遷移] 二次式$x=a+bxcxd$において係数$a,b,c,d\in R\W A$が
		単位元（空の文字列）を含む場合、状態遷移が非決定的になる。
		決定的な状態遷移を得るためには、単位元の部分を消去する必要がある。
		例えば、$b=d=1$とすると、摂動の漸化式は次のようになり、
		\begin{equation*}\begin{split}
			\left\{\begin{split}
				x_t &= a + tx_tcx_t \\
				x_t &= \sum_{n\in\sizen}t^nx_n
			\end{split}\right.  \implies \left\{\begin{split}
				x_0 &= a \\
				x_{n+1} &= \sum_{p=0}^n x_{n-p}cx_p
			\end{split}\right.
		\end{split}\end{equation*}
		$C_n\in R$として$x_n=C_n(ac)^na$と仮定すると、漸化式より、
		\begin{equation*}\begin{split}
			x_{n+1} = C_{n+1}(ac)^{n+1}a,\quad C_{n+1} = \sum_{p=0}^n C_{n-p}C_p
		\end{split}\end{equation*}
		となり、$C_n$は頂点数が$n$の平面二分木の数となることがわかり、
		$C_n$は次の$R$上の代数式の摂動係数として与えられる。
		\begin{equation*}\begin{split}
			x = 1 + tx^2 &\iff x = \frac{1\pm\sqrt{1 - 4t}}{2t}
			\implies \frac{1 - \sqrt{1 - 4t}}{2t} = \sum_{n\in\sizen}t^nC_n \\
			&\implies C_n = \frac{1}{n+1}\binom{2n}{n}
				\quad\text{for all } n\in\sizen \\
			&\quad\because\quad (1 - 4t)^{\frac{1}{2}} 
			= 1 - 2t\sum_{n\in\sizen} \frac{t^n}{n+1}\binom{2n}{n} \\
		\end{split}\end{equation*}
		$\set{C_n\in\sizen\bou n\in\sizen}$はCatalan数と呼ばれる数列である。
		代数方程式を真空期待値で表すと次のようになるから、
		\begin{equation*}\begin{split}
			x &= \Braket{\bigl(ac\eta_{-1}^*\eta_2^*\eta_1\eta_{-2}
				\bigr)^*\eta_2^*}a \\
			&= a + ac\Braket{\eta_{-1}^*\biggl(ac\bigl(
				\eta_2^*\eta_1+\eta_{-2}\eta_{-1}^*\bigr)\biggr)^*\eta_2^*}a \\
		\end{split}\end{equation*}
		Catalan数は次のように書けることがわかる。\footnote{
			Catalan経路の足し上げをフォック空間で表すと、Catalan数は一組の
			生成消滅演算子だけで次のように書くこともできる。
			\begin{equation*}\begin{split}
				C_{n+1} = \Braket{\bigl(\eta_+ + \eta_-\bigr)^{2n}}
				\quad\text{for all } n\in\sizen
			\end{split}\end{equation*}
			したがって、式\eqref{eq:Catalan数の二組表示}はある変換でこの式に
			なることが予想される。
		}
		\begin{equation}\label{eq:Catalan数の二組表示}\begin{split}
			C_{n+1} = \Braket{\eta_{-1}^*\bigl(
				\eta_2^*\eta_1 + \eta_{-2}\eta_{-1}^*\bigr)^n\eta_2^*}
				\quad\text{for all } n\in\sizen
		\end{split}\end{equation}
	\end{description} %}
%s1:二次方程式の正級数解}
\section{N次方程式の正級数解}\label{s1:N次方程式の正級数解} %{
	前節の二次方程式の正級数解の求め方を拡張して$N$次方程式の正級数解を
	求めることを考える。次の$N$次方程式を考える。
	\begin{equation}\label{eq:求めるN次式}\begin{split}
		x = a + bxc_1x\cdots c_{N-1}xd
		\quad\text{where } a,b,d,c_1,\dots,c_{N-1}\in V
	\end{split}\end{equation}
	セルオートマトン\eqref{eq:二次式のセルオートマトンその一}を拡張すること
	からスタートする。例えば、$N=3$の場合は次のようになる。
	\begin{equation*}\xymatrix@C=2ex{
		\sizen & 0 & 0 & 1 & 1 & 2 & 2 & 3 & 3 & 4 & 4 & 5 & 5 \\
		\sizen_2 & + & - & + & - & + & - & + & - & + & - & + & - \\
		0 & \circ \ar[r]^a \ar[d]^b & \circ & \circ \ar[r]^a  \ar[drrrr]^b 
			& \circ & \circ \ar[r]^a & \circ & \circ \ar[r]^a & \circ
			& \circ \ar[r]^a & \circ & \circ \ar[r]^a & \circ  \\
		1 & \circ \ar[r]^a \ar[d]^b & \circ \ar[r]^{c_1}
			& \circ \ar[r]^a \ar[drrrr]^b & \circ \ar[r]^{c_2} 
			& \circ \ar[r]^a & \circ \ar[ullll]_d 
			%
			& \circ \ar[r]^a & \circ \ar[r]^{c_1}
			& \circ \ar[r]^a & \circ \ar[r]^{c_2} 
			& \circ \ar[r]^a & \circ \ar[ullllllll]_d \\
			%
		2 & \circ \ar[r]^a & \circ \ar[r]^{c_1}
			& \circ \ar[r]^a & \circ \ar[r]^{c_2} 
			& \circ \ar[r]^a & \circ \ar[ullll]_d 
			%
			& \circ \ar[r]^a & \circ \ar[r]^{c_1}
			& \circ \ar[r]^a & \circ \ar[r]^{c_2} 
			& \circ \ar[r]^a & \circ \ar[ullllllll]_d \\
			%
	}\end{equation*}
	$(\sizen_2,\sizen,\sizen)$の最初の二つをセルオートマトンでの水平軸、
	最後の自然数を垂直軸として書くと、状態遷移は次のようになる。
	\begin{equation*}\begin{array}{rcrcrl}
		a &:& (+,m,n) &\mapsto& (-,m,n) \\
		c_i &:& (-,Nm+i-1,n+1) &\mapsto& (+,Nm+i,n+1)
			& \quad\text{for all } i=1,\dots,N-1 \\
		b &:& (+,m,n) &\mapsto& (+,Nm,n+1) \\
		d &:& (-,Nm + N-1,n+1) &\mapsto& (-,m,n) \\
	\end{array}\end{equation*}
	これを行列の形で書くと次のようになる。
	\begin{equation}\label{eq:N次代数方程式のセルオートマトン}\begin{split}
		x = m_V\bra{0}\otimes\bra{0}\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b\beta & a \\
			c_1\gamma_1 +\cdots+ c_{N-1}\gamma_{N-1} & d\delta \\
		\end{pmatrix}\begin{pmatrix}
			1 \\ 0
		\end{pmatrix}\ket{0}\otimes\ket{0}
	\end{split}\end{equation}
	ここで、$m_V$は$V$の積とし、$\beta,\delta$と$\gamma_i,\;i=1,\dots,N$を
	次のように定義する。
	\begin{equation*}\begin{array}{rclrcll}
		\gamma_i &=& \eta_-^{i-1}C\eta_-^i\otimes\eta_+\eta_-,
			&\quad C &=& \sum_{m\in\sizen}\ket{Nm}\bra{Nm} \\
		\beta &=& B_-\otimes\eta_-,
			&\quad B_- &=& \sum_{m\in\sizen}\ket{m}\bra{Nm} \\
		\delta &=& \eta_+^{N-1}B_+\otimes\eta_+,
			&\quad B_+ &=& \sum_{m\in\sizen}\ket{Nm}\bra{m} \\
	\end{array}\end{equation*}
	ここで、$\zeta_{\pm i},\;i=1,\dots,N$を次のように定義すると、
	\begin{equation*}\begin{split}
		\zeta_i := \eta_+^{i-1}\otimes\eta_+,\quad \zeta_{-i} := \zeta_i^\tran
	\end{split}\end{equation*}
	$\beta,\delta,\gamma_i$はそれぞれ次のように書ける。
	\begin{equation*}\begin{array}{rcll}
		\beta = \zeta_{-1},\quad \delta = \zeta_N,\quad
		\gamma_i &= \zeta_i\zeta_{-(i+1)} \quad\text{for all } i = 1,\dots,N-1
	\end{array}\end{equation*}
	そして、前節の議論と同様にして$\set{\zeta_{\pm i}\bou i=1,\dots,N}$から
	生成される代数と$\mycal{H}_N$が代数同型になることが示され、
	セルオートマトンによる正級数解\eqref{eq:N次代数方程式のセルオートマトン}
	は$\mycal{H}_N$による次の式に等しくなることがわかる。
	\begin{equation}\label{eq:N次式の正級数解その一}\begin{split}
		x = \bra{0}\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b\eta_{-1} & a \\
			c_1\eta_1\eta_{-2} +\cdots+ c_{N-1}\eta_{N-1}\eta_N & d\eta_{-N} \\
		\end{pmatrix}\begin{pmatrix}
			1 \\ 0
		\end{pmatrix}\ket{0}
	\end{split}\end{equation}
	この式が代数方程式$x=a+bc_1x\cdots c_{N-1}xd$の正級数解を与えることを
	代数的に証明しておく。

	\begin{proposition}[N次式の正級数解]\label{prop:N次式の正級数解} %{
		任意の$2$以上の自然数$N$に対して$\mycal{H}_N$の真空期待値
		\eqref{eq:N次式の正級数解その一}は代数方程式\eqref{eq:求めるN次式}の
		正級数解となる。
		\begin{equation*}\begin{split}
			x = \bra{0}\begin{pmatrix}
				1 & 0
			\end{pmatrix}\begin{pmatrix}
				b\eta_{-1} & a \\
				c_1\eta_1\eta_{-2} +\cdots+ c_{N-1}\eta_{N-1}\eta_N & d\eta_{-N} \\
			\end{pmatrix}^*\begin{pmatrix}
				0 \\ 1
			\end{pmatrix}\ket{0} \\
			\implies x = a + bxc_1x\cdots c_{N-1}xd
		\end{split}\end{equation*}
	\end{proposition} %prop:N次式の正級数解}
	\begin{proof} %{
		二次方程式の場合と同様にして証明する。命題の代数方程式の正級数解を
		$x=\sum_{n\in\sizen}x_n$とすると、各級数は次の漸化式を満たす。
		\begin{equation*}\begin{split}
			x_0 = a,\quad 
			x_{n+1} = \sum_{p_1+\cdots+p_N=n} 
				bx_{p_1}c_1x_{p_2}\cdots c_{N-1}x_{p_N}d
				\quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		ここで、$\sum_{p_1+\cdots+p_N=n}$は
		$\sum_{p_1,\dots,p_N\in\sizen}\jump{p_1+\cdots+p_N=n}$を略記したもの
		とする。
		二次元行列の対角成分について
		Kleeneスターを展開すると次の式が得られる。
		\begin{equation*}\begin{split}
			x = \braket{0|X},\quad
			\ket{X} := T^*a\ket{d:2},\quad
			T := (b\eta_{-1}^*)a(d\eta_N)^*\gamma \\
			\gamma := c_1\eta_1\eta_{-2} +\cdots+ c_{N-1}\eta_{N-1}\eta_{-N}
		\end{split}\end{equation*}

		\begin{todo}[この先]\label{todo:この先} %{
			生き残るのは$\bra{0}T^{n(N-1)}a\ket{d:2}$という$T^{N-1}$のべき乗の
			項だけになることを示し、$T^{N-1}$のKleeneスターを正規積の形に
			書き直す。上手く行けば正規積の形を求めることができる。
		\end{todo} %todo:この先}
		$T_+$と$T_{-i},\;i=1,\dots,N-1$を、任意の$f\in V$に対して次のように
		おくと、
		\begin{equation*}\begin{array}{rclcl}
			T_+f &:=& (d\eta_2)^*\gamma &=& f(d\eta_N)^*\gamma \\
			T_{-i}f &:=& (b\eta_{-1})^*\gamma^i 
				&=& (b\eta_{-1})^*bfc_1\cdots c_i\eta_{-(i+1)} \\
		\end{array}\end{equation*}
		$T=(T_++T_{-1})a$と書くことができる。
	\end{proof} %}
	\begin{note}[memo]\label{note:memo} %{
		lets look at $\gamma$. $\gamma^n$ is the following form:
		\begin{equation*}\begin{split}
			\gamma^n = \sum_{i=1}^{N-n} c_i\cdots c_{i+n} \eta_i\eta_{-(i+n)}
			\quad\text{for all } n=1,\dots,N-1
		\end{split}\end{equation*}
		, and $\gamma^N=0$ implies $\gamma^m\gamma^n=\jump{m+n<N}\gamma^{m+n}$.
		actions of $\gamma$ to $\eta_{\pm m}$ are the followings
		for all $1\le m,n< N$:
		\begin{equation*}\begin{split}
			\eta_{-m}\gamma^n &= \jump{m+n\le N} c_1\cdots c_n\eta_{-(m+n)} \\
			\gamma^n\eta_m &= \jump{n+1\le m} c_1\cdots c_n\eta_{m-n} \\
		\end{split}\end{equation*}
		. these actions are showing the following correspondance:
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $\gamma$ is an annihilation operator.
			\item $\eta_1$ is a vaccume and $\eta_{-1}$ is its dual.
			\item $\eta_i,\;i=2,\dots,N-1$ are exicted states.
		\end{itemize} %}
		.
	\end{note} %note:memo}
%s1:N次方程式の摂動}
	%
}\endgroup %}
