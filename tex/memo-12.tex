\begingroup %{
	\newcommand{\W}{\mycal{W}}
	\newcommand{\T}{\mycal{T}}
	\newcommand{\End}{\myop{End}}
	\newcommand{\Map}{\myop{Map}}
	\newcommand{\Lin}{\mathcal{L}}
	\newcommand{\Hol}{\mathcal{H}}
	\newcommand{\Aut}{\myop{Aut}}
	\newcommand{\Mat}{\myop{Mat}}
	%
	\newcommand{\id}{\myop{id}}
	\newcommand{\tran}{\mathbf{t}}
	\newcommand{\dfn}{\,\myop{def}\,}
	\newcommand{\xiff}[2][]{\xLongleftrightarrow[#1]{#2}}
	\newcommand{\tr}{\myop{tr}}
	%
	\newcommand{\mvec}[2]{\begin{matrix}{#1}\\{#2}\end{matrix}}
	\newcommand{\bvec}[2]{\begin{bmatrix}{#1}\\{#2}\end{bmatrix}}
	\newcommand{\what}{\widehat}
	\newcommand{\even}{\myop{even}}
	\newcommand{\lieso}{\myop{so}}
	\newcommand{\frk}[1]{\ensuremath{\mathfrak{#1}}}
	\newcommand{\ad}{\myop{ad}}
	\newcommand{\Ad}{\myop{Ad}}
	\newcommand{\Cn}{\myop{Cn}}
	%
	{\setlength\arraycolsep{2pt}
	%
\section{Lie代数}\label{s1:Lie代数} %{
\subsubsection{正規部分群}\label{s3:正規部分群} %{
	$G$を群とする。任意の$g\in G$に対して写像$g-g^{-1}:G\to G$を$g$による
	共役という。
	任意の$G$の元に対する共役が不変になる$G$の部分群を正規部分群という。
	\begin{equation*}\begin{split}
		\text{正規部分群}\; H\subseteq G
		\xiff{\dfn} ghg^{-1}\in H \quad\text{for all } g\in G,\; h\in H
	\end{split}\end{equation*}
	単位元だけからなる部分群$\mybf{1}$と$G$自身は常に正規部分群になる。
	したがって、$\mybf{1}$と$G$自身を$G$の自明な正規部分群という。
	また、任意の$G$の元と可換になる部分群を中心部分群という。
	\begin{equation*}\begin{split}
		\text{中心部分群}\; H\subseteq G
		\xiff{\dfn} ghg^{-1}=h \quad\text{for all } g\in G,\; h\in H
	\end{split}\end{equation*}
	部分群$\mybf{1}$は常に中心部分群になる。したがって、$\mybf{1}$を$G$の
	自明な中心部分群という。定義から、中心部分群は常に正規部分群となる。
	\begin{equation*}\begin{split}
		\text{中心部分群} \implies \text{正規部分群}
	\end{split}\end{equation*}

	\begin{proposition}[部分群]\label{prop:部分群} %{
		$G$を群、$H$を空でない$G$の部分集合とする。このとき、次の式が成り立つ。
		\begin{equation*}\begin{split}
			\text{$H$が部分群}
			\iff ab^{-1}\in H \quad\text{for all } a,b\in H
		\end{split}\end{equation*}
	\end{proposition} %prop:部分群}
	\begin{proof} %{
		次の式は明らかだから、
		\begin{equation*}\begin{split}
			\text{$H$が部分群}
			\implies ab^{-1}\in H \quad\text{for all } a,b\in H
		\end{split}\end{equation*}
		次の式を証明する。
		\begin{equation*}\begin{split}
			\text{$H$が部分群}
			\Leftarrow ab^{-1}\in H \quad\text{for all } a,b\in H
		\end{split}\end{equation*}
		\begin{description}\setlength{\itemsep}{-1mm} %{
			\item[単位元] 任意の$a\in H$に対して、命題の仮定より、
			$1=aa^{-1}\in H$が成り立つから、$1\in H$となることがわかる。
			\item[逆元] 任意の$a\in H$に対して、$1\in H$だから、
			命題の仮定より、$a^{-1}=1a^{-1}\in H$が成り立ち、
			$a^{-1}\in H$となることがわかる。
			\item[積] 任意の$a,b\in H$に対して、$b^{-1}\in H$だから、
			命題の仮定より、$ab=a(b^{-1})^{-1}\in H$が成り立ち、
			$ab\in H$となることがわかる。
		\end{description} %}
		したがって、命題が成り立つことがわかる。
	\end{proof} %}

	\begin{proposition}[部分群の共通集合]\label{prop:部分群の共通集合} %{
		$G$を群、$H_1$と$H_2$を$G$の部分群とする。
		共通集合$H_1\cap H_2$もまた部分群となる。
	\end{proposition} %prop:部分群の共通集合}
	\begin{proof} %{
		$H_1\cap H_2$は単位元を含むので空集合ではない。
		また、$H_1$と$H_2$が部分群だから、任意の$a,b\in H_1\cap H_2$に対して、
		$ab^{-1}\in H_1$かつ$ab^{-1}\in H_2$となる。
		したがって、$ab^{-1}\in H_1\cap H_2$となり、命題\ref{prop:部分群}から
		$H_1\cap H_2$が部分群となることがわかる。
	\end{proof} %}

	\begin{proposition}[共役は自己同型]\label{prop:共役は自己同型} %{
		$G$を群とする。任意の$g\in G$に対する共役は$G$の自己同型写像となる。
		\begin{equation*}\begin{split}
			gGg^{-1} = G
		\end{split}\end{equation*}
	\end{proposition} %prop:共役は自己同型}
	\begin{proof} %{
		共役が群準同型であることは明らかである。また、任意の$h_1,h_2\in G$に
		対して次の式が成り立ち、$1:1$となることもわかる。
		\begin{equation*}\begin{split}
			gh_1g^{-1} = gh_2g^{-1}
			\implies h_1 = h_2
		\end{split}\end{equation*}
	\end{proof} %}

	\begin{proposition}[共役部分群の共通集合]\label{prop:共役部分群の共通集合} %{
		$G$を群、$H$を$G$の部分群とする。$H$の共役部分群の共通集合は
		正規部分群となる。
		\begin{equation*}\begin{split}
			\text{部分群 } H \implies \text{ 正規部分群 } \cap_{g\in G} gHg^{-1}
		\end{split}\end{equation*}
	\end{proposition} %prop:共役部分群の共通集合}
	\begin{proof} %{
		部分集合集合$N:=\cap_{g\in G} gHg^{-1}$とおくと、
		命題\ref{prop:部分群の共通集合}より、$N$が部分群となることがわかる。
		任意の$a\in N$に対して、ある$h\in H$と$g\in G$が存在して、$a=ghg^{-1}$
		と書けるから、任意の$x\in G$に対して、$xax^{-1}=(xg)h(xg)^{-1}\in N$
		となり、$N$が正規部分群となることがわかる。
	\end{proof} %}
%s3:正規部分群}
\subsubsection{単純群と半単純群}\label{s3:単純群と半単純群} %{
	群$G$の正規部分群が自明な正規部分群のみになるとき、$G$を単純群という。
	\begin{equation*}\begin{split}
		\text{単純群}\; G
		\xiff{\dfn} \text{$G$の正規部分群が$\mybf{1}$と$G$だけ}
	\end{split}\end{equation*}
	Lie群$G$の場合、$G$の中心部分群が自明な中心部分群のみになるとき、
	$G$を半単純群ということもある。
	\begin{equation*}\begin{split}
		\text{半単純群}\; G
		\xiff{\dfn} \text{$G$の中心部分群が$\mybf{1}$だけ}
	\end{split}\end{equation*}
	この場合、単純群は常に半単純群となる。
	\begin{equation*}\begin{split}
		\text{単純群} \implies \text{半単純群}
	\end{split}\end{equation*}
	半単純群という言葉は状況によって定義が異なるようである。
	Lie群の場合には同値な定義がいくつかあって、そのどれを用いるかという
	違いしかないが、一般の群に対して定義されている言葉ではないようである。
%s3:単純群と半単純群}
\subsubsection{指数写像}\label{s3:指数写像} %{
	ここでは、線形群$GL_n(\fukuso)$の部分群となるLie群$G$を考える。
	この場合は、安直に自然対数の底を使って指数写像が定義できる。
	\begin{equation*}\begin{split}
		g\approx1\in G\subseteq GL_n(\fukuso) \\
		\implies \text{ exists matrix } 
		X\approx0\in gl_n(\fukuso) \text{ such that } g = e^X
	\end{split}\end{equation*}
	一般には、群と代数との対応は局所的になっている。通常は、群の原点$1$
	と代数の原点$0$近傍で対応させる。

	\begin{example}[sl(2)]\label{eg:sl(2)の指数写像} %{
		$K$を標数$0$の体として、$sl_2$を次のように定義する。
		\begin{equation*}\begin{split}
			sl_2 := \set{X\in\Mat_2(K)\bou \tr X = 0}
		\end{split}\end{equation*}
		$sl_2$の基底$\set{H,L_\pm}$は次のようにとれ、
		\begin{equation*}\begin{split}
			L_+ = \begin{pmatrix}
				0 & 1 \\ 0 & 0
			\end{pmatrix},\quad L_- = \begin{pmatrix}
				0 & 0 \\ 1 & 0
			\end{pmatrix},\quad H = \begin{pmatrix}
				1 & 0 \\ 0 & -1
			\end{pmatrix}
		\end{split}\end{equation*}
		次の交換関係を満たす。
		\begin{equation*}\begin{split}
			[L_+,L_-] = H,\quad [H,L_\pm] = \pm 2L_\pm
		\end{split}\end{equation*}
		この基底系を使うと$sl_2$は次のように書ける。
		\begin{equation}\label{eq:sl2の座標系}\begin{split}
			sl_2 = \Set{\begin{pmatrix}
				w & z_+ \\ z_- & - w
			\end{pmatrix}\bou z_\pm,w\in\fukuso}
		\end{split}\end{equation}
		この座標系を使って指数写像を計算してみると次のようになる。
		\begin{equation*}\begin{split}
			& X := W + Z\sigma,\quad W := \bvec{w}{-w},\quad Z := \bvec{z_+}{z_-}
			,\quad \sigma := \begin{pmatrix}
				0 & 1 \\ 1 & 0
			\end{pmatrix} \\
			&\implies X^2 = W^2 + ZZ^\sigma + (W + W^\sigma)Z\sigma
				= w^2 + z_+z_- \\
			&\implies \begin{array}{rcll}
				e^X &=& \sum_{n\in\sizen}\left(
					\cfrac{x^n}{(2n)!} + \cfrac{x^n}{(2n+1)!}X\right)
					& \quad\text{where } x := w^2 + z_+z_- \\
				&=& (\cosh t) + \cfrac{(\sinh t)}{t}X
					& \quad\text{where } t := \pm\sqrt{w^2 + z_+z_-}
			\end{array}
		\end{split}\end{equation*}
		$t$は平方根の正をとっても負をとっても右辺は同じ値を与え、
		$t=0$の極限では右辺は$1+X$となる。
		\begin{equation}\label{eq:sl2の指数写像}\begin{split}
			e^X = (\cosh t) + \cfrac{(\sinh t)}{t}X \quad\text{where }
			X = \begin{pmatrix}
				w & z_+ \\ z_- & - w
			\end{pmatrix} \\ t = \sqrt{w^2 + z_+z_-}
		\end{split}\end{equation}
	\end{example} %eg:sl(2)の指数写像}

	\begin{example}[su(2)]\label{eg:su(2)の指数写像} %{
		$su_2$を次のように定義する。
		\begin{equation*}\begin{split}
			su_2 := \set{X\in\Mat(2,\fukuso)\bou \tr X = 0 \And X^\dag = - X}
		\end{split}\end{equation*}
		$sl_2$の場合と異なり、$su_2$の定義には複素共役が含まれてるので、
		$su_2$の係数体は複素数に限定される。$su_2$の基底系はPauli行列
		$\set{\sigma_1,\sigma_2,\sigma_3}$を用いて次のようにとれ、
		\begin{equation*}\begin{split}
			\sigma_1 = \begin{pmatrix}
				0 & 1 \\ 1 & 0
			\end{pmatrix},\quad \sigma_2 = \begin{pmatrix}
				0 & -i \\ i & 0
			\end{pmatrix},\quad \sigma_3 = \begin{pmatrix}
				1 & 0 \\ 0 & -1
			\end{pmatrix}
		\end{split}\end{equation*}
		次の交換関係を満たす。
		\begin{equation*}\begin{split}
			[\sigma_1,\sigma_2] = 2i\sigma_3
			,\quad [\sigma_2,\sigma_3] = 2i\sigma_1
			,\quad [\sigma_3,\sigma_1] = 2i\sigma_2
		\end{split}\end{equation*}
		この基底系を使うと$su_2$は次のように書ける。
		\begin{equation}\label{eq:su2の座標系}\begin{split}
			su_2 = \Set{i\begin{pmatrix}
				x_3 & x_1 - ix_2 \\ x_1 + ix_2 & - x_3
			\end{pmatrix}\bou x_i\in\jitu}
		\end{split}\end{equation}
		$su_2$は$sl_2$の虚数部をとったような形になっている。
		この座標系を$sl_2$の指数写像\eqref{eq:sl2の指数写像}に当てはめると、
		次のようになる。
		\begin{equation}\label{eq:su2の指数写像}\begin{split}
			e^X = (\cos r) + \cfrac{(\sin r)}{r}X \quad\text{where }
			X = \begin{pmatrix}
				x_3 & x_1 - ix_2 \\ x_1 + ix_2 & - x_3
			\end{pmatrix} \\ r = \sqrt{x_1^2 + x_2^2 + x_3^2}
		\end{split}\end{equation}
	\end{example} %eg:su(2)の指数写像}
%s3:指数写像}
\subsubsection{Lie代数と随伴表現}\label{s3:Lie代数と随伴表現} %{
	パラメーター$t\in\fukuso$を用いて表して、
	$t$の一次近似したベクトル空間$\frk{g}$に、
	\begin{equation*}\begin{split}
		e^{tX} = 1 + X\int_0^tdse^{sX} = 1 + tX + Ot^2
		\quad\text{for all } X\in\frk{g}
	\end{split}\end{equation*}
	Lie括弧を定義したものを$G$のLie代数ということにする。

	Lie群$G$の随伴表現$\Ad:G\to\End\frk{g}$を共役によって定義する。
	\begin{equation*}\begin{split}
		e^{(\Ad g)X} := ge^Xg^{-1} \quad\text{for all } g\in G,\; X\in\frk{g}
	\end{split}\end{equation*}
	また、Lie代数の随伴表現$\ad:\frk{g}\to\End\frk{g}$を$\Ad$の微分に
	よって定義する。
	\begin{equation*}\begin{split}
		(\ad X)Y := \lim_{t\to0}\frac{d}{dt}(\Ad e^{tX})Y
		\quad\text{for all } X,Y\in\frk{g}
	\end{split}\end{equation*}
	$\ad$はLie括弧を用いて次のように書ける。
	\begin{equation*}\begin{split}
		(\ad X)Y = [X, Y] \quad\text{for all } X,Y\in\frk{g}
	\end{split}\end{equation*}

	$BCH$の公式を用いると、任意の$g\in G,\; Y,Z\in\frk{g}$と十分小さな
	$t\in\fukuso$に対して、次の二つの式が導かれる。
	\begin{equation*}\begin{split}
		\ln\left(ge^{tY}e^{tZ}g^{-1}\right)
		&= \ln\left(e^{t(\Ad g)Y}e^{t(\Ad g)Z}\right) \\
		&= t(\Ad g)(Y + Z) + \frac{t^2}{2}[(\Ad g)Y, (\Ad g)Z] + Ot^3 \\
		\ln\left(ge^{tY}e^{tZ}g^{-1}\right)
		&= \ln\left(ge^{t(Y+Z) + \frac{t}{2}[Y,Z] + Ot^3}g^{-1}\right) \\
		&= t(\Ad g)(Y + Z) + \frac{t^2}{2}(\Ad g)[Y, Z] + Ot^3 \\
	\end{split}\end{equation*}
	$t$の二次の項を比べると次の式が導かれる。
	\begin{equation*}\begin{split}
		(\Ad g)[Y,Z] = [(\Ad g)Y, (\Ad g)Z]
		\quad\text{for all } g\in G,\; Y,Z\in\frk{g}
	\end{split}\end{equation*}
	この式は共役が群の自己同型写像になることの反映である。
	この式で$g=e^{tX}$とおき、$t$の一次の項を取り出すと、
	Jacobiの恒等式が得られる。
	\begin{equation*}\begin{split}
		[X,[Y,Z]] = [[X,Y],Z] + [Y,[X,Z]] \quad\text{for all } X,Y,Z\in\frk{g}
	\end{split}\end{equation*}
	代数の随伴表現$\ad$を用いると、これらの式は次のように書くことができる。
	\begin{equation}\label{eq:随伴表現その一}\begin{array}{rcll}
		\ad\bigl((\Ad g)Y\bigr) &=& (\Ad g)(\ad Y)(\Ad g^{-1})
		& \quad\text{for all } g\in G,\; Y\in\frk{g} \\
		\ad[X,Y] &=& [\ad X,\ad Y] & \quad\text{for all } X,Y\in\frk{g}
	\end{array}\end{equation}
	二つ目の式は$\ad$がLie代数の表現になっていることを示している。

	Lie群の正規部分群を随伴表現を通してLie代数の言葉に翻訳することを考える。
	$\frk{h}\subseteq\frk{g}$を随伴表現の不変部分空間とすると、
	$\frk{h}$は$G$の正規部分群に対応することがわかる。
	\begin{equation*}\begin{split}
		(\Ad g)Y\in \frk{h} \implies ge^Yg^{-1} = e^{(\Ad g)Y}\in e^{\frk{h}}
		\quad\text{for all } g\in G,\; Y\in\frk{h}
	\end{split}\end{equation*}
	また、$\frk{h}\subseteq\frk{g}$を随伴表現の核空間とすると、
	$\frk{h}$は$G$の中心部分群に対応することがわかる。
	\begin{equation*}\begin{split}
		(\Ad g)Y = 0 \implies ge^Yg^{-1} = e^{(\Ad g)Y} = 1
		\quad\text{for all } g\in G,\; Y\in\frk{h}
	\end{split}\end{equation*}

	ここで、Lie代数について、随伴表現に依らない言葉を定義しておく。
	Lie代数$\frak{g}$のイデアル$I$を次のように定義する。
	\begin{equation*}\begin{split}
		\text{部分空間$I\subseteq\frak{g}$がイデアル} 
		\xiff{\dfn} [g,a]\in I \quad\text{for all } g\in\frak{g},\; a\in I
	\end{split}\end{equation*}
	ゼロ元だけからなる部分Lie代数$\set{0}$と$\frak{g}$自身は常に
	イデアルとなるので、自明なイデアルという。また、$\frak{g}$のすべての
	元と可換となるイデアルを中心という。
	\begin{equation*}\begin{split}
		\text{部分空間$I\subseteq\frak{g}$が中心} 
		\xiff{\dfn} [g,a]=0 \quad\text{for all } g\in\frak{g},\; a\in I
	\end{split}\end{equation*}
	$\set{0}$は常に中心となるので、自明な中心という。
	イデアルを使うとLie代数での単純と半単純を次のように定義することができる。

	\begin{definition}[Lie代数での単純と半単純]
	\label{def:Lie代数での単純と半単純} %{
		$\frak{g}$をLie代数とする。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $\frak{g}$のイデアルが自明なイデアルに限られるとき、
			$\frak{g}$を単純Lie代数といい、
			\item $\frak{g}$の中心イデアルが自明な中心イデアルに限られる
			とき、$\frak{g}$を半単純Lie代数という。
		\end{itemize} %}
	\end{definition} %def:Lie代数での単純と半単純}

	以上をまとめると、群とLie代数との対応は次のようになり、
	\begin{equation*}\begin{array}{cc}
		\text{群} & \text{Lie代数} \\ \hline
		\text{共役} & \text{Lie括弧} \\
		\text{正規部分群} & \text{イデアル} \\
		\text{中心部分群} & \text{中心イデアル} \\
	\end{array}\end{equation*}
	単純と半単純についての群とLie代数との対応は次のようになる。
	\begin{equation*}\begin{array}{c|ccc}
		& \text{群} & \text{Lie代数} & \text{随伴表現} \\ \hline
		\text{単純} & \text{自明な正規部分群なし} 
			& \text{自明なイデアルなし} & \text{不変部分空間なし} \\
		\text{半単純} & \text{自明な中心部分群なし} 
			& \text{自明な中心イデアルなし} & \text{核部分空間なし} \\
	\end{array}\end{equation*}
%s3:Lie代数と随伴表現}
\subsubsection{Killing形式}\label{s3:Killing形式} %{
	次の線形写像$\kappa:\frk{g}\otimes\frk{g}\to\fukuso$をKilling形式という。
	\begin{equation*}\begin{split}
		\kappa(X\otimes Y) := \tr\bigl((\ad X)(\ad Y)\bigr)
	\end{split}\end{equation*}
	トレースの性質$\tr(AB)=\tr(BA)$から$\kappa$は対称になることがわかる。
	また、随伴表現の性質\eqref{eq:随伴表現その一}から、
	$\Ad$を省略して$gX:=(\Ad g)X$と書くと、次の式が成り立ち、
	\begin{equation*}\begin{split}
		\kappa\bigl(gX\otimes Y\bigr)
		&= \tr\biggl((\ad gX)(\ad Y)\biggr)
		= \tr\biggl(g(\ad X)g^{-1}(\ad Y)\biggr) \\
		&= \tr\biggl((\ad X)g^{-1}(\ad Y)g\biggr)
		= \tr\biggl((\ad X)(\ad g^{-1}Y)\biggr) \\
		&= \kappa\bigl(X\otimes g^{-1}Y\bigr)
			\quad\text{for all } g\in G,\; X,Y\in\frk{g} \\
	\end{split}\end{equation*}
	$\kappa$が$\Ad$不変になることがわかる。
	\begin{equation*}\begin{split}
		\kappa\bigl((\Ad g)\otimes\id\bigr)
		= \kappa\bigl(\id\otimes(\Ad g^{-1})\bigr)
		\quad\text{for all } g\in G
	\end{split}\end{equation*}
	この式を微分すると$\ad$に関する次の式が得られる。
	\begin{equation*}\begin{split}
		\kappa\bigl((\ad X)\otimes\id\bigr)
		+ \kappa\bigl(\id\otimes(\ad X)\bigr) = 0
		\quad\text{for all } X\in \frk{g}
	\end{split}\end{equation*}

	Cartanの判定法とは、Killing形式を用いて有限次元Lie環$\frk{g}$の種類を
	判定する方法で、次の二つのバージョンがある。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[可解性] $\frk{g}$が可解かどうかの判定
		\begin{equation*}\begin{split}
			\kappa(X\otimes Y) = 0 
			\quad\text{for all }X\in\frk{g},\; Y\in[\frk{g},\frk{g}]
			\iff \text{$\frk{g}$が可解}
		\end{split}\end{equation*}
		\item[半単純性] $\frk{g}$が半単純かどうかの判定
		\begin{equation*}\begin{split}
			\det\kappa \neq 0 \iff \text{$\frk{g}$が半単純}
		\end{split}\end{equation*}
	\end{description} %}
	どちらの場合も有限次元Lie環に制限されているので、無限次元Lie環の場合は
	別途判定方法を考える必要があるようである。ここで、Killing形式を定義する
	目的はCartanの判定法にある。

	随伴表現とKilling形式を簡単なLie代数について調べてみる。

	\begin{example}[sl(2)]\label{eg:sl(2)の随伴表現} %{
		座標系\eqref{eq:sl2の座標系}を使い、$(L_+,H,L_-)$の順に基底を並べると、
		随伴表現とKilling形式は次のようになる。
		\begin{equation*}\begin{split}
			\ad L_+ = \begin{pmatrix}
				0 & -2 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0
			\end{pmatrix},\; \ad L_- = \begin{pmatrix}
				0 & 0 & 0 \\ -1 & 0 & 0 \\ 0 & 2 & 0
			\end{pmatrix},\; \ad H = \begin{pmatrix}
				2 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & -2
			\end{pmatrix},\; \kappa = \begin{pmatrix}
				0 & 0 & 4 \\ 0 & 8 & 0 \\ 4 & 0 & 0
			\end{pmatrix}
		\end{split}\end{equation*}
		Killing形式の固有方程式は次のようになり、
		\begin{equation*}\begin{split}
			\det(\lambda - \kappa) = (\lambda - 8)(\lambda^2 - 4^2)
		\end{split}\end{equation*}
		Killing形式は非退化だが、正定値または負定値でないことがわかる。
		座標系\eqref{eq:sl2の座標系}を使うと次の式が成り立つ。
		\begin{equation*}\begin{split}
			\kappa(X\otimes X) = 8(z_+z_-+w^2) \quad\text{for all } X\in sl_2
		\end{split}\end{equation*}
	\end{example} %eg:sl(2)の随伴表現}

	\begin{example}[su(2)]\label{eg:su(2)の随伴表現} %{
		随伴表現とKilling形式は$sl_2$の場合\ref{eg:sl(2)の随伴表現}と同じ
		になり、座標系\eqref{eq:su2の座標系}を使うと次の式が成り立つ。
		\begin{equation*}\begin{split}
			\kappa(X\otimes X) = -8\left(x_1^2+x_2^2+x_3^2\right)
			\quad\text{for all } X\in su_2
		\end{split}\end{equation*}
		したがって、$su_2$の場合は、$sl_2$の場合と異なり、Killing形式を用いて
		ノルムを定義することができる。
	\end{example} %eg:su(2)の随伴表現}

	\begin{todo}[ここまで]\label{todo:ここまで} %{
		有限群$G$とその表現$(\rho,V)$が与えられ、表現空間$V$が内積$\beta$を
		持つ場合、次のようにすると$G$-不変な内積$\beta_G$が得られる。
		\begin{equation*}\begin{split}
			\beta_G(v_1, v_2) 
			:= \frac{1}{|G|}\sum_{g\in G} \beta(\rho_gv_1, \rho_gv_2)
			\quad\text{for all } v_1,v_2\in V
		\end{split}\end{equation*}
		そして、内積$\beta_G$を用いると、表現$\rho$がユニタリ表現となる。
		\begin{equation*}\begin{split}
			\beta_G(v_1, \rho_gv_2) = \beta_G(\rho_g^{-1}v_1, v_2)
			\quad\text{for all } v_1,v_2\in V,\; g\in G
		\end{split}\end{equation*}
	\end{todo} %todo:ここまで}
%s3:Killing形式}
\subsection{線形代数}\label{s2:線形代数} %{
	対角化可能よりももう少し条件を弱めた三角化可能を定義する。
	まず、三角行列を定義しておく。

	\begin{definition}[三角行列]\label{def:三角行列} %{
		次の形の対角成分を除いた左下半分がすべて$0$となっている正方行列を
		三角行列という。
		\begin{equation*}\begin{split}
			\begin{pmatrix}
				* & * & * \\
				0 & * & * \\
				0 & 0 & * \\
			\end{pmatrix}
		\end{split}\end{equation*}
	\end{definition} %def:三角行列}

	正方行列の対角化と異なり、正方行列の三角化は常に可能である。
	三角化は単に三角行列に書き直すだけではなく、対角成分に固有値が並ぶように
	することができる。

	\begin{proposition}[正方行列の三角化]\label{prop:正方行列の三角化} %{
		$A$を$n$次正方行列、$\lambda_1,\lambda_2,\dots,\lambda_n$を$A$の
		固有値とする。このとき、あるユニタリ行列が存在して、次のように三角行列
		にすることができる。
		\begin{equation*}\begin{split}
			U^{-1}AU = 	\begin{pmatrix}
				\lambda_1 & & & * \\
				& \lambda_2 \\
				& & \ddots \\
				0 & & & \lambda_n \\
			\end{pmatrix}
		\end{split}\end{equation*}
	\end{proposition} %prop:正方行列の三角化}
	\begin{proof} %{
		正方行列の次数についての帰納法を用いる。次数が$1$のときは、明らかに
		命題が成り立つ。ある次数$n\in\sizen_+$で命題が成り立つとし、
		$A$を$n+1$次正方行列とする。$\lambda\in\fukuso$を$A$の固有値とし、
		$v\in\fukuso^{n+1}$を$\lambda$に属する固有ベクトルとする。
		そして、$v,u_1,\dots,u_n\in\fukuso^{n+1}$を互いに直交するベクトル
		とする。すると、$n+1$次正方行列$U=[v,u_1,\dots,u_n]$はユニタリ行列
		となり、次の式が成り立つ。
		\begin{equation*}\begin{split}
			U^{-1}AU &= U^{-1}[\lambda v,Au_1,\dots,Au_n] \\
			&= \left[\lambda\begin{pmatrix}
				1 \\ 0 \\ \vdots \\ 0
			\end{pmatrix},U^{-1}Au_1,\dots,U^{-1}Au_n\right] = \begin{pmatrix}
				\lambda & * & \cdots & * \\
				0 & * & \cdots & * \\
				\vdots & & \ddots & \vdots \\
				0 & \cdots & 0 & * \\
			\end{pmatrix}
		\end{split}\end{equation*}
		ここで、$n$次正方行列$B$を次のようにおくと、
		\begin{equation*}\begin{split}
			U^{-1}AU &= \begin{pmatrix}
				\lambda & * \\
				0 & B
			\end{pmatrix}
		\end{split}\end{equation*}
		帰納法の仮定より、$B$の固有値を$\lambda_1,\dots,\lambda_n$とすると、
		$B$を次のように三角行列にする$n$次ユニタリ行列$V$が存在する。
		\begin{equation*}\begin{split}
			V^{-1}BV = \begin{pmatrix}
				\lambda_1 & & & * \\
				& \lambda_2 \\
				& & \ddots \\
				0 & & & \lambda_n \\
			\end{pmatrix}
		\end{split}\end{equation*}
		ここで、$n+1$次正方行列$W$を次のように定義すると、$W$はユニタリ行列
		となる。
		\begin{equation*}\begin{split}
			W = U \begin{pmatrix}
				1 & 0 \\ 0 & V
			\end{pmatrix}
		\end{split}\end{equation*}
		すると、次の式が成り立ち、$n+1$次正方行列に対しても命題が成り立つことが
		わかる。
		\begin{equation*}\begin{split}
			W^{-1}AW = \begin{pmatrix}
				\lambda & & & * \\
				& \lambda_1 \\
				& & \ddots \\
				0 & & & \lambda_n \\
			\end{pmatrix}
		\end{split}\end{equation*}
	\end{proof} %}

	この命題でユニタリ変換という制限を外すとJordan標準形にまで持っていける
	ことが示される。例えば、$4$次正方行列$A$の場合、その固有値を
	$\lambda_i(i=1,2,3,4)$とすると、正則行列$P$によって次のような
	形の三角行列にすることができる。
	\begin{equation*}\begin{split}
		P^{-1}AP = 	\begin{pmatrix}
			\lambda_1 & \epsilon_1 & 0 & 0 \\
			0 & \lambda_2 & \epsilon_2 & 0 \\
			0 & 0 & \lambda_3 & \epsilon_3 \\
			0 & 0 & 0 & \lambda_n \\
		\end{pmatrix}
	\end{split}\end{equation*}
	ここで、$\epsilon_i\in\set{0,1}(i=1,2,3)$は固有値の縮退度によって
	決まる値である。

	\begin{proposition}[同時上半三角化]\label{prop:同時上半三角化} %{
		$A$と$B$を互いに可換な正方行列とする。このとき、適当な基底の変換に
		よって、$A$と$B$は同時に上半三角にすることができる。
	\end{proposition} %prop:同時上半三角化}
	\begin{proof} %{
		$A$の固有値を一つ選んで$\lambda$とし、$\lambda$に属する固有空間を
		$W\neq 0$とする。$A$と$B$が可換だから、$W$は$B$の不変部分空間
		となっている（$BW\subseteq W$）。したがって、
	\end{proof} %}
%s2:線形代数}
\subsection{群}\label{s2:群} %{
	$G$を群、$H$を$G$の部分群とする。任意の$g\in G$に対して$G$の部分集合
	$gH$を次のようにおくことにする。
	\begin{equation*}\begin{split}
		gH := \set{gh\bou h\in H} \quad\text{for all } g\in G
	\end{split}\end{equation*}
	すると、任意の$g_1,g_2\in G$に対して、部分集合$g_1H$と$g_2H$は等しいか、
	全く交わらないかのどちらかになる。
	\begin{equation*}\begin{array}{rcll}
		g_1H\cap g_2H \neq \emptyset 
		&\implies& g_1h_1 = g_2h_2 & \quad\text{for some } h_1,h_2\in H \\
		&\implies& g_1 = g_2h_2h_1^{-1} \\
		&\implies& g_1h = g_2h_2h_1^{-1}h\in g_2H & \quad\text{for all } h\in H
	\end{array}\end{equation*}
	したがって、ある$G$のある部分集合$K$があって、$G$は$G=\cup_{k\in K} kH$
	という部分集合の直和として書くことができる。$gH$を$H$を法とする剰余類
	という。

	部分群$H\subseteq G$が正規部分群の場合、次のようにして、
	剰余類の間に積$m$を定義することができる\footnote{
		部分群が正規部分群でなくても、このようにして積を定義することはできる
		が、代表元のとり方に依存してくる。
	}。
	\begin{equation*}\begin{split}
		m(g_1H,g_2H) := (g_1g_2)H
	\end{split}\end{equation*}
	$m$の定義は剰余類の代表元のとり方に依らず、
	\begin{equation*}\begin{split}
		g_1H = g_2H \implies g_1gH = g_2gH \quad\text{for all } g_1,g_2,g\in G
	\end{split}\end{equation*}
	$H$を単位元とする群になる。この群を正規部分群$H$による商群といい、
	$G/H$と書く。

	\begin{definition}[可解群]\label{def:可解群} %{
		群$G$が次のような有限な長さの部分群の列を持ち、
		\begin{equation*}\begin{split}
			G = G_0 \supset G_1 \supset\cdots\supset G_n = \mybf{1}
		\end{split}\end{equation*}
		すべての$i=0,\dots,n-1$で、
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $G_{i+1}$が$G_i$の正規部分群となり、
			\item $G_i/G_{i+1}$がアーベル群となる
		\end{itemize} %}
		とき、$G$を可解群という。
	\end{definition} %def:可解群}

\subsubsection{二次三角行列}\label{s3:二次三角行列} %{
	$T_2$を可逆な$2$次三角行列全体の作る集合とする。
	\begin{equation*}\begin{split}
		T_2 := \Set{\begin{pmatrix}
			a & c \\ 0 & b
		\end{pmatrix}\bou a,b\in\fukuso_\times,\; c\in\fukuso}
	\end{split}\end{equation*}
	ここで、$\fukuso_\times$を$\fukuso$から$0$を除いた集合とする。
	$T_2$は通常の行列の積について群となる。
	\begin{equation*}\begin{split}
		\begin{pmatrix}
			a_1 & c_1 \\ 0 & b_1
		\end{pmatrix}\begin{pmatrix}
			a_2 & c_2 \\ 0 & b_2
		\end{pmatrix} = \begin{pmatrix}
			a_1a_2 & a_1c_2+c_1b_2 \\ 0 & b_1b_2
		\end{pmatrix}
	\end{split}\end{equation*}
	逆元は次のように具体的に求まる。
	\begin{equation*}\begin{split}
		\begin{pmatrix}
			a & c \\ 0 & b
		\end{pmatrix}^{-1} = \frac{1}{ab}\begin{pmatrix}
			b & -c \\ 0 & a
		\end{pmatrix}
	\end{split}\end{equation*}
	これを用いると、$T_2$の共役変換は対角成分を変えないことがわかる。
	\begin{equation*}\begin{split}
		g^{-1} \begin{pmatrix}
			a & * \\ 0 & b
		\end{pmatrix}g = \begin{pmatrix}
			a & * \\ 0 & b
		\end{pmatrix} \quad\text{for all } g\in T_2
		,\; a,b\in \fukuso_\times
	\end{split}\end{equation*}
	したがって、$T_2$の交換子群$DT_2$は対角成分が$1$となる三角行列からなる
	ことがわかる。
	\begin{equation*}\begin{split}
		DT_2 := \Set{\begin{pmatrix}
			1 & c \\ 0 & 1 \end{pmatrix}\bou c\in\fukuso}
	\end{split}\end{equation*}
	さらに、$DT_2$の共役変換は次のようになり、
	\begin{equation*}\begin{split}
		\begin{pmatrix}
			1 & a \\ 0 & 1
		\end{pmatrix}^{-1}\begin{pmatrix}
			1 & b \\ 0 & 1
		\end{pmatrix}\begin{pmatrix}
			1 & a \\ 0 & 1
		\end{pmatrix} = \begin{pmatrix}
			1 & b \\ 0 & 1
		\end{pmatrix} \quad\text{for all } a,b\in\fukuso
	\end{split}\end{equation*}
	$DT_2$の交換子群$D^2T_2$は単位元だけからなる自明な群となる。
	\begin{equation*}\begin{split}
		g_1^{-1}g_2^{-1}g_1g_2 = 1 \quad\text{for all } g_1,g_2\in DT_2
	\end{split}\end{equation*}
	したがって、次の部分群の列が成り立ち、$T_2$は可解群となることがわかる。
	\begin{equation*}\begin{split}
		T_2 = D^0T_2\supset DT_2\supset D^2T_2 = \mybf{1}
	\end{split}\end{equation*}
%s3:二次三角行列}
%s2:群}
%s1:Lie代数}
\section{統計モデル}\label{s1:統計モデル} %{
\subsection{一次元モデル}\label{s2:一次元モデル} %{
	まず、最も簡単なモデルの一つであるIsingモデルをおさらいしておく。

\subsubsection{Isingモデル}\label{s3:Isingモデル} %{
	次のようなモデルを考えて、
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 頂点数が$N$の一定間隔の一次元格子上で考える。
		\item 格子上にスピン$\pm1$を割り当てる。
		\item 周期境界条件を課す。
		\item 格子上のスピンの隣接相互作用$k$を考える。
		\item 外部磁場$h$を入れる。
	\end{itemize} %}
	分配関数$Z(k,h,N)$を次のように定義する。
	\begin{equation*}\begin{split}
		Z(k,h,N) &= \sum_{s_0,\dots,s_{N-1}=\pm1} 
			\exp\left(\sum_{i=0}^{N-1}(ks_is_{i+1}+hs_i)\right) \\
	\end{split}\end{equation*}
	ここで、$\exp(ks_is_{i+1}+hs_i)$はBoltzmann重率と呼ばれる量で、
	格子の頂点一つ辺りのエネルギーを指数の肩に乗せたものになっている。
	スピン-スピン相互作用に相当する$k$の項はマイナスの符号がついた方が
	物理的に自然だが、記法の便宜上逆符号で書いている。
	任意の$s,t=\pm1$に対して$W(s,t)$を次のように定義すると、
	\begin{equation*}\begin{split}
		W(s,t) := \exp\bigl(kst + h\frac{s+t}{2}\bigr)
	\end{split}\end{equation*}
	分配関数は$Z(k,h,N)=\tr W^N$と書くことができる。
	$W$はBoltzmann重率を外部磁場$h$の項について対称化したもので、
	次のようになる。
	\begin{equation}\label{eq:転送行列その一}\begin{split}
		W = \begin{pmatrix}
			W(1,1) & W(1,-1) \\ W(-1,1) & W(-1,-1) \\
		\end{pmatrix} = \begin{pmatrix}
			\exp(k+h) & \exp(-k) \\ \exp(-k) & \exp(k-h) \\
		\end{pmatrix}
	\end{split}\end{equation}
	$W$は実対称行列なので、その固有値はすべて実数になる。
	$\lambda_\pm$を$W$の固有値で$\lambda_-\le\lambda_+$とすると、
	一頂点当たりの自由エネルギーが次のように計算できる。
	\begin{equation*}\begin{split}
		F(k,h) &:= -\lim_{N\to\infty}\frac{1}{N}\ln Z(k,h,N) \\
		&= -\lim_{N\to\infty}\frac{1}{N}\ln\tr W^n
		= -\lim_{N\to\infty}\frac{1}{N}\ln (\lambda_+^N + \lambda_-^N)
		= -\ln\lambda_+
	\end{split}\end{equation*}
	$W$の固有値$\lambda_\pm$は次のようになる。
	\begin{equation}\label{eq:転送行列の固有値その一}\begin{split}
		\lambda_\pm &= \frac{\tr W \pm \sqrt{(\tr W)^2 - 4(\det W)}}{2} \\
		&= e^k(\cosh e^h) \pm \sqrt{e^{2k}(\sinh e^h)^2 + e^{-2k}} \\
	\end{split}\end{equation}

	自由エネルギー$F$を外部磁場$h$で微分したものはスピンの向きの期待値
	$\braket{s}$となる。
	\begin{equation*}\begin{split}
		\braket{s} &= -\frac{\partial F}{\partial h}(k,h)
		= -\frac{\partial\ln\lambda_+}{\partial h}(k,h) \\
		&= -\frac{1}{\lambda_+} \left( e^k(\sinh e^h) 
			+ \frac{e^{2k}(\cosh e^h)(\sinh e^h)}
			{\sqrt{e^{2k}(\sinh e^h)^2 + e^{-2k}}} \right) \\
	\end{split}\end{equation*}
	外部磁場のない状態$h=0$で$\braket{s}\neq0$となれば、それは磁石となる。
	つまり、自発的対称性の破れが起きることになる。一次元Isingモデルでは
	$\lim_{h\to0}\braket{s}=0$となり、磁石にはならない。

	ボルツマン重率$W$はは空間$\pm1$に住む粒子が遷移確率$W$に
	したがって移動していくという描像をとることができる。
	絵にすると次のようになる。
	\begin{equation*}\xymatrix@C=6em{
		s_0 \ar[r]^{W(s_0,s_1)} & s_1 \ar[r]^{W(s_1,s_2)} 
		& \cdots \ar[r]^{W(s_{N-2},s_{N-1})}
		& s_{N-1} \ar@(u,u)[lll]_{W(s_{N-1},s_0)} \\
	}\end{equation*}
	この意味でボルツマン重率$W$を転送行列ということもある。

	格子の間隔が一定でなくても同様の議論が成り立ちそうに思うが、
	そうは問屋が下ろさない。$W$で$k$と$h$を明示的に次のように書いて、
	\begin{equation*}\begin{split}
		W(k,h) = e^k\bvec{e^h}{e^{-h}} + e^{-k}\sigma
		,\quad \bvec{a}{b} := \begin{pmatrix}
			a & 0 \\ 0 & b
		\end{pmatrix},\quad \sigma := \begin{pmatrix}
			0 & 1 \\ 1 & 0
		\end{pmatrix}
	\end{split}\end{equation*}
	$W(k_1,h)$と$W(k_2,h)$のLie括弧を計算すると次のようになり、
	\begin{equation*}\begin{split}
		\bigl[W(k_1,h),W(k_2,h)\bigr] 
		&= (e^{k_1-k_2} - e^{k_2-k_1})\left[\bvec{e^h}{e^{-h}},\sigma\right] \\
		&= (e^{k_1-k_2} - e^{k_2-k_1})(e^h - e^{-h})\bvec{1}{-1}\sigma \\
	\end{split}\end{equation*}
	$k_1=k_2$または$h=0$でない限り、$W(k_1,h)$と$W(k_2,h)$は同時に対角化する
	ことができないことがわかる。
%s3:Isingモデル}
%s2:一次元モデル}
%s1:統計モデル}

\section{三次元回転}\label{s1:三次元回転} %{
	$\lieso(3)$の既約表現とテンソル積表現の既約分解について書く。

\subsection{既約表現の構成}\label{s2:既約表現の構成} %{
	$\lieso(3)$の既約表現を列挙することを考える。

	$\lieso(3)$の生成子$\set{M_i\bou i=1,2,3}$を次の交換関係によって
	定義する。
	\begin{equation*}\begin{split}
		[M_i,M_j] = i\sum_{k=1}^3E_{ijk}M_k \quad\text{for all } i,j=1,2,3
	\end{split}\end{equation*}
	$M_\pm=M_1\pm iM_2$と定義すると、交換関係は次のように書ける。
	\begin{equation}\label{eq:交換関係その一}\begin{split}
		[M_+,M_-] = 2M_3,\quad [M_3,M_\pm] = \pm M_\pm
	\end{split}\end{equation}
	全角運動量$M^2$を次のように定義すると、
	\begin{equation*}\begin{split}
		M^2 := \sum_{i=1}^3 M_i^2
	\end{split}\end{equation*}
	$M^2$と各$M_i$は可換になる。
	\begin{equation*}\begin{split}
		[M_i,M^2] &= \sum_{j=1}^3 [M_i,M_j^2]
		= \sum_{j=1}^3 \bigl(M_j[M_i,M_j] + [M_i,M_j]M_j\bigr) \\
		& = i\sum_{j,k=1}^3 E_{ijk}\bigl(M_jM_k + M_kM_j\bigr) = 0
	\end{split}\end{equation*}
	したがって、$M^2$と$M_3$は同時に対角化可能となる。
	また、交換関係\eqref{eq:交換関係その一}から、$M_\pm$を$M_3$の固有値に
	対する昇降演算子としてフォック空間を構成することができる。
	$M^2$の固有値$l$と$M_3$の固有値$m$に属する固有ベクトルを$\ket{l,m}$と
	書き、その双対ベクトルを$\bra{l,m}$と書くことにする。
	\begin{equation*}\begin{split}
		M^2\ket{l,m} = l\ket{l,m},\quad M_3\ket{l,m} = m\ket{l,m} \\ 
		\braket{l_1,m_1\bou l_2,m_2} = \jump{l_1=l_2}\jump{m_1=m_2}
	\end{split}\end{equation*}
	$M^2$と各$M_i$と可換だから、次のベクトルによって張られるベクトル空間
	は$\lieso(3)$の作用に対して閉じている。
	\begin{equation*}\begin{split}
		\ket{l,m + n}\propto M_+^n\ket{l,m},\quad
		\ket{l,m - n}\propto M_-^n\ket{l,m} \quad\text{where } n\in\sizen
	\end{split}\end{equation*}

	$M_3$の固有値の範囲を調べる。次の式により、
	\begin{equation*}\begin{split}
		M_1^2 + M_2^2 &= \frac{1}{2}(M_+M_- + M_-M_+) \\
		M_1^2 - M_2^2 &= \frac{1}{2}(M_+M_+ + M_-M_-) \\
	\end{split}\end{equation*}
	$M^2$は次のように書ける。
	\begin{equation*}\begin{split}
		M^2 = \frac{1}{2}(M_+M_- + M_-M_+) + M_3^2
	\end{split}\end{equation*}
	この式の対角成分をとると、次の不等式が成り立つことがわかる。
	\begin{equation*}\begin{split}
		l = \frac{1}{2}\biggl(
			\bigl|M_-\ket{l,m}\bigr|^2 + \bigl|M_+\ket{l,m}\bigr|^2\biggr) + m^2
		&\implies l\ge m^2 \\
		&\iff -\sqrt{l} \le m \le \sqrt{l} \\
	\end{split}\end{equation*}
	$M^2$の固有値$l$を一つ決めて、$m$の上限を$m_l^{\max}$、
	下限を$m_l^{\min}$とすると、それらの固有ベクトルに対する昇降演算子
	の作用が次のように定まる。
	\begin{equation}\label{eq:上限と下限その一}\begin{split}
		M_+\ket{l,m_l^{\max}} = 0 = M_-\ket{l,m_l^{\min}}
	\end{split}\end{equation}
	ここで、次の式を使うと、
	\begin{equation}\label{昇降演算子のノルムその一}\begin{split}
		M_-M_+ = M^2 - M_3(M_3 + 1),\quad M_+M_- = M^2 - M_3(M_3 - 1)
	\end{split}\end{equation}
	式\eqref{eq:上限と下限その一}から次の式が導かれる。
	\begin{equation*}\begin{split}
		& l - m_l^{\max}(m_l^{\max} + 1) = 0 = l - m_l^{\min}(m_l^{\min} - 1) \\
		& \implies (m_l^{\max})^2 - (m_l^{\min})^2 + m_l^{\max} + m_l^{\min} = 0 \\
		& \iff  (m_l^{\max} + m_l^{\min})(m_l^{\max} - m_l^{\min} + 1) = 0 \\
	\end{split}\end{equation*}
	仮定から$m_l^{\min}\le m_l^{\max}$だから、この式が成り立つのは
	$m_l^{\max}+m_l^{\min}=0$となるときだけである。そして、
	$m_l^{\max}-m_l^{\min}\in\sizen$となるから、$M_3$の取りうる固有値は次の
	ようになる。
	\begin{equation*}\begin{array}{rrrrrrr}
		m_l^{\max} - m_l^{\min} & 0 & 1 & 2 & 3 & \cdots \\
		m_l^{\min} & 0 & -\frac{1}{2} & -1 & -\frac{3}{2} \\
		m_l^{\max} & 0 & \frac{1}{2} & 1 & \frac{3}{2} \\
	\end{array}\end{equation*}
	半自然数$\sizen/2=\set{0,\frac{1}{2},1,\frac{3}{2},\dots}$を
	用いると次のように書ける。
	\begin{equation*}\begin{split}
		m_l^{\min} = -j,\quad m_l^{\max} = j \quad\text{for all } j\in\sizen/2
	\end{split}\end{equation*}
	そして、$l$と$j$の関係は次のように求まる。
	\begin{equation*}\begin{split}
		l = m_l^{\max}(m_l^{\max} + 1) = j(j+1)
	\end{split}\end{equation*}
	以上をまとめると、次のように$M^2$と$M_3$の固有状態が得られた。
	\begin{equation*}\begin{split}
		M^2\ket{j,m} = j(j+1)\ket{j,m},\quad M_2\ket{j,m} = m\ket{j,m} \\
		\text{for all } j\in \sizen/2,\;
		m\in \set{-j, -j + 1,\dots, j - 1, j}
	\end{split}\end{equation*}
	また、式\eqref{昇降演算子のノルムその一}を使うと次のようになるから、
	\begin{equation*}\begin{split}
		\bigl|M_+\ket{j,m}\bigr|^2 = j(j+1) - m(m+1)
		,\quad \bigl|M_-\ket{j,m}\bigr|^2 = j(j+1) - m(m-1)
	\end{split}\end{equation*}
	昇降演算子の規格化因子は次のようになることがわかる。
	\begin{equation*}\begin{array}{rcll}
		M_+\ket{j,m} &=& \sqrt{j(j+1) - m(m + 1)}\;\ket{j,m+1}
			&\quad\text{for all } -j\le m< j \\
		M_-\ket{j,m} &=& \sqrt{j(j+1) - m(m - 1)}\;\ket{j,m-1}
			&\quad\text{for all } -j< m\le j \\
	\end{array}\end{equation*}
%s2:既約表現の構成}
\subsection{既約表現のテンソル積}\label{s2:既約表現のテンソル積} %{
	$\lieso(3)$の既約表現のテンソル積を既約表現の直和に分解することを考える。

	$\lieso(3)$に余積$\Delta$を次のように定義する。
	\begin{equation*}\begin{array}{rcll}
		\Delta 1 &=& 1\otimes 1 \\
		\Delta M_i &=& M_i\otimes1 + 1\otimes M_i
			&\quad\text{for all } i = 1,2,3 \\
		\Delta(M_{i_1}\cdots M_{i_n}) 
			&=& (\Delta M_{i_1})\cdots(\Delta M_{i_n})
			&\quad\text{for all } i_1,\dots,i_n = 1,2,3 \\
	\end{array}\end{equation*}
	すると，次の式が成り立ち、
	\begin{equation*}\begin{split}
		[\Delta M_i, \Delta M_j] = i\sum_{k=1}^3 E_{ijk}\Delta M_k
		\quad\text{for all } i,j = 1,2,3
	\end{split}\end{equation*}
	余積$\Delta$はLie代数準同型射となる。
	この余積を用いてテンソル積への表現を定義する。
	表現$(\rho_1,V_1)$と$(\rho_2,V_2)$のテンソル積への表現
	$\rho_1*\rho_2:\lieso(3)\to \End_\fukuso(V_1\otimes V_2)$を次のように
	定義する。
	\begin{equation*}\begin{split}
		(\rho_1*\rho_2)M_i := (\rho_1\otimes\rho_2)\Delta M_i
	\end{split}\end{equation*}
	以下の表現の準同型射$\rho$は省略して書く。

	前節の議論から、$\lieso(3)$の既約表現は半自然数を用いてパラメトライズ
	することができることがわかるので、任意の$j\in\sizen/2$に対して
	$M^2$の固有値が$j(j+1)$となる既約な表現空間を$V_j$と書くことにする。
	\begin{equation*}\begin{split}
		V_j = \myop{span} \set{\ket{j,m}\bou m=-j,-j+1,\dots,j-1,j}
	\end{split}\end{equation*}
	一般には、既約な表現空間のテンソル積によって作られる空間$V_j\otimes V_k$
	は既約ではない。$V_j\otimes V_k$を既約表現の直和に分解することを考える。
	
	ここで、テンソル積の記述を簡略化するための記法を定義しておく。
	$V_j$のベクトルで$M_3$の固有値$m$に属する固有ベクトルを単に$\ket{m}$
	と書くことにする。
	\begin{equation*}\begin{split}
		\ket{m}\in V_j \xiff{\dfn} \ket{j,m}
	\end{split}\end{equation*}
	また、この節では次の命題を使う。

	\begin{proposition}[最高ウィエイトによる部分既約表現]
	\label{prop:最高ウィエイトによる部分既約表現} %{
		$(\myspace,V)$を$\lieso(3)$のユニタリ表現とする。$u\in V$が
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $u\neq 0$かつ、
			\item $M_+u=0$かつ、
			\item ある$m\in\sizen$があって、$M_3u=mu$となる
		\end{itemize} %}
		とき、
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $u$は$M^2$の固有値$m(m+1)$を持ち、
			\item $\set{M_-^ku\bou k=0,1,\dots,2m}$で張られるベクトル空間は
			$M^2$の固有値が$m(m+1)$となる$\lieso(3)$の既約表現$V_m$と
			線形同型となる。
			\begin{equation*}\begin{split}
				V_m\simeq \myop{span}_\fukuso\set{u, M_-u,\dots, M_-^{2m}u}
			\end{split}\end{equation*}
		\end{itemize} %}
	\end{proposition} %prop:最高ウィエイトによる部分既約表現}
	\begin{proof} %{
		$u\in V$を命題の条件を満たすベクトルとし、
		ベクトルの集合$M_-^*u:=\set{M_-^ku\bou k=0,1,\dots,2m}$とする。
		$M^2$を'正規積'の形あらわした次の式を使うと、
		\begin{equation}\label{eq:二乗の正規積その一}\begin{split}
			M^2 = M_3(M_3 + 1) + M_-M_+ \\
		\end{split}\end{equation}
		$M^2u=m(m+1)u$となり、$u$が$M^2$の固有値$m(m+1)$を持つことがわかる。
		さらに、$M_-$と$M^2$は可換だから、$M_-^*u$の元はすべて$M^2$の固有値
		$m(m+1)$を持つことがわかる。
		そして、任意の$p\in\sizen$に対して次の式が成り立つから、
		\begin{equation*}\begin{split}
			M_-^{p+1}u = 0 \implies M_+M_-^{p+1}u = (2m - p)(p + 1)M_-^pu = 0
		\end{split}\end{equation*}
		$M_-^*u$に$0$が含まれないことがわかり、$M_-^pu$は$M_3$の固有値$m-p$
		を持つから、$M_-^*u$の元は互いに直交する。
		したがって、$M_-^*u$で張られるベクトル空間$\fukuso M_-^*u$の次元は
		$2m+1$となり、$V_m$の次元と一致する。そして、$M_-^*u$の定義より、
		$\fukuso M_-^*u$は$\lieso(3)$の既約表現となっているから、
		命題が成り立つことがわかる。
	\end{proof} %}

\subsubsection{(1/2,1/2)の場合}\label{s3:(1/2,1/2)の場合} %{
	$V_{1/2}\otimes V_{1/2}$の直和分解を考える。
	$V_{1/2}\otimes V_{1/2}$の標準的な基底系を、
	$M_3$の固有値だけを書いて
	$(m,n):=\ket{m}\otimes\ket{n}\in V_{1/2}\otimes V_{1/2}$として、
	$M_3$の固有値ごとに並べると、次のようになる。
	\begin{equation*}\begin{array}{rcrr}
		M_3 &\quad& \text{基底} \\
		1 &\quad& (\frac{1}{2},\frac{1}{2}) \\
		0 &\quad& (-\frac{1}{2},\frac{1}{2}) & (\frac{1}{2},-\frac{1}{2}) \\
		-1 &\quad& (-\frac{1}{2},-\frac{1}{2}) \\
	\end{array}\end{equation*}
	$M_3$の固有値が最も大きな基底$(1/2,1/2)$を$u1$と書くと、
	\begin{equation*}\begin{split}
		u1 := \ket{\frac{1}{2}}\otimes\ket{\frac{1}{2}}
	\end{split}\end{equation*}
	$(\Delta M_+)u1=0$となるから、
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{u1,M_-u1,M_-^2u1}$は、既約表現$V_1$の基底系を
	与えることがわかる。また、標準的な基底系の中で残る一つを$u0$とおき、
	次のように定義すると、
	\begin{equation*}\begin{split}
		u0 &:= \ket{-\frac{1}{2}}\otimes\ket{\frac{1}{2}}
			- \ket{\frac{1}{2}}\otimes\ket{-\frac{1}{2}} \\
	\end{split}\end{equation*}
	$\Delta M_\pm u0=0$となるから、やはり
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	シングルトン$\set{u0}$は既約表現$V_0$の基底系を与えることがわかる。
	以上より、次の直和分解が成り立つことがわかる。
	\begin{equation*}\begin{split}
		V_{\frac{1}{2}}\otimes V_{\frac{1}{2}} \simeq V_1\oplus V_0
	\end{split}\end{equation*}
%s3:(1/2,1/2)の場合}
\subsubsection{(1,1/2)の場合}\label{s3:(1,1/2)の場合} %{
	$V_1\otimes V_{1/2}$の直和分解を考える。
	$V_1\otimes V_{1/2}$の標準的な基底系を、
	$M_3$の固有値だけを書いて
	$(m,n):=\ket{m}\otimes\ket{n}\in V_1\otimes V_{1/2}$として、
	$M_3$の固有値ごとに並べると、次のようになる。
	\begin{equation*}\begin{array}{rcrr}
		M_3 &\quad& \text{基底} \\
		\frac{3}{2} &\quad& (1,\frac{1}{2}) \\
		\frac{1}{2} &\quad& (0,\frac{1}{2}) & (1,-\frac{1}{2}) \\
		- \frac{1}{2} &\quad& (-1,\frac{1}{2}) & (0,-\frac{1}{2}) \\
		-\frac{3}{2} &\quad& (-1,-\frac{1}{2}) \\
	\end{array}\end{equation*}
	$M_3$の固有値が最も大きな基底$(1,1/2)$を$u(3/2)$と書くと、
	\begin{equation*}\begin{split}
		u\frac{3}{2} := \ket{1}\otimes\ket{\frac{1}{2}}
	\end{split}\end{equation*}
	$(\Delta M_+)u(3/2)=0$となるから、
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{M_-^pu(3/2)\bou p=0,1,\dots,3}$は、
	既約表現$V_{3/2}$の基底系を与えることがわかる。
	また、$M_3=1/2$の標準基底系で残る一つのベクトルを$u(1/2)$とおき、
	$(\Delta M_-)u(3/2)$と直交するように定義すると、
	\begin{equation*}\begin{split}
		u\frac{1}{2} &:= \ket{0}\otimes\ket{\frac{1}{2}}
			- \sqrt{2}\ket{1}\otimes\ket{-\frac{1}{2}} \\
	\end{split}\end{equation*}
	$(\Delta M_+)u(1/2)=0$となるから、やはり
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{u(1/2),M_-u(1/2)}$は既約表現$V_{1/2}$の
	基底系を与えることがわかる。
	以上より、次の直和分解が成り立つことがわかる。
	\begin{equation*}\begin{split}
		V_1\otimes V_{\frac{1}{2}} \simeq V_{\frac{2}{2}}\oplus V_{\frac{1}{2}}
	\end{split}\end{equation*}
%s3:(1,1/2)の場合}
\subsubsection{(3/2,1/2)の場合}\label{s3:(3/2,1/2)の場合} %{
	$V_{3/2}\otimes V_{1/2}$の直和分解を考える。
	$V_{3/2}\otimes V_{1/2}$の標準的な基底系を、
	$M_3$の固有値だけを書いて
	$(m,n):=\ket{m}\otimes\ket{n}\in V_{3/2}\otimes V_{1/2}$として、
	$M_3$の固有値ごとに並べると、次のようになる。
	\begin{equation*}\begin{array}{rcrr}
		M_3 &\quad& \text{基底} \\
		2 &\quad& (\frac{3}{2},\frac{1}{2}) \\
		1 &\quad& (\frac{1}{2},\frac{1}{2}) & (\frac{3}{2},-\frac{1}{2}) \\
		0 &\quad& (-\frac{1}{2},\frac{1}{2}) & (\frac{1}{2},-\frac{1}{2}) \\
		-1 &\quad& (-\frac{3}{2},\frac{1}{2}) & (-\frac{1}{2},-\frac{1}{2}) \\
		- 2 &\quad& (-\frac{3}{2},-\frac{1}{2}) \\
	\end{array}\end{equation*}
	$M_3$の固有値が最も大きな基底$(3/2,1/2)$を$u2$と書くと、
	\begin{equation*}\begin{split}
		u2 := \ket{\frac{3}{2}}\otimes\ket{\frac{1}{2}}
	\end{split}\end{equation*}
	$(\Delta M_+)u2=0$となるから、
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{M_-^pu(3/2)\bou p=0,1,\dots,4}$は、
	既約表現$V_2$の基底系を与えることがわかる。
	また、$M_3=1/2$の標準基底系で残る一つのベクトルを$u1$とおき、
	$(\Delta M_-)u2$と直交するように定義すると、
	\begin{equation*}\begin{split}
		u1 &:= \ket{\frac{1}{2}}\otimes\ket{\frac{1}{2}}
			- \sqrt{3}\ket{\frac{3}{2}}\otimes\ket{-\frac{1}{2}} \\
	\end{split}\end{equation*}
	$(\Delta M_+)u1=0$となるから、やはり
	命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	ベクトルの集合$\set{u1,M_-u1,M_-^2u1}$は既約表現$V_1$の
	基底系を与えることがわかる。
	以上より、次の直和分解が成り立つことがわかる。
	\begin{equation*}\begin{split}
		V_{\frac{3}{2}}\otimes V_{\frac{1}{2}} \simeq V_2\oplus V_1
	\end{split}\end{equation*}
%s3:(3/2,1/2)の場合}
\subsubsection{(j,k)の場合}\label{s3:(j,k)の場合} %{
	$j,k\in\sizen/2$とする。$\dim(V_j\otimes V_j)=(2j+1)(2k-1)$となるが、
	$V_j\otimes V_j$の標準基底系を$M_3$の固有値ごとに縦に並べると、
	次のような台形になる。
	\begin{equation*}\xymatrix@R=1ex@C=1ex{
		& & & \circ & \cdots & \circ & & & \\
		& & & \vdots & \vdots & \vdots & & & \\
		& \circ & & \circ & \cdots & \circ & & \circ & \\
		\circ & \circ & & \circ & \cdots & \circ & & \circ & \circ \\
		j + k & j + k - 1 & \cdots & |j - k| & \cdots 
			& - |j - k| & \cdots & - (j + k - 1) & - (j + k) \\
	}\end{equation*}
	ここで、$|j-k|=\max(j,k)-\min(j,k)$となることに注意すると、
	図の$|j-k|$の意味がわかる。
	そして、$M_3=j+k$から順に、$\ker M_+$の元を一つ選び出して、
	それに$M_-$を掛けていって、次の図のようなベクトルの系列を作る。
	\begin{equation*}\xymatrix@R=1ex@C=1ex{
		& & & \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} & \circ \\
		& & & \vdots & \vdots & \vdots & & & \\
		& \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} 
			& \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} & \circ \ar[r]^{M_-} 
			& \cdots \ar[r]^{M_-} & \circ \\
		\circ \ar[r]^{M_-} & \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} 
			& \circ \ar[r]^{M_-} & \cdots \ar[r]^{M_-} & \circ \ar[r]^{M_-} 
			& \cdots \ar[r]^{M_-} & \circ \ar[r]^{M_-} & \circ \\
		j + k & j + k - 1 & \cdots & |j - k| & \cdots 
			& - |j - k| & \cdots & - (j + k - 1) & - (j + k) \\
	}\end{equation*}
	すると、命題\ref{prop:最高ウィエイトによる部分既約表現}より、
	次の直和分解が得られる。
	\begin{equation*}\begin{split}
		V_j\otimes V_k \simeq V_{j+k}\oplus V_{j+k-1}\oplus\cdots\oplus
			V_{|j-k|}
	\end{split}\end{equation*}

	ここで、$M_3$の固有値ごとに$\ker M_+$の元を一つ選び出す方法だが、
	教科書\cite{bk:jinbo.ryousigun}の方法を書いておく。
	$p\in\sizen/2$を$1\le p\le (j+k)-|j-k|=2\min(j,k)$となる半自然数とする。
	$u(j+k-p)\in V_j\otimes V_k$を$M_3$の固有値$j+k-p$を持ち、
	$(\Delta M_+)u(j+k-p)=0$となるベクトルとする。$u(j+k-p)$は未定係数
	$c_i\in\fukuso$を用いて次のように書くことができる。
	\begin{equation*}\begin{split}
		u(j+k-p) = \sum_{i=0}^p c_i\ket{j-i}\otimes\ket{k-p+i}
	\end{split}\end{equation*}
	$(\Delta M_+)u(j+k-p)=0$となるためには次の式を満たす必要がある。
	\begin{equation*}\begin{split}
		0 &= (\Delta M_+)u(j+k-p) \\
		&= \sum_{i=0}^{p-1}\bigl(c_{i+1}d^j_{j-i-1} + c_id^k_{k-p+i}\bigr)
			\ket{j-i}\otimes\ket{k-p+i+1} \\
		d^j_m &:= \braket{j,m+1|M_+|j,m} \\
	\end{split}\end{equation*}
	この条件は未定係数に対する漸化式になる。
	\begin{equation*}\begin{array}{rcll}
		c_{i+1} &=& - \cfrac{\braket{k,k-p+i+1|M_+|k,k-p+i}}
			{\braket{j,j-i|M_+|j,j-i-1}} c_i \\
		&=& - \left(\cfrac{(p-i)(2k-p+i+1)}{(i+1)(2j-i)}\right)^{\frac{1}{2}}
			c_i &\quad\text{for all } i=0,1,\dots,p-1
	\end{array}\end{equation*}
	そして、$c_0$と適当に選べば、例えば$c_0=1$、$u(j+k-p)$が一つ定まる。

	ここに書いた方法で最高ウィエイトベクトルを選び出すと次のようになる。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $j=1/2,\;k=1/2$の場合
		\begin{equation*}\begin{split}
			u1 = \ket{\frac{1}{2}}\otimes\ket{\frac{1}{2}},\quad
			u0 = \ket{\frac{1}{2}}\otimes\ket{-\frac{1}{2}}
				- \ket{-\frac{1}{2}}\otimes\ket{\frac{1}{2}}
		\end{split}\end{equation*}
		%
		\item $j=1,\;k=1/2$の場合
		\begin{equation*}\begin{split}
			u\frac{3}{2} = \ket{1}\otimes\ket{\frac{1}{2}},\quad
			u\frac{1}{2} = \ket{1}\otimes\ket{-\frac{1}{2}}
				- \frac{1}{\sqrt{2}}\ket{0}\otimes\ket{\frac{1}{2}}
		\end{split}\end{equation*}
		%
		\item $j=3/2,\;k=1/2$の場合
		\begin{equation*}\begin{split}
			u2 = \ket{\frac{3}{2}}\otimes\ket{\frac{1}{2}},\quad
			u1 = \ket{\frac{3}{2}}\otimes\ket{-\frac{1}{2}}
				- \frac{1}{\sqrt{3}}\ket{\frac{1}{2}}\otimes\ket{\frac{1}{2}}
		\end{split}\end{equation*}
	\end{itemize} %}
%s3:(j,k)の場合}
%s2:既約表現のテンソル積}
	\begin{note}[似た者同士]\label{note:似た者同士} %{
		$\lieso(3,\jitu)$と$su(2)$と$sl(2,\fukuso)$は似た者同士である。
		具体的にLie代数準同型を示すこと。
	\end{note} %note:似た者同士}
%s1:三次元回転}

\section{二次方程式の正級数解}\label{s1:二次方程式の正級数解} %{
	この節では次のような便宜を用いる。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[係数] $R=(R,+,0,\myspace,1)$を標数$0$の可換半体とする。
		ここで、半体とは次の集合とする。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item 分配則を満たす可換な加法$+$と乗法$\myspace$が定義されている。
			\item 加法と乗法はそれぞれ単位元$0$と$1$を持つ。
			\item $0$以外の元は乗法の逆元を持つ。
		\end{itemize} %}
		加算集合$A$に対して$RA$を自由半ベクトル空間とする。
		\begin{equation*}\begin{split}
			RA := \set{f:A\to R
				\bou fa \neq 0 \quad\text{for only finitely many } a\in A}
		\end{split}\end{equation*}
		%
		\item[半環] 単位的環から加法の逆元が存在すること仮定しないものを半環
		ということにする。半体は半環で$0$以外の元に対して乗法の逆元が存在する
		ことが保証されたものである。加群の係数を半環に置き換えたものを半加群
		ということにする。そして、半加群$V$上の集合$X$を基底とする自由半加群を
		$VX$と書く事にする。また、半加群に乗法が定義されたものを半代数という
		ことにする。
		%
		\item[フォック空間] $H_*:=\set{\eta_n\bou n\in\sizen_+}$を可算集合、
		$H_*^\tran=\set{\eta_{-n}\bou n\in\sizen_+}$を$RH$の双対空間の基底
		とする。
		\begin{equation*}\begin{split}
			\eta_{-m}\eta_n = \jump{m=n} \quad\text{for all } m,n\in\sizen_+
		\end{split}\end{equation*}
		$V$を$R$上の半代数とし、文字列$\W H_*$から生成される$V$上の自由半加群を
		$V\W H_*$と書く。そして、$V\W H_*$の自己線形写像全体のつくる
		$V$-半加群を$\mycal{H}_*:=\End_RV\W H_*$と書く事にする。$\mycal{H}_*$
		の元は$R$の元とは可換だが、一般には$V$の元とは非可換であることに
		注意する。また、はじめの$n$個の元だけからなる$H_*$の部分集合を
		$H_n:=\set{\eta_1,\dots,\eta_n}$と書くことにする。そして、$H_n$の
		自己線形写像全体のつくる$V$-半加群を$\mycal{H}_n$と書く事にする。
		特に、$\eta_1$だけからなる場合は、$H:=H_1$、$\mycal{H}:=\mycal{H}$と
		書き、$\eta_\pm:=\eta_{\pm1}$と書くこともある。
	\end{description} %}

	次の代数方程式について、
	\begin{equation}\label{eq:求める二次式}\begin{split}
		x = a + bxcxd \quad\text{where } a,b,c,d\in V
	\end{split}\end{equation}
	次の性質を満たす解を求めることを考える。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item この式にパラメーター$t\in R$を次のように入れたとき、
		\begin{equation*}\begin{split}
			x_t = a + tbx_tcx_td
		\end{split}\end{equation*}
		$t=0$で正則になり、$x_t=\sum_{n\in\sizen}x_nt^n$としたとき、
		すべての係数$x_n$が文字集合$\set{a,b,c,d}$の自然数を係数とする
		多項式で与えられる。
	\end{itemize} %}
	$x_t$の摂動係数$x_n$は次の漸化式を満たす。
	\begin{equation}\label{eq:求める漸化式}\begin{split}
		x_0 = a,\quad x_{n+1} = \sum_{p=0}^n bx_{n-p}cx_pd
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation}
	この解を\eqref{eq:求める二次式}の正級数解ということにする。

	代数方程式\eqref{eq:求める二次式}の正級数解$x$をオートマトンを使って
	解くことを考える。次のセルオートマトンが$x$に対応すると思われる。
	\begin{equation}\label{eq:二次式のセルオートマトンその一}\xymatrix@C=1ex{
		& (+,0) & (-,0) & (+,1) & (-,1) & (+,2) & (-,2) & (+,3) & (-,3) \\
		0 & \circ \ar[r]^a \ar[d]^b & \circ & \circ \ar[r]^a  \ar[drr]^b 
			& \circ & \circ \ar[r]^a & \circ & \circ \ar[r]^a & \circ  \\
		1 & \circ \ar[r]^a \ar[d]^b & \circ \ar[r]^c 
			& \circ \ar[r]^a \ar[drr]^b & \circ \ar[ull]_d
			& \circ \ar[r]^a & \circ \ar[r]^c & \circ \ar[r]^a
			& \circ \ar[ullll]_d \\
		2 & \circ \ar[r]^a & \circ \ar[r]^c & \circ \ar[r]^a 
			& \circ \ar[ull]_d
			& \circ \ar[r]^a & \circ \ar[r]^c & \circ \ar[r]^a
			& \circ \ar[ullll]_d 
	}\end{equation}
	遷移のパターンを考慮して水平方向の格子を偶奇で直和分解している。
	$+$が偶数番目、$-$が奇数番目の水平方向の座標を表す。
	可能な遷移を書くと任意の$m,n\in\sizen$に対して次のようになる。
	\begin{equation}\label{eq:二次式のセルオートマトンその二}\begin{array}{rcrcl}
		a &:& (+, m, n) &\mapsto& (-, m, n) \\
		c &:& (-, 2m, n + 1) &\mapsto& (+, 2m + 1, n + 1) \\
		b &:& (+, m, n) &\mapsto& (+, 2m, n + 1) \\
		d &:& (-, 2m + 1, n + 1) &\mapsto& (-, m, n) \\
	\end{array}\end{equation}
	$(+,0,0)$を始点、$(-,0,0)$を終点とするすべての経路を足し上げれば正級数解
	$x$が得られると予想される。二次元格子を次のように表して、
	\begin{equation*}\begin{split}
		\bra{m}\otimes\bra{n}
		,\quad \ket{m}\otimes\ket{n}
		,\quad \begin{pmatrix}
			+ & -
		\end{pmatrix},\quad\begin{pmatrix}
			+ \\ -
		\end{pmatrix}
	\end{split}\end{equation*}
	このセルオートマトンを$2\times2$行列の形で書くと次のようになる。
	\begin{equation}\label{eq:セルオートマトンでの真空期待値}\begin{split}
		x = m_V\bra{0}\otimes\bra{0}\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b\beta & a \\
			c\gamma & d\delta
		\end{pmatrix}^*\begin{pmatrix}
			0 \\ 1
		\end{pmatrix}\ket{0}\otimes\ket{0} \\
	\end{split}\end{equation}
	ここで、$m_V$は$V$の積とし、$\beta,\gamma,\delta$を次のように定義する。
	\begin{equation*}\begin{array}{rclrcl}
		\gamma &=& C\eta_-\otimes\eta_+\eta_-,
			&\quad C &=& \sum_{m\in\sizen}\ket{2m}\bra{2m} \\
		\beta &=& B_-\otimes\eta_-,
			&\quad B_- &=& \sum_{m\in\sizen}\ket{m}\bra{2m} \\
		\delta &=& \eta_+B_+\otimes\eta_+,
			&\quad B_+ &=& \sum_{m\in\sizen}\ket{2m}\bra{m} \\
	\end{array}\end{equation*}
	そして、$\eta_\pm$は自然数を$\pm1$する演算子で任意の$m\in\sizen$に対して
	次のように定義する。
	\begin{equation*}\begin{split}
		\eta_- = \sum_{m\in\sizen}\ket{m}\bra{m+1}
		,\quad \eta_+ = \sum_{m\in\sizen}\ket{m+1}\bra{m}
	\end{split}\end{equation*}
	$\zeta_{\pm1}$と$\zeta_{\pm}2$を次のようにおくと、
	\begin{equation*}\begin{array}{rclcrcl}
		\zeta_{-1} &:=& \beta, &\quad& \zeta_1 &:=& \zeta_{-1}^\tran \\
		\zeta_2 &:=& \gamma, &\quad& \zeta_{-2} &:=& \zeta_2^\tran \\
	\end{array}\end{equation*}
	$\gamma=\zeta_1\zeta_{-2}$と書け、次の交換関係と、
	\begin{equation}\label{eq:セルオートマトンでの交換関係}\begin{split}
		\zeta_{-i}\zeta_j &= \jump{i=j} \quad\text{for } i,j = 1,2
	\end{split}\end{equation}
	次の真空への作用が成り立つ。
	\begin{equation}\label{eq:セルオートマトンでの基底状態}\begin{array}{rclcrcl}
		\zeta_{-i}\ket{0}\otimes\ket{0} &=& 0 
			&=& \bra{0}\otimes\bra{0}\zeta_i  \\
		\zeta_{i}\ket{0}\otimes\ket{0} &\neq& 0 
		&\neq& \bra{0}\otimes\bra{0}\zeta_{-i} \\
	\end{array}
		\quad\text{for } i,j = 1,2
	\end{equation}
	したがって、$\set{\zeta_{\pm 1},\zeta_{\pm 2}}$から生成される$R$上の代数を
	$\mycal{H}_2'$、$\set{\eta_{\pm 1},\eta_{\pm 2}}$から生成される$R$上の
	代数を$\mycal{H}_2$とすると、代数同型$\mycal{H}_2'\simeq\mycal{H}_2$が
	成り立つことが予想される。そして予想が成り立つと、
	$H_2'=\set{\zeta_1,\zeta_2}$として、
	作用\eqref{eq:セルオートマトンでの基底状態}から、$\mycal{H}_2'$の表現空間
	、$R\W H_2'\ket{0}\otimes\ket{0}$、はフォック空間$R\W H$に$R$-線形同型
	となっていることが帰結される。代数同型$\mycal{H}_2'\simeq\mycal{H}_2$が
	成り立つことを言うためには、$R$上の代数$R\W H_2'$が自由代数になっている
	ことを示す必要がある。$R\W H_2'$が自由代数になっていることが示されれば、
	$\mycal{H}_2'$の任意の元は次のような正規積の形で書かれるので、
	\begin{equation*}\begin{split}
		\zeta_{i_1}\cdots\zeta_{i_m}\zeta_{-j_1}\cdots\zeta_{-j_n}
		\quad\text{where } i_1,\dots,i_m,j_1,\dots,j_n = 1,2
	\end{split}\end{equation*}
	$\mycal{H}_2'$が$\mycal{H}_2$と代数同型になることがわかる。

	$\zeta_i$は次のようになっているから、
	\begin{equation*}\begin{split}
		\zeta_1 = B_+\otimes\eta_+,\quad \zeta_2 = \eta_+B_+\otimes\eta_+
		,\quad B_+ = \sum_{m\in\sizen}\ket{2m}\bra{m}
	\end{split}\end{equation*}
	任意の$\W H'$の元は次のように表される。
	\begin{equation*}\begin{split}
		\zeta_{i_1}\cdots\zeta_{i_n}
		= \biggl((\eta_+)^{i_1-1}B_+\cdots(\eta_+)^{i_n-1}B_+\biggr)
		\otimes\eta_+^n
	\end{split}\end{equation*}
	テンソル積の二項目$\eta_+^n$から次の式が成り立つことがわかる。
	\begin{equation*}\begin{split}
		\zeta_{i_1}\cdots\zeta_{i_m} = \zeta_{j_1}\cdots\zeta_{j_n}
		\implies m = n
	\end{split}\end{equation*}
	したがって、テンソル積の一項目が線形独立であることが示されればよい。
	任意の$i_1,\dots,i_n,j_1,\dots,j_n=1,2$に対して次の式が成り立つが、
	\begin{equation*}\begin{split}
		& (\eta_+)^{i_1-1}B_+\cdots(\eta_+)^{i_n-1}B_+
			= (\eta_+)^{j_1-1}B_+\cdots(\eta_+)^{j_n-1}B_+ \\
		& \implies (\eta_+)^{i_1-1}B_+\cdots(\eta_+)^{i_n-1}B_+\ket{m}
			= (\eta_+)^{j_1-1}B_+\cdots(\eta_+)^{j_n-1}B_+\ket{m} \\
		& \quad\text{for all } m\in\sizen \\
	\end{split}\end{equation*}
	$\ket{m'}=(\eta_+)^{i_1-1}B_+\cdots(\eta_+)^{i_n-1}B_+\ket{m}$として、
	$m'$が偶数であれば$i_1=j_1=1$、$m'$が奇数であれば$i_1=j_1=2$となることが
	わかる。よって、帰納法を使うことにより、すべての$p=1,2,\dots,n$に対して
	$i_p=j_p$となることがわかる。よって、$R\W H_2$の元
	\begin{equation*}\begin{split}
		1,\; \zeta_i,\; \zeta_i\zeta_j,\;\dots,\;
		\zeta_{i_1}\cdots\zeta_{i_n},\;\dots
	\end{split}\end{equation*}
	が互いに$R$-線形独立となることがわかる。以上より、$R\W H_2'$が自由代数
	となっていることが示された。

	まとめると、$1:1$の代数射$\phi:\mycal{H}_2\to\mycal{H}\otimes\mycal{H}$が
	次のように与えられ、
	\begin{equation}\label{eq:一対一の代数射その一}\begin{split}
		\phi\eta_1 = B_+\otimes\eta_+,\quad
		\phi\eta_2 = \eta_+B_+\otimes\eta_+,\quad
		\phi f^\tran = (\phi f)^\tran \quad\text{for all } f\in \mycal{H}_2
	\end{split}\end{equation}
	代数方程式\eqref{eq:求める二次式}の正級数解が次のように与えられたこと
	になる。
	\begin{equation}\label{eq:二次式の正級数解その一}\begin{split}
		x = \bra{0}\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b\eta_{-1} & a \\
			c\eta_1\eta_{-2} & d\eta_2
		\end{pmatrix}^*\begin{pmatrix}
			0 \\ 1
		\end{pmatrix}\ket{0} \\
	\end{split}\end{equation}
	そして、セルオートマトン\eqref{eq:二次式のセルオートマトンその一}は
	次のスタックオートマトンと等しいことがわかる。
	\begin{equation}\label{eq:二次式のスタックオートマトンその一}\xymatrix{
		*++[o][F-]{+} \ar@(ul,dl)_{b\eta_{-1}} \ar@/_1ex/[r]_a
		& *++[o][F-]{-} \ar@(dr,ur)_{d\eta_{2}} \ar@/_1ex/[l]_{c\eta_1\eta_{-2}}
	}\end{equation}
	真空期待値\eqref{eq:二次式の正級数解その一}
	またはスタックオートマトン\eqref{eq:二次式のスタックオートマトンその一}
	が代数方程式\eqref{eq:求める二次式}の正級数解になっていることを代数的に
	証明しておく。

	\begin{proposition}[二次式の正級数解]\label{prop:二次式の正級数解} %{
		$\mycal{H}_2$の真空期待値\eqref{eq:二次式の正級数解その一}は
		代数方程式\eqref{eq:求める二次式}の正級数解となる。
		\begin{equation*}\begin{split}
			x = \bra{0}\begin{pmatrix}
				1 & 0
			\end{pmatrix}\begin{pmatrix}
				b\eta_{-1} & a \\
				c\eta_1\eta_{-2} & d\eta_2
			\end{pmatrix}^*\begin{pmatrix}
				0 \\ 1
			\end{pmatrix}\ket{0} \implies x = a + bxcxd
		\end{split}\end{equation*}
	\end{proposition} %prop:二次式の正級数解}
	\begin{proof} %{
		命題の左辺が右辺の式を満たすことを示す。まず、二次元行列のKleeneスター
		を展開する。二次元行列$M,M_0,M_1,\sigma$を次のようにおく。
		\begin{equation*}\begin{split}
			M := \begin{pmatrix}
				b\eta_{-1} & a \\
				c\eta_1\eta_{-2} & d\eta_2
			\end{pmatrix} = M_0 + M_1\sigma \\
			M_0 := \bvec{b\eta_{-1}}{d\eta_2}
			,\quad M_1 := \bvec{a}{c\eta_1\eta_{-2}}
			,\quad \sigma := \begin{pmatrix}
				0 & 1 \\ 1 & 0
			\end{pmatrix}
		\end{split}\end{equation*}
		ここで、$[\lambda_1,\lambda_2]^\tran$は成分が$\lambda_1,\lambda_2$の
		二次元対角行列を表す。$M^*$を次のように展開して、
		\begin{equation*}\begin{split}
			M^* = (M_0^*M_1\sigma)^*M_0^*
		\end{split}\end{equation*}
		$(1,0)$と$(0,1)^\tran$で挟むと次のようになることがわかる。
		\begin{equation*}\begin{split}
			\begin{pmatrix}
				1 & 0
			\end{pmatrix}M^*\begin{pmatrix}
				0 \\ 1
			\end{pmatrix} &= \begin{pmatrix}
				1 & 0
			\end{pmatrix}(M_0^*M_1\sigma M_0^*M_1\sigma)^*M_0^*M_1\sigma M_0^*
			\begin{pmatrix}
				0 \\ 1
			\end{pmatrix} \\
			&= \bigl((b\eta_{-1}^*)a(d\eta_2)^*c\eta_1\eta_{-2}\bigr)^*
			(b\eta_{-1}^*)a(d\eta_2)^*
		\end{split}\end{equation*}
		これを$\ket{0}$に作用させたものを$\ket{X}$、Kleeneスターの中を$T$
		と書く。
		\begin{equation*}\begin{split}
			\ket{X} := T^*a\ket{d:2},\quad
			T := (b\eta_{-1}^*)a(d\eta_2)^*c\eta_1\eta_{-2}
		\end{split}\end{equation*}
		ここで、$\ket{d:2}:=(d\eta_2)^*\ket{0}$としている。$\braket{0|X}$
		が命題の左辺の値になる。$T$を正規積の形に書き直すと次のようになる。
		\begin{equation*}\begin{split}
			T = T_1 + T_{-1},\quad
			T_1 := a(d\eta_2)^*c\eta_1\eta_{-2},\quad
			T_{-1} := (b\eta_{-1})^*bac\eta_{-2}
		\end{split}\end{equation*}
		$T_{\pm1}$を一般化して線形写像$T_\pm:V\to\mycal{H}_2$を次のように定義
		すると、
		\begin{equation*}\begin{split}
			T_+f := f(d\eta_2)^*c\eta_1\eta_{-2},\quad
			T_-f := (b\eta_{-1})^*bfc\eta_{-2}
		\end{split}\end{equation*}
		$T_\pm$は次の代数を満たし、
		\begin{equation*}\begin{split}
			(T_-f)(T_+g) = T_+(bfcgd) + T_-(bfcgd)
			\quad\text{for all } f,g\in V
		\end{split}\end{equation*}
		$T_-$は$\ket{d:2}$を固有状態に持つ。
		\begin{equation*}\begin{split}
			(T_-f)g\ket{d:2} = bfcgd\ket{d:2} \quad\text{for all } f,g\in V
		\end{split}\end{equation*}
		$T_{\pm1}$は$T_\pm a$と書くことができる。
		$T_\pm$の代数から$V$の二項演算$\odot$を
		\begin{equation*}\begin{split}
			f\odot g = bfcgd \quad\text{for all } f,g\in V
		\end{split}\end{equation*}
		とおき、$x$を代数方程式\eqref{eq:求める二次式}の正級数解とすると、
		\begin{equation*}\begin{split}
			x = \sum_{n\in\sizen} x_n,\quad
			x_0 = a,\quad x_{n+1} = \sum_{p=0}^n x_p\odot x_{n-p}
			\quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		命題\eqref{prop:ベクトル空間から代数}から、次の式が成り立つことが
		わかる。
		\begin{equation*}\begin{split}
			T^* = (T_+x)^*(T_-x)^*
		\end{split}\end{equation*}
		この式から次の式が得られる。
		\begin{equation*}\begin{split}
			\braket{0|X} &= \bra{0}(T_-x)^*a\ket{d:2} \\
			&= \bra{0}(bxc\eta_{-2})^*a(d\eta_2)\ket{0} \\
		\end{split}\end{equation*}
		この式は代数方程式$x=a+bxcxd$を次のように等しい。
		\begin{equation*}\begin{split}
			x = a+bxcxd = \sum_{n\in\sizen} (bxc)^nad^n
			= \bra{0}(bxc\eta_-)^*a(d\eta_+)^*\ket{0}
		\end{split}\end{equation*}
		したがって、命題が成り立つことが示された。
	\end{proof} %}

	この命題で、一般の半体$R$では命題の逆$\Leftarrow$は成り立たないことに
	注意する。例えば、$R$が複素数の場合、$x=1+tx^2$という二次方程式は
	$x=\frac{1\pm\sqrt{1-4t}}{2t}$と二つの解を持つが、命題が与える解は
	$x=\frac{1-\sqrt{1-4t}}{2t}$の方だけになっている。

	\begin{proposition}[ベクトル空間から代数]\label{prop:ベクトル空間から代数} %{
		$A$をベクトル空間、$B$を代数とする。$\odot$を$A$の線形とは限らない
		二項演算とし、$\phi_\pm:A\to B$を次の性質を満たす線形写像とする。
		\begin{equation*}\begin{split}
			(\phi_-x)(\phi_+y) = (\phi_+ + \phi_-)(x\odot y)
			\quad\text{for all } x,y\in A
		\end{split}\end{equation*}
		このとき、$\alpha:A\times\sizen_+\to A$を任意の$x\in A$に対して
		次のように定義し、
		\begin{equation*}\begin{array}{rcll}
			\alpha_1x &=& x \\
			\alpha_2x &=& x\odot x \\
			\alpha_3x &=& (x\odot x)\odot x + x\odot(x\odot x) \\
			\cdots \\
			\alpha_{n+1}x &=& \sum_{p=1}^n (\alpha_px)\odot(\alpha_{n+1-p}x)
			& \quad\text{for all } n\in\sizen_+
		\end{array}\end{equation*}
		写像$\psi_\pm:A\times\fukuso\to B$を次のように定義すると、
		\begin{equation*}\begin{split}
			\psi_\pm(x,z) = \sum_{n\in\sizen_+}(\phi_\pm\alpha_nx)z^n
			\quad\text{for all } x\in A,\; z\in\fukuso
		\end{split}\end{equation*}
		任意の$n\in\sizen$に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			(\phi_+x + \phi_-x)^n &= \frac{1}{2\pi i} \oint \frac{dz}{z^{n+1}} 
				\bigl(\psi_+(x,z)\bigr)^*\bigl(\psi_-(x,z)\bigr)^* \\
		\end{split}\end{equation*}
	\end{proposition} %prop:ベクトル空間から代数}
	\begin{proof} %{
		命題の複素積分は$z$の冪を抜き出しているだけだから、
		フォック空間$\mycal{H}$を使って証明する。$\psi_{\pm}$と$\phi_{\pm n}$
		を次のように定義し、
		\begin{equation*}\begin{split}
			\psi_\pm := \sum_{n\in\sizen_+}\phi_{\pm n}\eta_+^n
			,\quad \phi_{\pm n} := \phi_\pm\alpha_nx
			\quad\text{for all } n\in\sizen_+
		\end{split}\end{equation*}
		任意の$n\in\sizen$に対して次の式が成り立つことを
		帰納法を使って証明する。
		\begin{equation}\label{eq:証明すべき式その一}\begin{split}
			(\phi_1 + \phi_{-1})^n = \bra{n}\psi_+^*\psi_-^*\ket{0}
		\end{split}\end{equation}
		ここで、任意の$n\in\sizen$に対して$\bra{n}:=\bra{0}\eta_-^n$とする。
		$n=0,1$でこの式が成り立つことは明らかである。
		ある$N\in\sizen_+$でこの式が成り立つと仮定する。
		次の式が成り立っていれば、$n=N+1$でも式\eqref{eq:証明すべき式その一}
		が成り立っていることがわかる。
		\begin{equation}\label{eq:証明すべき式その二}\begin{split}
			\bra{N+1}\psi_+^*\psi_-^*\ket{0}
			= (\phi_1 + \phi_{-1})\bra{N}\psi_+^*\psi_-^*\ket{0}
		\end{split}\end{equation}
		任意の$n\in\sizen$に対して次の式が成り立つことを使って、
		\begin{equation}\label{eq:像の漸化式その一}\begin{split}
			\phi_{n+1} + \phi_{-(n+1)} = \sum_{p=1}^n\phi_{-p}\phi_{n+1-p}
		\end{split}\end{equation}
		$\phi_{-1}\psi_+^*\psi_-^*$を$\eta_+^p\cdots$という形になるように
		$p=N+1$まで計算\ref{eq:計算の途中経過その一}すると次のようになる。
		\begin{equation*}\begin{split}
			\phi_{-1}\psi_+^*\psi_-^*
			&= \biggl(\phi_{-1} + \phi_{-2}\eta_+ +\cdots+ \phi_{-(N+1)}\eta_+^N
				\biggr)\psi_-^* \\
			&\; + \biggl(\phi_2\eta_+ + \phi_3\eta_+^2
				+\cdots+ \phi_{N+1}\eta_+^N\biggr)\psi_+^*\psi_-^*  \\
			&\; + \phi_{-(N+1)}\eta_+^N\psi_+^+\psi_-^* \\
			&\; + \sum_{n=1}^\infty \biggl(\phi_{-1}\phi_{n+N} 
				+ \phi_{-2}\phi_{n+N-1} +\cdots+ \phi_{-N}\phi_{n+1}\biggr)
				\eta_+^{n+N}\psi_+^*\psi_-^* \\
		\end{split}\end{equation*}
		この計算を用いると次の式が得られる。
		\begin{equation*}\begin{split}
			(\phi_1 + \phi_{-1})\bra{N}\psi_+^*\psi_-^*\ket{0}
			&= \bra{N}\biggl(\phi_{-1} + \phi_{-2}\eta_+
				+\cdots+ \phi_{-(N+1)}\eta_+^N\biggr)\psi_-^*\ket{0} \\
			&\; + \bra{N}\biggl(\phi_1 + \phi_2\eta_+
				+\cdots+ \phi_{N+1}\eta_+^N\biggr)\psi_-^*\ket{0} \\
			&= \bra{N+1}\psi_-^+\ket{0}
				+ \bra{N+1}\psi_+^+\psi_-^*\ket{0} \\
		\end{split}\end{equation*}
		ここで次の式が成り立つことに注意すると、
		\begin{equation*}\begin{split}
			\bra{N+1}\psi_+^*\psi_-^*\ket{0} &= \bra{N+1}\psi_-^*\ket{0}
				+ \bra{N+1}\psi_+^+\psi_-^*\ket{0} \\
			&= \bra{N+1}\psi_-^+\ket{0} + \bra{N+1}\psi_+^+\psi_-^*\ket{0} \\
		\end{split}\end{equation*}
		次の式が成り立つことがわかり、$n=N+1$でも
		式\eqref{eq:証明すべき式その一}が成り立つことが示される。
		\begin{equation*}\begin{split}
			(\phi_1 + \phi_{-1})\bra{N}\psi_+^*\psi_-^*\ket{0}
			= \bra{N+1}\psi_+^*\psi_-^*\ket{0}
		\end{split}\end{equation*}
	\end{proof} %}

	\begin{note}[計算の途中経過その一]\label{note:計算の途中経過その一} %{
	証明中で用いた計算の途中経過を書いておく。
		\begin{equation*}\begin{split}
			\phi_{-1}\psi_+^*\psi_-^*
			&= \phi_{-1}\psi_-^* + \phi_{-1}\psi_+^+\psi_-^* \\
			&= \phi_{-1}\psi_-^* + \phi_2\eta_+\psi_+^*\psi_-^*
				+ \phi_{-2}\eta_+\psi_+^*\psi_-^* + \sum_{n=2}^\infty
				\phi_{-1}\phi_n\eta_+^n \psi_+^*\psi_-^* \\
			&= \biggl(\phi_{-1} + \phi_{-2}\eta_+\biggr)\psi_-^* 
				+ \biggl(\phi_2\eta_+ + \phi_3\eta_+^2\biggr)\psi_+^*\psi_-^* 
				+ \phi_{-3}\eta_+^2\psi_+^*\psi_-^* \\
			&\; + \sum_{n=1}^\infty \biggl(
				\phi_{-1}\phi_{n+2} + \phi_{-2}\phi_{n+1}\biggr)\eta_+^{n+2}
				\psi_+^*\psi_-^* \\
			&= \cdots \\
			&= \biggl(\phi_{-1} + \phi_{-2}\eta_+ +\cdots+ \phi_{-N}\eta_+^{N-1}
				\biggr)\psi_-^* \\
			&\; + \biggl(\phi_2\eta_+ + \phi_3\eta_+^2
				+\cdots+ \phi_{N+1}\eta_+^N\biggr)\psi_+^*\psi_-^*  \\
			&\; + \phi_{-(N+1)}\eta_+^N\psi_+^*\psi_-^* \\
			&\; + \sum_{n=1}^\infty \biggl(\phi_{-1}\phi_{n+N} 
				+ \phi_{-2}\phi_{n+N-1} +\cdots+ \phi_{-N}\phi_{n+1}\biggr)
				\eta_+^{n+N}\psi_+^*\psi_-^* \\
			&= \biggl(\phi_{-1} + \phi_{-2}\eta_+ +\cdots+ \phi_{-(N+1)}\eta_+^N
				\biggr)\psi_-^* \\
			&\; + \biggl(\phi_2\eta_+ + \phi_3\eta_+^2
				+\cdots+ \phi_{N+1}\eta_+^N\biggr)\psi_+^*\psi_-^*  \\
			&\; + \phi_{-(N+1)}\eta_+^N\psi_+^+\psi_-^* \\
			&\; + \sum_{n=1}^\infty \biggl(\phi_{-1}\phi_{n+N} 
				+ \phi_{-2}\phi_{n+N-1} +\cdots+ \phi_{-N}\phi_{n+1}\biggr)
				\eta_+^{n+N}\psi_+^*\psi_-^* \\
		\end{split}\end{equation*}
	\end{note} %note:計算の途中経過その一}

	この命題の二項演算$\odot$が積の場合、命題の中で定義した$\alpha_n$は
	べき乗にCatalan数を掛けたものになる。
	\begin{equation*}\begin{array}{rcll}
		\alpha_nx &=& C_nx^{n+1} &\quad\text{for all } x\in A,\; n\in\sizen \\
		C_n &=& \frac{1}{n+1}\binom{2n}{n} &\quad\text{for all } n\in\sizen \\
	\end{array}\end{equation*}
	したがって次の命題が成り立つ。

	\begin{proposition}[代数から代数]\label{prop:代数から代数} %{
		$A$と$B$を代数とする。$\phi_\pm:A\to B$を次の性質を満たす線形写像
		とする。
		\begin{equation*}\begin{split}
			(\phi_-x)(\phi_+y) = (\phi_+ + \phi_-)(xy)
			\quad\text{for all } x,y\in A
		\end{split}\end{equation*}
		このとき、写像$\psi_\pm:A\times\fukuso\to B$を次のように定義すると、
		\begin{equation*}\begin{array}{rcll}
			\psi_\pm(x,z) &=& \sum_{n\in\sizen_+} C_n(\phi_\pm x^n)z^n
			& \quad\text{for all } x\in A,\; z\in\fukuso \\
			C_n &=& \frac{1}{n+1}\binom{2n}{n} &\quad\text{for all } n\in\sizen \\
		\end{array}\end{equation*}
		任意の$n\in\sizen$に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			(\phi_+x + \phi_-x)^n &= \frac{1}{2\pi i} \oint \frac{dz}{z^{n+1}} 
				\bigl(\psi_+(x,z)\bigr)^*\bigl(\psi_-(x,z)\bigr)^* \\
		\end{split}\end{equation*}
	\end{proposition} %prop:代数から代数}

	幾つか残っている課題を書いておく。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[Yang-Baxter] Yang-Baxter方程式の効用は代数$A$の表現$(\rho_i,V_i)$
		が与えられた時、$R$-行列$R\in A\otimes A$から次の表現のintertwiner
		$\phi:V_1\otimes V_2\to V_2\otimes V_1$を作ることができる点にある。
		\begin{equation*}\begin{split}
			\xymatrix{
				V_1\otimes V_2 \ar[r]^\phi \ar[d]^{(\rho_1\otimes\rho_2)\Delta a} 
				& V_2\otimes V_1 \ar[d]^{(\rho_1\otimes\rho_2)\Delta a} \\ 
				V_1\otimes V_2 \ar[r]^\phi & V_2\otimes V_1 \\ 
			} \quad\text{for all } a\in A
		\end{split}\end{equation*}
		$\phi$は$R$から次のようにして作られ、
		\begin{equation*}\begin{array}{rcll}
			\phi &=& \sigma_{12}\bigl((\rho_1\otimes\rho_2)R\bigr) \\
		\end{array}\end{equation*}
		$R$は次の性質を満たす$A\otimes A$の可逆な元として定義される。
		\begin{equation*}\begin{array}{rcll}
			\sigma_{12}\Delta a &=& R(\Delta a)R^{-1}
			&\quad\text{for all } a\in A \\
			(\Delta\otimes\id)R &=& R_{13}R_{23} \\
			(\id\otimes\Delta)R &=& R_{13}R_{12} \\
		\end{array}\end{equation*}
		ここで、$\sigma_{ij}$はテンソル積の$i$番目と$j$番目の成分を交換する
		作用で、$R_{ij}$は$R=\sum a_i\otimes b_j$とすると次のように定義される。
		\begin{equation*}\begin{split}
			R_{12} = \sum a_i\otimes b_i\otimes \id
			,\quad R_{23} = \sum \id\otimes a_i\otimes b_i
			,\quad R_{13} = \sum a_i\otimes \id\otimes b_i
		\end{split}\end{equation*}
		大事なことは$R$が表現$\rho_i$とは独立に定義されていることである。
		$A$の代数構造からのみ$R$-行列が定義され、それを用いると任意の表現の
		間のintertwinerを作ることができる。$R$-行列が求まらなければ絵に描いた餅
		だが、多くの代数で$R$-行列が求められている。
		Diffie-Hellmanの鍵交換プロトコルを思い出す。
		%
		\item[Lyndon単語] Lie環の量子変形からみでLyndon単語が出てくることがある
		ので、Lyndon単語とはなんぞやということを書いておく。文字$A$から生成
		される単語の集合$\W A$で、文字の位置を巡回させた違いを無視したものを
		Lyndon単語という。式で書くと$\W A$に次の同値関係を定義してその商
		$\W A/\sim$をとったものをLyndon単語（の集合）という。
		\begin{equation*}\begin{split}
			[a_1a_2\cdots a_m] \sim [a_2a_3\cdots a_ma_1]
		\end{split}\end{equation*}
		%
		\item[インデックス言語] 半整数の遷移を使うとインデックス言語を
		セルオートマトンで表現できるかもしれない。例えば、
		$x=a+\sum_{n\in\sizen_+}b^nac^nad^n$というインデックス言語は次の
		ようなセルオートマトンで表すことができる。
		\begin{equation*}\xymatrix@C=1ex{
			& (0,0) & (1/2,0) & (1,0) & (0,1) & (1/2,1) & (1,1) \\
			0 & \circ \ar[rr]^a \ar[d]^b & & \\
			1 & \circ \ar[r]^a \ar[d]^b & \circ \ar[r]^c & \circ \ar[r]^a 
			& \circ \ar[ul]_d \\
			2 & \circ \ar[r]^a \ar[d]^b & \circ \ar[r]^c & \circ \ar[r]^c 
			& \circ \ar[r]^a & \circ \ar[ul]_d \\
			3 & & & & & & \ar[ul]_d \\
		}\end{equation*}
		形式言語と３次元多様体の基本群との関係を論じている論文
		\cite{gilman1996}を思い出す。中身はさっぱりわからんが。
		%
		\item[セルオートマトン] $a$の遷移に射影
		$\pi_0:=1-\sum_{n\in\sizen_+}(\eta_n\eta_{-n}$
		が必要になる気がする。例えば、$x=a+bxxd$という文法の場合、
		射影$\pi_0$がないと、水平方向の周期を$2$とすることができない。
		%
		\item[Yang-Baxter] 命題の証明の中に可積分系での箱玉モデルとよく似た
		構造が現れている。もともとがセルオートマトンとから出発しているので
		当然といえば当然かもしれないが、正規積への描き直しがYang盤を使って
		行うことができるところなどに似た構造があるように思える。現在のところ
		妄想に過ぎないが考えてみる価値はあると思う。
		Rota-Baxter代数に関する論文\cite{aguiar2000}にしたがって、Rota-Baxter
		代数とYang-Baxter方程式との関係を書いておく。
		$A$を代数とし、線形写像$\phi_{ij}:A^{\otimes2}\to A^{\otimes3}$を
		次のように定義し、
		\begin{equation*}\begin{split}
			\phi_{12}(u\otimes v) &= u\otimes v\otimes \id \\
			\phi_{13}(u\otimes v) &= u\otimes \id\otimes v \\
			\phi_{23}(u\otimes v) &= \id\ u\otimes v \\
		\end{split}
			\quad\text{for all } u,v\in A
		\end{equation*}
		線形写像$\phi_{ij}:A^{\otimes2}\to A^{\otimes3}$を次のように定義する。
		\begin{equation*}\begin{split}
			\phi t
			= (\phi_{13}t)(\phi_{12}t) - (\phi_{12}t)(\phi_{23}t)
			+ (\phi_{23}t)(\phi_{13}t)
			\quad\text{for all } t\in A\otimes A
		\end{split}\end{equation*}
		$\phi r=0$を結合的Yang-Baxter方程式、$r\in A^{\otimes2}$をその解という。
		%
		\item[集合] 命題\ref{prop:ベクトル空間から代数}のベクトル空間$A$を集合に
		変えても同様の定理が成り立つはずである。ただし、$A$がベクトル空間
		でないと、$x\in A$に対してべき乗$x^{\otimes n}$が簡潔に表現することが
		できない。$x^{\otimes n}$の代わりに漸化式\eqref{eq:像の漸化式その一}
		によって$\phi_{\pm n}$を定義してしまえばよいかも。
		ただし、漸化式\eqref{eq:像の漸化式その一}から和$\phi_n+\phi_{-n}$を
		定めることはできるが、個々の$\phi_{\pm n}$を定めることはできない。
		この点を考えなくてはならない。
		%
		\item[命題は間違っている] $V$を複素数としたとき命題は次のように
		修正する必要がある。
		\begin{equation*}\begin{split}
			\left\{\begin{split}
				x_t &= \ket{0}(tT)^*a\ket{d:2} \\
				T &= (b\eta_{-1}^*)a(d\eta_2)^*c\eta_1\eta_{-2} \\
			\end{split}\right. \And |t| < \frac{1}{4} \\
			\implies x_t = a + tbx_tcx_td
		\end{split}\end{equation*}
		左辺の真空期待値が無条件に右辺の多項式の正級数解になるわけではない。
		多分命題は
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $V$を複素数上の代数に限定して、
			\item $V$の完備化を仮定して、
		\end{itemize} %}
		次のように修正されるべきだろう。
		\begin{equation*}\begin{split}
			\left\{\begin{split}
				x_t &= \ket{0}(tT)^*a\ket{d:2} \\
				T &= (b\eta_{-1}^*)a(d\eta_2)^*c\eta_1\eta_{-2} \\
			\end{split}\right. \implies \exists\; t\in\fukuso \text{ such that }
			x_t = a + tbx_tcx_td
		\end{split}\end{equation*}
		$\implies$ $V$上の形式級数環$V[[t]]$を考えて$V[t]$から$V$への写像を
		文法によって定義する。例えば、$V[[t]]$から$V$への写像を次のように
		定義する。
		\begin{equation*}\begin{split}
			x_t = a + bx_tcx_td \quad\text{where }a,b,c,d\in 
		\end{split}\end{equation*}
		完備化をしないと形式級数環$V[[t]]$は定義できないかもしれないが、
		級数が収束することを気にすることなく議論を進めることができるのでは
		ないだろうか。
		%
		\item[サブセット構成法] 代数方程式$x=a+bxcxd$を一次近似して
		$y=a+b(\xi_{-1}a\xi_1)c(\xi_{-2}a\xi_2)d$という代数方程式を考える。
		ここで、$\xi_{\pm i}$は$V$の元と非可換な文字とする。
		%
		\item[変形] 対称的な形にすると次のようになり、
		\begin{equation*}\begin{split}
			T_+f = fd(d\eta_2)^*\eta_1,\quad 
			T_-f = \eta_{-2}(b\eta_{-1})^*bf
		\end{split}\end{equation*}
		次の式を満たす。
		\begin{equation*}\begin{split}
			(T_-f)c(T_+g) = (T_+ + T_-)(bfcgd)
		\end{split}\end{equation*}
		そして、$T_\pm$の中のKleeneスターを$n$で打ち切ったものを$[T_\pm]_n$
		とすると、
		\begin{equation*}\begin{split}
			[T_+]_nf = fd\frac{1 - (d\eta_2)^{n+1}}{1 - d\eta_2}\eta_1,\quad 
			[T_-]_nf = \eta_{-2}\frac{1 - (b\eta_{-1})^{n+1}}{1 - b\eta_{-1}}bf
		\end{split}\end{equation*}
		次の式を満たす。
		\begin{equation*}\begin{split}
			([T_-]_{m+1}f)c([T_+]_{n+1}g) &= ([T_-]_m + [T_+]_n)(bfcgd) \\
			([T_-]_{m+1}f)c([T_+]_0g) &= [T_-]_m(bfcgd) \\
			([T_-]_0f)c([T_+]_{n+1}g) &= [T_+]_n(bfcgd) \\
			([T_-]_0f)c([T_+]_0g) &= 0 \\
		\end{split}\end{equation*}
		Kleeneスターの打ち切り$n$を変形パラメーターとして$T_\pm$から元の
		線形な式を得られないものだろうか？
		%
		\item[組み合わせの数] 二次式ですべての係数が$1$の場合（$x=1+x^2$）、
		摂動計算はカタラン数を与えるだけである。カタラン数のような組み合わせの
		数に興味がない場合は、$x=1+x^2$の効果を抜き出してしまいたい。
		\begin{equation*}\begin{array}{rcll}
			x &=& a + bxcxd,&\quad x = \sum_{n\in\sizen} x_n \\
			k &=& 1 + k^2,&\quad k = \sum_{n\in\sizen} k_n \\
		\end{array}\end{equation*}
		とした場合、$\sum_{n\in\sizen}x_n/k_n$はどのような代数方程式を満たす
		だろうか？
		%
		\item[カウンターオートマトン] 二次元セルオートマトン
		\eqref{eq:二次式のセルオートマトンその一}
		\eqref{eq:二次式のセルオートマトンその二}
		\eqref{eq:セルオートマトンでの真空期待値}
		をプログラムで実装すると、二つのカウンターを持ったカウンターオートマトン
		として実装することができる（$\mycal{H}\otimes\mycal{H}$）。
		一方、スタックを用いたオートマトン\eqref{eq:二次式の正級数解その一}
		をプログラムで実装すると、二つの文字を要素として持つ一つのスタックとして
		実装することができる（$\mycal{H}_2$）。このことを数学的にみたものが、
		$1:1$の代数射\eqref{eq:一対一の代数射その一}とその表現空間の$1:1$対応
		になっている。そこで問題：
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item 二次式の場合と同様に、多項式$x=a+bx^nd$$n$に対して、
			文字のカウンターオートマトンと$n$文字を要素とするスタックオートマトン
			との対応をつけることは可能か？
		\end{itemize} %}
		%
		\item[空遷移] パーシングの話での空遷移を一般の代数の話に持って行くと
		代数の中心となるだろう。したがって、係数$a,b,c,d$に代数の中心が含まれて
		いる場合を考えればよいだろう。$a,b,c$がそれぞれ$1$の場合の
		二次元セルオートマトンを考えれば次のようになるだろう。
		\begin{equation*}\begin{array}{ccc}
			b = 1 & d = 1 & c = 1 \\
			\xymatrix@R=4ex@C=4ex{
				\circ \ar[r]^a & \circ \ar[d]^c \\
				& \circ \ar[r]^a & \circ \ar[d]^c\ar[ul]_d \\
				& & & \ar[ul]_d \\
			} & \xymatrix@R=4ex@C=4ex{
				\circ \ar[d]^b \ar[r]^a & \circ \\
				\circ \ar[r]^a \ar[d]^b & \circ \ar[ul]_c \\
				& \ar[ul]_c \\
			} & \xymatrix@R=4ex@C=4ex{
				\circ \ar[d]^b \ar[r]^a & \circ \\
				\circ \ar[r]^a \ar[d]^b & \circ \ar[r]^a \ar[drr]^b 
					& \circ \ar[ul]_d \\
				& & \ar[ul]_d & & & \ar[ulll]_d \\
			}
		\end{array}\end{equation*}
		サブセット構成法を用いてこのセルオートマトンもしくはスタックオートマトン
		を構成できないだろうか？
		%
		\item[摂動] Dyck言語$x_t=a+tbx_t^2d$の摂動展開
		$x_t=\sum_{n\in\sizen}t^nx_n$は$x_{n+1}=\sum_{p=0}^nbx_{n-p}x_pd$
		という漸化式を満たす。摂動係数$x_n$を自然数から半代数$V$への写像の像
		と思うと、自然数の余積
		$m_\sizen^\tran\ket{n}=\sum_{p=0}^n\ket{n-p}\otimes\ket{p}$と
		インクリメント$\eta_+\ket{n}=\ket{n+1}$を用いて、漸化式は
		$x\eta_+=\beta(x\otimes x)m_\sizen^\tran$と書くことができる。
		ここで、$\beta(f\otimes g)=bfgd$とする。可換図で書くと次のように
		表される。
		\begin{equation*}\xymatrix@C=6em{
			\sum_{p=0}^n \ket{n-p}\otimes\ket{p} \ar@{|->}[d]^{x\otimes x}
				& \ket{n} \ar@{|->}[l]_{m_\sizen^\tran} \ar@{|->}[d]^{x\eta_+} \\
			\sum_{p=0}^n x_{n-p}\otimes x_{p} \ar@{|->}[r]^\beta & x_{n+1} \\
		}\end{equation*}
		%
		\item[優先順位] 代数方程式$x=a+xcx$の正級数解はカタラン数$C_n$を用いて
		$x=\sum_{n\in\sizen}C_n(ac)^na$と書ける。カタラン数が出てくる起源は
		二項演算$f\odot g=fcg$を適用していく方法の和にある。例えば、次のように
		なっている。
		\begin{equation*}\begin{split}
			C_1(ac)a &= a\odot a \\
			C_2(ac)^2a &= (a\odot a)\odot a + a\odot(a\odot a) \\
			C_3(ac)^3a &= ((a\odot a)\odot a)\odot a 
				+ (a\odot(a\odot a))\odot a \\
			&\; + (a\odot a)\odot(a\odot a) \\
			&\; + a\odot(a\odot(a\odot a))
				+ a\odot((a\odot a)\odot a) \\
		\end{split}\end{equation*}
		ここで、二項演算$\odot$を$(a\odot a)\odot a=0$と変更すると、
		次のように変更される。
		\begin{equation*}\begin{split}
			(ac)a &= a\odot a \\
			(ac)^2a &= a\odot(a\odot a) \\
			(ac)^3a &= a\odot(a\odot(a\odot a)) \\
		\end{split}\end{equation*}
		パーシングの場面で考えると、パース結果の木構造が次のように絞られることに
		対応する。
		\begin{equation*}\begin{split}
			\xymatrix@R=2ex@C=2ex{
				& & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] & c & a \\
				a & c & a
			} + \xymatrix@R=2ex@C=2ex{
				& & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& a & c & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& & a & c & a
			} \xmapsto{(aca)ca=0} \xymatrix@R=2ex@C=2ex{
				& & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& a & c & \circ \ar@{-}[dl] \ar@{-}[d] \ar@{-}[dr] \\
				& & a & c & a
			}
		\end{split}\end{equation*}
		確率$\mu_1+\mu_2=1,\;\nu_1+\cdots+\nu_5=1$を導入して考えると
		次のようになるだろう。
		\begin{equation*}\begin{split}
			(ac)a &= a\odot a \\
			(ac)^2a &= \mu_1(a\odot a)\odot a + \mu_2a\odot(a\odot a) \\
			(ac)^3a &= \nu_1((a\odot a)\odot a)\odot a 
				+ \nu_2(a\odot(a\odot a))\odot a \\
			&\; + \nu_3(a\odot a)\odot(a\odot a) \\
			&\; + \nu_4{2}a\odot(a\odot(a\odot a))
				+ \nu_5a\odot((a\odot a)\odot a) \\
		\end{split}\end{equation*}
		確率変数$\mu_i,\nu_i,\dots$を決める都合の良い方法はないだろうか？
		一つの方法として、$x=a+xcx$をパースした結果を二分木としてみた場合、
		左の降りていくときは$\mu_1$、右の降りていくときは$\mu_2$とすると、
		次のようになる。
		\begin{equation*}\begin{split}
			(ac)a &= a\odot a \\
			(ac)^2a &= \mu_1(a\odot a)\odot a + \mu_2a\odot(a\odot a) \\
			(ac)^3a &= (\mu_1^3)((a\odot a)\odot a)\odot a 
				+ (\mu_1^2\mu_2)(a\odot(a\odot a))\odot a \\
			&\; + 2(\mu_1\mu_2)(a\odot a)\odot(a\odot a) \\
			&\; + (\mu_2^3){2}a\odot(a\odot(a\odot a))
				+ (\mu_1\mu_2^2)a\odot((a\odot a)\odot a) \\
		\end{split}\end{equation*}
		%
		\item[一般化] 命題を一般化する方法は幾つかあるだろうが、その一つとして、
		次のように写像$\phi: R\W A[x]\to R\W A$を定義して、
		\begin{equation*}\begin{split}
			\phi: f \mapsto x \text{ such that } x = 1 + fx
		\end{split}\end{equation*}
		$\phi$によって$R\W A[x]$の代数構造がどのように移されるかを調べる方法
		があると思う。
		\begin{equation*}\begin{split}
			(\phi f)\times (\phi g) &\mapsto \phi(f + g) \\
			(\phi f)\times (\phi g) &\mapsto \phi(fg) \\
		\end{split}\end{equation*}
		%
		\item[完備化] 命題の証明の中で無限長の文字列が$0$になるということを
		使いまくっている。このことを正当化するためには、$R\W A$において完備化
		をしておく必要がある。完備化は一意でないために、形式級数を扱う場合、
		完備化の方法によって計算結果が変わってくる。したがって、どのように完備化
		したかを明示する必要がある。
		%
		\item[冪等半体] パーシングの場合、係数$R$については$0$かそれ以外かにしか
		興味がない。したがって、$R$を冪等半体として取り扱うことになる。
		そして、$R$が冪等半体の場合には単に係数の処理が簡単になるというだけで
		なく、フォック空間が不必要になることがある。例えば、
		代数方程式$x=a+xcx$は$R$が一般の半体の場合には次のようになるが、
		\begin{equation*}\begin{split}
			x &= a + ac\Braket{\eta_{-1}^*\biggl(ac\bigl(
				\eta_2^*\eta_1+\eta_{-2}\eta_{-1}^*\bigr)\biggr)^*\eta_2^*}a \\
		\end{split}\end{equation*}
		$R$が冪等半体の場合には次のようになる。
		\begin{equation*}\begin{split}
			x &= (ac)^*a
		\end{split}\end{equation*}
		$R$が一般の半体の場合にはカタラン数$C_n$を与えるために真空期待値
		\begin{equation*}\begin{split}
			C_{n+1} = \Braket{\eta_{-1}^*\biggl(ac\bigl(
				\eta_2^*\eta_1+\eta_{-2}\eta_{-1}^*\bigr)\biggr)^n\eta_2^*}
		\end{split}\end{equation*}
		の計算が必要になるが、$R$が冪等半体の場合にはこの計算が不必要になる。
		パーシングに適用した場合、真空期待値の計算は実行時におけるスタックの
		プッシュ/ポップ操作に対応するので、真空期待値の計算はなるべく避けたい。
		そのために、冪等半体の場合にのみ成り立つ特殊事情について考察する必要
		がある。（Max-Plus？）
		%
		\item[空遷移] 二次式$x=a+bxcxd$において係数$a,b,c,d\in R\W A$が
		単位元（空の文字列）を含む場合、状態遷移が非決定的になる。
		決定的な状態遷移を得るためには、単位元の部分を消去する必要がある。
		例えば、$b=d=1$とすると、摂動の漸化式は次のようになり、
		\begin{equation*}\begin{split}
			\left\{\begin{split}
				x_t &= a + tx_tcx_t \\
				x_t &= \sum_{n\in\sizen}t^nx_n
			\end{split}\right.  \implies \left\{\begin{split}
				x_0 &= a \\
				x_{n+1} &= \sum_{p=0}^n x_{n-p}cx_p
			\end{split}\right.
		\end{split}\end{equation*}
		$C_n\in R$として$x_n=C_n(ac)^na$と仮定すると、漸化式より、
		\begin{equation*}\begin{split}
			x_{n+1} = C_{n+1}(ac)^{n+1}a,\quad C_{n+1} = \sum_{p=0}^n C_{n-p}C_p
		\end{split}\end{equation*}
		となり、$C_n$は頂点数が$n$の平面二分木の数となることがわかり、
		$C_n$は次の$R$上の代数式の摂動係数として与えられる。
		\begin{equation*}\begin{split}
			x = 1 + tx^2 &\iff x = \frac{1\pm\sqrt{1 - 4t}}{2t}
			\implies \frac{1 - \sqrt{1 - 4t}}{2t} = \sum_{n\in\sizen}t^nC_n \\
			&\implies C_n = \frac{1}{n+1}\binom{2n}{n}
				\quad\text{for all } n\in\sizen \\
			&\quad\because\quad (1 - 4t)^{\frac{1}{2}} 
			= 1 - 2t\sum_{n\in\sizen} \frac{t^n}{n+1}\binom{2n}{n} \\
		\end{split}\end{equation*}
		$\set{C_n\in\sizen\bou n\in\sizen}$はカタラン数と呼ばれる数列である。
		代数方程式を真空期待値で表すと次のようになるから、
		\begin{equation*}\begin{split}
			x &= \Braket{\bigl(ac\eta_{-1}^*\eta_2^*\eta_1\eta_{-2}
				\bigr)^*\eta_2^*}a \\
			&= a + ac\Braket{\eta_{-1}^*\biggl(ac\bigl(
				\eta_2^*\eta_1+\eta_{-2}\eta_{-1}^*\bigr)\biggr)^*\eta_2^*}a \\
		\end{split}\end{equation*}
		カタラン数は次のように書けることがわかる。\footnote{
			カタラン経路の足し上げをフォック空間で表すと、カタラン数は一組の
			生成消滅演算子だけで次のように書くこともできる。
			\begin{equation*}\begin{split}
				C_{n+1} = \Braket{\bigl(\eta_+ + \eta_-\bigr)^{2n}}
				\quad\text{for all } n\in\sizen
			\end{split}\end{equation*}
			したがって、式\eqref{eq:カタラン数の二組表示}はある変換でこの式に
			なることが予想される。
		}
		\begin{equation}\label{eq:カタラン数の二組表示}\begin{split}
			C_{n+1} = \Braket{\eta_{-1}^*\bigl(
				\eta_2^*\eta_1 + \eta_{-2}\eta_{-1}^*\bigr)^n\eta_2^*}
				\quad\text{for all } n\in\sizen
		\end{split}\end{equation}
	\end{description} %}
%s1:二次方程式の正級数解}
\section{N次方程式の正級数解}\label{s1:N次方程式の正級数解} %{
	前節の二次方程式の正級数解の求め方を拡張して$N$次方程式の正級数解を
	求めることを考える。次の$N$次方程式を考える。
	\begin{equation}\label{eq:求めるN次式}\begin{split}
		x = a + bxc_1x\cdots c_{N-1}xd
		\quad\text{where } a,b,d,c_1,\dots,c_{N-1}\in V
	\end{split}\end{equation}
	セルオートマトン\eqref{eq:二次式のセルオートマトンその一}を拡張すること
	からスタートする。例えば、$N=3$の場合は次のようになる。
	\begin{equation*}\xymatrix@C=2ex{
		\sizen & 0 & 0 & 1 & 1 & 2 & 2 & 3 & 3 & 4 & 4 & 5 & 5 \\
		\sizen_2 & + & - & + & - & + & - & + & - & + & - & + & - \\
		0 & \circ \ar[r]^a \ar[d]^b & \circ & \circ \ar[r]^a  \ar[drrrr]^b 
			& \circ & \circ \ar[r]^a & \circ & \circ \ar[r]^a & \circ
			& \circ \ar[r]^a & \circ & \circ \ar[r]^a & \circ  \\
		1 & \circ \ar[r]^a \ar[d]^b & \circ \ar[r]^{c_1}
			& \circ \ar[r]^a \ar[drrrr]^b & \circ \ar[r]^{c_2} 
			& \circ \ar[r]^a & \circ \ar[ullll]_d 
			%
			& \circ \ar[r]^a & \circ \ar[r]^{c_1}
			& \circ \ar[r]^a & \circ \ar[r]^{c_2} 
			& \circ \ar[r]^a & \circ \ar[ullllllll]_d \\
			%
		2 & \circ \ar[r]^a & \circ \ar[r]^{c_1}
			& \circ \ar[r]^a & \circ \ar[r]^{c_2} 
			& \circ \ar[r]^a & \circ \ar[ullll]_d 
			%
			& \circ \ar[r]^a & \circ \ar[r]^{c_1}
			& \circ \ar[r]^a & \circ \ar[r]^{c_2} 
			& \circ \ar[r]^a & \circ \ar[ullllllll]_d \\
			%
	}\end{equation*}
	$(\sizen_2,\sizen,\sizen)$の最初の二つをセルオートマトンでの水平軸、
	最後の自然数を垂直軸として書くと、状態遷移は次のようになる。
	\begin{equation*}\begin{array}{rcrcrl}
		a &:& (+,m,n) &\mapsto& (-,m,n) \\
		c_i &:& (-,Nm+i-1,n+1) &\mapsto& (+,Nm+i,n+1)
			& \quad\text{for all } i=1,\dots,N-1 \\
		b &:& (+,m,n) &\mapsto& (+,Nm,n+1) \\
		d &:& (-,Nm + N-1,n+1) &\mapsto& (-,m,n) \\
	\end{array}\end{equation*}
	これを行列の形で書くと次のようになる。
	\begin{equation}\label{eq:N次代数方程式のセルオートマトン}\begin{split}
		x = m_V\bra{0}\otimes\bra{0}\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b\beta & a \\
			c_1\gamma_1 +\cdots+ c_{N-1}\gamma_{N-1} & d\delta \\
		\end{pmatrix}\begin{pmatrix}
			1 \\ 0
		\end{pmatrix}\ket{0}\otimes\ket{0}
	\end{split}\end{equation}
	ここで、$m_V$は$V$の積とし、$\beta,\delta$と$\gamma_i,\;i=1,\dots,N$を
	次のように定義する。
	\begin{equation*}\begin{array}{rclrcll}
		\gamma_i &=& \eta_-^{i-1}C\eta_-^i\otimes\eta_+\eta_-,
			&\quad C &=& \sum_{m\in\sizen}\ket{Nm}\bra{Nm} \\
		\beta &=& B_-\otimes\eta_-,
			&\quad B_- &=& \sum_{m\in\sizen}\ket{m}\bra{Nm} \\
		\delta &=& \eta_+^{N-1}B_+\otimes\eta_+,
			&\quad B_+ &=& \sum_{m\in\sizen}\ket{Nm}\bra{m} \\
	\end{array}\end{equation*}
	ここで、$\zeta_{\pm i},\;i=1,\dots,N$を次のように定義すると、
	\begin{equation*}\begin{split}
		\zeta_i := \eta_+^{i-1}\otimes\eta_+,\quad \zeta_{-i} := \zeta_i^\tran
	\end{split}\end{equation*}
	$\beta,\delta,\gamma_i$はそれぞれ次のように書ける。
	\begin{equation*}\begin{array}{rcll}
		\beta = \zeta_{-1},\quad \delta = \zeta_N,\quad
		\gamma_i &= \zeta_i\zeta_{-(i+1)} \quad\text{for all } i = 1,\dots,N-1
	\end{array}\end{equation*}
	そして、前節の議論と同様にして$\set{\zeta_{\pm i}\bou i=1,\dots,N}$から
	生成される代数と$\mycal{H}_N$が代数同型になることが示され、
	セルオートマトンによる正級数解\eqref{eq:N次代数方程式のセルオートマトン}
	は$\mycal{H}_N$による次の式に等しくなることがわかる。
	\begin{equation}\label{eq:N次式の正級数解その一}\begin{split}
		x = \bra{0}\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b\eta_{-1} & a \\
			c_1\eta_1\eta_{-2} +\cdots+ c_{N-1}\eta_{N-1}\eta_N & d\eta_{-N} \\
		\end{pmatrix}\begin{pmatrix}
			1 \\ 0
		\end{pmatrix}\ket{0}
	\end{split}\end{equation}
	この式が代数方程式$x=a+bc_1x\cdots c_{N-1}xd$の正級数解を与えることを
	代数的に証明しておく。

	\begin{proposition}[N次式の正級数解]\label{prop:N次式の正級数解} %{
		任意の$2$以上の自然数$N$に対して$\mycal{H}_N$の真空期待値
		\eqref{eq:N次式の正級数解その一}は代数方程式\eqref{eq:求めるN次式}の
		正級数解となる。
		\begin{equation*}\begin{split}
			x = \bra{0}\begin{pmatrix}
				1 & 0
			\end{pmatrix}\begin{pmatrix}
				b\eta_{-1} & a \\
				c_1\eta_1\eta_{-2} +\cdots+ c_{N-1}\eta_{N-1}\eta_N & d\eta_{-N} \\
			\end{pmatrix}^*\begin{pmatrix}
				0 \\ 1
			\end{pmatrix}\ket{0} \\
			\implies x = a + bxc_1x\cdots c_{N-1}xd
		\end{split}\end{equation*}
	\end{proposition} %prop:N次式の正級数解}
	\begin{proof} %{
		二次方程式の場合と同様にして証明する。命題の代数方程式の正級数解を
		$x=\sum_{n\in\sizen}x_n$とすると、各級数は次の漸化式を満たす。
		\begin{equation*}\begin{split}
			x_0 = a,\quad 
			x_{n+1} = \sum_{p_1+\cdots+p_N=n} 
				bx_{p_1}c_1x_{p_2}\cdots c_{N-1}x_{p_N}d
				\quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		ここで、$\sum_{p_1+\cdots+p_N=n}$は
		$\sum_{p_1,\dots,p_N\in\sizen}\jump{p_1+\cdots+p_N=n}$を略記したもの
		とする。
		二次元行列の対角成分について
		Kleeneスターを展開すると次の式が得られる。
		\begin{equation*}\begin{split}
			x = \braket{0|X},\quad
			\ket{X} := T^*a\ket{d:2},\quad
			T := (b\eta_{-1}^*)a(d\eta_N)^*\gamma \\
			\gamma := c_1\eta_1\eta_{-2} +\cdots+ c_{N-1}\eta_{N-1}\eta_{-N}
		\end{split}\end{equation*}

		\begin{todo}[この先]\label{todo:この先} %{
			生き残るのは$\bra{0}T^{n(N-1)}a\ket{d:2}$という$T^{N-1}$のべき乗の
			項だけになることを示し、$T^{N-1}$のKleeneスターを正規積の形に
			書き直す。上手く行けば正規積の形を求めることができる。
		\end{todo} %todo:この先}
		$T_+$と$T_{-i},\;i=1,\dots,N-1$を、任意の$f\in V$に対して次のように
		おくと、
		\begin{equation*}\begin{array}{rclcl}
			T_+f &:=& (d\eta_2)^*\gamma &=& f(d\eta_N)^*\gamma \\
			T_{-i}f &:=& (b\eta_{-1})^*\gamma^i 
				&=& (b\eta_{-1})^*bfc_1\cdots c_i\eta_{-(i+1)} \\
		\end{array}\end{equation*}
		$T=(T_++T_{-1})a$と書くことができる。
	\end{proof} %}
	\begin{note}[memo]\label{note:memo} %{
		lets look at $\gamma$. $\gamma^n$ is the following form:
		\begin{equation*}\begin{split}
			\gamma^n = \sum_{i=1}^{N-n} c_i\cdots c_{i+n} \eta_i\eta_{-(i+n)}
			\quad\text{for all } n=1,\dots,N-1
		\end{split}\end{equation*}
		, and $\gamma^N=0$ implies $\gamma^m\gamma^n=\jump{m+n<N}\gamma^{m+n}$.
		actions of $\gamma$ to $\eta_{\pm m}$ are the followings
		for all $1\le m,n< N$:
		\begin{equation*}\begin{split}
			\eta_{-m}\gamma^n &= \jump{m+n\le N} c_1\cdots c_n\eta_{-(m+n)} \\
			\gamma^n\eta_m &= \jump{n+1\le m} c_1\cdots c_n\eta_{m-n} \\
		\end{split}\end{equation*}
		. these actions are showing the following correspondance:
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $\gamma$ is an annihilation operator.
			\item $\eta_1$ is a vaccume and $\eta_{-1}$ is its dual.
			\item $\eta_i,\;i=2,\dots,N-1$ are exicted states.
		\end{itemize} %}
		.
	\end{note} %note:memo}
%s1:N次方程式の摂動}
	%
}\endgroup %}
