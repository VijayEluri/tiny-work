\begingroup %{
\newcommand{\W}{\mycal{W}}
\newcommand{\T}{\mycal{T}}
\newcommand{\B}{\mycal{B}}
\newcommand{\D}{\mycal{D}}
\newcommand{\Pow}{\mycal{P}}
\newcommand{\End}{\myop{End}}
\newcommand{\Map}{\myop{Map}}
\newcommand{\Lin}{\myop{Lin}}
\newcommand{\Aut}{\myop{Aut}}
\newcommand{\Mat}{\myop{Mat}}
\newcommand{\Hom}{\myop{Hom}}
%
\newcommand{\id}{\myop{id}}
\newcommand{\tran}{\mathbf{t}}
\newcommand{\dfn}{\,\myop{def}\,}
\newcommand{\xiff}[2][]{\xLongleftrightarrow[#1]{#2}}
\newcommand{\tr}{\myop{tr}}
%
\newcommand{\mvec}[2]{\begin{matrix}{#1}\\{#2}\end{matrix}}
\newcommand{\pvec}[2]{\begin{pmatrix}{#1}\\{#2}\end{pmatrix}}
\newcommand{\bvec}[2]{\begin{bmatrix}{#1}\\{#2}\end{bmatrix}}
\newcommand{\rvec}[1]{\overrightarrow{#1}}
\newcommand{\lvec}[1]{\overleftarrow{#1}}
\newcommand{\what}{\widehat}
\newcommand{\wbar}{\widebar}
\newcommand{\frk}[1]{\ensuremath{\mathfrak{#1}}}
\newcommand{\ad}{\myop{ad}}
\newcommand{\Ad}{\myop{Ad}}
%
\newcommand{\Alp}[1]{\ensuremath{\,'{#1}'\,}}
\newcommand{\eos}{\ensuremath{\$}}
%
\newcommand{\tofrom}[2]{\underset{#2}{\overset{#1}{\rightleftarrows}}}
\newcommand{\fromto}[2]{\underset{#2}{\overset{#1}{\leftrightarrows}}}
%
\newcommand{\lr}[1]{\left({#1}\right)}
\newcommand{\glr}[1]{\bigl({#1}\bigr)}
\newcommand{\gglr}[1]{\Bigl({#1}\Bigr)}
\newcommand{\ggglr}[1]{\biggl({#1}\biggr)}
\newcommand{\gggglr}[1]{\Biggl({#1}\Biggr)}
%
\newcommand{\glrb}[1]{\bigl[{#1}\bigr]}
\newcommand{\gglrb}[1]{\Bigl[{#1}\Bigr]}
\newcommand{\ggglrb}[1]{\biggl[{#1}\biggr]}
\newcommand{\gggglrb}[1]{\Biggl[{#1}\Biggr]}
%
%\newcommand{\ldyck}{\lceil}
%\newcommand{\rdyck}{\rceil}
\newcommand{\ldyck}{[}
\newcommand{\rdyck}{]}
\newcommand{\dyck}[1][]{\ldyck{#1}\rdyck}
\newcommand{\gdyck}[1]{\bigl\ldyck{#1}\bigr\rdyck}
\newcommand{\ggdyck}[1]{\Bigl\ldyck{#1}\Bigr\rdyck}
\newcommand{\gggdyck}[1]{\biggl\ldyck{#1}\biggr\rdyck}
\newcommand{\ggggdyck}[1]{\Biggl\ldyck{#1}\Biggr\rdyck}

\newcommand{\qbinom}[2]{\genfrac{[}{]}{0pt}{0}{#1}{#2}}

\newcommand{\Brz}{\mycal{B}}
\newcommand{\cat}[1]{\mybf{{#1}}}
\newcommand{\onto}{\myop{onto}}
\newcommand{\Maybe}{\myop{Maybe}}
\newcommand{\dabs}[1]{\left\lVert{#1}\right\rVert}
%
\newcommand{\smallxy}[1]{\vcenter{\xymatrix@R=4pt@C=4pt{#1}}}
\newcommand{\hen}{\ar@{-}}
\newcommand{\er}{\ar@{-}}
%
\newcommand{\wordu}{1_\W}
\newcommand{\treeu}{1_\T}
\newcommand{\Path}{\mycal{P}}
\newcommand{\brz}{Brzozowski}
%
{\setlength\arraycolsep{2pt}
%
\section{覚書}\label{s1:覚書} %{
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item Redfordの定理 \\
		体上の有限次元Hopf代数は行列Hopf代数となる。
	\end{itemize} %}
\subsection{単純と直和}\label{s2:単純と直和} %{
	$R$を一般の環、$V$を$R$-加群とする。
	indecomposableの日本語訳を知らないので、ここでは分解不可と訳しておく。

	単純と分解不可は次のように定義される。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[単純] $V$の部分空間で$R$の作用で閉じている部分空間は$V$自身または
		$\set{0}$だけとなるとき、$V$を単純という。
		\item[半単純] $V$が単純な部分空間の直和になっているとき、$V$を半単純
		という。
		\item[分解不可] $V$の直和分解が$\set{0}\oplus V$または$V\oplus\set{0}$
		に限られるとき、$V$を分解不可という。
	\end{description} %}
	$2$次元ベクトル空間をオートマトンとして書くと次のようになっている。
	\begin{equation*}\begin{array}{ll}
		1 \to 2 &\quad 1 \tofrom{}{} 2 \\
		\text{単純でない} &\quad \text{単純} \\
		\text{分解不可} &\quad \text{分解不可} \\
	\end{array}\end{equation*}
	一般に、単純$\implies$分解不可、となる。有理言語の分類を考える場合、
	単純という性質はオートマトンと記述するのには厳しすぎる性質である。
	閉路だけから構成されるオートマトンのみが単純になる。
%s2:単純と直和}
\subsection{箙の表現と有限オートマトン}
\label{s2:箙の表現と有限オートマトン} %{
	箙の表現とオートマトンは同じものを扱っているように見える。

	簡単な例を使って考えてみる。
	次の箙$Q$から作られる経路代数$RQ$を考える。
	\begin{equation*}\begin{split}
		Q := \xymatrix{
			x \ar@/_1ex/[r]_c \ar@(lu,ld)_b & y \ar@/_1ex/[l]_a
		}
	\end{split}\end{equation*}
	$Q_0$を$Q$の頂点の集合、$Q_1$を$Q$の辺の集合とする。
	$[i,j]\subset Q_1^*,\;i,j=x,y$を、頂点$j$から頂点$i$に至る経路
	によって生成される自由モノイド$Q_1^*$の元の集合とする。
	$\sum[i,j]:=\sum_{w\in[i,j]}w$と略記すると次の漸化式が成り立つ。
	\begin{equation*}\begin{split}
		\begin{pmatrix}
			\sum[x,x] & \sum[x,y] \\ \sum[y,x] & \sum[y,y]
		\end{pmatrix} = \begin{pmatrix}
			1 & 0 \\ 0 & 1
		\end{pmatrix} + \begin{pmatrix}
			b & a \\ c & 0
		\end{pmatrix}\begin{pmatrix}
			\sum[x,x] & \sum[x,y] \\ \sum[y,x] & \sum[y,y]
		\end{pmatrix}
	\end{split}\end{equation*}
	任意の$i,j,k\in\set{x,y}$に対して次の式が成り立つが、
	\begin{equation*}\begin{split}
		w_1w_2\in[i,k] \quad\text{for all } w_1\in[i,j],\; w_2\in[j,k]
	\end{split}\end{equation*}
	これを拡張して、$Q_1^\circ\subset Q_1^*$を次のようにおき、
	\begin{equation*}\begin{split}
		Q_1^\circ := \cup_{i,j=x,y}[i,j]
	\end{split}\end{equation*}
	$RQ_1^\circ$に積$m_*$を次のように定義する。
	\begin{equation*}\begin{split}
		w_1*w_2 := \begin{cases}
			w_1w_2, &\text{ iff } j=k \\
			0, &\text{ otherwise } \\
		\end{cases} \quad\text{for all } w_1\in[i,j],\; w_2\in[k,l]
	\end{split}\end{equation*}
	$R$-代数$(RQ_1^\circ,m_*,1)$を$Q$の経路代数といい、$RQ$と書かれる。
	$RQ$は次のように書くこともできる。
	\begin{equation*}\begin{split}
		R\Gamma = \frac{R\Braket{a,b,c}}{\Braket{a^2=ba=cb=c^2=0}}
	\end{split}\end{equation*}

	箙の経路代数とオートマトンとはよく似ている。ここでは、次の言葉の
	使い方をする。
	\begin{equation}\begin{array}{l|ll}
		\text{グラフ表現} & \text{箙} & \text{遷移図} \\
		\text{代数} & \text{箙の経路代数} & \text{オートマトン} \\
	\end{array}\end{equation}
	大雑把には、箙と遷移図はグラフの書き方が違うだけである。
	文字$e\in Q_1$の{\brz}微分を$e^\dag$と書くと、箙と遷移図は次のような関係
	になる。
	\begin{equation*}\begin{array}{ccccc}
		\text{quiver} &\quad& &\quad& \text{autoamton} \\
		\xymatrix{
			x \ar@/_1ex/[r]_c \ar@(lu,ld)_b & y \ar@/_1ex/[l]_a
		} &\iff& \xymatrix{
			x \ar@/^1ex/[r]^{a^\dag} \ar@(ld,lu)^{b^\dag} 
			& y \ar@/^1ex/[l]^{c^\dag}
		} &\mapsto& \xymatrix{
			x \ar@/^1ex/[r]^{a} \ar@(ld,lu)^{b} & y \ar@/^1ex/[l]^{c}
		}
	\end{array}\end{equation*}
	箙の辺の向きを逆にして、辺のラベルをその{\brz}微分にしたものが、
	オートマトンに対応する。箙と遷移図は次の点で異なる。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 使用目的 \\
		箙も遷移図も様々な使い道があるが、ここではそれらの現在の主たる使用方法
		に限定して述べてみる。
		箙は箙の経路代数の表現を調べることに使う。経路代数の元の列挙が主な
		目的ではない。遷移図は経路代数の元を列挙することに使う。経路代数の
		表現を調べることが主な目的ではない。
		\item 辺のラベルの重複 \\
		箙は辺のラベルが重複することは許されない。一方、遷移図は辺のラベルが
		重複すること許されている。文字列の部分集合を表すには、箙のような制限
		をすることは無駄である。しかし、辺のラベルが重複することを許す代償が
		ある。箙では生成元同士の積表を作れば、箙の経路代数は完全に決まって
		しまうが、遷移図では生成元同士の積表だけでは、オートマトンは決まらな
		い。例えば、$\bullet\xfrom{a}\bullet\xfrom{a}\bullet$という遷移図では、
		$a^3=0$という関係が現れるが、これは生成元同士の積表では書くことが
		できない。
		\item 始点の指定 \\
		箙では経路の始点と呼べるものがあるとすれば、それはグラフ構造から
		決まってしまうものだけである。遷移図では複数の始点をグラフの末端でない
		頂点に対して指定することができる。始点の指定は経路代数には影響を
		与えない。終点を指定して経路代数の部分集合を取り出す時に関係する。
	\end{itemize} %}
	箙と遷移図とでは、その使用目的の違いにより異なる点もあるが、どちらも
	グラフから生成される経路代数を使うことには変わりない。大きな違いとして、
	遷移図では辺のラベルが重複することが許されているが、次のような変形に
	よって箙に書き直すことができる。
	\begin{equation*}\begin{split}
		\xymatrix{
			x_4 & x_3 \ar[l]_a & x_2 \ar[l]_b & x_1 \ar[l]_a
		} \xmapsto{\text{箙へ書き直す}} \xymatrix{
			x_2 + x_4 \ar@/_1ex/[r]_b & x_1 + x_3 \ar@/_1ex/[l]_a
		}
	\end{split}\end{equation*}
	この図の左の遷移図と右の箙では生成する経路代数は異なる。
	左の遷移図では$baba=0$となるが、右の箙にはそのような関係式は含まれない。
	遷移図で、 このように同一のラベルのついた辺が唯一になるように頂点を
	マージしていく操作を$\phi$とすると、遷移図$A$と箙$\phi A$から生成される
	経路代数は$RA\subseteq R\lr{\phi A}$という関係になる。

	箙の表現については解説\cite{derksen2005}に簡潔な概要が書かれている。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 箙の分類 \\
		箙は、有限型、tame型、野生型の三種類に分類される。
		\item 箙の基礎無向グラフ \\
		箙の辺の向きを忘れた無向グラフを箙の基礎無向グラフという。
		\item Gabrielの定理-その一 \\
		箙が有限型になる。 
		$\iff$ 基礎無向グラフがA,D,E型のDynkinグラフの合併になる。
		\item Gabrielの定理-その二 \\
		有限型の箙では、分解不可な表現と、その基礎無向グラフから定まる
		ルート系の正のルートとが$1:1$対応する。
		\item 箙の表現の分類 \\
		有限型の箙以外では、分解不可な表現をつくる一般的な処方箋を与えることは
		望み薄と思われる。
		\item 箙を分類する道具 \\
		箙に対してEular行列とCartan行列を定義する。
		\item Lie代数の手法 \\
		箙のCartan行列に対して、ルート系とLie代数を定義する。
		\item Kacの定理 \\
		箙の分解不可な表現はそのルート系の正ルートに対応する。
		\item 有限次元代数 \\
		有限次元代数の表現全体のつくる圏は、ある箙$Q$とあるイデアル
		$I\subseteq Q$があって、$\fukuso Q/I$のつくる圏と等しくなる。
		\item Drozdの定理 \\
		任意の有限次元代数は有限型、tame型、野生型のどれか一つに分類される。
	\end{itemize} %}
%s2:箙の表現と有限オートマトン}
\subsection{正方行列での文字列の類似}\label{s2:正方行列での文字列の類似} %{
	$R$可換環、 $RM_n$を$R$上の$n$行$n$列の正方行列全体のつくる$R$上の代数
	とし、$RM_n$の通常の乗法を前置記号$m$と書く。
	$E_{ij}\in RM_n$を$i$行$j$列の成分のみが$1$でその他の成分がすべて
	$0$となる行列とする。集合$\mycal{E}:=\set{E_{ij}\bou i,j\in1..n}$は
	$RM_n$の基底系となる。
	$RM_n^\flat:=\cat{Mod}_R(RM_n)$を$RM_n$の共役空間とし、
	$RM_n^\flat$の基底系$E_{ij}^\flat\in RM_n^\flat$を次のように定義する。
	\begin{equation*}\begin{split}
		E_{ij}^\flat E_{kl} = \jump{i=k}\jump{j=l}
		\quad\text{for all } i,j,k,l\in1..n
	\end{split}\end{equation*}
	共役を線形射$-^\flat:RM_n\tofrom{}{} RM_n^\flat$で表すことにする。
	\begin{equation*}\begin{split}
		\lr{E_{ij}}^\flat := E_{ij}^\flat,\quad
		\lr{E_{ij}^\flat}^\flat = E_{ij} \quad\text{for all } i,j\in1..n
	\end{split}\end{equation*}

	線形射$-m:RM_n^\flat\to RM_n^\flat\otimes RM_n^\flat$を次の式が成り立つ
	ように定義する。
	\begin{equation*}\begin{split}
		f\lr{m\lr{x\otimes y}} \simeq_R (fm)\lr{x\otimes y}
		\quad\text{for all } f\in RM_n^\flat,\; x,y\in RM_n
	\end{split}\end{equation*}
	$-m$は基底系を用いると次のように書ける。
	\begin{equation*}\begin{split}
		E_{ij}^\flat m = \sum_{k,l,p,q\in1..n} E_{ij}^\flat m
		\lr{E_{kl}\otimes E_{pq}}\lr{E_{kl}^\flat\otimes E_{pq}^\flat}
		= \sum_{k\in1..n} E_{ik}^\flat\otimes E_{kj}^\flat
	\end{split}\end{equation*}
	$-m$は結合的な積$m-$の共役なので、$-m$は余結合的になる。また、
	線形射$\epsilon^\flat:RM_n^\flat\to R$を次のように定義すると、
	\begin{equation*}\begin{split}
		\epsilon^\flat E_{ij}^\flat = \jump{i=j} 
		\quad\text{for all } i,j\in1..n
	\end{split}\end{equation*}
	$\epsilon^\flat$は$-m$の余単位射となる。

	$RM_n^\flat$で定義された余積$-m$と余単位$\epsilon^\flat$を共役によって
	$RM_n$に持ってきたものをそれぞれ$m^\flat$と$\epsilon$と書くことにする。
	\begin{equation*}\begin{split}
		m^\flat E_{ij} = \sum_{k\in1..n} E_{ik}\otimes E_{kj},\quad
		\epsilon E_{ij} = \jump{i=j} \quad\text{for all } i,j\in1..n
	\end{split}\end{equation*}
	$m$と$m^\flat$は、次の式で示されるように、圏論的な双対にはならないが、
	\begin{equation*}\begin{array}{rcl}
		E_{ij}\otimes E_{kl} 
		&\xmapsto{m\lr{\id\otimes\sigma\otimes\id}\lr{m^\flat\otimes m^\flat}}&
			E_{ij}\otimes E_{kl} \\
		E_{ij}\otimes E_{kl} &\xmapsto{m^\flat m}&
			\jump{j=k} \sum_{p\in1..n} E_{ip}\otimes E_{pl} \\
	\end{array}\end{equation*}
	$mm^\flat=n$という式が成り立つ。

	線形射$\delta:RM_n\to\cat{Mod}_R(RM_n)$を次の式が成り立つように定義
	すると、
	\begin{equation*}\begin{split}
		\lr{\delta A}B \simeq_R \lr{A^\flat\otimes-} m^\flat B
		\quad\text{for all } A,B\in RM_n
	\end{split}\end{equation*}
	次の式より、$\delta$は転置になっていることがわかる。
	\begin{equation*}\begin{split}
		\delta E_{ij}
		\simeq_R \sum_{k,l\in1..n} \lr{E_{ij}^\flat\otimes\id} 
		m^\flat E_{kl}E_{kl}^\flat
		\simeq_R \sum_{k\in1..n} E_{jk}E_{ik}^\flat
		= E_{ij}^\tran
	\end{split}\end{equation*}

\subsubsection{余単位射の出処}\label{s3:余単位射の出処} %{
	$X_1\in R^n$を始状態、$X_0\in R^n$を終状態として、余単位射を
	$M\mapsto X_1^\tran MX_0$と定義したい。上記の標準的な
	余単位射は$M\mapsto\sum_{k=0}^n\mybf{e}_k^\tran M\mybf{e}_k$と書くことが
	できるが、これは、始状態と終状態が同一になっているループ状の遷移を
	ピックアップしていると解釈できる。それを、始状態$X_1$から終状態$X_0$
	への遷移をピックアップするように変更したい。
	このように余単位射を定義するためには、余積も変更する必要がある。

	\begin{problem}[余単位射の出処]\label{prob:余単位射の出処} %{
		パーシングを考えたとき、何故、余単位射が出てくるのだろうか？
	\end{problem} %prob:余単位射の出処}

	文字列にかぎらず一般の代数で考えてみる。$R$を可換環、$V=(V,m,1)$を$R$上
	の代数、$V^\dag:=\cat{Mod}_R\lr{V,R}$を$V$の双対空間とする。
	$V$の積$m$と単位元$1$により$V^\dag$に余積
	$m^\dag:V^\dag\to V^\dag\otimes V^\dag$とその余単位射
	$\epsilon:V^\dag\to R$が定まる。
	\begin{alignat*}{2}
		\lr{m^\dag f}\lr{x\otimes y} &\simeq_R fm\lr{x\otimes y} 
		&\quad&\text{for all } f\in V^\dag,\; x,y\in V \\
		\epsilon f &= f1 &\quad&\text{for all } f\in V^\dag
	\end{alignat*}
	そして、線形射$\mu:V\to\cat{Mod}_R\lr{V^\dag}$を次の式が
	成り立つように定義すると、
	\begin{equation*}\begin{split}
		\glr{\lr{\mu x}f} y = fm\lr{x\otimes y}
		\quad\text{for all } f\in V^\dag,\; x,y\in V
	\end{split}\end{equation*}
	$\mu$は逆順の代数射となる。
	\begin{equation*}\begin{split}
		\mu1 = \id,\quad \lr{\mu x}\lr{\mu y} = \mu m\lr{y\otimes x}
		\quad\text{for all } x,y\in V
	\end{split}\end{equation*}
	変換$\mu x$と余積$m^\dag$は次の関係になる。
	\begin{equation*}\begin{split}
		\lr{\mu x}f \simeq_R \lr{m^\dag f}\lr{x\otimes-}
		\quad\text{for all } f\in V^\dag,\; x\in V
	\end{split}\end{equation*}
	像$\mu V\subseteq\cat{Mod}_R\lr{V^\dag}$がBrzozowski微分に対応する。

	写像$\delta:V\to V\otimes V$が$m\delta=\id$となり、任意の$x\in V$に対して
	有限の$n\in\sizen$で$\lr{\pi_2\delta}^nx=1$となれば、
	次のようにして、任意の$f\in V^\dag$と$x\in V$に対して$fx$の計算を
	$\cat{Mod}_R\lr{V^\dag}$の計算に帰着させることができる。
	\begin{equation*}\xymatrix{
		& x_L^1\otimes x_R^1 \ar@<1ex>@{|->}[ld]^{m} \ar[d]^{\pi_2}
		& \cdots \ar@<1ex>@{|->}[ld]^{m} 
		& x_L^n\otimes x_R^n \ar@<1ex>@{|->}[ld]^{m} \ar[d]^{\pi_2} \\
		x \ar@<1ex>@{|->}[ru]^\delta \ar[d]^f
		& x_R^1 \ar[d]^{\lr{\mu x_L^1}f} \ar@<1ex>@{|->}[ru]^\delta
		& \cdots \ar@<1ex>@{|->}[ru]^\delta
		& x_R^n = 1 \ar[d]^{\lr{\mu x_L^n}\cdots\lr{\mu x_L^1}f} \\
		fx \ar@{=}[r] & \glr{\lr{\mu x_L^1}f}x_R^1 \ar@{=}[r]
		& \cdots \ar@{=}[r]
		& \epsilon\lr{\mu x_L^n}\cdots\lr{\mu x_L^1}f
	}\end{equation*}
	これが質問\ref{prob:余単位射の出処}の答えになっているだろう。
	大抵の場合、こうすることは簡単なものをより難しくするが、
	言語の文法が与えられた場合は、この考えを使って、パーシングを効率的に
	行う事前準備をすることができる。

	$f\in V^\dag$を固定して考える。$[f]\subseteq V^\dag$を
	$[f]:=\myop{span}_R\set{\lr{\mu V}f}$によって定義する。すると、
	$\mu$を$[f]$に制限した代数射$\mu_f:V\to[f]$は代数$\lr{V,m,1}$の表現を
	与え、
	\begin{equation*}\begin{split}
		\lr{\mu_fx}g = \lr{\mu fx}g
		\quad\text{for all } g\in V^\dag,\; x\in V
	\end{split}\end{equation*}
	$m^\dag$を$[f]$に制限した線形射$m^\dag_f:[f]\to V^\dag\otimes[f]$は、
	\begin{equation*}\begin{split}
		m^\dag_fg = m^\dag g \quad\text{for all } g\in[f]
	\end{split}\end{equation*}
	次の式を満たし、余代数$(V^\dag,m^\dag,\epsilon)$の余表現を与える。
	\begin{equation*}\begin{split}
		\lr{\id\otimes m^\dag}m^\dag_f = \lr{m^\dag\otimes\id}m^\dag_f
		,\quad \lr{\epsilon\otimes\id}m^\dag_f \simeq_R \id
	\end{split}\end{equation*}
	$[f]$が$A^\dag$の余表現を与えることは、環$A$のイデアル$I$が$A$の
	表現となることと同様の事象なのだろう。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $I\subset A$で$I$は加法について$A$の部分群となり、
		\item 任意の$x\in I$と$a\in A$に対して$ax\in I$かつ$xa\in I$となる
		とき、
		\item $I$を$R$の（両側）イデアルという。
	\end{itemize} %}

	\begin{note}[Sweedler双対]\label{note:Sweedler双対} %{
		論文\cite{2007arXiv0712.0125D}に積の共役によって定義される余積について
		成り立つ性質が述べられている。積の共役によって定義される余積または
		その逆をSweedler双対というらしい。斜め読みした限り、予想以上に多くの
		ことがわかっている。
	\end{note} %note:Sweedler双対}

	筋書き。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 文法が与えられる $\iff$ $L\subseteq\Sigma^*$が定まる。
		\item 転置により指示関数（indicator）
		$\chi_L^\dag\in\lr{R\Sigma^*}^\dag$を次のように定義すると、
		\begin{equation*}\begin{split}
			\chi_L^\dag := \sum_{w\in L}w^\dag
		\end{split}\end{equation*}
		任意の$w\in\Sigma^*$に対して$\chi_L^\dag w\neq 0 \iff w\in L$が
		成り立つ。
		\item $V:=R\Sigma^*$とおく。
		\item 部分空間$[\chi_L^\dag]\subseteq V^\dag$を次のように定義すると、
		\begin{equation*}\begin{split}
			[\chi_L^\dag] 
			:= \myop{span}_R\Set{\lr{\mu w}\chi_L^\dag\bou w\in\Sigma^*}
		\end{split}\end{equation*}
		$\mu $が代数射で$[\chi_L^\dag]$で閉じているから、$\mu V$の作用域
		を$[\chi_L^\dag]$に制限することで、表現
		$\mu_L:V\to\cat{Mod}_R\lr{[\chi_L^\dag]}$が得られる。
		\begin{equation*}\begin{split}
			\lr{\mu_Lx}f := \lr{\mu x}f
			\quad\text{for all } f\in[\chi_L^\dag],\; x\in V
		\end{split}\end{equation*}
		特に、$L$が有理言語の場合、$[\chi_L^\dag]$が有限次元となり、
		$\rho_L\Sigma$が行列の形で書ける。$L$が有理言語の場合でも、
		$\mu$自身は$\cat{Mod}_R\lr{V^\dag}$への写像で$\cat{Mod}_R\lr{V^\dag}$
		は無限次元なので、$\mu$自身は行列の形で書くことができないことに注意
		する。
	\end{itemize} %}

	この筋書きを簡単な有理言語によって見てみる。
	集合$\Sigma$と$L\subset\Sigma^*$を次のように定義する。
	\begin{equation*}\begin{split}
		\Sigma := \set{a,b,c},\quad L := \Set{b^nac^n\bou n\in\sizen}
	\end{split}\end{equation*}
	すると、指示関数の共役が$\chi_L:=b^*ac^*\in R\Sigma^*$となり、
	次の式より、
	\begin{equation*}\begin{split}
		&\left\{\begin{split}
			X &= X_0 + TX \\
			\chi_L &= X_1^\tran X
		\end{split}\right. \quad\text{where } X := \pvec{b^*ac^*}{c^*} \\
		&\quad X_0 := \pvec{0}{1},\; X_1 := \pvec{1}{0},\;
		T := \begin{pmatrix}
			b & a \\ 0 & c
		\end{pmatrix} = aT_a + bT_b + cT_c
	\end{split}\end{equation*}
	対応する$R\Sigma^*$の部分空間が
	$\gdyck{\chi_L}:=\myop{span}_R\set{b^*ac^*,c^*}$となる。
	同一視$\gdyck{\chi_L}\simeq R^2$により、表現
	$\mu_L^\dag:R\Sigma^*\to\cat{Mod}_R\lr{\gdyck{\chi_L}}\simeq RM_2$が
	次のように定まる。
	\begin{equation*}\begin{split}
		\lr{\mu_L^\dag x}X = T_xX \quad\text{for all } x\in\Sigma
	\end{split}\end{equation*}
	$1^\dag:R\Sigma^*\to R$を余単位射とすると、
	\begin{equation*}\begin{split}
		1^\dag w=\jump{w=1} \quad\text{for all } w\in\Sigma^*
	\end{split}\end{equation*}
	遷移行列$T$が$\sum_{x\in\Sigma}xT_x$と書かれていることにより、
	次の式が成り立つ。
	\begin{equation*}\begin{split}
		1^\dag\lr{X_1^\tran MT^*X_0} = X_1^\tran MX_0
		\quad\text{for all } M\in RM_2
	\end{split}\end{equation*}
	したがって、$x_1,\dots,x_n\in\Sigma$に対して$x_1\cdots x_n\in\Sigma^*$が
	$L$に属しているかどうかの判定は、次のように書ける。
	\begin{equation}\label{eq:メンバーシップの判定}\begin{split}
		\lr{x_1\cdots x_n}^\dag\chi_L
		= X_1^\tran T_{x_1}\cdots T_{x_n}X_0 \neq 0 \iff x_1\cdots x_n\in L
	\end{split}\end{equation}
	ここで、$\mu_L$が逆順準同型であり、$\mu_Lx$の作用とその表現との関係から
	次のような順序で行列が並ぶことに注意する。
	\begin{equation*}\begin{split}
		\lr{\mu_L^\dag\lr{x_1\cdots x_n}}X = \lr{\mu_L^\dag x_n}
		\cdots\lr{\mu_L^\dag {x_1}}X = T_{x_1}\cdots T_{x_n}X
	\end{split}\end{equation*}

	単語が$L$に属しているかどうかの判定\eqref{eq:メンバーシップの判定}は、
	次のように定義された部分空間$[\mu_L\Sigma^*]\subset R\Sigma^*M_2$
	に、
	\begin{equation*}\begin{split}
		\gdyck{\mu_L\Sigma^*} := \myop{span}_R\cup_{n\in\sizen}
		\Set{M_{x_1}\cdots M_{x_n}\bou x_1,\dots,x_n\in\Sigma}
	\end{split}\end{equation*}
	余単位射$\epsilon:\gdyck{\mu_L\Sigma^*}\to R$を次のように定義している
	ように見える。
	\begin{equation*}\begin{split}
		\epsilon M := 1^\dag\lr{X_1^\tran MX}
		\quad\text{for all } M\in\gdyck{\mu_L\Sigma^*}
	\end{split}\end{equation*}
%s3:余単位射の出処}
%s2:正方行列での文字列の類似}
\subsection{平面上の二分木と格子上の経路}
\label{s2:平面上の二分木と格子上の経路} %{
	頂点数が$n$の平面上の二分木の集合を$\T_n$、
	$\T_+:=\cup_{n\in\sizen_+}\T_n$と$\T_*:=\T_0\cup\T_+$をその合併とする。
	\begin{equation*}\begin{split}
		\T_0 &:= \Set{\treeu} \\
		\T_1 &:= \Set{\bullet} \\
		\T_2 &:= \Set{\smallxy{
			& \bullet \hen[dl] \\
			\bullet
		}, \smallxy{
			\bullet \hen[dr] \\
			& \bullet
		}} \\
		\T_3 &:= \Set{\smallxy{
			& & \bullet \hen[dl] \\
			& \bullet \hen[dl] \\
			\bullet
		}, \smallxy{
			& \bullet \hen[dl] \\
			\bullet \hen[dr] \\
			& \bullet
		}, \smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\bullet & & \bullet \\
		}, \smallxy{
			\bullet \hen[dr] \\
			& \bullet \hen[dl] \\
			\bullet
		}, \smallxy{
			\bullet \hen[dr] \\
			& \bullet \hen[dr] \\
			& & \bullet
		}}
	\end{split}\end{equation*}

	二項演算$\beta:\T_*\times\T_*\to\T_+$を次のように定義する。
	\begin{equation*}\begin{split}
		\beta\lr{\tau_1,\tau_2} := \smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\tau_1 & & \tau_2
		} \quad\text{for all } \tau_1,\tau_2\in\T_*
	\end{split}\end{equation*}
	ここで、$\beta$の空の木$\treeu$への作用は次のように定義する。
	\begin{alignat*}{3}
		\beta\lr{\tau,\treeu} &= \smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\tau & & \treeu
		} &&:= \smallxy{
			& \bullet \hen[dl] \\
			\tau
		} &\quad\text{for all } \tau\in\T_+ \\
		\beta\lr{\treeu,\tau} &= \smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\treeu & & \tau
		} &&:= \smallxy{
			\bullet \hen[dr] \\
			& \tau
		} &\quad\text{for all } \tau\in\T_+ \\
		\bullet\lr{\treeu,\treeu} &= \smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\treeu & & \treeu
		} &&:= \bullet
	\end{alignat*}
	$\beta$は次の意味で頂点を一つ追加する操作になっている。
	\begin{equation*}\begin{split}
		\beta:\T_m\times\T_n\to\T_{m+n+1}\quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}
	したがって、$\beta$は結合的でないし、単位元を持たない。
	しかし、"大きな問題を\underline{一意に}小さな問題に分割する"機能を
	持つので、平面二分木を表現する上でとても便利である。

	\begin{proposition}[Gedel関数もどき]\label{prop:Gedel関数もどき} %{
		任意の$\tau\in\T_+$に対して$\tau=\beta\lr{\tau_1,\tau_2}$となる
		$\tau_1,\tau_2\in\T_*$が唯一つ存在する。
	\end{proposition} %prop:Gedel関数もどき}
	\begin{proof} %{
		任意の$\tau\in\T_+$はある$\tau_1,\tau_2\in\T_*$が存在して、$\smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\tau_1 & & \tau_2
		}$と書くことができる。したがって、$\tau=\beta\lr{\tau_1,\tau_2}$と
		なる$\tau_1,\tau_2\in\T_*$は存在する。また、ある
		$\sigma_1,\sigma_2\in\T_*$が存在して、
		$\smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\tau_1 & & \tau_2
		}=\smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\sigma_1 & & \sigma_2
		}$となれば、$\tau_1=\sigma_1$かつ$\tau_2=\sigma_2$となるから、
		そのような$\tau_1,\tau_2$が一意に定まることもわかる。
	\end{proof} %}

	この命題より、集合同型$\beta:\T_*\times\T_*\simeq\T_+$が成り立ち、
	$\beta^{-1}:\T_+\to\T_*\times\T_*$が定義できることがわかる。
	また、$\T_{n+1}$の大きさが$|\T_{n+1}|=\sum_{k=0}^n|\T_k||\T_{n-k}|$
	で定まり、それがCatalan数になることがわかる。
	\begin{equation*}\begin{split}
		|\T_n| = \frac{(2n)!}{(n+1)!n!} \quad\text{for all } n\in\sizen
	\end{split}\end{equation*}

	頂点と辺の数を数える写像を定義しよう。
	頂点数を数える写像$N_V:\T_*\to\sizen$を次のように定義する。
	\begin{equation*}\begin{split}
		N_V\treeu &:= 0 \\
		N_V\beta\lr{\tau_1,\tau_2} &:= 1 + \lr{N_V\tau_1}+ \lr{N_V\tau_2}
		\quad\text{for all } \tau_1,\tau_2\in\T_*
	\end{split}\end{equation*}
	二分木の場合、辺は左下へ向かう辺と右下に向かう辺の二種類あるから、
	それぞれ別に数える写像を定義する。$N_+$を左下に向かう辺の数、
	$N_-$を右下に向かう辺の数として、写像$N_\pm:\T_*\to\sizen$を次の
	ように定義し、
	\begin{equation*}\begin{split}
		N_+\treeu &:= 0 \\
		N_+\beta\lr{\tau_1,\tau_2} &:= \jump{\tau_1\neq\treeu} 
		+ \lr{N_+\tau_1}+ \lr{N_+\tau_2}
		\quad\text{for all } \tau_1,\tau_2\in\T_* \\
		N_-\treeu &:= 0 \\
		N_-\beta\lr{\tau_1,\tau_2} &:= \jump{\tau_2\neq\treeu} 
		+ \lr{N_-\tau_1}+ \lr{N_-\tau_2}
		\quad\text{for all } \tau_1,\tau_2\in\T_* \\
	\end{split}\end{equation*}
	すべての辺の数を$N_E:=N_++N_-$と定義する。ただし、任意の$\tau\in\T_+$に
	対して$N_V\tau=\lr{N_E\tau}+1$が成り立つ。

	\begin{todo}[ここまで]\label{todo:ここまで} %{
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item 次数の定義 \\
			辺の数で代用できる。Dyck木の場合は、辺の数を$2$で割ったものがDyck木の
			次数になる。グラフ理論で次数といった場合、別の意味、頂点に入力または
			出力する辺の数になる。したがって、無用の混乱を避けるために次数という
			言葉を使わない方がよいかもしれない。
			\item 自然な成長を経路木で解釈する場合、元の木の葉を追跡しないと、
			経路木で解釈することができない。したがって、一旦、$\T_*$を$\Path_*$の
			直積に分解して、それを$\Path_*$の積で連結するという方法がいいかも
			しれない。$\T_*$を$\Path_*$の直積に分解する際には、元の葉が分解した後
			にも葉になっているように分解する必要がある。
			\begin{equation*}\begin{split}
				\smallxy{
					& & 1 \hen[dl] \hen[dr] \\
					& 2 \hen[dl] \hen[d] & & 5 \hen[d] \hen[dr] \\
					3 & 4 & & 6 & 7 \\
				} \mapsto \smallxy{
					& & 1 \hen[dl] \\
					& 2 \hen[dl] \\
					3 \\
				}\times \smallxy{
					2 \hen[dr] \\
					& 4 \\
				}
			\end{split}\end{equation*}
		\end{itemize} %}
	\end{todo} %todo:ここまで}

	任意の$n\in\sizen$に対して$\D_n\subseteq\T_{2n+1}$を次の性質を持つ
	木全体の集合とする。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item すべての頂点が子供を$0$または$2$つ持つ。
		\item 葉でない頂点が$n$個ある。
	\end{itemize} %}
	$\D_n$を$n$次のDyck木（の集合）ということにする。
	写像$\deg:\T_*\to\sizen$を次のように定義すると、
	\begin{equation*}\begin{split}
		\deg\tau := \text{$\tau$の葉でない頂点の数}
		\quad\text{for all } \tau\in\T_*
	\end{split}\end{equation*}
	$\tau\in\D_n$ならば$\deg\tau=n$かつ$|\tau|=2n+1$となる。

	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 任意の$m,n\in\sizen$に対して$\tau_1\in\D_m$かつ$\tau_2\in\D_n$
		ならば、$\beta\lr{\tau_1,\tau_2}\in\D_{m+n+1}$が成り立ち、
		\item 任意の$n\in\sizen$に対して$\beta\lr{\tau_1,\tau_2}\in\D_{n+1}$
		ならば、$\lr{\tau_1,\tau_2}\in\cup_{k=0}^n\D_k\times\D_{n-k}$が成り立つ
		から、
	\end{itemize} %}
	集合同型$\beta:\D_*\times\D_*\simeq\D_+$が成り立つ。
	可換図にすると次のようになる。
	\begin{equation*}\xymatrix@C=8ex{
		\cup_{k=0}^{2(n+1)} \T_k\times\T_{2(n+1)-k} \ar[r]^{\beta}_\simeq 
		& \T_{2(n+1)+1} \\
		\cup_{k=0}^{n} \D_k\times\D_{n-k} \ar[r]^{\beta}_\simeq 
		\ar[u]_{\subseteq}
		& \D_{n+1} \ar[u]_{\subseteq}
	}\end{equation*}
	不思議なことに、任意の$n\in\sizen$に対して$|\T_n|=|\D_n|$が成り立つ。
	写像$D:\T_*\to\T_+$を次のように定義する。
	\begin{equation*}\begin{split}
		D0 &:= \bullet \\
		D\beta\lr{\tau_1,\tau_2} &:= \beta\lr{D\tau_1,D\tau_2}
		\quad\text{for all }\tau_1,\tau_2
	\end{split}\end{equation*}
	Dは次のように、
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 子供を追加する余地のある葉でない頂点と、
		\item すべての葉に
	\end{itemize} %}
	$0$という未来の子供を追加して、$0$を$\bullet$で置き換える操作に
	なっている。
	\begin{equation*}\begin{split}
		D: \smallxy{
			\bullet \hen[dr] \\
			& \bullet \hen[dl] \\
			\bullet
		} = \smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			0 & & \bullet \hen[dl] \hen[dr] \\
			& \bullet \hen[dl] \hen[dr] & & 0 \\
			0 & & 0
		} \mapsto \smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\bullet & & \bullet \hen[dl] \hen[dr] \\
			& \bullet \hen[dl] \hen[dr] & & \bullet \\
			\bullet & & \bullet
		}
	\end{split}\end{equation*}
	任意の$n\in\sizen$に対して集合同型$D:\T_n\simeq\D_n$が成り立つ。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 任意の$n\in\sizen$に対して$D:\T_n\to\D_*$となる。\\
		$D$の定義より、任意の$\tau\in\T_*$に対して$D\tau$は子供を$1$つしか
		持たない頂点はないから、$D\tau\in\D_*$となる。
		\item 任意の$n\in\sizen$に対して$D:\T_n\to\D_n$となる。\\
		$D\T_n\subseteq\T_{2n+1}$となることを頂点数に関する証明する。
		まず、$|D0|=1=2|0|+1$となる。ある$n\in\sizen$があって、
		任意の$k\le n$と$\tau\in\T_k$に対して$|D\tau|=2|\tau|+1$となると
		仮定する。すると、任意の$\tau\in\T_{n+1}$に対して、ある$0\le k\le n$
		があって、$\tau=\beta\lr{\tau_1,\tau_2}$となる$\tau_1\in\T_k$と
		$\tau_2\in\T_{n-k}$がある。すると、次の式から頂点数が$n+1$の場合も
		帰納法の仮定が成り立つことがわかる。
		\begin{equation*}\begin{split}
			|D\tau| = |D\tau_1|+|D\tau_2|+1 = \lr{2k+1}+\lr{2\lr{n-k}+1}+1
			= 2|\tau| + 1
		\end{split}\end{equation*}
		%
		\item 写像$E:\D_*\to\T_*$を次のように定義する。
		\begin{equation*}\begin{split}
			E\bullet &:= 0 \\
			E\beta\lr{\tau_1,\tau_2} &:= \beta\lr{E\tau_1,E\tau_2}
			\quad\text{for all } \tau_1,\tau_2\in\D_*
		\end{split}\end{equation*}
		すると、$DE=\id$となるから、集合同型$D:\T_*\simeq\D_*$が成り立つことが
		わかる。
	\end{itemize} %}

	\begin{todo}[ここまで]\label{todo:ここまで} %{
		Dyck経路はそのまま平面二分木として見ることができる。
		\begin{equation*}\begin{split}
			\xymatrix@R=2ex@C=2ex{
				& & \ar[dr] \\
				& \ar[ur] & & \ar[dr] & & \ar[dr] \\
				\ar[ur] & & & & \ar[ur] & & \\
			} \mapsto \smallxy{
				& & \bullet \hen[dl] \\
				& \bullet \hen[dl] \\
				\bullet \hen[dr] \\
				& \bullet \hen[dr] \\
				& & \bullet \hen[dl] \\
				& \bullet \hen[dr] \\
				& & \bullet
			}
		\end{split}\end{equation*}
		Dyck経路による描像はBrzozowski代数を用いた列挙に直接対応するので、
		Dyck木からDyck経路への対応をつけたい。$\mybf{2}:=\set{b,c}$とする。
		写像$\omega:\D_*\to\mybf{2}^*$を次のように定義すると、
		\begin{equation*}\begin{split}
			\omega\bullet = \wordu,\quad 
			\omega\beta\lr{\tau_1,\tau_2} = b\lr{\omega\tau_1}c\lr{\omega\tau_2}
			\quad\text{for all } \tau_1,\tau_2\in\D_*
		\end{split}\end{equation*}
		$\omega$は$1:1$になる。
		写像$\pi:\mybf{2}^*\to\T_+$を次のように定義すると、
		\begin{equation*}\begin{split}
			\pi\wordu = \bullet,\quad
			\pi\lr{bw} = \beta\lr{\pi w,\treeu},\quad 
			\pi\lr{cw} = \beta\lr{\treeu, \pi w}
			\quad\text{for all } w\in\mybf{2}^*
		\end{split}\end{equation*}
		$\pi$は$1:1$になる。したがって、$\pi\omega:\D_*\to\T_+$は$1:1$になる。
		\begin{equation*}\begin{split}
			\pi\omega\bullet &= \bullet \\
			\pi\omega\beta\lr{\tau_1,\tau_2} 
			&= \beta\gglr{\pi\glr{\lr{\omega\tau_1}c\lr{\omega\tau_2}},\treeu}
			\quad\text{for all } \tau_1,\tau_2\in\D_*
		\end{split}\end{equation*}
		この二つ目の式を作用素の形で書くと次のようになる。
		\begin{equation*}\begin{split}
			\pi\omega\beta\lr{\tau_1,\tau_2} 
			= \beta\lr{\pi\times\id}\lr{m\times\id}
			\lr{\id\times c-\times\id}\lr{\omega\times\omega\times\id}
			\lr{\tau_1,\tau_2,\treeu}
		\end{split}\end{equation*}

		定式化してみよう。
		任意の$n\in\sizen$に対して$\Path_n\subseteq\T_{n+1}$を次の性質を持つ
		木全体の集合とする。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item すべての頂点が子供を$0$または$1$つ持つ。
			\item 葉でない頂点が$n$個ある。
		\end{itemize} %}
		$\Path_n$を$n$次の経路木（の集合）ということにする。
		二項演算$m:\Path_*\times P_*\to\Path_*$を次のように定義する。
		\begin{alignat*}{2}
			m\lr{\bullet,\tau} &= m\lr{\tau,\bullet} 
			= \tau &\quad&\text{for all } \tau\in\Path_* \\
			m\lr{\beta\lr{\tau_1,\treeu},\tau_2}
			&= \beta\lr{m\lr{\tau_1,\tau_2},\treeu} 
			&\quad&\text{for all } \tau_1,\tau_2\in\Path_* \\
			m\lr{\beta\lr{\treeu,\tau_1},\tau_2}
			&= \beta\lr{\treeu,m\lr{\tau_1,\tau_2}} 
			&\quad&\text{for all } \tau_1,\tau_2\in\Path_*
		\end{alignat*}
		ここで、$\beta_\pm:\T_*\to\T_+$を次のように定義すると、
		\begin{equation*}\begin{split}
			\beta_+\tau := \beta\lr{\tau,\treeu},\quad 
			\beta_-\tau := \beta\lr{\treeu,\tau}
			\quad\text{for all }\tau\in\T_*
		\end{split}\end{equation*}
		$m$の定義の二つ目と三つ目の式は$m\lr{\beta_\pm\times\id}=\beta_\pm m$
		と書くことができる。$\Path_n$の任意の元は一意に次のように書くことが
		できるから、
		\begin{equation*}\begin{split}
			\beta_1\cdots\beta_n\bullet
			\quad\text{where } \beta_1,\dots,\beta_n=\beta_\pm
		\end{split}\end{equation*}
		任意の$n\in\sizen$に対して集合同型$\Path_n\simeq\mybf{2}^n$が成り立ち、
		$m$が文字列の連結に対応し、モノイド同型
		$(\Path_*,m,\bullet)\simeq\mybf{2}^*$が成り立つ。

		$P:\T_+\to\Path_*$を次のように定義する。
		\begin{alignat*}{2}
			P\bullet &:= \bullet,\quad P\beta_\pm = \beta_\pm P \\
			P\beta\lr{\tau_1,\tau_2} &:= m\lr{\beta_+P\tau_1, \beta_-P\tau_2}
			&\quad& \text{for all }\tau_1,\tau_2\in\T_+ \\
		\end{alignat*}
		$P\bullet=\bullet$となり、$P$は$\beta_\pm$と可換だから、任意の
		$\tau\in\Path_*$に対して$P\tau=\tau$となる。
		したがって、$P$は$\Path_*$への射影となり、べき等$P^2=\id$になる。
		\footnote{
			$\tau\in\Path_*$に対して$P^{-1}\tau\subset\T_*$に代数構造が入れば、
			ファイバー束に似た構造が入ることになる。
		}
		$P$は木を行きがけ順に辿りながら、右側の子供を左側の経路の末端に
		付け替えるという操作を行う。例えば次のような操作をすることになる。
		\begin{equation*}\begin{split}
			\smallxy{
				& & 1 \hen[dl] \hen[dr] \\
				& 2 \hen[dl] \hen[d] & & 5 \hen[d] \hen[dr] \\
				3 & 4 & & 6 & 7
			} \mapsto \smallxy{
				& & 1 \hen[dl] \hen[dr] \\
				& 2 \hen[dl] & & 5 \hen[dl] \hen[dr] \\
				3 \hen[dr] & & 6 & & 7 \\
				& 4
			} \mapsto \smallxy{
				& & 1 \hen[dl] \\
				& 2 \hen[dl] \\
				3 \hen[dr] \\
				& 4 \hen[dr] \\
				& & 5 \hen[dl] \hen[dr] \\
				& 6 & & 7
			} \mapsto \smallxy{
				& & 1 \hen[dl] \\
				& 2 \hen[dl] \\
				3 \hen[dr] \\
				& 4 \hen[dr] \\
				& & 5 \hen[dl] \\
				& 6 \hen[dr] \\
				& & 7
			}
		\end{split}\end{equation*}

		$P$が$\Path_*$への射影なので、写像
		$\what{P}:T_*\to\cat{Set}\lr{\Path_*}$を次のように定義することが
		できる。
		\begin{equation*}\begin{split}
			\what{P}\treeu &:= \beta_- \\
			\lr{\what{P}\tau}\pi &:= P\beta\lr{\tau,\pi}
			= m\lr{\beta_+P\tau,\beta_-\pi}
			\quad\text{for all } \tau\in\T_+,\; \pi\in\Path_*
		\end{split}\end{equation*}
		特に、次の式が成り立つ。
		\begin{equation*}\begin{split}
			\what{P}\bullet = \beta_+\beta_-
		\end{split}\end{equation*}

		この対応を$\pi$とすると、$\pi$は写像$\pi:\mybf{3}^*\to\T_*$として
		次のように定義できる。
		\begin{alignat*}{2}
			\pi1 &:= 0 \\
			\pi\lr{aw} &:= \pi w &\quad& \text{for all } w\in\mybf{3}^* \\
			\pi\lr{bw} &:= \beta\lr{\pi w,0} &\quad& \text{for all } w\in\mybf{3}^* \\
			\pi\lr{cw} &:= \beta\lr{0, \pi w} &\quad& \text{for all } w\in\mybf{3}^* \\
		\end{alignat*}
		$\bra{0}\lr{b\eta+ac\eta^\dag}^n=\sum_{k=0}^nx_{n,k}\bra{k}$とすると、
		次の漸化式が得られる。
		\begin{alignat*}{2}
			x_{n+1,0} &=  x_{n,1}ac \\
			x_{n+1,k} &=  x_{n,k-1}b + x_{n,k+1}ac 
				&\quad& \text{for all } k\in1..(n-1) \\
			x_{n+1,k} &=  x_{n,k-1}b
				&\quad& \text{for } k=n-1,n
		\end{alignat*}
		うーん、漸化式にすると意味のわからない式になってしまう。

		$T_n:=\lr{b\eta+ac\eta^\dag}^na$とすると、
		\begin{alignat*}{2}
			\bra{0}T_0 &= a &&\xmapsfrom{\phi} \bullet \\
			\bra{0}T_1 &= ba\bra{1} &&\xmapsfrom{\phi} \smallxy{
				& \bullet \hen[dl] \\
				\bullet \\
			} \\
			\bra{0}T_2 &= b^2a\bra{2} + baca\bra{0} &&\xmapsfrom{\phi} \smallxy{
				& & \bullet \hen[dl] \\
				& \bullet \hen[dl] \\
				\bullet \\
			} + \smallxy{
				& \bullet \hen[dl] \hen[dr] \\
				\bullet & & \bullet \\
			} \\
			\bra{0}T_3 &= b^3a\bra{3} + \lr{b^2aca+bacba}\bra{1} 
			&&\xmapsfrom{\phi} \smallxy{
				& & & \bullet \hen[dl] \\
				& & \bullet \hen[dl] \\
				& \bullet \hen[dl] \\
				\bullet \\
			} + \smallxy{
				& & \bullet \hen[dl] \\
				& \bullet \hen[dl] \hen[dr] \\
				\bullet & & \bullet \\
			} + \smallxy{
				& \bullet \hen[dl] \hen[dr] \\
				\bullet & & \bullet \hen[dl] \\
				& \bullet \\
			}
		\end{alignat*}
		という対応になる。この対応を与える木の成長をどのように定義したら
		よいだろうか。線形射$\gamma:R\T_*\to R\T_+$を次のように定義すると、
		\begin{equation*}\begin{split}
			\gamma0 &:= \bullet \\
			\gamma\beta\lr{\tau_1,\tau_2} 
			&:= \beta\lr{\gamma\tau_1,\tau_2}
			+ \jump{\tau_1=\bullet}\beta\lr{\tau_1,\gamma\tau_2}
			\quad\text{for all } \tau_1,\tau_2\in\T_*
		\end{split}\end{equation*}
		次のようになるが、
		\begin{equation*}\begin{split}
			\gamma\smallxy{
				& & & \bullet \hen[dl] \\
				& & \bullet \hen[dl] \\
				& \bullet \hen[dl] \\
				\bullet \\
			} &= \smallxy{
				& & & & \bullet \hen[dl] \\
				& & & \bullet \hen[dl] \\
				& & \bullet \hen[dl] \\
				& \bullet \hen[dl] \\
				\bullet \\
			} + \smallxy{
				& & & \bullet \hen[dl] \\
				& & \bullet \hen[dl] \\
				& \bullet \hen[dl] \hen[dr] \\
				\bullet & & \bullet \\
			} \\
		\end{split}\end{equation*}
	\end{todo} %todo:ここまで}

	$\mybf{3}:=\set{a,b,c}$を大きさ$3$の集合とする。
	$\mybf{3}$から生成される自由モノイドを$\mybf{3}^*$と書き、
	長さ$n$の単語全体のつくる$\mybf{3}^*$の部分集合を$\mybf{3}^n$と書く。
	写像$\omega:\D_*\to\mybf{3}^*$を次のように定義する。
	\begin{alignat*}{2}
		\omega\bullet &:= a \\
		\omega\beta\lr{\tau_1,\tau_2} &:= b(\omega\tau_1)c(\omega\tau_2)
			&\quad& \text{for all } \tau_1,\tau_2\in\D_*
	\end{alignat*}
	$\omega$は次のように
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 葉にラベル$a$を、
		\item 辺にラベル$b$または$c$を、
	\end{itemize} %}
	書いて、それを行きがけ順に辿って文字列化する操作になっている。
	\begin{equation*}\begin{split}
		\xymatrix@R=2ex@C=2ex{
			& & \bullet \ar[dl]_b \ar[dr]^c \\
			& \bullet \ar[dl]_b \ar[dr]^c & & a \\
			a & & a \\
		}
	\end{split}\end{equation*}
	$\D_n$の木の辺の数は$2n$、葉の数は$n+1$だから、
	$\omega:\D_n\to\mybf{3}^{3n+1}$となる。
	\begin{equation*}\begin{split}
		\tau\in\D_n \implies \left\{\begin{split}
			\sharp_a\omega\tau &= n + 1 \\
			\sharp_b\omega\tau &= \sharp_c\omega\tau = n \\
		\end{split}\right.
	\end{split}\end{equation*}
	ここで、$\sharp$は任意の有限集合$X$に対して定義される写像
	$\sharp:X\times X^*\to\sizen$で、$x\in X$に対して
	$\sharp_xw$は$w\in X^*$に含まれる文字$x$を数えるとする。
	$a$を$1$とすれば、$\omega$はDyck経路への写像になるので、
	$\omega$は$1:1$になることがわかる。


	$\mybf{2}:=\set{b,c}$を大きさ$2$の集合とする。
	$\mybf{2}$から生成される自由モノイドを$\mybf{2}^*$と書き、
	長さ$n$の単語全体のつくる部分集合を$\mybf{2}^n$と書く。
	写像$\phi:\T_+\to\mybf{2}^*$を次のように定義する。
	\begin{alignat*}{2}
		\phi\bullet &:= 1 \\
		\phi\beta\lr{\tau,0} &:= b(\phi\tau) 
			&\quad& \text{for all } \tau\in\T_+ \\
		\phi\beta\lr{0,\tau} &:= c(\phi\tau)
			&\quad& \text{for all } \tau\in\T_+ \\
		\phi\beta\lr{\tau_1,\tau_2} &:= b(\phi\tau_1)c(\phi\tau_2)
			&\quad& \text{for all } \tau_1,\tau_2\in\T_+
	\end{alignat*}

	$\mybf{2}:=\set{b,c}$を大きさ$2$の集合とする。
	$\mybf{2}$から生成される自由モノイドを$\mybf{2}^*$と書き、
	長さ$n$の単語全体のつくる部分集合を$\mybf{2}^n$と書く。
	写像$\phi:\T_+\to\mybf{2}^*$を次のように定義する。
	\begin{alignat*}{2}
		\phi\bullet &:= 1 \\
		\phi\beta\lr{\tau,0} &:= b(\phi\tau) 
			&\quad& \text{for all } \tau\in\T_+ \\
		\phi\beta\lr{0,\tau} &:= c(\phi\tau)
			&\quad& \text{for all } \tau\in\T_+ \\
		\phi\beta\lr{\tau_1,\tau_2} &:= b(\phi\tau_1)c(\phi\tau_2)
			&\quad& \text{for all } \tau_1,\tau_2\in\T_+
	\end{alignat*}
	$\phi$は次のように平面二分木の頂点にラベルを書いて、
	\begin{equation*}\begin{split}
		\smallxy{
			& & \bullet \hen[dl] \hen[dr] \\
			& b \hen[dl] \hen[d] & & c \hen[d] \hen[dr] \\
			b & c & & b & c \\
		}
	\end{split}\end{equation*}
	それを行きがけ順に辿って文字列化する操作になっている。
	木の頂点は文字列化しないので、頂点数から$1$引いた長さの単語が生成される。
	したがって、任意の$n\in\sizen$で$\phi:T_{n+1}\to\mybf{2}^n$となることが
	わかる。

	$\phi$を$\T_3$まで書いてみると次のようになる。
	\begin{equation*}\begin{split}
		\phi\bullet = 1,\quad \phi\smallxy{
			& \bullet \hen[dl] \\
			\bullet
		} = b,\quad \phi\smallxy{
			\bullet \hen[dr] \\
			& \bullet
		} = c \\
		\phi\smallxy{
			& & \bullet \hen[dl] \\
			& \bullet \hen[dl] \\
			\bullet
		} = b^2,\quad \phi\smallxy{
			& \bullet \hen[dl] \\
			\bullet \hen[dr] \\
			& \bullet
		} = bc,\quad \phi\smallxy{
			& \bullet \hen[dl] \hen[dr] \\
			\bullet & & \bullet \\
		} = bc \\
		\phi\smallxy{
			\bullet \hen[dr] \\
			& \bullet \hen[dl] \\
			\bullet
		} = cb,\quad \phi\smallxy{
			\bullet \hen[dr] \\
			& \bullet \hen[dr] \\
			& & \bullet
		} = c^2
	\end{split}\end{equation*}
	$\mybf{2}^n$と$\T_{n+1}$のそれぞれの大きさを表
	\ref{table:集合の大きさの比較}に書いておいた。
	$|\mybf{2}^0|=|\T_1|=1$、$|\mybf{2}^1|=|\T_2|=2$となり、それ以降は、
	任意の$n\in\sizen$に対して$|\mybf{2}^{n+2}|<|\T_{n+3}|$となるから、
	$\phi$は$1:1$にはならないことがわかる。
	$\psi:\mybf{2}^*\to\T_+$を次のように定義すると、
	\begin{equation*}\begin{split}
		\psi 1 := \bullet,\quad \psi\lr{bw} := \beta\lr{\psi w, 0}
		,\quad \psi\lr{cw} := \beta\lr{0, \psi w} 
		\quad\text{for all } w\in\mybf{2}^*
	\end{split}\end{equation*}
	$\phi\psi=\id$となる。したがって、$\phi$は$\onto$となる。
	$\psi$はすべての頂点が子供を$0$または$1$つしか持たないリスト状の
	木に写像する。

\begin{table}[!htpd]\begin{center}\begin{tabular}{rrr}\hline
$n$ & $|\mybf{2}^n|$ & $|\T_{n+1}|$ \\\hline
1 & 2 & 2 \\ 
2 & 4 & 5 \\ 
3 & 8 & 14 \\ 
4 & 16 & 42 \\ 
5 & 32 & 132 \\ 
6 & 64 & 429 \\ 
7 & 128 & 1430 \\ 
8 & 256 & 4862 \\ 
9 & 512 & 16796 \\ 
10 & 1024 & 58786 \\ 
\hline\end{tabular}\end{center}
\caption{集合の大きさの比較}\label{table:集合の大きさの比較}
\end{table}
	次の図の？はどのような対応になるのだろうか。
	\begin{equation*}\xymatrix{
		\T_{n+1} \ar[r]^\phi \ar[d]^D_\simeq & \mybf{2}^n \ar@{.>}[d]^{?} \\
		\D_{n+1} \ar[r]^\phi & \mybf{2}^{2(n+1)} \\
	}\end{equation*}
%s2:平面上の二分木と格子上の経路}
\subsection{再起下降パーサーの構成}\label{s2:再起下降パーサーの構成} %{
	再起下降パーサーを、Chomsky-Schutzenbergerの定理にならって構成するのが
	見通しがよいだろう。
%s2:再起下降パーサーの構成}
\subsection{モノイド環}\label{s2:モノイド環} %{
	\begin{proposition}[対合射の一意性]\label{prop:対合射の一意性} %{
		$B=(B,m,u,\Delta,\epsilon)$を複素数上の双代数とする。
		$B$に対合射が存在するならば、唯一つ定まる。
	\end{proposition} %prop:対合射の一意性}

	\begin{proposition}[モノイド環のHopf代数]\label{prop:モノイド環のHopf代数} %{
		$k$を体、$G$をモノイド、$kG$を$G$の$k$-モノイド環とする。
		$kG$がHopf代数となることと、$G$が群であることは同値である。
	\end{proposition} %prop:モノイド環のHopf代数}
	\begin{proof} %{
		$kG=(kG,m,u,\Delta,\epsilon)$を双代数とする。$kG$にアンチポード
		$S\in\cat{Mod}_k(kG)$が定義できれば、$kG$はHopf代数となる。
		\begin{equation*}\begin{split}
			m(S\otimes\id)\Delta = u\epsilon = m(\id\otimes S)\Delta
		\end{split}\end{equation*}
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $G$が群ならばアンチポード$S$が定義できる。\\
			任意の$g\in G$に対して$Sg=g^{-1}$と定義すると、
			\begin{equation*}\begin{split}
				m(S\otimes\id)\Delta g = m(S\otimes\id)\Delta g = 
			\end{split}\end{equation*}
		\end{itemize} %}
	\end{proof} %}
%s2:モノイド環}
\subsection{Dyck言語と微分方程式の関係}\label{s2:Dyck言語と微分方程式の関係} %{
	$R$を可換環、$V$を$R$上の代数、$a,b,c\in V$として、
	次のq-微分方程式に対するPicardの逐次近似を考える。
	\begin{equation}\label{eq:q-微分方程式その一}\begin{split}
		x^q_t = a + \int_0^t(bx^q_scx^q_s)d_qs
	\end{split}\end{equation}
	解$x^q_t$が$t$に関して正則と仮定して次のように展開すると、
	\begin{equation*}\begin{split}
		x^q_t = \sum_{n\in\sizen}\frac{t^n}{[n]_q^!} x^q_n
		\quad\text{where } x^q_n\in V
	\end{split}\end{equation*}
	係数$x^q_t$に対する次の漸化式が得られる。
	\begin{equation*}\begin{split}
		x^q_0 = a,\quad x^q_{n+1} 
		= \sum_{r=0}^n\qbinom{n}{r}_q bx^q_rcx^q_{n-r}
	\end{split}\end{equation*}
	ある$n\in\sizen$があってすべての$k\le n$に対して$x^q_k=y^q_ka$
	となる$y^q_n\in V$が存在すると仮定すると、この漸化式より、
	次の式が成り立ち、
	\begin{equation*}\begin{split}
		x^q_{n+1} = \lr{\sum_{r=0}^n\qbinom{n}{r}_q by^q_racy^q_{n-r}}a
	\end{split}\end{equation*}
	$x^q_{n+1}=y^q_{n+1}a$となる$y^q_{n+1}\in V$が存在することがわかる。
	したがって、正則解$x^q_t$は、$x^q_t=y^q_ta$と書けることがわかる。
	そして、この$y^q_t$は次のq-微分方程式を満たす。
	\begin{equation*}\begin{split}
		y^q_t = 1 + \int_0^t(by^q_sacy^q_s)d_qs
	\end{split}\end{equation*}
	よって、q-微分方程式\eqref{eq:q-微分方程式その一}ではなく、
	次のq-微分方程式を考えれば十分である。
	\begin{equation}\label{eq:q-微分方程式その二}\begin{split}
		x^q_t = 1 + \int_0^t(bx^q_scx^q_s)d_qs
	\end{split}\end{equation}
	このq-微分方程式解$x^q_t$が$t$に関して正則と仮定して次のように展開
	すると、
	\begin{equation*}\begin{split}
		x^q_t = \sum_{n\in\sizen}\frac{t^n}{[n]_q^!} x^q_n
		\quad\text{where } x^q_n\in V
	\end{split}\end{equation*}
	係数$x^q_t$に対する次の漸化式が得られる。
	\begin{equation}\label{eq:q-微分方程式のテイラー級数その二}\begin{split}
		x^q_0 = a,\quad x^q_{n+1} 
		= \sum_{r=0}^n\qbinom{n}{r}_q bx^q_rcx^q_{n-r}
	\end{split}\end{equation}
	三次までの係数を求めると次のようになる。
	\begin{equation*}\begin{split}
		x^q_0 &= 1 \\
		x^q_1 &= bx^q_0cx^q_0 \\
		x^q_2 &= bx^q_0cx^q_1 + bx^q_1cx^q_0 \\
		x^q_3 &= bx^q_0cx^q_2 + [2]_qbx^q_1cx^q_1 + bx^q_2cx^q_0 \\
	\end{split}\end{equation*}
	三次の項からqの効果が現れることがわかる。
	一方、$q=0$の場合は次のように係数を真空期待値として表すことができる。
	\begin{equation*}\begin{split}
		x^0_t = \Braket{\begin{pmatrix}
				1 & 0
			\end{pmatrix}\begin{pmatrix}
				tb\eta_1 & 1 \\
				\eta_{-1}c & 0
			\end{pmatrix}^*\begin{pmatrix}
				0 \\ 1
			\end{pmatrix}} = \Braket{\lr{tb\eta_1 + \eta_{-1}c}^*} \\
		\implies x^0_n = \Braket{\lr{b\eta_1 + \eta_{-1}c}^{2n}}
	\end{split}\end{equation*}
	一般の$q$の場合にも、係数を真空期待値として表すことができないだろうか？

	平面二分木の助けを借りて定式化することを考える。
	$\T_n$を頂点数$2n+1$の平面二分木の集合、$\T_*:=\cup_{n\in\sizen}\T_n$
	をその合併とする。
	\begin{equation*}\begin{split}
		\T_0 &:= \Set{\circ} \\
		\T_1 &:= \Set{\vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \er[dl] \er[dr] \\
			\circ & & \circ \\
		}}} \\
		\T_2 &:= \Set{\vcenter{\xymatrix@R=1ex@C=1ex{
			& & \circ \er[dl] \er[dr] \\
			& \circ \er[dl] \er[dr] & & \circ \\
			\circ & & \circ \\
		}},\; \vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \er[dl] \er[dr] \\
			\circ & & \circ \er[dl] \er[dr] \\
			& \circ & & \circ \\
		}}} \\
 		\T_3 &:= \Set{\vcenter{\xymatrix@R=1ex@C=1ex{
			& & & \circ \er[dl] \er[dr] \\
			& & \circ \er[dl] \er[dr] & & \circ \\
			& \circ \er[dl] \er[dr] & & \circ \\
			\circ & & \circ \\
		}},\; \vcenter{\xymatrix@R=1ex@C=1ex{
			& & & \circ \er[dl] \er[dr] \\
			& & \circ \er[dl] \er[dr] & & \circ \\
			& \circ & & \circ \er[dl] \er[dr] \\
			& & \circ & & \circ \\
		}},\; \vcenter{\xymatrix@R=1ex@C=1ex{
			& & \circ \er[dl] \er[dr] \\
			& \circ \er[dl] \er[d] & & \circ \er[dr] \er[d] \\
			\circ & \circ & & \circ & \circ \\
		}},\; \vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \er[dl] \er[dr] \\
			\circ & & \circ \er[dl] \er[dr] \\
			& \circ \er[dl] \er[dr] & & \circ \\
			\circ & & \circ \\
		}},\; \vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \er[dl] \er[dr] \\
			\circ & & \circ \er[dl] \er[dr] \\
			& \circ & & \circ \er[dl] \er[dr] \\
			& & \circ & & \circ \\
		}}}
	\end{split}\end{equation*}
	ここで、双線形射$\beta:R\T_*\otimes R\T_*\to R\T_*$を次のように定義する。
	\begin{equation*}\begin{split}
		\beta\lr{\tau_1\otimes\tau_2} := \vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \er[dl] \er[dr] \\
			\tau_1 & & \tau_2 \\
		}} \quad\text{for all } \tau_1,\tau_2\in\T_*
	\end{split}\end{equation*}
	$\beta$は結合的でもないし単位元も持たない二項演算だが、
	\begin{equation*}\begin{split}
		\beta\lr{\id\otimes\beta}\lr{\tau_1\otimes\tau_2\otimes\tau_3}
		&= \vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \er[dl] \er[dr] \\
			\tau_1 & & \circ \er[dl] \er[dr] \\
			& \tau_2 & & \tau_3 \\
		}} \\
		\beta\lr{\beta\otimes\id}\lr{\tau_1\otimes\tau_2\otimes\tau_3}
		&= \vcenter{\xymatrix@R=1ex@C=1ex{
			& & \circ \er[dl] \er[dr] \\
			& \circ \er[dl] \er[dr] & & \tau_3 \\
			\tau_1 & & \tau_2 \\
		}}
	\end{split}\end{equation*}
	$\circ$と$\beta$から$\T_*$を生成することができる。
	\begin{equation*}\begin{split}
		\T_0 &= \Set{\circ} \\
		\T_{n+1} &= \cup_{k=0}^n\Set{\beta\lr{\tau_1\otimes\tau_2}
		\bou \tau_1\in\T_k,\; \tau_2\in\T_{n-k}}
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}

	線形射$\dabs{-}:R\T_*\to R$を次のように定義する。
	\begin{equation*}\begin{split}
		\dabs{\tau} = n \xiff{\dfn} \tau\in\T_n
	\end{split}\end{equation*}
	$\dabs{\tau}$は$\tau$の中に含まれる$[\circ,\circ]$の個数を数える演算と
	なっている。$\dabs{\tau}$を$\tau$の次数ということにする。

	線形射$\gamma_q:R\T_*\to R\T_*$を次のように定義し、
	\begin{equation*}\begin{split}
		\gamma_q\circ &:= \beta\lr{\circ\otimes\circ} \\
		\gamma_q\beta\lr{\tau_1\otimes\tau_2} 
		&:= \beta\lr{\gamma_q\tau_1\otimes\tau_2} 
			+ q^{\dabs{\tau_1}} \beta\lr{\tau_1\otimes\gamma_q\tau_2} 
			\quad\text{for all } \tau_1,\tau_2\in\T_*
	\end{split}\end{equation*}
	$\gamma_q$を（平面二分木の）自然な成長ということにする。
	ここで、$q=0$のときは次の約束を使うものとする。
	\begin{equation*}\begin{split}
		\lim_{q\to0}q^{\dabs{\tau}}=\jump{\tau=\circ}
		\quad\text{for all } \tau\in\T_*
	\end{split}\end{equation*}
	この約束を使うと、$q=0$の場合は次のようになる。
	\begin{equation*}\begin{split}
		\gamma_0\beta\lr{\tau_1\otimes\tau_2} 
		&= \beta\lr{\gamma_0\tau_1\otimes\tau_2} 
			+ \jump{\tau_1=\circ}\beta\lr{\tau_1\otimes\gamma_0\tau_2} 
			\quad\text{for all } \tau_1,\tau_2\in\T_*
	\end{split}\end{equation*}
	自然な成長を$\beta$との交換関係で書くと次のようになる。
	\begin{equation*}\begin{split}
		\gamma_q\beta 
		= \beta\lr{\gamma_q\otimes\id + q^{\dabs{-}}\otimes\gamma_q}
	\end{split}\end{equation*}
	自然な成長は次の式を満たす。
	\begin{equation*}\begin{split}
		\gamma_q^{n+1}\circ = \sum_{k=0}^n \qbinom{n}{k}_q
		\beta\lr{\gamma_q^k\circ\otimes\gamma_q^{n-k}\circ}
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	\begin{proof} %{
		$\gamma_q^{n+1}$の$n$についての帰納法で証明する。
		$\gamma_q$の定義より次の式が成り立ち、
		\begin{equation*}\begin{split}
			\gamma_q\circ = \beta\lr{\circ\otimes\circ} 
			= \sum_{k=0}^0 \qbinom{0}{k}_q
			\beta\lr{\gamma_q^k\circ\otimes\gamma_q^{n-k}\circ}
		\end{split}\end{equation*}
		$n=0$のとき命題が成り立つことがわかる。ある$n\in\sizen$で命題が成り立つ
		とすると、次の式が成り立つが、
		\begin{equation*}\begin{split}
			\gamma_q^{n+2}\circ &= \sum_{k=0}^n \qbinom{n}{k}_q \gamma_q
				\beta\lr{\gamma_q^k\circ\otimes\gamma_q^{n-k}\circ} \\
			&= \sum_{k=0}^n \qbinom{n}{k}_q\lr{
				\beta\lr{\gamma_q^{k+1}\circ\otimes\gamma_q^{n-k}\circ}
				+ q^k \beta\lr{\gamma_q^k\circ\otimes\gamma_q^{n-k+1}\circ}} \\
			&= \sum_{k=1}^n \lr{\qbinom{n}{k-1}_q + q^k \qbinom{n}{k}_q}
				\beta{\gamma_q^k\circ\otimes\gamma_q^{n+1-k}\circ} \\
			&\; + \qbinom{n}{n}_q 
			\beta\lr{\gamma_q^{n+1}\circ\otimes\gamma_q^{0}\circ}
				+ \qbinom{n}{0}_q 
				\beta\lr{\gamma_q^{0}\circ\otimes\gamma_q^{n+1}\circ} \\
		\end{split}\end{equation*}
		q-二項係数について成り立つ次の式を使うと、
		\begin{alignat*}{2}
			\qbinom{n+1}{k+1} &= \qbinom{n}{k} + q^{k+1}\qbinom{n}{k+1}
			&\quad& \text{for all } n\in\sizen,\; k\in1..n \\
			\qbinom{n}{n}_q &= \qbinom{n+1}{n+1}_q 
			= \qbinom{n}{0}_q = \qbinom{n+1}{0}_q = 1 
			&\quad& \text{for all } n\in\sizen
		\end{alignat*}
		次の式が成り立ち、$n+1$でも命題が成り立つことが示される。
		\begin{equation*}\begin{split}
			\gamma_q^{n+2}\circ &= \sum_{k=0}^{n+1} \qbinom{n+1}{k}_q
				\beta\lr{\gamma_q^k\circ\otimes\gamma_q^{n+1-k}\circ} \\
		\end{split}\end{equation*}
	\end{proof} %}

	線形射$\phi:R\T_*\to V$を次のように定義する。
	\begin{equation*}\begin{split}
		\phi\circ &:= 1 \\
		\phi\beta\lr{\tau_1\otimes\tau_2} &:= b(\phi\tau_1)c(\phi\tau_2)
		\quad\text{for all } \tau_1,\tau_2\in\T_*
	\end{split}\end{equation*}
	双線形射$\beta:V\otimes V\to V$を次のように定義すると、
	\begin{equation*}\begin{split}
		\beta\lr{x\otimes y} := bxcy \quad\text{for all } x,y\in V
	\end{split}\end{equation*}
	次の交換関係が成り立つ。
	\begin{equation*}\begin{split}
		\phi\beta = \beta\lr{\phi\otimes\phi}
	\end{split}\end{equation*}
	$\beta$はDyck言語$\phi R\T_*\subseteq V$だけでなく、$V$全体で定義
	できることに注意する。$V$の積を$m$とすると、次の交換関係が成り立つから、
	\begin{equation*}\begin{split}
		m\lr{\beta\otimes\id} = \beta\lr{\id\otimes m}
	\end{split}\end{equation*}
	この交換関係を使って$R\T_*$に積$m$を定義することができる。
	\begin{alignat*}{2}
		m\lr{\circ\otimes t} &:= t =: m\lr{t\otimes\circ}
			&\quad&\text{for all } t\in R\T_* \\
		m\lr{\beta\otimes\id}\lr{t_1\otimes t_2\otimes t_3} 
			&:= \beta\lr{\id\otimes m}\lr{t_1\otimes t_2\otimes t_3}
			&\quad&\text{for all } t_1,t_2,t_3\in R\T_*
	\end{alignat*}
	$\tau_1,\tau_2\in\T_*$として、$m\lr{\tau_1\otimes\tau_2}$は、
	$\tau_1$の右端の葉を$\tau_2$で置き換える操作になる。
	
	$X^q_n\in V$を次のように定義すると、
	\begin{equation*}\begin{split}
		X^q_n := \phi\gamma_q^n\circ \quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	$X^q_n$は次の漸化式を満たす。
	\begin{equation*}\begin{split}
		X^q_0 &= 1 \\
		X^q_{n+1} &= \sum_{k=0}^n \qbinom{n}{k}_q bX^q_kcX^q_{n-k}
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	この式はq-微分方程式\eqref{eq:q-微分方程式その二}の解の係数が満たす漸化式
	\eqref{eq:q-微分方程式のテイラー級数その二}に他ならない。

	\begin{todo}[ココマデ]\label{todo:ココマデ} %{
		多項式環$R[t]$の通常の積を$m$とし、q-微分を
		$\partial_q:=\lr{\partial_t}_q$と書く。
		線形射$N:R[t]\to R[t]$を次のように定義すると、
		\begin{equation*}\begin{split}
			Nt^n = nt^n \quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
		次の式が成り立ち、
		\begin{equation*}\begin{split}
			\partial_q m = m\lr{\partial_q\otimes\id + q^N\otimes\partial_q}
		\end{split}\end{equation*}
		次の式が成り立つ。
		\begin{equation*}\begin{split}
			\partial_q^n m = m\lr{\partial_q\otimes\id + q^N\otimes\partial_q}^n
		\end{split}\end{equation*}
		ある$n\in\sizen$で次の式が成り立つと仮定すると、
		\begin{equation}\label{eq:q-Leibnitz則}\begin{split}
			\lr{\partial_q\otimes\id + q^N\otimes\partial_q}^n
			= \sum_{k=0}^n \qbinom{n}{k} 
			\lr{q^{kN}\partial_q^k\otimes\partial_q^{n-k}}
		\end{split}\end{equation}
		$\partial_qq^{kN}=q^{k(N+1)}\partial_q$より、次の式が成り立つが、
		\begin{equation*}\begin{split}
			\lr{\partial_q\otimes\id + q^N\otimes\partial_q}^{n+1}
			= \sum_{k=0}^n \qbinom{n}{k}\lr{
			q^{k(N+1)}\partial_q^{k+1}\otimes\partial_q^{n-k}
			+ q^{(k+1)N}\partial_q^k\otimes\partial_q^{n-k+1}}
		\end{split}\end{equation*}
		q-二項係数に関するいつもの公式を使うと、次のようになって、
		\begin{equation*}\begin{split}
			\lr{\partial_q\otimes\id + q^N\otimes\partial_q}^{n+1}
			= \sum_{k=0}^{n+1} \qbinom{n+1}{k}_q
			\lr{q^{kN}\partial_q^k\otimes\partial_q^{n+1-k}}
		\end{split}\end{equation*}
		$n+1$でも式\eqref{eq:q-Leibnitz則}が成り立つことがわかる。
		したがって、$\chi_1\chi_{-1}=1$とし、$t$を$R$に値を持つ不定元とすると、
		\begin{equation*}\begin{split}
			\Braket{\lr{tb\chi_1 + \chi_{-1}c}^{2(n+1)}}
			= \sum_{k=0}^n tb\Braket{\lr{tb\chi_1 + \chi_{-1}c}^{2r}}
				c\Braket{\lr{tb\chi_1 + \chi_{-1}c}^{2(n-r)}}
		\end{split}\end{equation*}
		より、\Midline{次の式が成り立ちそうに思える}明らかに成り立たない。
		\begin{equation*}\begin{split}
			&\lim_{t\to0} \Braket{\lr{\partial_t}_q^{n+1}
				\lr{tb\chi_1 + \chi_{-1}c}^{2(n+1)}} \\
			&= \lim_{s,t\to0}\sum_{k=0}^n \qbinom{n}{k}_q
				b\Braket{\lr{\partial_s}_q^k
				\lr{sb\chi_1 + \chi_{-1}c}^{2k}}
				c\Braket{\lr{\partial_t}_q^{n-k}
				\lr{tb\chi_1 + \chi_{-1}c}^{2(n-k)}}
		\end{split}\end{equation*}
		この式が成り立つと、次のような交換関係を定義して、
		\begin{equation*}\begin{split}
			\chi_1\chi_{-1} = 1
			,\quad \tau_1\tau_{-1} = 1
			,\quad \chi_i\tau_j = \tau_j\chi_i \quad\text{for all } i,j=\pm1
		\end{split}\end{equation*}
		Fock空間を次のように定義して、
		\begin{equation*}\begin{split}
			\bra{1}\chi_{-1} = \bra{1}\tau_{-1} = 0
			,\quad \chi_{1}\ket{1} = \tau_{1}\ket{1} = 0
		\end{split}\end{equation*}
		$Y^q_n\in V$を次のように定義すると、
		\begin{equation*}\begin{split}
			Y^q_n 
			:= \Braket{\lr{\tau_1}_q^*\lr{\tau_{-1}b\chi_1 + \chi_{-1}c}^{2n}}
		\end{split}\end{equation*}
		$Y^q_n$は漸化式\eqref{eq:q-微分方程式のテイラー級数その二}を満たすこと
		になる。

		線形射$-^r:R\T_*\to R\T_*$を次のように定義する。
		\begin{equation*}\begin{split}
			\circ^r = \circ,\quad \lr{\beta\lr{\tau_1\otimes\tau_2}}^r
		\end{split}\end{equation*}

		線形射$-!:R\T_*\to R$を次のように定義する。
		\begin{equation*}\begin{split}
			\circ! &:= 1 \\
			\gdyck{\tau_1,\tau_2}! &:= \dabs{\gdyck{\tau_1,\tau_2}}
				\lr{\tau_1!}\lr{\tau_2!}
		\end{split}\end{equation*}
		すると、$-!$はButcherの根付き平面木に対する階乗に一致する。

		次の式より、
		\begin{equation*}\begin{split}
			\qbinom{0}{k}_q = 1 \quad\text{for all } k=0,\quad
			\qbinom{1}{k}_q = 1 \quad\text{for all } k=0,1
		\end{split}\end{equation*}
		$\gamma_q$のべきが$2$以下では$q$の値に依らずに同一の係数を与える。
		\begin{equation*}\begin{split}
			\phi\gamma_q^n\circ = \phi\gamma_0^n\circ
			\quad\text{for all } n=0,1,2
		\end{split}\end{equation*}
		$\gamma_q$のべきが$3$以上で$q$の効果が現れる。

		次のように、$2$次の自然な成長までは、$q=0$の場合の真空期待値と
		$q$が$0$でない場合の係数は等しいが、
		\begin{alignat*}{2}
			\phi\gamma_q^0\circ &= a 
			&&= \Braket{\lr{b\eta + \eta^\dag ac}^0}a \\
			\phi\gamma_q^1\circ &= baca 
			&&= \Braket{\lr{b\eta + \eta^\dag ac}^2}a \\
			\phi\gamma_q^2\circ &= b^2(ac)^2a + (bac)^2a 
			&&= \Braket{\lr{b\eta + \eta^\dag ac}^4}a
		\end{alignat*}
		$q$変形の効果により、$3$次の自然な成長から、$q=0$の場合の真空期待値
		と$q$が$0$でない場合の係数とのズレが現れる。
		\begin{equation*}\begin{split}
			\phi\gamma_q^3\circ &= b^3(ac)^3a + b(bac)^2aca 
				+ [2]_q b^2(ac)^2baca + bacb^2(ac)^2a + (bac)^3a \\
			&= \Braket{\lr{b\eta + \eta^\dag ac}^6}a
				+ q b\Braket{\lr{b\eta + \eta^\dag ac}^2}ac
				\Braket{\lr{b\eta + \eta^\dag ac}^2}a \\
			&= \sum_{k=0}^2 \qbinom{2}{k}_q
				b\Braket{\lr{b\eta + \eta^\dag ac}^{2k}}
				ac \Braket{\lr{b\eta + \eta^\dag ac}^{2(n-k)}}a \\
			&= \sum_{k=0}^2 \qbinom{2}{k}_q
				b\lr{\phi\gamma_0^k\circ}ac\lr{\phi\gamma_0^{n-k}\circ} \\
		\end{split}\end{equation*}
		この$3$次の自然な成長による式を、代数の変形もしくは、作用素の挿入
		によって単一の真空期待値として表すことはできないものだろうか。

		Schutzenbergerの公式
		\begin{equation*}\begin{split}
			xy = qyx \implies (x + y)^n = \sum_{k=0}^n \qbinom{n}{k} y^kx^{n-k}
		\end{split}\end{equation*}
		を使ってみる。$\xi_1,\xi_2$を次の交換関係を満たす不定元とすると、
		\begin{equation*}\begin{split}
			\xi_2\xi_1 = q\xi_1\xi_2
		\end{split}\end{equation*}
		次の式が成り立つ。
		\begin{equation*}\begin{split}
			\Braket{\lr{b\xi_1\eta + \eta^\dag\xi_2 ac}^2}a
			&= baca(\xi_1\xi_2) \\
			\Braket{\lr{b\xi_1\eta + \eta^\dag\xi_2 ac}^4}a
			&= b^2(ac)^2a(\xi_1^2\xi_2^2) + (bac)^2a (\xi_1^2\xi_2^2)
		\end{split}\end{equation*}

		以下の議論はダメだが、バックアップとして残しておく。
	\end{todo} %todo:ココマデ}

	単純にBrzozowski代数をq-シャッフル積によって変形しただけだと、
	次のようになって、$q=0$のとき以外は、
	係数の漸化式\eqref{eq:q-微分方程式のテイラー級数}は満たさない。
	\begin{equation*}\begin{split}
		y^q_n := t^{-n}\Braket{\lr{tb\eta_1 + a\lr{\eta_{-1}}_qc}^{2n}}a
		\quad\text{for all } n\in\sizen \\
		\implies \left\{\begin{split}
			y^q_0 &= a \\
			y^q_1 &= by^q_0cy^q_0 \\
			y^q_2 &= by^q_0cy^q_1 + [2]_q by^q_1cy^q_0 \\
			\cdots \\
		\end{split}\right.
	\end{split}\end{equation*}
	もちろん、q-シャッフル積による変形でq-微分方程式の解が得られる根拠は
	どこにもないので、成り立たなくて当然ではある。

	平面二分木全体のつくる集合を$\T$、$A=\set{a,b,c}$を文字集合とし、
	$\phi_A\in\cat{Mod}_\fukuso(\fukuso\T,\fukuso A^*)$と
	$\phi^q_t\in\cat{Mod}_\fukuso(\fukuso\T,\fukuso[q,t])$を次のように
	定義する。
	\begin{alignat*}{2}
		\phi_A\circ &:= a, &\quad
		\phi_A\lr{\vcenter{\xymatrix@R=2ex@C=2ex{
			& \circ \er[dl] \er[dr] \\
			\tau_1 & & \tau_2
		}}} &:= b\lr{\phi_A\tau_1}c\lr{\phi_A\tau_2} \\
		\phi^q_t\circ &:= 1, &\quad
		\phi^q_t\lr{\vcenter{\xymatrix@R=2ex@C=2ex{
			& \circ \er[dl] \er[dr] \\
			\tau_1 & & \tau_2
		}}} &:= \int_0^t\tau_0^t\lr{\phi^q_s\tau_1}\lr{\phi^q_s\tau_2}d_qs
	\end{alignat*}
	$X^q_t:=\sum_{\tau\in\T}(\phi^q_t\tau)\otimes(\phi_A\tau)$と定義すると、
	$\fukuso[q,t]\otimes\fukuso A^*\simeq_\fukuso \fukuso A^*[q,t]$の
	同一視によって、$X^q_t$はq-微分方程式\eqref{eq:q-微分方程式}の解となる。
	\begin{equation*}\begin{split}
		X^q_t &= a + \sum_{\tau_1,\tau_2\in\T}
			\int_0^t b\lr{\lr{\phi^q_s\tau_1}\lr{\phi_A\tau_1}}
			c\lr{\lr{\phi^q_s\tau_2}\lr{\phi_A\tau_2}} d_qs \\
		&= a + \int_0^t bX^q_tcX^q_t d_qs
	\end{split}\end{equation*}

	q-微分方程式\eqref{eq:q-微分方程式}の解$x^q_t$が$q=0$の時の解$x^0_t$を
	用いて次のように書けると仮定すると、
	\begin{equation*}\begin{split}
		x^q_t = \sum_{n\in\sizen} t^n\xi^q_nx^0_n
		\quad\text{where } \xi^q_n\in \fukuso[q]
	\end{split}\end{equation*}
	次の漸化式が得られるが、
	\begin{equation*}\begin{split}
		c^q_0 = 1,\quad [n+1]_q\xi^q_{n+1}\sum_{r=0}^n bx^0_rcx^0_{n-r}
		= \sum_{r=0}^n \xi^q_r\xi^q_{n-r} bx^0_rcx^0_{n-r}
	\end{split}\end{equation*}
	$bx^0_rcx^0_{n-r}$が各$r=0,1,\dots,n$で互いに$R$-線形独立だから、
	次の式が得られる。
	\begin{equation*}\begin{split}
		[n+1]_q\xi^q_{n+1} = \xi^q_{r}\xi^q_{n-r} 
		\quad\text{for all } n\in\sizen,\; r=0,\dots,n
	\end{split}\end{equation*}


	\begin{todo}[宿題]\label{todo:宿題} %{
		q-二項係数について成り立つ次の式を幾何的に理解したい。
		\begin{equation*}\begin{split}
			\qbinom{n+1}{r+1}_q = q^r\qbinom{n}{r+1}_q + \qbinom{n}{r}_q
			\quad\text{for all } n\in\sizen,\; r=0,\dots,n
		\end{split}\end{equation*}
	\end{todo} %todo:宿題}
%s2:Dyck言語と微分方程式の関係}
%s1:覚書}
\section{Chomsky-Schutzenberger}\label{s1:Chomsky-Schutzenberger} %{
	論文\cite{Chomsky1963118}のノート。
	論文中で使われている記号を書いておく。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $V_T$を終端記号の集合、$V_N$を非終端記号の集合とする。
		\item $F\braket{X}$を有限集合から生成される自由モノイドとする。
		\item $r:F<V_T>\to\sei$とし、$r$の適用を$f\in F\braket{V_T}$に対して
		$\braket{r,f}$と書く。さらに、写像と自由加群の同型対応
		$\cat{Set}_\sei(F\braket{V_T},\sei)\simeq\sei F\braket{V_T}$を使って、
		$r$を次のように表す。
		\begin{equation*}\begin{split}
			r = \sum_{f\in F\braket{V_T}}\braket{r, f}f^\dag
			\simeq \sum_{f\in F\braket{V_T}}\braket{r,f}f
		\end{split}\end{equation*}
		$\sup(r)\subseteq F\braket{V_T}$を次のように定義する。
		\begin{equation*}\begin{split}
			\sup(r) := \set{f\in F\braket{V_T}\bou \braket{r,f}\neq0}
		\end{split}\end{equation*}
		さらに、次の言葉を定義している。
		\begin{description}\setlength{\itemsep}{-1mm} %{
			\item[正の形式級数] $r$の係数がすべて非負のとき
			\item[固有の形式級数] $r$の係数がすべて$0$か$1$のとき
		\end{description} %}
		$\sei F\braket{V_T}$にカットオフつきの同値関係を次のように定義する。
		\begin{equation*}\begin{split}
			r_1 \equiv r_2 (\bmod \deg n) \xiff{\dfn} 
			\braket{r_1,f} = \braket{r_2,f} \quad\text{for all } |f|\le n
		\end{split}\end{equation*}
		%
		\item 文法$G$に対して$G$から生成される単語の列挙を$r(G)$で表す。
		すると、$\sup r(G)$が$G$から生成される言語になる。また、
		$f\in F\braket{V_T}$に対して$\braket{r(G),f}$は$f$の曖昧さの数を
		表す。曖昧さの数を$N(G,F):=\braket{r(G),f}$と書く。
		%
		\item 文法が次のように与えられたする。
		\begin{equation*}\begin{split}
			\alpha_i \to \phi_{i,j}(\alpha_1,\dots,\alpha_n)
			\quad\text{for all } i=1,\dots,n,\; j=1,\dots,m_i
		\end{split}\end{equation*}
		すると、次のように書き換えて
		\begin{equation*}\begin{split}
			\alpha_i = \cup_{j=1}^{m_i} \phi_{i,j}(\alpha_1,\dots,\alpha_n)
		\end{split}\end{equation*}
		$\alpha_i$を$r_i$に置き換えることで、文法に対応する
		$\sei F\braket{V_T}$の再帰式が定まる。
		\begin{equation*}\begin{split}
			r_i = \psi_i(r_1,\dots,r_n) \quad\text{for all } i=1,\dots,n
		\end{split}\end{equation*}
		$\psi_i$は$\cup_{j=1}^{m_i} \phi_{i,j}$に対応する多項式である。
		$\psi:(\sei F\braket{V_T})^n\to(\sei F\braket{V_T})^n$を次のように
		定義する。
		\begin{equation*}\begin{split}
			\psi (x_1,\dots,x_n) := (\psi_1x_1,\dots,\psi_nx_n)
			\quad\text{for all } x_i\in \sei F\braket{V_T}
		\end{split}\end{equation*}
		%
		\item 文法から生成される$(\sei F\braket{V_T})^n$を考える。
		$\rho_i\in(\sei F\braket{V_T})^n$を次のように定義する。
		\begin{equation*}\begin{split}
			\rho_0 &:= (0,\dots,0) \\
			\rho_1 &:= \psi\rho_0 \\
			\rho_2 &:= \psi\rho_1 \\
			\cdots \\
		\end{split}\end{equation*}
		次のような言葉を定義している。
		\begin{description}\setlength{\itemsep}{-1mm} %{
			\item[文法の解] $\rho_\infty$を文法$\psi$の解という。
			\item[代数的] ある多項式$\xi$があって$\rho=\xi\rho$を満たす$\rho$
			を代数的な形式級数という。
			\item[文脈自由] 係数がすべて正の多項式$\xi$があって$\rho=\xi\rho$
			を満たす$\rho$を文脈自由という。文脈自由は代数的の特別の場合になる。
		\end{description} %}
		%
		\item Hadamard積$\odot$を
		$\braket{r_1\odot r_2,f}:=\braket{r_1,f}\braket{r_2,f}$によって
		定義する。Hadamard積の有用性は、
		$\sup(r_1\odot r_2)=(\sup r_1)\cap(\sup r_2)$となることにある。
		二つの言語の共通をとるときに便利である。
		%
		\item 文字列$f$の反転を$\tilde{f}$と書く。
		%
		\item $\phi:\sei F\braket{V_T}\to\sei$を環準同型、$r\in F\braket{V_t}$
		を代数的な形式級数とすると、$\phi r$は文字列の長さに対して
		指数関数より小さく増加していく。
		\begin{equation*}\begin{split}
			r = \sum_{w\in\W_A}r_ww
			\implies r_{(n)} := |\sum_{\substack{w\in\W_A\\|w|=n}} r_w| \le n!
		\end{split}\end{equation*}
		このことは自明に思えないが、知る限りの例では成り立っている。
		このことが成り立つことを信じると、Tayler展開$\sum_nr_{(n)}t^n/n!$は収束
		して、文法と解析との関係をつけることができる。
		%
		\item 文法規則を次のように定義している。
		\begin{alignat*}{2}
			\alpha &\to f\beta &\quad&\text{右線形} \\
			\alpha &\to \beta f &\quad&\text{左線形} \\
			\alpha &\to f\beta g &\quad&\text{線形} \\
			\alpha &\to f &\quad&\text{終端} \\
		\end{alignat*}
		文法の族を次のように定義している。
		\begin{alignat*}{2}
			\mycal{P}^+ & \text{多項式} \\
			\mycal{L}_0^+ & \text{片側線形} \\
			\mycal{L}^+ & \text{線形} \\
			\mycal{L}_m^+ & \text{メタ線形} \\
			\mycal{J}^+ & \text{文脈自由} \\
		\end{alignat*}
		%
		\item 自己埋め込み文法
		\begin{equation*}\begin{split}
			\ggdyck{\phi\gdyck{\psi}\xi}
			\quad\text{where } \phi,\xi\in\sei F\braket{V_T}
			,\; \psi \text{ is dyck language over $\ldyck$ and $\rdyck$}
		\end{split}\end{equation*}
		%
		\item 次の線形な文法を考える。
		\begin{equation*}\begin{split}
			\alpha = a + \sum_{i=1}^n b_i\alpha c_i
		\end{split}\end{equation*}
		この解は次のように書ける。
		\begin{equation*}\begin{split}
			\alpha = \Braket{B^*aC^*}
			\quad\text{where } B = \sum_{i=1}^n b_i\eta_i,\;
			C = \sum_{i=1}^n \eta_i^\dag c_i
		\end{split}\end{equation*}
		$\langle B^*$と$C^*\rangle$がコヒーレント状態となり、
		コヒーレント状態は逆順の準同型を与えることに注意すると、
		$H_n:=\set{\eta_1,\dots,\eta_n}^*$として、次の式が得られる。
		\begin{equation*}\begin{split}
			\alpha = \sum_{w\in H_n}\bra{1}B^*\ket{w}a\bra{w}C^*\ket{1}
			= \sum_{w\in H_n} (\phi_L w^R)a(\phi_R w) \\ 
		\end{split}\end{equation*}
		ここで、$-^R$は文字列の反転を表し、$\phi_L$と$\phi_R$は次の式を
		満たす代数準同型である。
		\begin{equation*}\begin{split}
			\phi_L\eta_i = b_i,\; \phi_R\eta_i = c_i 
			\quad\text{for all } i=1,\dots, n
		\end{split}\end{equation*}
		%
		\item Dyck言語を生成する文法
		\begin{equation*}\begin{split}
			\alpha_i = x_i\lr{\gamma - \alpha_{-i}}^*x_{-i}
			\quad\text{for all } i=\pm1,\dots,\pm n \\
			\beta = \gamma^*,\quad \gamma = \sum\alpha_i
		\end{split}\end{equation*}
		難しい。
		\item Chomsky-Schutzenbergerの定理を証明している論文\cite{book1976}
		を読んでみる。大きさ$2n$の集合
		$\Delta_n:=\set{a_1,\dots,a_n,a_1^\dag,\dots,a_n^\dag}$
		を用いてDyck言語$D_n$を定義する。自由モノイド$\Delta_n^*$に合同式
		$\sim$を次のように定義する。
		\begin{equation*}\begin{split}
			aa^\dag \sim 1 \quad\text{for all } a\in\Delta_n^+
		\end{split}\end{equation*}
		Dyck言語$D_n$は、合同式$\sim$を用いて
		$D_n:=\set{w\in\Delta_n^*\bou w\sim 1}$と定義できる。
		$w\in\Delta_n^*$と$\sim$が等しい単語の集合を$(w)_\sim$と書く。
		\begin{equation*}\begin{split}
			(w)_\sim := \set{x\in\Delta_n^*\bou x\sim w}
		\end{split}\end{equation*}
		$(w)_\sim$の中には長さが最小の単語が唯一つ必ず存在する。
		$\sim$をとっても変化しない単語がそれである。それを$\mu w$と書く。
		\begin{equation*}\begin{split}
			\mu: \Delta_n^* &\to \Delta_n^* \\
				w &\mapsto (\mu w)\in\Delta_n^* \text{ such that }
				\mu w \sim w \\
				&\quad\text{and } (\mu w) \text{ is already in normal ordered form}
		\end{split}\end{equation*}
		$\mu$は次の性質を持つ。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $|\mu w|\le |w|$かつ$|\mu w|=|w|\iff \mu w=w$となる。
			\item $\mu w=1\iff w\in D_n$となる。
			\item 任意の$x,y\in\Delta_n^*$に対して$\mu(xy)=\mu\glr{(\mu x)y}$
			となる。
			\item 任意の$x\in\Delta_n^*$と$y\in(\Delta_n^+)^*$に対して
			$\mu(xy)=(\mu x)y$となる。
		\end{itemize} %}
		$\mu$は正規積の形に書き直すWickの定理である。
	\end{itemize} %}
\subsection{考えたことその二}\label{s2:考えたことその二} %{
	次の可換図によって、代数射$f,g$と余積$\epsilon$から線形射$f_*$を
	定義する。
	\begin{equation*}\begin{split}
		\xymatrix{
			RA^* \ar[r]^{\myop{dup}} \ar@{.>}[d]^{f_*} 
			& RA^*\otimes RA^* \ar[r]^{f\otimes g}
			& V\otimes W \ar[d]^{\id\otimes\epsilon} \\
			V & & V\otimes R \ar[ll]_{\simeq_R} \\
		}
	\end{split}\end{equation*}
	幾つか疑問がある。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 余単位射$\epsilon$を使うのは必然か？ \\
		線形射$f_*$を得るためだけであれば、$W\to R$は線形射であれば何でもよい。
		そこで余単位射を使うこのによるメリットは何であろうか。
		現状では、たまたま成り立つBrzozowski代数で成り立つ式を利用している
		だけである。たとえそうだったとしても、この構造を量子変形して役に立つ
		結果を得ることができるだろうか。形式言語にしか役に立たない理論よりは
		他の分野と関係する理論であった方が、結果の相互利用ができる点で
		優れている。
		\item Rota-Baxter作用素 \\
		複素数上の多項式環$\fukuso[x]$で微分作用素$\partial_x$は
		$\partial_xx=1+x\partial_x$という交換関係を満たす。そして、積分作用素
		$\int_x$を次のように定義する。
		\begin{equation*}\begin{split}
			\int_x f_x := \int_0^x dy f_y \quad\text{for all } f_x\in\fukuso[x]
		\end{split}\end{equation*}
		すると、$\int_x$は$\partial_x\int_x=1$という交換関係を満たし、
		次のBaxterの関係を満たす。
		\begin{equation*}\begin{split}
			\int_xm\lr{\partial_x\otimes\partial_x}
			= m\lr{\int_x\partial_x\otimes\id + \id\otimes\int_x\partial_x}
			- \int_x\partial_xm
		\end{split}\end{equation*}
		$P$を次のようにおくと、
		\begin{equation*}\begin{split}
			P_x := 1 - \int_x\partial_x
		\end{split}\end{equation*}
		$\mycal{C}:=\ker\partial_x=P_x\fukuso[x]$となり、
		$\mycal{I}:=\ker P_x$とおくと、$\fukuso[x]=\mycal{C}\oplus\mycal{I}$
		と直和分解できる。
		$\int_x$を定義する積分の下限を定数$c$で置き換えて、
		$f_x\mapsto\int_c^xdyf_y$としても同じ代数が得られる。
	\end{itemize} %}
%s2:考えたことその二}
\subsection{考えたこと}\label{s2:考えたこと} %{
	考えの断片
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 線形化$\phi=a+b\eta+\eta^\dag c$とすると、
		\begin{equation*}\begin{split}
			\braket{\phi^*} = \begin{cases}
				1 + b\braket{\phi^*}c\braket{\phi^*}, &\text{ iff } a = 1 \\
				1 + \gglr{a + b\braket{\phi^*}c}\braket{\phi^*}
				, &\text{ otherwise } \\
			\end{cases}
		\end{split}\end{equation*}
		\item 真空期待値$\braket{-}:V\B_A\to V$
		\item 埋め込み$\bra{1}-:V\B_A\to\cat{Mod}_R(RA^*,V)$
		\item 射影$\pi_\B:V\W_{A\cup A^\dag}\to V\B_A$
		\item Dyck言語$V\D_A=\pi_\B^{-1}V\subseteq V\W_{A\cup A^\dag}$
	\end{itemize} %}

	$V$を環、$V\B_1$を$V$上のBrzozowski代数とする。
	\begin{equation*}\begin{split}
		V\B_1 := \frac{V\braket{\eta_1,\eta_{-1}}}
		{\braket{\eta_1\eta_{-1}=1}}
	\end{split}\end{equation*}
	$\Gamma=\set{\gamma_1,\gamma_{-1}}$を集合とし、モノイド射
	$\mu:\W_\Gamma\to V\B_1$を次のように定義する。
	\begin{alignat*}{2}
		\mu\gamma_1 &= \eta_1, &\quad \mu\gamma_{-1} &= \eta_{-1}
	\end{alignat*}
	任意のモノイド射$\phi:\W_\Gamma\to V$に対して、
	$\phi:\W_\Gamma\to V\subseteq V\B_1$という同一視によって、
	$\lambda\phi\in V\B_1$を次のようにおくと、
	\begin{equation*}\begin{split}
		\lambda\phi := \sum_{i=\pm1} (\phi\gamma_i)(\mu\gamma_i)
	\end{split}\end{equation*}
	次の式が得られる。
	\begin{equation*}\begin{split}
		\Braket{(\lambda\phi)^n} &= \sum_{i_1,\dots,i_n=\pm1}
			(\phi\gamma_{i_1})\cdots(\phi\gamma_{i_n})
			\Braket{(\mu\gamma_{i_1})\cdots(\mu\gamma_{i_n})} \\
		&= \sum_{i_1,\dots,i_n=\pm1}
			\glr{\phi\lr{\gamma_{i_1}\cdots\gamma_{i_n}}}
			\Braket{\mu(\gamma_{i_1}\cdots\gamma_{i_n})} \\
		&= \sum_{w\in\W_\Gamma} \jump{|w|=n} (\phi w)\Braket{\mu w} \\
	\end{split}\end{equation*}
	また、$\braket{\mu w}$は$0$または$1$だが、次の式が成り立つから、
	\begin{equation*}\begin{split}
		\braket{\mu w} = 1 \iff \text{$w$ is a Dyck word}
		\quad\text{for all } w\in\W_\Gamma
	\end{split}\end{equation*}
	次のように書くことができる。
	\begin{equation*}\begin{split}
		\braket{(\lambda\phi)^n} = \sum_{\substack{w\in\W_\Gamma\\
			\text{$w$ is a Dyck word of length $n$}}} \phi w
	\end{split}\end{equation*}
	以上より、次の式が成り立つことがわかる。
	\begin{equation*}\begin{split}
		x := \sum_{\substack{w\in\W_\Gamma\\\text{$w$ is a Dyck word}}}
			\phi w \implies x = 1 + (\phi\gamma_1)x(\phi\gamma_{-1})x
	\end{split}\end{equation*}
	この式はわからないものを別のわからないもので置き換えただけの式だが、
	Brzozowski代数とChomsky-Schutzenbergerの定理をつなぐ上でカギとなる式
	である。

	既に、次の式が成り立つことを知っている。
	\begin{equation*}\begin{split}
		x := \Braket{\begin{pmatrix}
			1 & 0
		\end{pmatrix}\begin{pmatrix}
			b + c\eta_1 & a \\
			\eta_{-1}d & 0
		\end{pmatrix}^*\begin{pmatrix}
			0 \\ 1
		\end{pmatrix}}\implies x = a + bx + cxdx
	\end{split}\end{equation*}
	この$x$は行列部分を計算してしまうと次のようになる。
	\begin{equation*}\begin{split}
		x = \Braket{\lr{b + c\eta_1}^*\lr{a\eta_{-1}d\lr{b + c\eta_1}^*}^*}a
	\end{split}\end{equation*}
	この式の真空期待値の中を次のように置き換えると、
	\begin{equation*}\begin{split}
		a\mapsto\alpha_1,\quad b\mapsto\beta_1,\quad c\eta_1\mapsto\gamma_1
		,\quad \eta_{-1}d\mapsto\gamma_{-1}
	\end{split}\end{equation*}
	次のように書くことができる。
	\begin{equation*}\begin{split}
		R := \lr{\beta_1 + \gamma_1}^*
			\lr{\alpha_1\gamma_{-1}\lr{\beta_1 + \gamma_1}^*}^*\alpha_1
	\end{split}\end{equation*}
	これは集合$\Delta=\set{\alpha_1,\beta_1,\gamma_{\pm1}}$から生成された
	有理言語になっている。$S:=\gamma_{-1}R\in\W_\Delta$とおき、
	文字のBrzozowski微分を$-^\flat$で表すと、次のようになっていて、
	既に知っている結果を再現する。
	\begin{alignat*}{2}
		\alpha_1^\flat\pvec{R}{S} &= \pvec{1 + S}{0}, &\quad
		\beta_1^\flat\pvec{R}{S} &= \pvec{R}{0} \\
		\gamma_1^\flat\pvec{R}{S} &= \pvec{R}{0}, &\quad
		\gamma_{-1}^\flat\pvec{R}{S} &= \pvec{0}{R}
	\end{alignat*}
	したがって、Dyck言語を拡張した部分モノイド$\what{D}_1\subset\W_\Delta$を
	次のように定義し、
	\begin{equation*}\begin{split}
		D_0 := \set{\alpha_1, \beta_1}^*,\quad
		\what{D}_1 := D_0 \cup\lr{D_0\gamma_1\what{D}_1\gamma_{-1}\what{D}_1}
	\end{split}\end{equation*}
	モノイド射$\rho:\W_\Delta\to V$を次のように定義すると、
	\begin{equation*}\begin{split}
		\rho\alpha_1 = a ,\quad \rho\beta_1 = b ,\quad \rho\gamma_1 = c
		,\quad \rho\gamma_{-1} = d
	\end{split}\end{equation*}
	次のように書くことができる。
	\begin{equation*}\begin{split}
		x = \sum_{w\in\lr{\what{D}_1\cap R}}\rho w \implies x = (\rho\alpha_1) 
			+ (\rho\beta_1)x + (\rho\gamma_1)x(\rho\gamma_{-1})x
	\end{split}\end{equation*}
	以上が、Chomusky-Schutzenbergerの定理を例を使って追ったものである。

	通常使われるChomusky-Schutzenbergerの定理では、ここで定義した$\what{D}_1$
	のようなDyck言語の拡張を防ぐために、$\Delta$に$\alpha_1$と$\beta_1$の
	対となる文字を追加して、有理言語がDyck言語に含まれるように、有理言語
	$R_0$を次のように定義する。
	\begin{equation*}\begin{split}
		R_0 &:= \lr{\beta_1\beta_{-1} + \gamma_1}^*
			\lr{\alpha_1\alpha_{-1}\gamma_{-1}\lr{\beta_1\beta_{-1} 
			+ \gamma_1}^*}^*\alpha_1\alpha_{-1} \\
	\end{split}\end{equation*}
	そして、$R_1,R_2,R_3$は次のように定義すると、
	\begin{equation*}\begin{split}
		R_1 := \alpha_{-1}(1 + R_2),\quad R_2 := \gamma_{-1}R_0
		,\quad R_3 := \beta_{-1}R_0
	\end{split}\end{equation*}
	状態遷移は次のようになる。
	\begin{alignat*}{2}
		\alpha_1^\flat \begin{pmatrix}
			R_0 \\ R_1 \\ R_2 \\ R_3
		\end{pmatrix} &= \begin{pmatrix}
			R_1 \\ 0 \\ 0 \\ 0
		\end{pmatrix}, &\quad \alpha_{-1}^\flat\begin{pmatrix}
			R_0 \\ R_1 \\ R_2 \\ R_3
		\end{pmatrix} &= \begin{pmatrix}
			0 \\ 1 + R_2 \\ 0 \\ 0
		\end{pmatrix} \\
		\beta_1^\flat\begin{pmatrix}
			R_0 \\ R_1 \\ R_2 \\ R_3
		\end{pmatrix} &= \begin{pmatrix}
			R_3 \\ 0 \\ 0 \\ 0
		\end{pmatrix} &\quad \beta_{-1}^\flat\begin{pmatrix}
			R_0 \\ R_1 \\ R_2 \\ R_3
		\end{pmatrix} &= \begin{pmatrix}
			0 \\ 0 \\ 0 \\ R_0
		\end{pmatrix} \\
		\gamma_1^\flat\begin{pmatrix}
			R_0 \\ R_1 \\ R_2 \\ R_3
		\end{pmatrix} &= \begin{pmatrix}
			R_0 \\ 0 \\ 0 \\ 0
		\end{pmatrix}, &\quad \gamma_{-1}^\flat\begin{pmatrix}
			R_0 \\ R_1 \\ R_2 \\ R_3
		\end{pmatrix} &= \begin{pmatrix}
			0 \\ 0 \\ R_0 \\ 0
		\end{pmatrix}
	\end{alignat*}
	これを状態遷移図に書き直すと次のようになる。
	\begin{equation*}\begin{split}
		\xymatrix{
			R_3 \ar@/^1ex/[r]^{\eta_{-2}} 
			& R_0 \ar[r]^{a\eta_1} \ar@/^1ex/[l]^{b\eta_2} \ar@(ul,ur)^{c\eta_3}
			& R_1 \ar[r]^{\eta_{-1}} 
			& *++[o][F=]{R_2} \ar@(d,d)[ll]^{\eta_{-3}d} \\
		} \xmapsfrom{\substack{\text{ makes}\\\text{ redundant}}} \xymatrix{
			R_0 + R_3R_0 \ar[r]^{a} \ar@(ul,ur)^{b + c\eta_3}
			& *++[o][F=]{R_1R_2} \ar@(d,d)[l]^{\eta_{-3}d} \\
		}
	\end{split}\end{equation*}
	次のようにモノイド射$\rho$を定義すると、
	\begin{equation*}\begin{split}
		\rho\alpha_1 = a,\quad \rho\alpha_{-1} = 1,\quad 
		\rho\beta_1 = b ,\quad \rho\beta_{-1} = 1 ,\quad 
		\rho\gamma_1 = c,\quad \rho\gamma_{-1} = d
	\end{split}\end{equation*}
	$D_3$を三つの組$\alpha_{\pm1}$、$\beta_{\pm1}$、$\gamma_{\pm1}$
	から生成されるDyck言語とすると、言語の生成関数は次のように次のように
	書くことができる。
	\begin{equation*}\begin{split}
		x = \sum_{w\in\lr{D_3\cap R_0}}\rho w \implies x = (\rho\alpha_1) 
			+ (\rho\beta_1)x + (\rho\gamma_1)x(\rho\gamma_{-1})x
	\end{split}\end{equation*}
	これが通常使われるChomusky-Schutzenbergerの定理に沿った形である。

	$\fukuso$上の有限集合$A$から生成された自由代数$A^*$からBrzozowski代数
	$\fukuso\B_n$への代数射$f$が与えられたとする。$f$を次のように行列で表して、
	\begin{equation*}\begin{split}
		f\begin{pmatrix}
			a_1 \\ \vdots \\ a_{|A|}
		\end{pmatrix} = \begin{pmatrix}
			f_{1,0} \\ \vdots \\ f_{|A|,0}
		\end{pmatrix} + \begin{pmatrix}
			f_{1,1} & f_{1,-1} & \cdots & f_{1,n} & f_{1,-n} \\
			\vdots \\
			f_{|A|,1} & f_{|A|,-1} & \cdots & f_{|A|,n} & f_{|A|,-n} \\
		\end{pmatrix}\begin{pmatrix}
			\eta_1 \\ \eta_{-1} \\ \vdots \\ \eta_{n} \\ \eta_{-n}
		\end{pmatrix}
	\end{split}\end{equation*}
	$f\mybf{a}=F_{a0}+F_{a1}\mybf{\eta}$と書くと、
%s2:考えたこと}
\subsection{Brzozowski代数}\label{s2:Brzozowski代数} %{
	Chomsky-Schutzenberberの定理の改良\cite{book1976}で使われている、
	$n=1,2,\dots$として、Dyck言語の間の写像$h:\D_n\to\D_2$
	\begin{equation*}\begin{split}
		ha_i = a_1^ia_2,\quad ha_{-i} = a_{-2}a_{-1}^i
		\quad\text{for all } i=1,\dots,n
	\end{split}\end{equation*}
	について考えてみる。

	$n\in\sizen_+$として、$A_n=\set{a_1,\dots,a_n}$と
	$A_n^\flat=\set{a_{-1},\dots,a_{-n}}$を有限集合、$R\B_n$を$n$次Brzozowki
	代数とし、その生成元を$\eta_{\pm1},\dots,\eta_{\pm n}$で表す。
	モノイド射$\pi_n:(A_n\cup A_n^\flat)^*\to R\B_n$を次のように定義する。
	\begin{equation*}\begin{split}
		\pi_n a_i = \eta_i,\quad \pi_n a_{-i} = \eta_{-i} 
		\quad\text{for all } i = 1,\dots,n
	\end{split}\end{equation*}
	すると、$\pi_n^{-1}1\subset(A_n\cup A_n^\flat)^*$がDyck単語のつくる
	部分モノイドとなる。任意の$n\in\sizen$に対して
	モノイド射$h_n:(A_n\cup A_n^\flat)^*\to(A_2\cup A_2^\flat)^*$を次のように
	定義すると、
	\begin{equation*}\begin{split}
		h_na_i = a_1^ia_2,\quad h_na_{-i} = a_{-2}a_{-1}^i
		\quad\text{for all } i=1,\dots,n
	\end{split}\end{equation*}
	$h_n$は$1:1$となる。そして、代数射$h_n^\sharp:R\B_n\to R\B_2$を
	$h_n^\sharp\pi_n=\pi_2h_n$となるように定義できて、次のようになる。
	\begin{equation*}\begin{split}
		h_n^\sharp\eta_i = \eta_1^i\eta_2,\quad 
		h_n^\sharp\eta_{-i} = \eta_{-2}\eta_{-1}^i
		\quad\text{for all } i=1,\dots,n
	\end{split}\end{equation*}
	やはり、$h_n^\sharp$も$1:1$となる。
	したがって、$(h_n^\sharp\pi_n)^{-1}1=\pi_n^{-1}1$かつ
	$(\pi_2h_n)^{-1}1=h_n^{-1}\pi_2^{-1}1$より、
	$\pi_n^{-1}1=h_n^{-1}\pi_2^{-1}1$となる。
%s2:Brzozowski代数}
%s1:Chomsky-Schutzenberger}

\section{Brzozowski代数}\label{s1:Brzozowski代数} %{
\subsection{可換環上のBrzozowski代数}\label{s2:可換環上のBrzozowski代数} %{
\subsubsection{Brzozowski代数の導出}\label{s3:Brzozowski代数の導出} %{
	$R$を可換環、$A$を有限集合、$\W_A:=A^*$を$A$から生成された自由モノイド
	とする。$R\W_A$の元をケットを用いて次のように書き、
	\begin{equation*}\begin{split}
		\sum_{w\in\W_A} \ket{w}r_w \quad\begin{split}
			&\text{where } r_w\in R \text{ for all } w\in\W_A \\
			&\text{and } r_w\neq 0 \text{ only finitely many } w
		\end{split}
	\end{split}\end{equation*}
	その双対空間$R\W_A^\dag:=\cat{Mod}_R\lr{R\W_A,R}$を次のように書く。
	\begin{equation*}\begin{split}
		\sum_{w\in\W_A} r_w\bra{w}
			\quad\text{where } r_w\in R \text{ for all } w\in\W_A \\
	\end{split}\end{equation*}
	ここで、双対基底を次のように定義し、
	\begin{equation*}\begin{split}
		\braket{w_1|w_2} = \jump{w_1 = w_2} \quad\text{for all } w_1,w_2\in\W_A
	\end{split}\end{equation*}
	線形射$-^\dag\in\cat{Mon}_R\glr{R\W_A,R\W_A^\dag}$を次のように定義する。
	\begin{equation*}\begin{split}
		\ket{w}^\dag := \bra{w} \quad\text{for all } w\in\W_A
	\end{split}\end{equation*}
	積$m_0$を文字列の連結によって次のように定義する。
	\begin{equation*}\begin{split}
		m_0\lr{\ket{w_1}\otimes\ket{w_2}} := \ket{w_1w_2}
		\quad\text{for all } w_1,w_2\in\W_A
	\end{split}\end{equation*}
	テンソル積の内積を次のように定義すると、
	\begin{equation*}\begin{split}
		\lr{f\otimes g}\lr{x\otimes y} := (fx)\otimes(gx) \simeq_R (fx)(gx) \\
		\quad\text{for all } f,g\in R\W_A^\dag,\; x,y\in R\W_A
	\end{split}\end{equation*}
	$m_0$の畳み込みは次のようになる。
	\begin{equation*}\begin{split}
		\bra{w}m_0 = \sum_{\substack{w_1,w_2\in\W_A\\ w=w_1w_2}}
			\bra{w_1}\otimes\bra{w_2} \quad\text{for all } w\in\W_A
	\end{split}\end{equation*}
	$m_0^\dag$を$m_0$の共役として次の式が成り立つように定義する。
	\begin{equation*}\begin{split}
		\gglr{m_0(x\otimes y)}^\dag = \glr{x^\dag\otimes y^\dag} m_0^\dag 
		\quad\text{for all } x,y\in R\W_A
	\end{split}\end{equation*}
	線形射$\iota:R\W_A\to\cat{Mod}_R\glr{R\W_A^\dag}$を次のように定義する。
	\begin{equation*}\begin{split}
		f\lr{\iota w} = \gglr{\bra{w}\otimes f} m_0^\dag
		\quad\text{for all } w\in \W_A,\; f\in R\W_A^\dag
	\end{split}\end{equation*}
	誤解の無い場合は、$\iota$を省略して次のように書く。
	\begin{equation*}\begin{split}
		w := \iota w,\quad w^\dag := \lr{\iota w}^\dag
		\quad\text{for all } w\in\W_A
	\end{split}\end{equation*}
	文字列を使って書くと次のようになり、
	\begin{alignat*}{4}
		a^\dag\ket{w} &= \ket{aw} ,&\quad \bra{w}a &= \bra{aw} 
			&\quad&\text{for all } a\in A,\; w\in\W_A \\
		a\ket{1} &= 0 ,&\quad \bra{1}a^\dag &= 0
			&\quad&\text{for all } a\in A \\
		a\ket{bw} &= \jump{a=b}\ket{w} ,&\quad 
			\bra{bw}a^\dag &= \jump{a=b}\bra{w}
			&\quad&\text{for all } a,b\in A,\; w\in\W_A
	\end{alignat*}
	次の交換関係、
	\begin{equation*}\begin{split}
		ab^\dag = \jump{a=b} \quad\text{for all } a,b\in A
	\end{split}\end{equation*}
	もしくは次の交換関係が得られる。
	\begin{equation*}\begin{split}
		a^\dag m_0 = m_0(a^\dag\otimes\id),\quad
		a m_0 = m_0(a\otimes\id + P_0\otimes a) \quad\text{for all } a\in A
	\end{split}\end{equation*}
	ここで、$P_0$は真空への射影で$P_0:=\ket{1}\bra{1}$と定義される。
	部分空間$R\B_A\subseteq\cat{Mod}_R\glr{R\W_A^\dag}$を次のように定義する。
	\begin{equation*}\begin{split}
		R\B_A := \myop{span}_R\Set{w_1^\dag w_2\in\cat{Mod}_R\glr{R\W_A^\dag}
		| w_1,w_2\in\W_A}
	\end{split}\end{equation*}
	$R\B_A$は$\iota RA$と$(\iota RA)^\dag$の合成列によって作られる
	$\cat{Mod}_R\glr{R\W_A^\dag}$の部分空間となっている。
	$R\B_A$を$R$上のBrzozowski代数ということにする。
	\begin{definition}[Brzozowski代数]\label{def:Brzozowski代数} %{
		$R$を可換環とする。$2n$個の元$\eta_{\pm 1},\dots,\eta_{\pm n}$から
		生成された$R$上の非可換環代数$R\B_n$が、生成元同士が次の関係を
		持つとき、$R\B_n$を$R$上の$n$次Brzozowski代数ということにする。
		\begin{equation*}\begin{split}
			\eta_i\eta_{-j} = \jump{i = j} \quad\text{for all } i,j\in 1,\dots,n
		\end{split}\end{equation*}
		代数学でよく使われる記号を用いると次のように書ける。
		\begin{equation*}\begin{split}
			R\B_n := \frac{R\braket{\eta_{\pm 1},\dots,\eta_{\pm n}}}
				{\Braket{\eta_i\eta_{-j} - \jump{i=j}\bou i,j=1,\dots,n}}
		\end{split}\end{equation*}
		ここで、$R\braket{x,y,\dots}$は互いに非可換な不定元$x,y,\dots$によって
		生成される$R$上の多項式を表す。
	\end{definition} %def:Brzozowski代数}

	有限集合$A$とそのコピー$\wbar{A}$を生成元とする可換環$R$上の
	Brzozowski代数を$R\B_A$とも書くことにする。
	\begin{equation*}\begin{split}
		R\B_A := \frac{R\braket{A, \wbar{A}}}
		{\Braket{a\wbar{b}-\jump{a=b}\bou a,b\in A}}
	\end{split}\end{equation*}
	任意の$a\in A$に対して$a^\dag=\wbar{a}$となる表現がBrzozowski代数の
	ユニタリ表現となるだろうが、ユニタリー性を仮定しなくても多くの事柄が
	導かれる。
%s3:Brzozowski代数の導出}

\subsubsection{Brzozowski代数の表現}\label{s3:Brzozowski代数の表現} %{
	Brzozowski代数の表現を考える。まず、$\fukuso\B_1$について考える。
	$\fukuso\B_1$の基底系を$\eta_+\eta_-=1$とし、$\nu:=\eta_-\eta_+$とする。
	$\nu$はWeyl代数における数演算子に相当する。
	$\fukuso\B_1$の表現空間を$V$とする。$\nu$はべき等$\nu^2=\nu$だから、
	$\nu$の固有値は$0$または$1$に限られる。
	また、命題\ref{prop:べき等作用素の対角化}から$\nu$は任意の表現空間で
	対角化できるから、$\nu$の固有値$\lambda$を持つ$V$の固有空間を
	$V_\lambda$とすると、$V=V_0\oplus V_1$と直和分解できる。したがって、
	表現空間は次の場合分けができる。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 自明な表現、$\dim V_0=\dim V_1=0$
		\item 0-固有空間だけの表現、$0<\dim V_0$かつ$\dim V_1=0$
		\item 1-固有空間だけの表現、$\dim V_0=0$かつ$0<\dim V_1$
		\item 両方の固有空間を持つ表現、$0<\dim V_0$かつ$0<\dim V_1$
	\end{itemize} %}
	さらに次の性質が成り立つ。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $\eta_-$は$1:1$となる。
		\begin{equation*}\begin{split}
			\eta_-v_1 = \eta_-v_2 \implies \eta_+\eta_-v_1 = \eta_+\eta_-v_2 
			\implies v_1 = v_2 \quad\text{for all } v_1,v_2\in V
		\end{split}\end{equation*}
		%
		\item $\eta_-V\subseteq V_1$となる。
		\begin{equation*}\begin{split}
			\nu\eta_- = \eta_-\implies
			\nu\eta_-v = \eta_-v \quad\text{for all } v\in V
		\end{split}\end{equation*}
		%
		\item $V_0=\ker\eta_+$となる。\\
		$\nu$の定義より、$\ker\eta_+\subseteq V_0$
		となるが、$\eta_+\nu=\eta_+$より、任意の$v\in V_0$に対して$\eta_+v=0$
		となり、$V_0\subseteq\ker\eta_+$となるから、$\ker\eta_+=V_0$となる。
	\end{itemize} %}
	$V_0$と$V_1$の次元について場合分けして考える。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $0<\dim V_0$かつ$\dim V_1=0$の場合 \\
		$\eta_-V\subseteq V_1$より、$V_0=\ker\eta_+=\ker\eta_-$となる。
		したがって、自明な表現となる。
		%
		\item $\dim V_0=0$かつ$0<\dim V_1$の場合 \\
		$V$への表現を$\rho$とする。
		この場合は、$(\rho\eta_-)(\rho\eta_+)=1$となり、$\rho\eta_\pm$は共に
		正則、$\ker\rho\eta_\pm=\set{0}$、になる。また、任意の$n\in\sizen$で
		$\rho(\eta_-^n\eta_+^n)=1$となるから、$\rho$は忠実な表現ではない。
		特に、$V$が有限次元の場合、正則な正方行列の左逆行列と右逆行列は
		一致するので、$(\rho\eta_-)=(\rho\eta_+)^{-1}$となる。
		%
		\item $\dim V_0=1$かつ$0<\dim V_1$の場合 \\
		任意の$v\neq0\in\ker\eta_+$と$n\in\sizen$に対して、
		$E_n(v):=\set{v,\eta_-v,\dots,\eta_-^nv}$の元は互いに一次独立となる。
		\begin{proof} %{
			$E_n(v)$の帰納法で証明する。$v\in\ker\eta_+$かつ$\eta_-v\in V_1$
			だから、$n=1$のときは命題が成り立つことがわかる。ある$n\in\sizen_+$で
			命題が成り立つ仮定する。任意の$c_k\in\fukuso$に対して次の式が
			成り立つから、
			\begin{equation*}\begin{split}
				\sum_{k=0}^{n+1} c_k\eta_-^kv = 0
				&\implies \eta_+\sum_{k=0}^{n+1} c_k\eta_-^kv = 0
				\implies \eta_-\sum_{k=0}^n c_{k+1}\eta_-^kv = 0 \\
				&\implies \sum_{k=0}^n c_{k+1}\eta_-^kv = 0
			\end{split}\end{equation*}
			帰納法の仮定より、$c_1=c_2=\cdots=c_{n+1}=0$となり、その結果$c_0=0$
			となり、次の式が成り立ち、$E_{n+1}(v)$でも命題が成り立つことがわかる。
			\begin{equation*}\begin{split}
				\sum_{k=0}^{n+1} c_k\eta_-^kv = 0
				\implies c_0 = c_1 = \cdots = c_{n+1} = 0
			\end{split}\end{equation*}
		\end{proof} %}
		したがって、$W:=\myop{span}_\fukuso E_\infty(v)$とすると、
		次の式が成り立ち、
		\begin{equation*}\begin{split}
			W\subseteq V 
		\end{split}\end{equation*}
		$V$が無限次元となることがわかる。そして、$W$が$\fukuso\B_1$の既約表現
		となることがわかる。
		図にすると次のようになる。
		\begin{equation*}\begin{split}
			0 \xfrom{\eta_+} v \tofrom{\eta_-}{\eta_+} 
			\eta_-v \tofrom{\eta_-}{\eta_+}
			\eta_-^2v \tofrom{\eta_-}{\eta_+}
			\cdots
		\end{split}\end{equation*}
		%
		\item $1<\dim V_0$かつ$0<\dim V_1$の場合 \\
		$\eta_-$が$1:1$だから、$v_1\in\ker\eta_+$と$v_2\in\ker\eta_+$が互いに
		一次独立ならば、任意の$n\in\sizen$に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			\myop{span}_\fukuso E_n(v_1) \cup \myop{span}_\fukuso E_n(v_2)
			= \myop{span}_\fukuso E_n(v_1) \oplus \myop{span}_\fukuso E_n(v_2)
		\end{split}\end{equation*}
		したがって、$V$は$\dim V_0$個の$W$と同型な部分空間を含む。
		\begin{equation*}\begin{split}
			\underbrace{W\oplus\cdots\oplus W}_{\dim V_0}\subseteq V
		\end{split}\end{equation*}
	\end{itemize} %}

	\begin{proposition}[べき等作用素の対角化]\label{prop:べき等作用素の対角化} %{
		べき等作用素は対角化可能である。
	\end{proposition} %prop:べき等作用素の対角化}
	\begin{proof} %{
		$V$を実ベクトル空間、線形射$P:V\to V$をべき等とする。
		$P$の固有値$\lambda$に属する固有空間を$V_\lambda$とする。
		$V_0\oplus V_1\subseteq V$となるが、$V_0\oplus V_1=\fukuso^n$が
		証明したいことである。定義より、$\ker P=V_0$が成り立つ。また、
		次のことから$PV=V_1$が成り立つ。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item 任意の$v\in V_1$に対して$v=Pv$となるから、
			$V_1\subseteq PV$が成り立ち、
			\item 任意の$v\in PV$に対して、ある$w\in V$が存在して$v=Pw$となるが、
			$Pv=P^2w=Pw=v$となるから、$PV\subseteq V_1$が成り立つ
		\end{itemize} %}
		したがって、$(\ker P)\oplus PV=V$を示せば、命題が成り立つことがわかる。
		任意の$v\in V$は$v=(1-P)v + Pv$と書くことができる。$(1-P)v\in\ker P$
		かつ$Pv\in PV$だから、$(\ker P)\oplus PV=V$が成り立つことが示される。
	\end{proof} %}

	\begin{proposition}[左右の逆元]\label{prop:左右の逆元} %{
		$R$を環、$x\in R$とする。$a\in R$を$x$の左逆元、$b\in R$を$x$の
		右逆元とする。このとき、$a=b$となる。
	\end{proposition} %prop:左右の逆元}
	\begin{proof} %{
		命題の仮定より、$ax=1$だから、右から$b$を掛けると、$a=b$となる。
	\end{proof} %}
%s3:Brzozowski代数の表現}
%s2:可換環上のBrzozowski代数}
%s1:Brzozowski代数}

\section{品詞分解の曖昧さについて}\label{s1:品詞分解の曖昧さについて} %{
	品詞分解の曖昧さには次の二つの要因があるように思える。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 加法によって生じる曖昧さ \\
		次の文法では、
		\begin{equation*}\begin{split}
			A_1 = a,\; A_2 = a^2,\; X = A_1A_2 + A_2A_1
		\end{split}\end{equation*}
		入力文字列$aaa$は$A_1A_2$と$A_2A_1$の両方の品詞分解が成り立つ。
		%
		\item 乗法によって生じる曖昧さ \\
		次の文法では、
		\begin{equation*}\begin{split}
			X = a + XbX
		\end{split}\end{equation*}
		入力文字列$ababa$は$(XbX)bX$と$Xb(XbX)$の両方の品詞分解が成り立つ。
		平面木で書くと次のようになる。
		\begin{equation*}\begin{split}
			\xymatrix@R=1ex@C=1ex{
				& & X \er[dl] \er[dr] \er[d] \\
				& X \er[dl] \er[dr] \er[d] & b & X \er[d] \\
				X \er[d] & b & X \er[d] & a \\
				a & & a \\
			},\quad \xymatrix@R=1ex@C=1ex{
				& X \er[dl] \er[dr] \er[d] \\
				X & b & X \er[dl] \er[dr] \er[d] \\
				& X \er[d] & b & X \er[d] \\
				& a & & a \\
			},\quad \xymatrix@R=1ex@C=1ex{
			}
		\end{split}\end{equation*}
		$XbX=(Xb)X=X(bX)$だが、$(XbX)bX\neq Xb(XbX)$という自由モノイドとしては
		訳の分からない規則が入っている。一般的は、与えられた文法で、$X=\cdots$
		と書かれる右辺の中では乗法は結合的だが、変数に代入した部分の乗法とは
		結合的でないという規則が暗黙に定めらている。
		\begin{equation*}\begin{split}
			X = XY,\; Y = ZW \implies X = X(ZW) \neq XZW
		\end{split}\end{equation*}
		通常の数学上の計算は、式を簡単化するために自由に一時的な変数を使うが、
		\begin{equation*}\begin{split}
			X = (1 + a)(1 + b + b^2) \iff \left\{\begin{split}
				X &= (1 + a)Y \\
				Y &= 1 + b + b^2 \\
			\end{split}\right.
		\end{split}\end{equation*}
		文法の記述では、一般に変数を用いて式の分離には品詞分解という意味が付属
		する。したがって、上の例で言うと、左の右の式は同値ではなく、次のような
		関係になる。
		\begin{equation*}\begin{split}
			X = (1 + a)(1 + b + b^2) \implies \left\{\begin{split}
				X &= (1 + a)Y \\
				Y &= 1 + b + b^2 \\
			\end{split}\right.\iff X = (1 + a)(\underbrace{1 + b + b^2}_{Y})
		\end{split}\end{equation*}
		結合的でない二項演算は扱いにくいので、何とか結合的な二項演算で代用して
		曖昧さを扱っていきたい。
	\end{itemize} %}

	文法の曖昧さを検知することについては次のように書かれている。
	\begin{center}\begin{boxedminipage}{.9\textwidth}
The general question of whether a grammar is not ambiguous is undecidable. No algorithm can exist to determine the ambiguity of a grammar because the undecidable Post correspondence problem can be encoded as an ambiguity problem. At least, there are tools implementing some semi-decision procedure for detecting ambiguity of context-free grammars, see e.g. (Axelsson, Heljanko \& Lange 2008).
	\end{boxedminipage}\end{center}

	そこでPost対応問題を調べてみると、
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $A$と$B$を有限集合とし、
		\item 二つの写像$f,g:A\to\W_B$が与えられたとき、
		\item $(fa_1)\cdots(fa_n)=(ga_1)\cdots(ga_n)$となる$A$の元の系列
		$a_1,\dots,a_n$が存在するかどうかを調べる
	\end{itemize} %}
	という問題だそうだ。例えば、$A=\set{1,2,3}$、$B=\set{a,b}$とし、
	\begin{equation*}\begin{split}
		f = \begin{array}{r|r|r|}
			1 & 2 & 3 \\\hline
			a & ab & b^2a
		\end{array},\quad g = \begin{array}{r|r|r|}
			1 & 2 & 3 \\\hline
			ba^2 & a^2 & b^2
		\end{array}
	\end{split}\end{equation*}
	とすると、$A$の系列$[3,2,3,1]$がPost問題の肯定的な答えになる。
	\begin{equation*}\begin{split}
		(f3)(f2)(f3)(f1) = b^2a^2b^3a^2 = (g3)(g2)(g3)(g1)
	\end{split}\end{equation*}
	肯定的な答えは有限回の操作で得られるが、$A$の元からは無数に長い系列を
	作ることができるので、無限に長い系列を作ってみないと否定的な答えを出す
	ことができない。もちろん、$f1=f2=f3=a$かつ$g1=g2=g3=b$のような場合は、
	すぐに否定的な答えを得られるが、一般には無限に長い系列を作って調べるしか
	方法はないようだ。

	文法$X=a+XcX$の例を考えてみる。次の線形化によって、
	\begin{equation*}\begin{split}
		\xymatrix{
			X \ar[r]^{a} \ar@(ld,lu)^{Xc} & 1_X
		} \mapsto \xymatrix{
			X \ar@/^1ex/[r]^{a} \ar@(ld,lu)^{\gamma_1} 
			& 1_X \ar@/^1ex/[l]^{\gamma_{-1}c}
		} \mapsto \xymatrix{
			X \ar[r]^{a} \ar@(ul,ur)^{\gamma_1} \ar@(dr,dl)^{a\gamma_{-1}c}
			& 1_X
		}
	\end{split}\end{equation*}
	$X=\Braket{(\gamma_1+a\gamma_{-1}c)^*}a=\sum_{n\in\sizen}C_n(ac)^na$
	となることがわかる。ここで、$C_n$はカタラン数であり、文法の曖昧さの度合い
	を表す。$(ac)^2a$なら$C_2=2$通りの品詞分解の曖昧さがあり、$(ac)^3a$なら
	$C_3=5$通りの品詞分解の曖昧さがある。
	文法が$X=a+bXcX$なら曖昧さは生じない。$b$を$1$とすることで曖昧さが生じる。
	\begin{equation*}\begin{split}
		b^2(ac)^2a + (bac)^2a \xmapsto{b=1} 2(ac)^2a
	\end{split}\end{equation*}
	面白いことに、$c=1$としても曖昧さは生じない。
	\begin{equation*}\begin{split}
		b^2(ac)^2a + (bac)^2a \xmapsto{c=1} b^2a^3 + (ba)^2a
	\end{split}\end{equation*}
	文法でみると次のようになっている。
	\begin{alignat*}{2}
		X &= a + bXcX &\quad&\text{曖昧でない} \\
		X &= a + bXX &\quad&\text{三次までは曖昧でない} \\
		X &= a + XcX &\quad&\text{曖昧}
	\end{alignat*}
	”三次までは曖昧でない”は四次以上はわからないということである。
	曖昧さは空遷移のみから生じるものではない。例えば、次の文法も曖昧である。
	\begin{equation*}\begin{split}
		X = a + b^2(ac)^2X + bXcX
	\end{split}\end{equation*}

\subsubsection{品詞分解の代数}\label{s3:品詞分解の代数} %{
	$R$を可換環、$A$を終端記号の集合、$B$を非終端記号の集合、
	$R\W_B\W_A^\dag:=\cat{Mod}_R(R\W_A,R\W_B)$とする。
	$A$は入力文字、$B$は品詞、$\W_B\W_A^\dag$は入力単語の品詞への割り当てに
	対応する。$R\W_B\W_A^\dag$に畳み込みによって積と余積を定義する。
	\begin{equation*}\begin{split}
		\xymatrix{
			R\W_A\otimes R\W_A \ar[r]^{f\otimes g} 
			& R\W_B\otimes R\W_B \ar[d]^{m} \\ 
			R\W_A \ar[r] \ar[u]_{m^\dag} \ar@{.>}[r]^{m(f\otimes g)} 
			& R\W_B \\ 
		},\quad \xymatrix{
			R\W_A\otimes R\W_A \ar[d]^{m} \ar@{.>}[r]^{m^\dag f} 
			& R\W_B\otimes R\W_B \\ 
			R\W_A \ar[r] \ar[r]^{f} & R\W_B \ar[u]_{m^\dag} \\ 
		}
	\end{split}\end{equation*}
	この積と余積を使って文法を定義する。例えば、次の文法は、
	\begin{equation*}\begin{split}
		X = A_1A_2 + A_2A_1,\; A_1 = a,\; A_2 = a^2
	\end{split}\end{equation*}
	次の三つの写像$E:=\set{\what{X},\what{A}_1,\what{A}_2}$を定める。
	\begin{equation*}\begin{split}
		\what{X}w = \lr{\what{A}_1\what{A}_2}w,\;
		\what{A}_1w = \jump{w = a}A_1,\; \what{A}_2w = \jump{w = a^2}A_2
	\end{split}\end{equation*}
	写像$\what{X}$に曖昧さが生じる。
	\begin{equation*}\begin{split}
		\what{X}w = \jump{w = a^3}(A_1A_2 + A_2A_1)
	\end{split}\end{equation*}
	一般には次のようになっていて、
	\begin{equation*}\begin{split}
		\left\{\begin{split}
			f &= \sum_{w\in\W_A} f_ww \\
			g &= \sum_{w\in\W_A} g_ww
		\end{split}\right. \implies \left\{\begin{split}
			h &:= fg = \sum_{w\in\W_A}h_ww \\
			h_w &=  m_B(f\otimes g)m_A^\dag w
		\end{split}\right.
	\end{split}\end{equation*}
	$h_w\in R\W_B$が
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 二つ以上の項を含むか、
		\item ある項の係数が$2$以上になる
	\end{itemize} %}
	場合に、曖昧さが生じる。

	\begin{problem}[有理言語の曖昧さ]\label{prob:有理言語の曖昧さ} %{
		写像$f$と$g$の遷移状態が共に有限個の場合、$fg$の遷移状態も有限個となる。
		有限回の分配則の適用（powerset construction）によって$fg$が曖昧かどうか
		を判定することができるだろうか。
	\end{problem} %prob:有理言語の曖昧さ}
%s3:品詞分解の代数}
	
\subsubsection{PEGと量子変形}\label{s3:PEGと量子変形} %{
	$X=\Braket{(\gamma_1+a\gamma_{-1}c)^*}a$の
	Kleeneスターの中のべき乗の部分を次のように書き換えると、
	\begin{equation*}\begin{split}
		\Braket{(\gamma_1+a\gamma_{-1}c)^2(q\gamma_1+a\gamma_{-1}c)^2
			(q^2\gamma_1+a\gamma_{-1}c)^2\cdots}
	\end{split}\end{equation*}
	次のようになって、$q$のべきによって、縮退していたDyck経路が分離される。
	\begin{equation*}\begin{split}
		\vcenter{\xymatrix{
			& & \\
			& & \ar[u]_{ac} \\
			\ar[r]^1 & \ar[r]^1 & \ar[u]_{ac} \\
		}} + \vcenter{\xymatrix{
			& & \\
			& \ar[r]^q & \ar[u]_{ac} \\
			\ar[r]^1 & \ar[u]_{ac} \\
		}} = (1 + q)(ac)^2
	\end{split}\end{equation*}
	PEGでの品詞分解の方法と類似している。PEGでの品詞分解の方法は、
	qのべきの小さいものから優先的に品詞分解の規則を当てはめていくことに
	相当する。
%s3:PEGと量子変形}
%s1:品詞分解の曖昧さについて}

\section{Dyck言語}\label{s1:Dyck言語} %{
	通常の定義とは異なるが、ここで扱いやすい形でDyck言語を定義しておく。

	\begin{definition}[Dyck言語]\label{def:Dyck言語} %{
		文字$\ldyck$と$\rdyck$から生成される自由モノイドを$G=(G,\myspace,1_\W)$
		とする。任意の$n\in\sizen$に対して部分集合$D_n\subset G$を次のように
		定義する。
		\begin{equation*}\begin{split}
			D_0 &:= \set{1_\W} \\
			D_{n+1} &:= \cup_{r=0}^n\Set{\gdyck{w_1}w_2\in G
				\bou w_1\in D_r,\;w_2\in D_{n-r}} \\
		\end{split}\end{equation*}
		$D_n$を文字$\ldyck$と$\rdyck$から生成された長さ$2n$のDyck言語といい、
		その合併$D_*:=\cup_{n\in\sizen}D_n$を単に文字$\ldyck$と$\rdyck$から
		生成されたDyck言語という。
	\end{definition} %def:Dyck言語}

	Dyck言語は以下のような文字列の集合である。
	\begin{equation*}\begin{split}
		D_0 &= \Set{1_\W} \\
		D_1 &= \Set{\dyck} \\
		D_2 &= \Set{\gdyck{\dyck},\; \dyck\dyck} \\
		D_3 &= \Set{\ggdyck{\gdyck{\dyck}},\; \gdyck{\dyck\dyck}
			,\; \gdyck{\dyck}\dyck\;, \dyck\gdyck{\dyck},\; \dyck\dyck\dyck} \\
	\end{split}\end{equation*}
	Dyck言語は自由モノイドの部分モノイドとなっている。
	定義\label{def:Dyck言語}の記号を使うと、部分モノイド$D_*\subseteq G$
	となっている。ただし、文字列の連結による積では$D_1$が$D_*$の生成系には
	なっていない。Dyck言語の場合、文字列の長さではなくその半分を次数として
	勘定した方が都合がよいので、写像$|-|_D:D_*\to\sizen$を次のように
	定義する。
	\begin{equation*}\begin{split}
		|w|_D = n \xiff{\dfn} w\in D_n \quad\text{for all } n\in\sizen
	\end{split}\end{equation*}

	一般に有限集合$X$に対して$\lambda X\in \sizen X$を次のように定義する。
	\begin{equation*}\begin{split}
		\lambda X := \sum_{x\in X} x
	\end{split}\end{equation*}
	また、$\sizen X$に二項関係$\preceq$を次のように定義すると、
	\begin{equation*}\begin{split}
		f\preceq g \xiff{\dfn} \text{there exists } h\in\sizen X
		\text{ such that } g = f + h
	\end{split}\end{equation*}
	$\preceq$は半順序となる。任意の部分集合$Y\subseteq X$に対して
	$\lambda Y\preceq\lambda X$が成り立つ。
	$\lambda$を用いると、集合の元を列挙する操作を線形代数を使って表すことが
	できる。Dyck言語の列挙は次のように書くことができる。
	\begin{equation*}\begin{split}
		\lambda D_0 &= 1_\W \\ 
		\lambda D_{n+1} &= \sum_{r=0}^n \gdyck{(\lambda D_r)}(\lambda D_{n-r})
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}

\subsubsection{q-微分方程式}\label{s3:q-微分方程式} %{
	線形射$\rho^t_q:\sizen D_*\to\fukuso[t,q]$を次のように定義すると、
	\begin{equation*}\begin{split}
		\rho^t_q 1_\W &= 1 \\
		\rho^t_q \gdyck{w_1}w_2 &= \int_0^t (\rho^s_q w_1)(\rho^s_q w_2) d_qs
		\quad\text{for all } w_1,w_2\in D_*
	\end{split}\end{equation*}
	次のq-微分方程式が得られる。
	\begin{equation*}\begin{split}
		\rho^t_q \lambda D_{n+1} = \sum_{r=0}^n \int_0^t 
		(\rho^t_q\lambda D_r)(\rho^t_q\lambda D_{n-r}) d_qs
	\end{split}\end{equation*}
	そして、$\rho^t_q\lambda D_*:=\sum_{n\in\sizen} \rho^t_q\lambda D_n$
	が収束するならば、次のq-微分方程式が得られる。
	\begin{equation*}\begin{split}
		\rho^t_q\lambda D_* = 1 + \int_0^t 
		(\rho^t_q\lambda D_*)(\rho^t_q\lambda D_*) d_qs
	\end{split}\end{equation*}
	$q=0,1$の場合にはこの式は簡単に解けて次のようになる。
	\begin{equation*}\begin{split}
		\rho^t_0\lambda D_* = \frac{\sqrt{1-4t}}{2t} 
			= \sum_{n\in\sizen} \frac{(2n)!}{(n+1)!n!}t^n,\quad
		\rho^t_1\lambda D_* = \frac{1}{1-t}
	\end{split}\end{equation*}
	特に、$q=0$の場合から長さ$2n$のDyck言語の大きさがわかる。
	\begin{equation*}\begin{split}
		|D_n| = \frac{(2n)!}{(n+1)!n!}
	\end{split}\end{equation*}
	$\rho^t_q\lambda D_*$を次のように級数展開すると、
	\begin{equation*}\begin{split}
		\rho^t_q\lambda D_* := x_t = x_0 + x_1 + x_2t^2 + \cdots
	\end{split}\end{equation*}
	次の漸化式が得られる。
	\begin{equation*}\begin{split}
		x_{n+1} = \frac{1}{[n+1]_q^!}\sum_{r=0}^n x_rx_{n-r}
	\end{split}\end{equation*}
	$5$次まで計算してみると次のようになる。
	\begin{equation*}\begin{split}
		[0]_q^!\, x_0 &= 1 \\
		[1]_q^!\, x_1 &= 1 \\
		[2]_q^!\, x_2 &= 2 \\
		[3]_q^!\, x_3 &= 2^2 + [2]_q \\
		[4]_q^!\, x_4 &= 2^3 + 2^2[3]_q + 2[2]_q \\
		[5]_q^!\, x_5 &= 2^4 + 2^3[4]_q + 2^3[3]_q + 2^2[2]_q 
			+ 2^2\frac{[4]_q[3]_q}{[2]_q} + 2[4]_q[2]_q \\
	\end{split}\end{equation*}
%s3:q-微分方程式}
\subsubsection{Dyck経路}\label{s3:Dyck経路} %{
	Dyck経路とは二次元格子を右上または右下に動きながら$(0,0)$から$(2n,0)$
	へ到達する経路のことである。例えば次のようになる。
	\begin{equation}\label{eq:Dyck経路その一}\begin{split}
		\gdyck{\dyck}\dyck \sim &\vcenter{\xymatrix@R=2ex@C=2ex{
			(0,2) & & \ar[rd] \\
			(0,1) & \ar[ru] & & \ar[rd] & & \ar[rd] \\
			(0,0) \ar[ru] & (1,0) & (2,0) & (3,0) & (4,0) \ar[ru] & (5,0) 
			& (6,0) \\
		}} \\
		\dyck\dyck\dyck \sim &\vcenter{\xymatrix@R=2ex@C=2ex{
			(0,1) & \ar[rd] & & \ar[rd] & & \ar[rd] \\
			(0,0) \ar[ru] & (1,0) & (2,0) \ar[ru] & (3,0) & (4,0) \ar[ru] & (5,0) 
			& (6,0) \\
		}} \\
	\end{split}\end{equation}
	この描像からDyck言語の列挙をBrzozowski代数を用いて書くことができる。
	文字$\ldyck$と$\rdyck$は数式の中で書くと紛らわしいので、$b$と$c$で
	置き換えて書く。$\eta$と$\eta^\dag$に次の交換関係とその表現を定義すると、
	\begin{equation*}\begin{split}
		\eta\eta^\dag = 1,\quad \eta\rangle = \langle\eta^\dag = 0
	\end{split}\end{equation*}
	次の因子化が成り立つことから、
	\begin{equation*}\begin{split}
		\Braket{\glr{b\eta + \eta^\dag c}^{2(n+1)}} = \sum_{r=0}^n
			b\Braket{\glr{b\eta + \eta^\dag c}^{2r}}c
			\Braket{\glr{b\eta + \eta^\dag c}^{2(n-r)}}
	\end{split}\end{equation*}
	$\braket{}=1$より、Dyck言語の列挙が次のように得られる。
	\begin{equation*}\begin{split}
		\lambda D_n = \Braket{\glr{b\eta + \eta^\dag c}^{2n}}
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	Dyck経路を図\eqref{eq:Dyck経路その一}のように書くことは、Brzozowski代数
	との対応がつきやすいが、図\eqref{eq:Dyck経路その一}を上下反転して45度回転
	させた図や、Ferres図形でDyck経路を表すことが多い。
	\begin{alignat*}{2}
		\gdyck{\dyck}\dyck \sim &\vcenter{\xymatrix@R=2ex@C=2ex{
			& & & (6,0) \\
			& & (4,0) \ar[r] & (5,1) \ar[u] \\
			& & (3,1) \ar[u] \\
			(0,0) \ar[r] & (1,1) \ar[r] & (2,2) \ar[u] \\
		}} &&\sim \yng(3,2,2) \\
		\dyck\dyck\dyck \sim &\vcenter{\xymatrix@R=2ex@C=2ex{
			& & & (6,0) \\
			& & (4,0) \ar[r] & (5,1) \ar[u] \\
			& (2,0) \ar[r] & (3,1) \ar[u] \\
			(0,0) \ar[r] & (1,1) \ar[u] \\
		}} &&\sim \yng(3,2,1) \\
	\end{alignat*}
	Dyck言語からFerrers図形への写像を$(FD^{-1})$とすると次のようになる。
	\begin{equation*}\begin{split}
		(FD^{-1}) \gdyck{w_1}w_2 = \begin{array}{|c|c|c|}\hline
			\vdots & \ddots & (FD^{-1}) w_2 \\\hline
			\quad\; & \cdots \\\cline{1-2}
			\vdots & (FD^{-1}) w_1 \\\cline{1-2}
		\end{array} \quad\text{for all } w_1,w_2\in D_*
	\end{split}\end{equation*}
	$\phi$は$1:1$だが$\onto$ではない。文字列の連結による積は次のようになる。
	\begin{equation*}\begin{split}
		(FD^{-1} w_1w_2 = \begin{array}{|c|c|}\hline
			\ddots & (FD^{-1}) w_2 \\\hline
			(FD^{-1}) w_1 \\\cline{1-1}
		\end{array} \quad\text{for all } w_1,w_2\in D_*
	\end{split}\end{equation*}
%s3:Dyck経路}
\subsubsection{平面上の二分木}\label{s3:平面上の二分木} %{
	頂点数$2n+1$の平面上の二分木のつくる集合を$T_n$、
	$T_*:=\cup_{n\in\sizen}T_n$とする。写像$(TD^{-1}):D_*\to T_*$を
	次のように定義する。
	\begin{equation*}\begin{split}
		(TD^{-1}) 1_\W &= \circ \\
		(TD^{-1}) \gdyck{w_1}w_2 &= \vcenter{\xymatrix@R=1ex@C=2ex{
			& \circ \ar@{-}[dl] \ar@{-}[dr] \\
			(TD^{-1})w_1 & & (TD^{-1})w_2
		}}
	\end{split}\end{equation*}
	文字数の帰納法により、各$n\in\sizen$で$(TD^{-1})$が集合同型
	$D_n\simeq T_n$を与えることがわかる。したがって、$D_*$の文字列の
	連結による積を$T_*$に持ち込むことができる。文字列の連結は、
	一つ目の木の右端の葉を二つ目の木で置き換えるという操作になる。
	可換図で書くと次のようになる。
	\begin{equation*}\begin{CD}
		\gdyck{w_1}w_2\times w_3 @> {(TD^{-1})\times(TD^{-1})} >>
		\vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \ar@{-}[dl] \ar@{-}[dr] \\
			(TD^{-1})w_1 & & (TD^{-1})w_2
		}}\times (TD^{-1})w_3 \\
		@V m_\myspace VV @V m_\myspace VV \\
		\gdyck{w_1}w_2w_3 @> {(TD^{-1})} >>
		\vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \ar@{-}[dl] \ar@{-}[dr] \\
			(TD^{-1})w_1 & & \glr{(TD^{-1})w_2}\glr{(TD^{-1})w_3}
		}} \\
	\end{CD}\end{equation*}
	この操作では$T_1$から$T_*$を生成しないので、一つ目の木のすべての葉を
	二つ目の木で置き換える操作を表す作用
	$-\lhd_q-:\sizen[q]T_*\times \sizen[q]T_*\to \sizen[q]T_*$を次のように
	定義する。
	\begin{alignat*}{2}
		\circ\lhd_q t &= t && \quad\text{for all } t\in T_* \\
		\vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \ar@{-}[dl] \ar@{-}[dr] \\
			t_1 & & t_2
		}} \lhd_q t_3 &= \vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \ar@{-}[dl] \ar@{-}[dr] \\
			t_1 & & t_2\lhd_q t_3
		}} + q^{|t_2|_D + |t_3|_D} \vcenter{\xymatrix@R=1ex@C=1ex{
			& \circ \ar@{-}[dl] \ar@{-}[dr] \\
			t_1\lhd_q t_3 & & t_2
		}} && \quad\text{for all } t_1,t_2,t_3\in T_*
	\end{alignat*}
	$\lhd_q$は$q=0$で文字列の連結になり結合性を満たすが、$q\neq0$では結合性
	を満たさない。例えば、次のようになる。
	\begin{equation*}\begin{split}
		\glr{\dyck\lhd_q\dyck}\lhd_q\dyck &= \dyck\lhd_q\glr{\dyck\lhd_q\dyck}
		+ (q + q^2) \gdyck{\dyck}\dyck{} \\
	\end{split}\end{equation*}
	この例で、結合性を満たさない部分は次のような二分木になっている。
	\begin{equation*}\begin{split}
		(TD^{-1})\gdyck{\dyck}\dyck{} &= \vcenter{\xymatrix@R=1ex@C=1ex{
			& & \circ \ar@{-}[dl] \ar@{-}[dr] \\
			& \circ \ar@{-}[dl] \ar@{-}[d] & & \circ \ar@{-}[d] \ar@{-}[dr] \\
			\circ & \circ & & \circ & \circ \\
		}}
	\end{split}\end{equation*}
%s3:平面上の二分木}

	\begin{todo}[残りの話題]\label{todo:残りの話題} %{
		課題を書いておく。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[Chomsky-Schutzenbergerの定理] $L_*$を曖昧の無い文法定義が存在する
		言語とし、$L_n\subseteq L_*$を$n$文字の単語からなる$L$の部分集合とする。
		すると、形式和$\gamma_tL_*:=\sum_{n\in\sizen} |L_n|t^n\in\sizen[[t]]$
		は、ある$n\in\sizen$と次の性質を満たす$p_k\in\bun[t]$が存在する。
		\begin{equation*}\begin{split}
			\sum_{k=0}^n p_k(\gamma_tL)^k = 0
		\end{split}\end{equation*}
		このことは、数学の方言で$\gamma_tL_*$は$\bun[t]$上で代数的であるという。
		Dyck言語$D_*$の場合、$x_t:=\gamma_tD_*$とおくと、$x_t=1+t^2x_t^2$
		だから、$p_0=1,\;p_1=-1,p_2=t^2$とすると、$\sum_{k=0}^2p_kx_t^k=0$
		となる。
		\item[Chomsky-Schutzenbergerの定理その二] Chomsky-Schutzenbergerの定理
		と呼ばれるものは他にもある。それだけChomskyとSchutzenbergerが多くの
		仕事をしたということだろう。そのうちの一つに次のような言い草がある。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item A language $L$ over the alphabet $A$ is context-free iff 
			there exists an alphabet $T$ , a rational set $K$ over 
			$(T\cup T^\dag)^*$ and a morphism $\phi:(T\cup T^\dag)^*\to A^*$, 
			such that $L=\phi(D_T^*\cup K)$.
		\end{itemize} %}
		ここで、$D_T$は$T$と$T^\dag$から生成されるDyck言語である。
		この言い草は、Brzozowski代数を用いた文法の線形化に他ならない。
		$\phi$が真空期待値をとることになる。
		大筋は次のようになる。有限集合$A$から生成されるモノイド環$RA^*$
		から$R$上の代数$V$への線形射全体のつくる集合
		$V(A^*)^\dag:=\cat{Mod}_R(RA^*,V)$を考える。まず、
		$R(A^*)^\dag:=\cat{Mod}_R(RA^*,R)$を考えて、作用素$a$と$a^\dag$を
		正当化する。これは、文字列の積$m_0$と共役$-^\dag$により定義することが
		できる。そして、$RA^**$と$R(A^*)^\dag$の基底系が次のように書けることが
		わかる。
		\begin{equation*}\begin{split}
			\ket{a_1a_2\cdots a_n} = a_1a_2\cdots a_n\ket{0}
			,\quad \bra{a_1\cdots a_{n-1}a_n} 
			= \bra{0}a_n^\dag a_{n-1}^\dag\cdots a_1^\dag
		\end{split}\end{equation*}
		そして、部分空間$\B_RA\subseteq\cat{Mod}_R(RA^*)$を定義することが
		できる。
		\begin{equation*}\begin{split}
			\B_RA := \myop{span}_R\set{w_1^\dag w_2\bou w_1,w_2\in A^*}
		\end{split}\end{equation*}
		$\B_RA$は$A$を文字とするスタックの操作を表すと解釈できる。
		$-m_0:V(A^*)^\dag\to V(A^*)^\dag\otimes V(A^*)^\dag$を次の式が成り立つ
		ように定義する。
		\begin{equation*}\begin{split}
			f\glr{m_0\lr{x\otimes y}} = m_V\lr{fm_0}\lr{x\otimes y}
			\quad\text{for all } f\in V(A^*)^\dag,\; x,y\in RA^*
		\end{split}\end{equation*}
		ここでは次のように定義する。
		\begin{equation*}\begin{split}
			v\bra{w}m_0 = \sum_{w_1w_2=w}v\bra{w_1}\otimes\bra{w_2}
			\quad\text{for all } v\in V,\; w\in A^*
		\end{split}\end{equation*}
		また、$-m_0^\dag:V(A^*)^\dag\otimes V(A^*)^\dag\to V(A^*)^\dag$を
		次の式が成り立つように定義する。
		\begin{equation*}\begin{split}
			m_V\lr{f\otimes g}\glr{m_0^\dag x} = \glr{\lr{f\otimes g}m_0}x
			\quad\text{for all } f,g\in V(A^*)^\dag,\; x\in RA^*
		\end{split}\end{equation*}
		\begin{equation*}\begin{split}
			\gglr{v_1\bra{w_1}\otimes v_2\bra{w_2}}m_0^\dag 
			= (v_1v_2)\bra{w_1w_2}
		\end{split}\end{equation*}
		%
		\item[正規積] 
		\begin{equation*}\begin{split}
			(b + c)^{2n} = \Braket{(\eta)^*(b\eta + c\eta^\dag)^{2n}
			(\eta^\dag)^*}
		\end{split}\end{equation*}
		%
		\item[Dyck言語の積] Dyck言語は文字列の連結による積$m_0$で閉じている
		が、$m_0$では$\D_1$から$\D_*$を生成することができない。
		$\D_1$から$\D_*$を生成されるような積を定義したい。
		\item[反転に関する対称性] $R:\D_*\to\sizen$を次のように定義する。
		\begin{equation*}\begin{split}
			R 1_\W &= 0 \\
			R \gdyck{w_1}w_2 &= \jump{w_1=w_2} + (Rw_1) + (Rw_2) \\
		\end{split}\end{equation*}
		$\D_n$を二分木で書いて、深さが最大になる単語が$\D_n$の中で$R$が
		最小になり、深さが最小になる単語が$\D_n$の中で$R$が最大になる。
		%
		\item[q-微分方程式] $q$-微分は次のように書けるから、
		\begin{equation*}\begin{split}
			[\partial_t]_q(ft) = \frac{(ft) - (fqt)}{t - qt}
		\end{split}\end{equation*}
		次のLeibnitz則に似た式が成り立つ。
		\begin{equation*}\begin{split}
			[\partial_t]_q\gglr{f_tg_t} = \gglr{[\partial_t]_qf_t}g_t
			+ (g_{qt})\gglr{[\partial_t]_qg_t}
		\end{split}\end{equation*}
		この式を使うとKleeneスターについて次の式が成り立つことがわかる。
		\begin{equation*}\begin{split}
			[\partial_t]_qf_t^* = [\partial_t]_q(1 + f_tf_t^*) 
			= \gglr{[\partial_t]_qf_t}f_t^* + f_{qt}\gglr{[\partial_t]_qf_t^*} 
			= f_{qt}^*\gglr{[\partial_t]_qf_t}f_t^*
		\end{split}\end{equation*}
		したがって、次のq-微分方程式で、
		\begin{equation*}\begin{split}
			[\partial_t]_qx_t = x_t^2
		\end{split}\end{equation*}
		解が$x_t=y_tz_t^*$と書けると仮定すると、
		\begin{equation*}\begin{split}
			[\partial_t]_qx_t = \gglr{[\partial_t]_qy_t}z_t^* 
			+ y_{qt}z_{qt}^*\gglr{[\partial_t]z_t}z_t^*,\quad
			x_t^2 = y_t^2\gglr{z_t^*}^2
		\end{split}\end{equation*}
		より、
		\begin{equation*}\begin{split}
			[\partial_t]_qy_t + y_{qt}z_{qt}^*\gglr{[\partial_t]z_t} = y_t^2z_t^*
		\end{split}\end{equation*}
		\end{description} %}
	\end{todo} %todo:残りの話題}
%s1:Dyck言語}

\section{Chomsky-Schutzenbergerの定理}\label{s1:Chomsky-Schutzenbergerの定理} %{
	Chomsky-Schutzenbergerの名前で呼ばれる定理はいくつかあるようだが、
	ここでは次の定理をChomsky-Schutzenbergerの定理という。

	\begin{theorem}[Chomsky-Schutzenberger]\label{prop:Chomsky-Schutzenberger} %{
		有限集合$\Sigma$から生成された言語$L\subseteq\Sigma^*$について、
		$L$が文脈自由であることと、次の性質を満たすことは同値である。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item ある有限集合$T$とその組$\wbar{T}$、
			\item $T\cup\wbar{T}$から生成された有理言語$R$、
			\item 準同型$h:(T\cup T)^*\to\Sigma^*$が存在して、
			\item $L=h(D_T\cup R)$となる。
		\end{itemize} %}
		ここで、$D_T$は$T$と$\wbar{T}$によって生成されるDyck言語である。
	\end{theorem} %prop:Chomsky-Schutzenberger}

	$R$を可換環、$A$を有限集合、$V=(V,m_V,1)$を$R$上の代数とする。
	$RA^*$をから生成された$R$の自由モノイドとし、文字列の連結による積を
	前置記号で$m$と書き、その共役を$m^\dag$と書く。
	\begin{alignat*}{2}
		\ket{w_1}\otimes\ket{w_2}
			&\xmapsto{m} \ket{w_1w_2} &\quad&\text{for all } w_i\in A^* \\
		\ket{w} &\xmapsto{m^\dag} 
			\sum_{\substack{w_1,w_2\in A^*\\\jump{w = w_1w_2}}}
			\ket{w_1}\otimes\ket{w_2} &\quad&\text{for all } w\in A^*
	\end{alignat*}
	次の可換図により、$V(A^*)^\dag:=\cat{Mod}_R(RA^*,V)$に積$\wbar{m}$と
	$R$-線形な余二項演算$m^\dag$を定義する。
	\begin{equation*}\begin{split}
		\xymatrix{
			RA^*\otimes RA^* \ar[r]^{f\otimes g} & V\otimes V \ar[d]^{m_V\sigma} \\
			RA^* \ar[r]^{\wbar{m}(f\otimes g)} \ar[u]_{m^\dag} & V \\
		},\quad &\xymatrix{
			RA^*\otimes RA^* \ar[r]^{m^\dag f} \ar[d]^{m} & V\otimes V \\
			RA^* \ar[r]^{f} & V \ar[u]_{\delta_L}^\simeq \\
		} \\
	\end{split}\end{equation*}
	ここで、$\sigma$と$\delta_L$は次のように定義する。
	\begin{equation*}\begin{split}
		\sigma(v_1\otimes v_2) = v_2\otimes v_1
			\quad\text{for all } v_i\in V,\quad
		\delta_L v = v\otimes1 \quad \text{for all } v\in V
	\end{split}\end{equation*}
	$m^\dag$は左余単位射が定義できないので、余積ではないが、余結合律は満たす。
	$\wbar{m}$と$m^\dag$を双対基底を用いて書くと次のようになっている。
	\begin{alignat*}{2}
		v_1\bra{w_1}\otimes v_2\bra{w_2} &\xmapsto{\wbar{m}}
			(v_2v_1)\bra{w_1w_2}
			&\quad&\text{for all } w_i\in A^*,\; v_i\in V \\
		v\bra{w} &\xmapsto{m^\dag} 
			\sum_{\substack{w_1,w_2\in A^*\\\jump{w = w_1w_2}}}
			v\bra{w_1}\otimes\bra{w_2} &\quad&\text{for all } w\in A^*,\; v\in V
	\end{alignat*}
	$VA$を$A$の$V$-自由加群として、$\iota\in\cat{Mod}_V\glr{{VA,(VA^*)^\dag}}$
	を次のように定義する。
	\begin{equation*}\begin{split}
		\glr{\iota(va)}
	\end{split}\end{equation*}

	\begin{todo}[ここまで]\label{todo:ここまで} %{
		表記を洗練する。
	\end{todo} %todo:ここまで}
	線形射$\lhd-:RA^*\cup V(A^*)^\dag\to\cat{Mod}_R\glr{V(A^*)^\dag}$を次の
	ように定義する。
	\begin{alignat*}{2}
		(f\lhd x)y &= fm(x\otimes y)
			&\quad&\text{for all } f\in R(A)^*,\; x,y\in RA^* \\
		f\lhd g &= \wbar{m}(g\otimes f)
			&\quad&\text{for all } f,g\in V(A^*)^\dag
	\end{alignat*}
	$\B_RA\subseteq\cat{Mod}_R\glr{V(A^*)^\dag}$を$\lhd RA^*$と
	$\lhd R(A^*)^\dag$の合成によって生成される部分空間とする。
	\begin{equation*}\begin{split}
		\B_RA := \myop{span}_R\cup_{n\in\sizen}\Set{(\lhd x_1)\cdots(\lhd x_n)
		\bou x_1,\dots,x_n\in RA^*\cup V(A^*)^\dag}
	\end{split}\end{equation*}
	\begin{alignat*}{2}
		\lhd\ket{a}m &= m\glr{\lhd\ket{a}\otimes\id} 
			&\quad&\text{for all } a\in A \\
		(\lhd a) m &= m\glr{(\lhd a)\otimes\id + P_0\otimes (\lhd a)}
			&\quad&\text{for all } a\in A \\
	\end{alignat*}

	以降、誤解のない場合はを$\lhd-$省略して次のように書くことにする。
	\begin{alignat*}{2}
		fw^\dag &:= f\lhd\ket{w}
			&\quad&\text{for all } f\in V(A^*)^\dag,\; w\in A^* \\
		fvw &:= f\lhd\glr{v\bra{w}}
			&\quad&\text{for all } f\in V(A^*)^\dag,\; v\in V,\; w\in A^*
	\end{alignat*}

	$\lhd RA^*$と$\lhd V(A^*)^\dag$の積によって生成される
	$\cat{Mod}_R\glr{V(A^*)^\dag}$の部分空間を$\B_RA$と書くことにする。
	\begin{equation*}\begin{split}
		B_RA := \set{()}
	\end{split}\end{equation*}

	文脈自由文法とプシュダウン-オートマトンをつなぐ
	$R$を可換環、$V=(V,m_V,u_V)$と$W=(W,m_W,u_W)$を$R$の代数とする。
	$WV^\dag:=\cat{Mod}_R(V,W)$と書く。
	双線型射$-\lhd-:WV^\dag\otimes WV^\dag\to WV^\dag$を次のように定義し、
	\begin{equation*}\begin{split}
		(f\lhd x) y = fm_V(x\otimes y)
		\quad\text{for all } f\in WV^\dag,\;x,y\in V
	\end{split}\end{equation*}
	双線型射$-\rhd-:W\otimes WV^\dag\to WV^\dag$を次のように定義する。
	\begin{equation*}\begin{split}
		(w\rhd f) x = m_W\glr{w\otimes (fx)}
		\quad\text{for all } w\in W,\; f\in WV^\dag,\;x\in V
	\end{split}\end{equation*}
	すると、$WV^\dag$は左$W$-加群、右$V$-加群となる。
	さらに、$V$に余積$(\delta_V,\epsilon_V)$が定義されているとすると、双線型射
	$-\lhd-:WV^\dag\otimes WV^\dag\to WV^\dag$を次のように定義することが
	できる。
	\begin{equation*}\begin{split}
		(f\lhd g) x = m_W(f\otimes g)\delta_V^r x
		\quad\text{for all } f,g\in WV^\dag,\;x\in V
	\end{split}\end{equation*}
	ここで、$\delta_V^r:=\sigma_{12}\delta_V$と定義した。
	すると、$u^\dag:=u_W\epsilon_V$とおくと、次の式より、
	$WV^\dag=u^\dag\lhd WV^\dag$となることがわかる。
	\begin{equation*}\begin{split}
		(u^\dag\lhd f)x = fx \quad\text{for all } f\in WV^\dag,\; x\in V
	\end{split}\end{equation*}
	\begin{equation*}\begin{split}
		\glr{(f\lhd g)\lhd u} v &= m_W(f\otimes g)\delta_V^r m_V (u\otimes v) \\
		\glr{(f\lhd u)\lhd g} v &= m_W(f\otimes g)(m_V\otimes\id)
			(\id\otimes\delta_V^r)(u\otimes v) \\
	\end{split}\end{equation*}

	次の畳み込みにより、$WV^\dag$に積$d_V^\dag$が定義できる。
	\begin{equation*}\xymatrix{
		V\otimes V \ar[r]^{f\otimes g} & W\otimes W \ar[d]^{m_W} \\
		V \ar[u]_{d_V} \ar[r]^{d_V^\dag(f\otimes g)} & W \\
	}\end{equation*}
	この積を用いて、
%s1:Chomsky-Schutzenbergerの定理}
%
}\endgroup %}
