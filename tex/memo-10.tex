\begingroup %{
	\newcommand{\Mod}[1][\fukuso]{{\mybf{Mod}}_{#1}}
	\newcommand{\Vect}[1][\fukukso]{{\mybf{Vec}}_{#1}}
	\newcommand{\Alg}[1][\fukuso]{{\mybf{Alg}}_{#1}}
	\newcommand{\Hom}{\myop{Hom}}
	\newcommand{\End}{\myop{End}}
	\newcommand{\Mat}{\myop{M}}
	\newcommand{\Map}{\mybf{Set}}
	\newcommand{\Pow}{\mycal{P}}
	\newcommand{\Perm}{\mycal{S}}
	\newcommand{\W}{\mycal{W}}
	\newcommand{\T}{\mycal{T}}
	\newcommand{\N}{\mycal{N}}
	\newcommand{\D}{\mycal{D}}
	\newcommand{\U}{\mycal{U}}
	\newcommand{\Ord}{\mycal{O}}
	\newcommand{\Wedge}{{\bigwedge}}
	%
	\newcommand{\id}{\myop{id}}
	\newcommand{\dup}{\myop{du}}
	\newcommand{\onto}{\myop{onto}}
	\newcommand{\dfn}{\,\myop{def}\,}
	\newcommand{\oless}{\olessthan}
	%
	\newcommand{\tran}{\mathbf{t}}
	%
	\newcommand{\from}{\xfrom{}}
	\newcommand{\toto}{\rightrightarrows}
	\newcommand{\fromfrom}{\leftleftarrows}
	\newcommand{\tofrom}{\rightleftarrows}
	\newcommand{\fromto}{\leftrightarrows}
	\newcommand{\xiff}[2][]{\xLongleftrightarrow[#1]{#2}}
	%
	\newcommand{\bld}[1][e]{{\mathbf{#1}}}
	\newcommand{\swap}{\leftrightarrow}
	\newcommand{\range}[2]{\genfrac{[}{]}{0pt}{}{#1}{#2}}
	%
	\newcommand{\mf}[1]{{\mathfrak{#1}}}
	\newcommand{\Dyck}{{\mathfrak D}}
	\newcommand{\Cyck}{{\mathfrak C}}
	\newcommand{\Path}{{\mathfrak P}}
	\newcommand{\cbinom}[2]{\genfrac{[}{]}{0pt}{}{#1}{#2}}
	\newcommand{\rot}[2][-90]{{\rotatebox[origin=c]{#1}{$#2$}}}
	%
	{\setlength\arraycolsep{2pt}
	%
\section{パーサーの曖昧さ}\label{s1:パーサーの曖昧さ} %{
	次のBNFで与えられた文法を考える。
	\begin{equation*}\begin{split}
		& E = A_1A_2B + A_2A_1B \\
		& A_1 = a,\quad A_2 = a^2,\quad B = b,\quad C = c \\
	\end{split}\end{equation*}
	大文字のアルファベットを品詞、小文字のアルファベットを入力文字とする。
	文法$E$に従って入力文字列を品詞分解する操作は次のように書けるだろう。
	\begin{equation*}\xymatrix{
		& E \ar[d]^{a}_{\phi(A_1,1,\eta_1^\dag)} \\
		& A_2B + A_{21}A_1C \ar[d]^{a}_{\phi(A_2,2,\eta_2^\dag)} \\
		& A_{21}B + A_1C \ar[d]^{a}_{\phi(A_2,2,\eta_1\eta_3^\dag) + \phi(A_1,1,\eta_2\eta_4^\dag)} \\
		& B + C \ar@(l,u)[dl]_{b}^{\phi(B,1,\eta_3)} \ar@(r,u)[dr]^{c}_{\phi(C,1,\eta_4)} \\
		\$_B \ar[dr]_{\beta} & & \$_C \ar[dl]^{\beta} \\
		& \$ \\
	}\end{equation*}
	ここで、$\phi$と$\beta$は品詞バッファと入力バッファの操作で次のように
	定義する。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $\phi$は(品詞, 文字数, Leavitt経路代数)の三つ組を品詞バッファ
		にプッシュする操作を表す。
		\item $\beta$はバックトレースの操作で、品詞バッファに積まれた三つ組から
		入力バッファの文字列を品詞分解していく操作を表す。
	\end{itemize} %}
	Leavitte代数は$\eta_i^\dag\eta_j=\jump{i=j}$とする。
	入力文字列が$a^3b$の場合は状態$\$_1$で品詞バッファは次のようになる。
	\begin{equation*}\begin{split}
		[a^3b] \mapsto \bigl[(A_1,1,\eta_1^\dag), (A_2,2,\eta_2^\dag)
		, (A_2,2,\eta_1\eta_3^\dag) + (A_1,1,\eta_2\eta_4^\dag)
		, (B,1,\eta_3) \bigr]
	\end{split}\end{equation*}
	操作$\beta$は品詞バッファの文字列を次のように操作する。
	\begin{equation*}\begin{split}
		\text{Leavitt}\quad
		& [a^3b] \mapsto \bigl[(A_1,1), 0 , (A_2,2) , (B,1) \bigr] \\
		\text{tokenize}\quad & \tau(A_1,0,1), \tau(A_2,1,3), \tau(B,3,4) \\
		\text{clear}\quad & \text{clears input and token buffers} \\
	\end{split}\end{equation*}
	ここで、$\tau(A,i,j)$は入力バッファの$i$番目から$j-1$番目までの文字列を
	品詞$A$とする操作である。Leavitt経路代数を挿入する場所は、
	NFAからDFAを作成する時に決めることができる（多分）。

	品詞分解の曖昧さの観点から、文法は次の二通りに分けられるだろう。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 入力をすべて読み終わっても曖昧さが残る文法 \\
		例えば、$A_2+A_1^2$という文法では、$a^2$という入力文字列をどのように
		分解して良いかがわからない。
		\item 少なくとも入力をすべて読み終われば品詞分解が唯一つ定まる文法 \\
		例えば、$A_2^*+A_2^*A_1$という文法では、$a^{2n}$なら$A_2$、
		$a$なら$A_1$、$a^{2n+3}$なら$A_2A_1$というように、入力をすべて
		読み終われば品詞分解が唯一つ定まる。
	\end{itemize} %}
	もちろん、論理和を表す加法$+$を積ではなく、優先順位がついた二項演算と
	みなせば曖昧さはなくなる。例えば、文法$A_2\lhd A_1^2$を入力文字列$a^2$
	に対して$A_2$を割り当てる二項演算する。また、確率を用いても曖昧さを
	解消することができる。例えば、文法$0.3A_2+0.7A_1^2$を、入力文字列$a^2$
	に対して、$30\%$の確率で$A_2$、$70\%$の確率で$A_2^2$とすることができる。
	自然言語への応用を考えると、確率的な解釈をするのが良さそうである。
	確率的な解釈は、文法ミスに対してのコンパイラからのヒントに使うことが
	できるだろうが、プログラミング言語の文法自体が確率的になっていることは
	困りものだろう。
%s1:パーサーの曖昧さ}
\section{シーケント計算}\label{s1:シーケント計算} %{
	シーケント計算を論理式を扱うための計算規則として捉えておく。

	\begin{definition}[シーケント（sequent）]\label{def:シーケント} %{
		$m,n\in\sizen$として、$A_1,\dots,A_m$と$B_1,\dots,B_n$を式とする。
		次の記号をシーケントと言い、
		\begin{equation*}\begin{split}
			A_1,\dots,A_m\vdash B_1,\dots,B_n 
		\end{split}\end{equation*}
		次の事を表したものとする。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item 右辺と左辺が共に空でないときは、次の式を表す。
			\begin{equation*}\begin{split}
				A_1\text{ and }\cdots\text{ and } A_m
				\implies B_1\text{ or }\cdots\text{ or } B_n
			\end{split}\end{equation*}
			\item 左辺が何もないときは、右辺の少なくとも一つが成り立つ。
			\item 右辺が何もないときは、左辺の少なくとも一つが成り立たない。
			\item 両辺が何もないときは、矛盾である。
		\end{itemize} %}
	\end{definition} %def:シーケント}
%s1:シーケント計算}
\section{ラムダ式の記法}\label{s1:ラムダ式の記法} %{
	ラムダ式全体のつくる集合を$\Lambda$と書く。
	ラムダ式全体は集合ではないかもしれないが、たとえ集合でなくても、
	集合のように扱うことにする。

\subsubsection{括弧の省略}\label{s3:括弧の省略} %{
	ラムダ式をパット見て分かるように、束縛変数と自由変数は共に小文字
	$x,y,\dots$、一般のラムダ式を大文字$A,B,\dots$で書くことにする。
	また、括弧を減らすために、ラムダ式を次の約束で書くことにする。
	\begin{equation*}\begin{array}{lrcll}
		\text{関数適用}\quad 
			& A_1A_2\cdots A_n &:=& (\cdots(A_1A_2)\cdots)A_n \\
		\text{関数抽象}\quad 
			& \lambda x_1x_2x_3\cdots x_n.A 
			&:=& \lambda x_1.(\lambda x_2.\cdots (\lambda x_n.A)\cdots) \\
	\end{array}\end{equation*}
	ここで、$A,A_1,\dots,A_n$はラムダ式、$x_1,\dots,x_n$は束縛変数とした。
%s3:括弧の省略}
\subsubsection{変数への代入}\label{s3:変数への代入} %{
	ラムダ式中の変数へ別のラムダ式を代入することを次のように書く。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item ラムダ式$A$の中の変数$x$にラムダ式$B$を代入したものを$A[x:=B]$
		と書く。
		\item ラムダ式$A$の中の変数$x$にラムダ式$B$を代入した後に、
		$A$の中の変数$y\neq x$にラムダ式$C$を代入したものを$A[x:=B,y:=C]$
		と書く。
		\item ラムダ式$A$の中の変数$x$にラムダ式$B$を代入した後に、
		$A$と$B$の中の変数$y\neq x$を$C$で置き換えたものを$A[x:=B][y:=C]$
		と書く。
	\end{itemize} %}
	$A[x:=B][y:=C]=A\bigl[x:=B[y:=C],y:=C\bigr]$となり、一般には、
	$A[x:=B,y:=C]\neq A[x:=B][y:=C]$であることに注意する。
%s3:変数への代入}
\subsubsection{ベータ変換}\label{s3:ベータ変換} %{
	ラムダ式の関係$\Lambda\xto{\beta}\Lambda\subseteq\Lambda\times\Lambda$
	を、次のように再帰によって定義する。
	\begin{equation*}\begin{split}
		A,B\in\Lambda &\implies (\lambda x.A)B \xto{\beta} A[x:=B] \\
		A\xto{\beta}B &\implies \left\{\begin{split}
			\lambda x.A &\xto{\beta} \lambda x.B \\
			AC &\xto{\beta} BC  \quad\text{for all } C\in\Lambda \\
			CA &\xto{\beta} CB  \quad\text{for all } C\in\Lambda \\
		\end{split}\right. \\
	\end{split}\end{equation*}
	そして、$(\lambda x.A)B$という形のラムダ式または部分ラムダ式を$\beta$基
	（$\beta$ redex）という。
	また、ラムダ式$A$から有限個の$\beta$変換で$B$に到達できるとき、
	その$\beta$変換の列を$\beta$変換の鎖という。
	\begin{equation*}\begin{split}
		A\xtoto{\beta}B \xiff{\dfn} \left\{\begin{split}
			& A = B \text{ or} \\
			& A\xto{\beta}B \text{ or} \\
			& \exists\; C\in\Lambda \text{ s.t. }
				A\xto{\beta}C\xtoto{\beta} B \\
		\end{split}\right. \\
	\end{split}\end{equation*}
	ラムダ式$A$から$B$への$\beta$変換の鎖があるとき、$A\xtoto{\beta}B$
	と書く。
%s3:ベータ変換}
%s1:ラムダ式の記法}
\section{Church-Rosserの定理}\label{s1:Church-Rosserの定理} %{
	教科書\cite{takahashi:keisan}に従って話を進める。

	任意の$n\in\sizen_+$に対してラムダ式$X_n:=\lambda_xx^n$とする。
	すると、任意のラムダ式$A$に対して$X_nA=A^n$となる。
	特に、$X_1$は'恒等写像'となる。$X_n$を使うと$\beta$変換で発散する
	ラムダ式をつくることができる。
	\begin{equation*}\begin{array}{rcll}
		X_2^2\xto{\beta}X_2^2\xto{\beta}X_2^2\xto{\beta}\cdots \\
		X_3^2\xto{\beta}X_3^3\xto{\beta}X_3^4\xto{\beta}\cdots \\
	\end{array}\end{equation*}
	$X_2^2$は発散と言っていいのかどうかわからないが、$\beta$変換をやり切る
	ことができない例で、$X_3^3$は発散する例である。一般に、$n\ge3$のとき
	$X_n^2$は発散する。ここで、任意の$n\in\sizen_+$に対してラムダ式
	$Y_n:=\lambda x.X_n$とすると、任意のラムダ式$M$に対して$Y_nM=X_n$
	となるから、次のような$\beta$変換が得られる。
	\begin{equation*}\xymatrix{
		Y_m(X_3^2) \ar[d]_\beta \ar[r]^\beta 
		& Y_m(X_3^3) \ar[dl]_\beta \ar[r]^\beta
		& Y_m(X_3^4) \ar[dll]_\beta \ar[r]^\beta
		& \cdots \\
		X_m
	} \quad\text{for all } m\in\sizen_+
	\end{equation*}
	ラムダ式$Y_m(X_3^2)$は$\beta$変換の収束点$X_m$を持つが、そこに至る経路
	は無数にある。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item ラムダ式$A$が$\beta$変換の収束点$B$を持てば、$A$を$\beta$変換
		していけば必ず$B$に収束するであろうか
	\end{itemize} %}
	という疑問に答えてくれるのが、Church-Rosserの定理である。

	\begin{proposition}[Church-Rosserの定理]
	\label{prop:Church-Rosserの定理} %{
		任意のラムダ式$A,B_1,B_2$に対して次の式が存在する。
		\begin{equation*}\begin{split}
			B_1 \xfromfrom{\beta} A \xtoto{\beta} B_2
			\implies \exists\; C\in\Lambda \text{ s.t. } \xymatrix@R=1em@C=1em{
				& A \ar@{>>}[dl]_\beta \ar@{>>}[dr]^\beta \\
				B_1 \ar@{>>}[dr]_\beta & & B_2 \ar@{>>}[dl]^\beta \\
				& C
			}
		\end{split}\end{equation*}
	\end{proposition} %prop:Church-Rosserの定理}

	Church-Rosserの定理は$\beta$変換が合流性\ref{def:合流性}を持つことを
	主張している。Church-Rosserの定理を証明する前に、$\beta$変換が
	局所合流性を持つことを証明しておく。

	\begin{proposition}[局所Church-Rosserの定理]
	\label{prop:局所Church-Rosserの定理} %{
		任意のラムダ式$A,B_1,B_2$に対して次の式が存在する。
		\begin{equation*}\begin{split}
			B_1 \xfrom{\beta} A \xto{\beta} B_2
			\implies \exists\; N\in\Lambda \text{ s.t. } \xymatrix@R=1em@C=1em{
				& A \ar[dl]_\beta \ar[dr]^\beta \\
				B_1 \ar@{>>}[dr]_\beta & & B_2 \ar@{>>}[dl]^\beta \\
				& N
			}
		\end{split}\end{equation*}
	\end{proposition} %prop:局所Church-Rosserの定理}
	\begin{proof} %{
		$\beta$変換の分岐$\xfrom{\beta}A\xto{\beta}$は次の三つのパターン
		に帰着される。
		\begin{enumerate}\setlength{\itemsep}{-1mm} %{
			\item\label{item:ラムダ式の分岐パターンその一}
			$\cdots\bigl((\lambda x.A_1)B_1\bigr)
				\cdots\bigl((\lambda y.A_2)B_2\bigr)\cdots$
			\item\label{item:ラムダ式の分岐パターンその二}
			$\cdots\biggl((\lambda x.A)\bigl((\lambda x.B)C\bigr)\biggr)
				\cdots$
			\item\label{item:ラムダ式の分岐パターンその三}
			$\cdots\biggl(\bigl(\lambda x.(\lambda y.A)B\bigr)C\biggr)\cdots$
		\end{enumerate} %}
		これらのパターンを簡略化して、それぞれのパターン毎に合流するラムダ式
		が存在することを証明する。
		\begin{description}\setlength{\itemsep}{-1mm} %{
			\item[\ref{item:ラムダ式の分岐パターンその一}]
			二つの$\beta$変換を行う順序に関わらず次の式が成り立つ。
			\begin{equation}\label{eq:ラムダ式の分岐パターンその一}
			\xymatrix@R=1em@C=1ex{
				\bigl(A_1[x:=B_1])\bigl((\lambda y.A_2)B_2\bigr) \ar[rd]^\beta \\
				\bigl((\lambda x.A_1)B_1\bigr)\bigl((\lambda y.A_2)B_2\bigr)
					\ar[u]^\beta \ar[d]_\beta
					& \bigl(A_1[x:=B_1]\bigr)\bigl(A_2[y:=B_2]\bigr) \\
				\bigl((\lambda x.A_1)B_1\bigr)\bigl(A_2[y:=B_2]\bigr) \ar[ru]_\beta
			}\end{equation}
			%
			\item[\ref{item:ラムダ式の分岐パターンその二}]
			二つの$\beta$変換を行う順序に関わらず次の式が成り立つ。
			\begin{equation}\label{eq:ラムダ式の分岐パターンその二}
			\xymatrix@R=1em@C=1ex{
				A\bigl[x:=\bigl((\lambda y.B)C\bigr)\bigr] \ar@{>>}[rd]^\beta \\
				(\lambda x.A)\bigl((\lambda y.B)C\bigr) \ar[u]^\beta
					\ar[d]_\beta & A\bigl[x:=B[y:=C]\bigr] \\
				(\lambda x.A)\bigl(B[y:=C]\bigr) \ar[ru]_\beta
			}\end{equation}
			%
			\item[\ref{item:ラムダ式の分岐パターンその三}]
			このパターンは先の二つと異なり、合流するラムダ式が存在することは
			自明と思われないが、
			\begin{equation}\label{eq:ラムダ式の分岐パターンその三}
			\xymatrix@R=1em@C=1em{
				\bigl(\lambda x.(A[y:=B])\bigr)C \ar[r]^\beta & A[y:=B][x:=C] \\
				\bigl(\lambda x.(\lambda y.A)B\bigr)C \ar[u]^\beta \ar[d]_\beta \\
				\bigl(\lambda y.A[x:=N]\bigr)B[x:=C] \ar[r]^\beta
					& A[x:=C]\bigr)\bigl[y:=B[x:=C] \\
			}\end{equation}
			$A$を変数$x,y$の関数と思って$A=f_A(x,y)$と書き、$B$を変数$x$
			の関数と思って$B=f_Bx$と書くと、次のように書ける。
			\begin{equation*}\begin{split}
				A[y:=B][x:=C] = f_A(C, f_BC) = A[x:=C]\bigl[y:=B[x:=C]\bigr]
			\end{split}\end{equation*}
			したがって、このパターンでも合流するラムダ式が存在することがわかる。
		\end{description} %}
	\end{proof} %}

	この命題の証明の中で、一回の$\beta$変換ではなく$\beta$変換の鎖によって
	合流することが示されているのは、式\eqref{eq:ラムダ式の分岐パターンその二}
	の中に現れる次の$\beta$変換の鎖だけである。
	\begin{equation*}\begin{split}
		A\bigl[x:=\bigl((\lambda y.B)C\bigr)\bigr]
		\xtoto{\beta}A\bigl[x:=B[y:=C]\bigr]
	\end{split}\end{equation*}
	関数抽象を代入しているところが、$\beta$変換の鎖を要求する。例えば、
	$\lambda x.A$を$\lambda x.z,\;\lambda x.x,\;\lambda x.(x^2)$
	としてみると次のようになる。
	\begin{equation*}\begin{array}{rcrcr}
		z\bigl[x:=\bigl((\lambda y.B)C\bigr)\bigr] &=& z \\
		x\bigl[x:=\bigl((\lambda y.B)C\bigr)\bigr] &=& (\lambda y.B)C
			&\xto{\beta}& B[y:=C] \\
		(x^2)\bigl[x:=\bigl((\lambda y.B)C\bigr)\bigr] 
			&=& \bigl((\lambda y.B)C\bigr)^2
			&\xtoto{\beta}& \bigl(B[y:=C]\bigr)^2
	\end{array}\end{equation*}
	一回の$\beta$変換だけで合流するのは、$A$が$x$の一次式で書かれている
	場合のみである。もし、この$\beta$変換の鎖で書かれている部分が一回の
	$\beta$変換になったとすると、格子状に合流する例\ref{eg:合流性を持つ例}
	にあるように、（大域）Church-Rosserの定理は自明になる。
	したがって、式\eqref{eq:ラムダ式の分岐パターンその二}の$\beta$変換の鎖が
	（大域）Church-Rosserの定理を難しくしていると言える。

	この命題の証明に現れた次の式において、
	\begin{equation}\label{eq:Jacobiの恒等式に相当する式}\begin{split}
		\bigl(A[y:=B]\bigr)[x:=C] 
		= \bigl(A[x:=C]\bigr)\bigl[y:=B[x:=C]\bigr] \\
		\quad\text{for all } A,B,C\in \Lambda
	\end{split}\end{equation}
	関数適用を変数をパラメータに持つ二項演算子$\lhd_x$で次のように書くと、
	\begin{equation*}\begin{split}
		(\lambda x.A)B \mapsto A\lhd_x B \quad\text{for all } A,B\in\Lambda
	\end{split}\end{equation*}
	式\eqref{eq:Jacobiの恒等式に相当する式}は分配則の形にまとまる。
	\begin{equation}\label{eq:Jacobiの恒等式に相当する式その二}\begin{split}
		(A\lhd_y B)\lhd_x C = (A\lhd_x C)\lhd_y(B\lhd_x C) \\
		\quad\text{for all } A,B,C\in\Lambda,\;x,y\in X
	\end{split}\end{equation}
	この分配則は二項演算としてはかなり特徴的な式なので、何らかの名前
	がついていると思われる。何かの拍子で見つかるかもしれないので、
	覚えておく。

	まとめると、$\beta$変換の局所合流性は、次のような標語でまとめられる
	だろう。
	\begin{equation*}\begin{array}{ll}
		\text{格子状の合流性からのズレ}\quad & A\lhd_x(B\lhd_y C) \\
		\text{関数適用の分配則}\quad & (A\lhd_xB)\lhd_y C \xtoto{\beta} 
			(A\lhd_y C)\lhd_x(B\lhd_y C)
	\end{array}\end{equation*}

\subsection{合流性}\label{s2:合流性} %{
	ここでは、合流性を向きづけられたグラフの性質として定義する。
	まず、グラフの連結可能な辺の列を表す記号を定義しておく。

	\begin{definition}[グラフの辺]\label{def:グラフの辺} %{
		$G=(G_0,G_1)$を向きづけられたグラフとする。
		$G$の辺を頂点$a,b\in G_0$を用いて$a\to b$と書く。
		\begin{equation*}\begin{split}
			a\to b \xiff{\dfn} a\times b\in G_1 \quad\text{for all } a,b\in G_0
		\end{split}\end{equation*}
		そして、頂点$a_1$から$a_n$への辺の有限列$a_1\to a_2\to\cdots\to a_n$
		が存在するとき、$a_1\xtoto{}a_n$と書く。便宜上、任意の頂点$a$に対して
		$a\xtoto{}a$とする。また、$a_1\to a_2\to\cdots\to a_n$を$a_1$から
		$a_n$への辺の鎖という。
	\end{definition} %def:グラフの辺}

	\begin{definition}[合流性（confluence）]\label{def:合流性} %{
		$G=(G_0,G_1)$を向きづけられたグラフとする。
		任意の$a,b_1,b_2\in G_0$に対して、
		\begin{description}\setlength{\itemsep}{-1mm} %{
			\item[局所合流性] 次の式が成り立つとき、$G$は局所合流性または
			局所Church-Rosser性を持つといい、
			\begin{equation*}\begin{split}
				b_1\from a\to b_2 \implies \exists\; c\in G_0 \text{ s.t. }
				\xymatrix@R=1em@C=1em{
					& a \ar[dl] \ar[dr] \\
					b_1 \ar@{>>}[dr] & & b_2 \ar@{>>}[dl] \\
					& c
				}
			\end{split}\end{equation*}
			\item[合流性] 次の式が成り立つとき、$G$は合流性またはChurch-Rosser性
			を持つという。
			\begin{equation*}\begin{split}
				b_1\xfromfrom{} a\xtoto{} b_2 \implies \exists\; c\in G_0
				\text{ s.t. } \xymatrix@R=1em@C=1em{
					& a \ar@{>>}[dl] \ar@{>>}[dr] \\
					b_1 \ar@{>>}[dr] & & b_2 \ar@{>>}[dl] \\
					& c
				}
			\end{split}\end{equation*}
		\end{description} %}
		局所合流性は弱合流性とも言われる。ここでは、意味の掴みやすい局所合流性
		という言葉を使うことにする。
	\end{definition} %def:合流性}

	局所合流性を持っていても、合流性は持たないことがある。
	次の例は、局所合流性を持つが、合流性を持たない例である。

	\begin{example}[局所合流性だけを持つ例その一]
	\label{eg:局所合流性だけを持つ例その一} %{
		集合$\set{2^n,3^n\bou n\in\sizen_+}$に対する次の変換系$\set{f,g}$
		を考える。
		\begin{equation*}\begin{split}
			2^{n+1} \xmapsfrom{\;f} 2^n \xmapsto{g} 3^n \xmapsto{g} 3^{n+2}
			\quad\text{for all } n\in\sizen_+
		\end{split}\end{equation*}
		変換系$\set{f,g}$は局所合流性を持つが、
		\begin{equation*}\begin{split}
			2^n \xmapsto{f} 2^{n+1} \xmapsto{f} 2^{n+2} \xmapsto{g} 3^{n+2}
			\quad\text{and}\quad 2^n \xmapsto{g} 3^n \xmapsto{g} 3^{n+2}
		\end{split}\end{equation*}
		$3$と$9$は合流することがないので、合流性は持たない。
		\begin{equation*}\begin{split}
			2 \xmapsto{f} 3 \quad\text{and}\quad 2 \xmapsto{f} 3 \xmapsto{g} 9
		\end{split}\end{equation*}
	\end{example} %eg:局所合流性だけを持つ例その一}

	\begin{example}[局所合流性だけを持つ例その二]
	\label{eg:局所合流性だけを持つ例その二} %{
		次のグラフは局所合流性を持つ。
		\begin{equation*}\xymatrix{
			a & b \ar[l] \ar@/^1ex/[r] & c \ar@/^1ex/[l] \ar[r] & d
		}\end{equation*}
		しかし、$a\xfrom{}b\xtoto{}d$だが、$a$と$d$に合流する点はないので、
		このグラフは合流性は持たない。
	\end{example} %eg:局所合流性だけを持つ例その二}

	次の例は、合流性を持つ例である。

	\begin{example}[合流性を持つ例]\label{eg:合流性を持つ例} %{
		$G=(G_0,G_1)$を向きづけられたグラフとする。
		任意の$a,b_1,b_2\in G_0$に対して、次の形の局所合流性が成り立つとき、
		$G$は合流性を持つ。
		\begin{equation*}\begin{split}
			b_1\from a\to b_2 \implies \exists\; c\in G_0 \text{ s.t. }
			\xymatrix@R=1em@C=1em{
				& a \ar[dl] \ar[dr] \\
				b_1 \ar[dr] & & b_2 \ar[dl] \\
				& c
			}
		\end{split}\end{equation*}
		このことは、任意の辺の鎖
		$a_{1m}\from\cdots\from a_{11}\from a\to a_{21}\to\cdots\to a_{n1}$
		に対して次の格子状の辺の鎖が成り立つことからわかる。
		\begin{equation*}\xymatrix@R=1em@C=1em{
			a \ar[r] \ar[d] & a_{11} \ar[r] \ar[d] & \cdots \ar[r] \ar[d] 
				& a_{1m} \ar[d] \\
			a_{21} \ar[r] \ar[d] & a_{21} \ar[r] \ar[d] & \cdots \ar[r] \ar[d] 
				& a_{2m} \ar[d] \\
			\vdots \ar[r] \ar[d] & \vdots \ar[r] \ar[d] & \cdots \ar[r] \ar[d] 
				& \vdots \ar[d] \\
			a_{n1} \ar[r] & a_{n1} \ar[r] & \cdots \ar[r] & a_{nm} \\
		}\end{equation*}
	\end{example} %eg:合流性を持つ例}

	その他にも局所合流性と合流性が同値になる例が知られているが、
	Newmanの定理は最も有名なものの一つで、深さが有限なグラフの場合は、
	局所合流性と合流性が同値になることを主張する。深さが有限なグラフという
	ことは、次の鎖の有限性で定義される。

	\begin{definition}[鎖の有限性]\label{def:鎖の有限性} %{
		$G$を向き付けられたグラフとする。$G$のすべての辺の鎖が有限の長さとなる
		とき、$G$は鎖の有限性を満たすという。鎖の有限性は次のような方言を持つ。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item well-founded
			\item 降鎖条件
			\item 昇鎖条件
		\end{itemize} %}
	\end{definition} %def:降鎖条件}

	鎖の有限性は環論のイデアルに関する性質など数学の色々なところで用いられる
	性質なので、様々な呼び名がある。

	グラフにループがあると、無限の長さの辺の鎖が存在するので、
	\begin{equation*}\begin{split}
		\xymatrix{
			a \ar@/^1ex/[r] & b \ar@/^1ex/[l]
		}\implies a\to b\to a\to b\to\cdots
	\end{split}\end{equation*}
	グラフが鎖の有限性を満たすときは、グラフはループを持たない。
	さらに、グラフがループを持たなければ、頂点の関係$a\to b$は半順序$a>b$
	または$a<b$とみることができる。図にすると次のようになる。
	\begin{equation*}\begin{split}
		\text{$G$は鎖の有限性を持つ} &\implies \left\{\begin{array}{l}
			\text{$G$にはループがない} \\
			\text{$G$は半順序集合}
		\end{array}\right. \\
	\end{split}\end{equation*}

	Newmanの定理は従属選択公理を必要とする。少なくとも、ここで与える証明は
	従属選択公理を必要とする。従属選択公理を書いておく。

	\begin{definition}[従属選択公理（axiom of dependent choice）]
	\label{def:従属選択公理} %{
		$S$を空でない集合とする。$S$上の次の性質を満たす任意の関係$R$に対して、
		\begin{equation*}\begin{split}
			s\in S\implies \exists\; t\in S\text{ s.t. } (s,t)\in R
		\end{split}\end{equation*}
		次の性質を満たす写像$x:\sizen\to S$が存在することを仮定するのが、
		従属選択公理である。
		\begin{equation*}\begin{split}
			(x_n,x_{n+1})\in R \quad\text{for all } n\in\sizen
		\end{split}\end{equation*}
	\end{definition} %def:従属選択公理}

	従属選択公理は、実数$R$の数列$r_0<r_1<\cdots< r_n$を任意の$n\in\sizen$
	に対して作ることができるなどを仮定する。曲者は'任意の長さの数列'という
	ところで、そこに従属選択公理といういかめしい公理が必要になるようだ。

	\begin{proposition}[Newmanの定理]\label{prop:Newmanの定理} %{
		$G$を向きづけられたグラフとする。$G$が次の性質を持つ時、$G$は合流性
		を持つ。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $G$は鎖の有限性を持つ。
			\item $G$は局所合流性を持つ。
		\end{itemize} %}
	\end{proposition} %prop:Newmanの定理}
	\begin{proof} %{
		背理法により証明する。
		頂点$a$が次の性質を持つ時、合流しない分岐点ということにする。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item ある頂点$b_1$と$b_2$があって$b_1\xfromfrom{}a\xtoto{}b_2$
			となり、$b_1$と$b_2$は互いに共通する下流の頂点を持たない。
		\end{itemize} %}
		頂点$a$を合流しない分岐点とする。
		$x$を$a$もしくは$a$の下流の頂点で次の性質を満たす頂点とする。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $x$は合流しない分岐点である。
			\item $x$を含まない$x$の下流には合流しない分岐点が含まれない。
		\end{itemize} %}
		$a$の下流の頂点数が有限であれば、深さ優先探索によって、$x$を列挙する
		ことができ、その中の一つを選び出せばよい。
		$a$の下流の頂点数が無限のとき、$x$を選択することができることを
		従属選択公理によって仮定する。

		$x$の定義から、$x$の下流の頂点$x_1$と$x_2$で共通の下流の頂点を持たない
		ものが存在する。$x_1\neq x$かつ$x_2\neq x$だから、$x\to i_i\xtoto{}x_i$
		となる頂点$i_1$と$i_2$が存在する。$G$が局所合流性を持つから、
		$i_1\xtoto{}y\xfromfrom{}i_2$となる頂点$y$が存在する。さらに、$x$の
		定義から、$i_1$は合流する分岐点だから、$x_1\xtoto{}z\xfromfrom{}y$
		となる頂点$z$が存在する。同様に、$i_2$は合流する分岐点だから、
		$z\xtoto{}w\xfromfrom{}x_2$となる頂点$w$が存在する。したがって、
		下図の経路が成り立つ。
		\begin{equation*}\xymatrix{
			x \ar[r] \ar[d] & i_1 \ar@{>>}[r] \ar@{>>}[d] & x_1 \ar@{>>}[d] \\
			i_2 \ar@{>>}[r] \ar@{>>}[d] & y \ar@{>>}[r] & z \ar@{>>}[d] \\
			x_2 \ar@{>>}[rr] & & w \\
		}\end{equation*}
		すると、$x_1$と$x_2$が共通の下流の頂点$w$を持つことになり、
		$x_1$と$x_2$の定義に矛盾する。
	\end{proof} %}
%s2:合流性}
\subsection{Taitによる証明}\label{s2:Taitによる証明} %{
	\cite{takahashi:keisan}にならい、並行$\beta$変換を定義して、
	並行$\beta$変換を使ってChurch-Rosserの定理を証明する。

	\begin{definition}[並行ベータ変換]\label{def:並行ベータ変換} %{
		並行$\beta$変換$\eqto{\beta}$を次のように再帰的に定義する。
		\begin{equation*}\begin{array}{rcll}
			x\text{ is a variable} &\implies& x\eqto{\beta}x \\
			M\eqto{\beta}N &\implies& \lambda x.M\eqto{\beta}\lambda x.N \\
			M_i\eqto{\beta}N_i &\implies& M_1M_2\eqto{\beta}N_1N_2 \\
			M_i\eqto{\beta}N_i &\implies&
				(\lambda x.M_1)M_2\eqto{\beta}(\lambda x.N_1)N_2 \\
		\end{array}\end{equation*}
	\end{definition} %def:並行ベータ変換}

	ラムダ式$M$の並行$\beta$変換は、$M$の中にある$\beta$変換可能な
	部分ラムダ式の組について$\beta$変換を行ったものとなる。その際、
	ベータ変換を行った後に新たに現れる$\beta$変換可能な部分ラムダ式の組に
	ついては$\beta$変換を行わない。あくまで$M$の中に既にある$\beta$変換可能な
	部分ラムダ式の組についてのみ変換を行う。
	例えば、$Y_m(X_3^2)$の並行$\beta$変換は次の三通りとなる。
	\begin{equation}\label{eq:並行変換の例}\begin{split}
		Y_m(X_3X_3) &\eqto{\beta} Y_m(X_3X_3) \\
		\contraction{Y_m(}{X_3}{}{X_3}Y_m(X_3X_3) &\eqto{\beta} Y_m(X_3X_3X_3) \\
		\contraction[2ex]{}{Y_m}{(}{X_3X_3}Y_m(X_3X_3) &\eqto{\beta} X_m \\
		\contraction[2ex]{}{Y_m}{(}{X_3X_3}
			\contraction{Y_m(}{X_3}{}{X_3}Y_m(X_3X_3) &\eqto{\beta} X_m \\
	\end{split}\end{equation}
	$\beta$変換をする仕方は全部で三通りあるが、最後の二つは同一の結果を
	与えるので、$Y_m(X_2^2)$の並行$\beta$変換の結果は、$\beta$変換しない
	ラムダ式も含めて全部で三通りとなる。

	ラムダ式の中の$\beta$変換可能な$n$個の部分ラムダ式の組をすべて
	$\beta$変換する方法の総数は、$\beta$変換する順序を入れ替えた分だけ
	異なる方法があるから、$n!$となる。したがって、ラムダ式$M$に変換可能な
	部分ラムダ式の組が全部で$n$個あったとき、並行$\beta$変換を得る方法の
	総数は$\sum_{p=0}^np!\binom{n}{p}$となる。
	ただし、この式には、同一の結果を与える並行$\beta$変換も含まれるから、
	並行$\beta$変換して得られるラムダ式の数は、この式で与えられる値よりも
	小さくなることがある。式で書くと次のようになる。
	\begin{equation*}\begin{split}
		& \text{$\beta$変換可能な組が$n$個} \\
		& \implies \text{並行$\beta$変換の総数}
		\le \sum_{p=0}^np!\binom{n}{p}
		= n!\biggl(1+\frac{1}{2!}+\cdots+\frac{1}{n!}\biggr)
	\end{split}\end{equation*}
%s2:Taitによる証明}
%s1:Church-Rosserの定理}
\section{ダイアモンドの補題}\label{s1:ダイアモンドの補題} %{
	論文\cite{Hevlicek2010Diamond}からの抜粋を書いておく。
	ノート\cite{KhareDiamond}も参考させてもらう。

	交差条件は、順序集合に対して定義されることもあるが、ここでは、
	論文\cite{Hevlicek2010Diamond}に習ってグラフに対して定義しておく。

	\begin{definition}[降鎖条件]\label{def:降鎖条件} %{
		$G$を向き付けられたグラフとする。$G$の任意の点を始点とする
		任意の経路は有限の長さとなる。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $G$は、well-foundedである。
			\item $G$は、アルチアン（Artinian）である。
			\item $G$は、降鎖条件を満たす。
		\end{itemize} %}
	\end{definition} %def:降鎖条件}

	次のようなループを持たないグラフが降鎖条件を満たすグラフである。
	\begin{equation*}\begin{split}
		\xymatrix{
			\vdots \ar[d] \ar[dr] & \vdots \ar[dl] \ar[d] \\
			\bullet \ar[d] \ar[dr] & \bullet \ar[dl] \ar[d] \\
			\bullet & \bullet \\
		}
	\end{split}\end{equation*}
	経路の終点に向かって有限性を要求するが、逆向きの経路については有限性を
	要求しない。ループを持つと、終点に向かって有限に循環してしまうので、
	ループを持たないことが必要条件となる。

	交差条件とは別に経路の合流を表すダイアモンド条件という性質がある。

	\begin{definition}[ダイアモンド条件]\label{def:ダイアモンド条件} %{
		$G$を向き付けられたグラフとする。任意の部分グラフ$v_1\from v_0\to v_2$
		に対して、次の図を満たす$v_1$と$v_2$から$v_3$への経路が存在するとき、
		\begin{equation*}\xymatrix{
			v_0 \ar[d] \ar[r] & v_2 \ar@{>>}[d] \\
			v_1 \ar@{>>}[r] & v_3 \\
		}\end{equation*}
		を次のように言う。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $G$は、ダイアモンド条件を満たす。
			\item $G$は、合流性（confluence）を満たす。
		\end{itemize} %}
	\end{definition} %def:ダイアモンド条件}

	ダイアモンド条件という言葉は代数方面、合流性という言葉は計算機科学方面で
	使われるようである。

	\begin{proposition}[ダイアモンドの補題]\label{prop:ダイアモンドの補題} %{
		$G$を向き付けられたグラフとする。
		$G$が交差条件とダイアモンド条件の両方を満たすならば、
		任意の$G$の連結な部分グラフは終点を唯一つだけ持つ。
	\end{proposition} %prop:ダイアモンドの補題}
	\begin{proof} TODO
	\end{proof}

	ダイアモンドの補題をLie代数の普遍包絡環に適用することを考える。
	$n$次元Lie代数$\mf{g}$の基底系$X:=\set{x_i\in\mf{g}\bou i\in1..n}$を固定
	して考える。Poincare-Birkhoff-Wittの定理（PBWの定理）は、
	次の集合$\mf{X}$が$\mf{g}$の普遍包絡環$\U_*\mf{g}$の基底系となることを
	教えてくれる。
	\begin{equation*}\begin{split}
		\mf{X} := \set{x_{i_1}^{p_1}\cdots x_{i_n}^{p_n}\in\U_*\mf{g}
			\bou p_1,\dots,p_k\in\sizen} \\
	\end{split}\end{equation*}
	PBWの定理をダイアモンドの補題によって証明することができる。

	$\myop{sl}_2$の基底系を$E=\set{X,Y,H}$を次のようにおく。
	\begin{equation*}\begin{split}
		[H,X] = 2X,\quad [H,Y] = -2Y,\quad [X,Y] = H
	\end{split}\end{equation*}
	PBWの定理は次の集合$\mf{E}$が$U\myop{sl}_2$の基底系になることを
	教えてくれる。
	$E$に順序を次のように定義すると、
	\begin{equation*}\begin{split}
		Y < Z < X
	\end{split}\end{equation*}
	$E$の文字列$\W_*E$に次のようにして半順序$\preceq$を定義することができる。
	\begin{equation*}\begin{split}
		w_1\preceq w_2
		\xiff{\dfn} \left\{\begin{split}
			|w_1|<|w_2| &\quad\text{or} \\
			|w_1|=|w_2| &\implies \text{lexicographical order}
		\end{split}\right. \\
	\end{split}\end{equation*}
%s1:ダイアモンドの補題}
\section{Dyck言語}\label{s1:Dyck言語} %{
	一般的にはDyck言語は次のように定義される。

	\begin{definition}[Dyck言語]\label{def:Dyck言語} %{
		大きさ$2$の集合$\mybf{2}=\set{a,b}$から生成される自由モノイドを
		$\W_*\mybf{2}$とする。任意の$n\in\sizen$に対して、
		$\W_{2n}\mybf{2}$の部分集合$\Dyck_n$が次の条件を満たすとき、
		$\Dyck_*:=\sum_{n\in\sizen}\Dyck_n$をDyck言語という。
		\begin{enumerate}\setlength{\itemsep}{-1mm} %{
			\item $w\in\Dyck_n$ならば、$\sharp_{a}w=\sharp_{b}w$となる。
			\item $w\in\Dyck_n,\;w_1,w_2\in\W_*\mybf{2}$かつ$w=w_1w_2$
			ならば、$\sharp_{a}w_1\ge\sharp_{b}w_1$となる。
		\end{enumerate} %}
	\end{definition} %def:Dyck言語}

	Dyck言語の場合、$\Dyck_n$は長さ$2n$の単語の集合としていることに注意する。
	式で書くと、$\Dyck_n\subset\W_{2n}\mybf{2}$という約束を使う。

	この定義は、直感的でないが簡潔にDyck言語を定義する。
	長さ$2,4,6$のDyck言語を文字$\set{0,1}$で書くと次のようになる。
	\begin{equation*}\begin{array}{rrrrr}
		01 \\
		0011 & 0101 \\
		000111 & 001011 & 001101 & 010011 & 010101 \\
	\end{array}\end{equation*}
	これを文字$\set{\langle,\rangle}$で書き直すと形式言語との関係が
	明確になる。
	\begin{equation*}\begin{array}{rrrrr}
		\braket{} \\
		\langle\braket{}\rangle & \braket{}\braket{} \\
		\langle\langle\braket{}\rangle\rangle
		& \langle\braket{}\braket{}\rangle
		& \langle\braket{}\rangle\braket{}
		& \braket{}\langle\braket{}\rangle
		& \braket{}\braket{}\braket{} \\
	\end{array}\end{equation*}

	\begin{note}[Dyck言語と自己線形写像]\label{note:Dyck言語と自己線形写像} %{
		多項式$R[x]$を通常の加法と乗法によって$R$-代数とみなす。
		$R[x]$の自己線形写像全体のつくる集合を$V=\Mod[R](R[x],R[x])$とする。
		$V$は畳み込みによる加法と係数の作用によって$R$-加群となり、
		写像の合成により$R$-代数となる。
		$x^{n\tran}:=(x^n)^\tran\in\Mod[R](R[x],R)$を次のようにおくと、
		\begin{equation*}\begin{split}
			x^{m\tran}x^n = \jump{m=n}
		\end{split}\end{equation*}
		集合$E=\set{x^mx^{n\tran}\in V\bou m,n\in\sizen}$は$V$の基底系となり、
		次の代数を満たす。
		\begin{equation*}\begin{split}
			x^{m_1}x^{n_1\tran}x^{m_2}x^{n_2\tran}
			= \jump{n_1=m_2}x^{m_1}x^{n_2\tran}
			\quad\text{for all } m_1,m_2,n_1,n_2\in\sizen
		\end{split}\end{equation*}
		集合$X=\set{x,y}$とすると、自由モノイドの普遍性により、
		次の性質を満たす$f\in\Alg[R](R\W_*X,V)$が一意に定まる。
		\begin{equation*}\begin{split}
			fx = x := xx^{0\tran},\quad fy = x^\tran := x^0x^\tran
		\end{split}\end{equation*}
		$\ker f$は$X$から生成されるDyck言語となる。
	\end{note} %note:Dyck言語と自己線形写像}

	Dyck言語は、次のような平面格子上の経路から生成することができる。
	\begin{equation}\label{eq:Dyck経路}\xymatrix@R=1em@C=1em{
		& & & (3,3) \\
		& & (2,2) \ar[r]^0 & (3,2) \ar[u]_1\\
		& (1,1) \ar[r]^0 & (2,1) \ar[r] \ar[u]_1& (3,1) \ar[u]_1\\
		(0,0) \ar[r]^0 & (1,0) \ar[r]^0 \ar[u]_1 & (2,0) \ar[r]^0 \ar[u]_1
			& (3,0) \ar[u]_1\\
	}\end{equation}
	経路内を
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 右へ移動した時に$0$、
		\item 上へ移動した時に$1$
	\end{itemize} %}
	を書いていくと、$(0,0)$から$(n,n)$への経路によって、長さ$2n$のDyck言語の
	単語が生成される。例えば、経路$(0,0)(1,0)(2,0)(2,1)(2,2)(3,2)(3,3)$
	からは$001101$という単語が生成される。この図のようにDyck言語を生成する
	経路をDyck経路という。

	Dyck経路を２次元平面上の経路の特別な場合として定義する。

	\begin{definition}[単調経路（monotonic path）]\label{def:単調経路} %{
		平面上の自然数を頂点とする格子で、$(0,0)$から$(m,n)$への経路で、
		水平方向にも垂直方向にもプラス方向にのみ頂点の移動が可能となる経路を
		$(0,0)$から$(m,n)$への単調経路という。
	\end{definition} %def:単調経路}

	次の図は$(0,0)$から$(3,2)$への単調経路（の集合）を表している。
	\begin{equation*}\xymatrix@R=1em@C=1em{
		& & (2,2) \ar[r] & (3,2) \\
		& (1,1) \ar[r] & (2,1) \ar[r] \ar[u] & (3,1) \ar[u] \\
		(0,0) \ar[r] & (1,0) \ar[r] \ar[u] & (2,0) \ar[r] \ar[u]
			& (3,0) \ar[u] \\
	}\end{equation*}

	\begin{definition}[Dyck経路]\label{def:Dyck経路} %{
		$(0,0)$から$(n,n)$への単調経路で、$p\ge q$となる頂点$(p,q)$のみを通過
		する経路をDyck経路という。
	\end{definition} %def:Dyck経路}

	Dyck言語もDyck経路も同じものとして、用途に応じて両者を用いる。
	Dyck言語を次の命題によって再帰的に定義する流儀もある。

	\begin{proposition}[Dyck言語その二]\label{prop:Dyck言語その二} %{
		$\Dyck_*$を集合$\mybf{2}=\set{a,b}$から生成されたDyck言語とする。
		任意の$w\in\Dyck_+$に対して次の式を満たす$w_1,w_2\in\Dyck_*$
		が唯一つ定まる。
		\begin{equation*}\begin{split}
			w = (aw_1)(bw_2)
		\end{split}\end{equation*}
	\end{proposition} %prop:Dyck言語その二}
	\begin{proof} Dyck経路を用いて証明する。
	$n\ge 1$として、$(n,n)$へのDyck経路全体のつくる集合を$\Gamma_n$とする。
	経路$\gamma\in\Gamma_n$が通る対角線上の頂点の集合を$\myop{diag}\gamma$
	と書く。$(0,0)$と$(n,n)$は常に$\myop{diag}\gamma$に含まれ、
	$1\le n$なので、$2\le|\myop{diag}\gamma|$となる。
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[存在] $\myop{diag}\gamma$の中で、$(0,0)$の次に小さな頂点を
		$(p,p)$とする。$\gamma$は次のようなDyck経路となる。
		\begin{equation*}\xymatrix@R=1em@C=1em{
			 & & & (n,n) \\
			 & & (p,p) \ar@{>>}[ru]^{\gamma_2} \\
			 & & (p,p-1) \ar[u] \\
			(0,0) \ar@{.}[rruu] \ar[r] & (1,0) \ar@{>>}[ru]^{\gamma_1} \\
		}\end{equation*}
		$\gamma$を命題の$w\in\Dyck$に対応させると、$\gamma_1$と$\gamma_2$は
		それぞれ、命題の$w_1$と$w_2$に対応する。
		%
		\item[一意性] $\myop{diag}\gamma$の中で、$(p,p)$の次に小さな頂点
		$(q,q)$が存在したとする。すると、$\gamma$は次のようなDyck経路となる。
		\begin{equation*}\xymatrix@R=1em@C=1em{
			 & & & & & (n, n) \\
			 & & & & (q, q) \ar@{>>}[ru]^{\eta_2} \\
			 & & & & (q, q - 1) \ar[u] \\
			 & & (p,p) \ar[r] \ar@{.}[rruu] & (p + 1,p) \ar@{>>}[ru]^{\eta_1} \\
			 & & (p,p-1) \ar[u] \\
			(0,0) \ar@{.}[rruu] \ar[r] & (1,0) \ar@{>>}[ru]^{\gamma_1} \\
		}\end{equation*}
		この図で、経路$(1,0)(q,q-1)$は始点と終点が対角的な関係になっているが、
		部分経路$(p,p-1)(p,p)(p+1,p)$で対角線の上にはみ出てしまっているので、
		$(1,0)(q,q-1)$はDyck経路とはならない。
	\end{description} %}
	\end{proof}

	この命題によって、Dyck言語の大きさに関する次の命題が導かれる。

	\begin{proposition}[Dyck言語の大きさ]\label{prop:Dyck言語の大きさ} %{
		$\Dyck_*$をDyck言語とする。任意の$n\in\sizen$に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			|\Dyck_{n+1}| = \sum_{p\in0..n}|\Dyck_p||\Dyck_{n-p}|
		\end{split}\end{equation*}
	\end{proposition} %prop:Dyck言語の大きさ}
	\begin{proof} $\mybf{2}=\set{a,b}$として、
	命題\ref{prop:Dyck言語その二}から、任意の$n\in\sizen$に対して、次の写像
	$\phi:\sum_{p\in0..n}\Dyck_p\times\Dyck_{n-p}\to\Dyck_{n+1}$が
	集合同型となる。
	\begin{equation*}\begin{split}
		\phi(w_1,w_2) = (aw_1)(bw_2) \quad\text{for all } (w_1,w_2)\in
		\sum_{p\in0..n}\Dyck_p\times\Dyck_{n-p}
	\end{split}\end{equation*}
	\end{proof}

	Dyck経路の数は既知で次のようにCataran数で表される。
	\begin{equation*}\begin{split}
		|\Dyck_n| = \frac{1}{n+1}\binom{2n}{n}
		\quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	この式はDyck経路の数についての漸化式\ref{prop:Dyck言語の大きさ}を
	用いて次のようにして導くことができる。

	変数$z$についての形式級数$d_z$を次のように定義する。
	\begin{equation*}\begin{split}
		d_z := \sum_{n\in\sizen}|\Dyck_n|z^n
	\end{split}\end{equation*}
	すると、漸化式\ref{prop:Dyck言語の大きさ}より次の式が成り立つ。
	\begin{equation*}\begin{split}
		d_z^2 &= \sum_{p,q\in\sizen} |\Dyck_p||\Dyck_q|z^{p+q}
		= \sum_{n\in\sizen}\sum_{p=0}^n |\Dyck_p||\Dyck_{n-p}|z^n
		= \sum_{n\in\sizen} |\Dyck_{n+1}|z^n \\
		&= \frac{d_z - |\Dyck_0|}{z} = \frac{d_z - 1}{z}
	\end{split}\end{equation*}
	したがって、変数$z$についての形式級数$D_z$を次のように定義すると、
	\begin{equation*}\begin{split}
		D_z := \sum_{n\in\sizen}|\Dyck_n|z^{n+1}
	\end{split}\end{equation*}
	$D_z^2 = D_z - z$が成り立ち、この$D_z$に関する二次式を解くと、
	次の二つの解が得られる。
	\begin{equation*}\begin{split}
		D_z = \frac{1\pm\sqrt{1 - 4z}}{2}
	\end{split}\end{equation*}
	この解に$D_0=0$という条件を課すと、次の解が得られ、
	\begin{equation*}\begin{split}
		D_z = \frac{1-\sqrt{1 - 4z}}{2}
	\end{split}\end{equation*}
	Dyck経路の数を次のように解析的に表すことができる。
	\begin{equation*}\begin{split}
		|\Dyck_n| = \frac{1}{2\pi i}\oint_{0}\frac{dz}{z^{n+2}} D_z
	\end{split}\end{equation*}
	根号$\sqrt{1-4z}$を$z=0$の周りで展開してみる。
	一般に、任意の$\nu\in\fukuso,\;k\in\sizen$に対して、$\cbinom{\nu}{k}$を
	次の式で定義すると、
	\begin{equation*}\begin{split}
		(1 + x)^\nu = \sum_{k\in\sizen}\cbinom{\nu}{k} x^k
	\end{split}\end{equation*}
	$\cbinom{\nu}{k}$は次のようになる。
	\begin{equation*}\begin{split}
		\cbinom{\nu}{0} = 1,\quad
		\cbinom{\nu}{k} = \frac{\nu}{k}\frac{\nu-1}{k-1}
			\cdots\frac{\nu-(k-1)}{1}
		= \frac{\Gamma_{\nu+1}}{\Gamma_{k+1}\Gamma_{\nu-k+1}}
		\quad\text{for all } k\in\sizen_+
	\end{split}\end{equation*}
	$\nu\in\sizen$の時$\cbinom{\nu}{k}$は通常の二項係数となる。
	$\cbinom{\nu}{k}$を使うと、$\sqrt{1-4z}$は次のように書ける。
	\begin{equation*}\begin{split}
		\sqrt{1-4z} = \sum_{k\in\sizen} \cbinom{\frac{1}{2}}{k} (-4z)^k
	\end{split}\end{equation*}
	ここで、任意の$k\in\sizen_+$に対して次の式が成り立つから、
	\begin{equation*}\begin{split}
		\cbinom{\frac{1}{2}}{k}
		&= \frac{\frac{1}{2}}{k}\frac{\frac{1}{2}-1}{k-1}
			\cdots\frac{\frac{1}{2}-(k-1)}{1}
		= -\left(-\frac{1}{2}\right)^k\frac{1\cdot3\cdots(2k-3)}{k!} \\
		&= -2\left(-\frac{1}{4}\right)^k \frac{(2k-2)!}{k!(k-1)!} \\
		\implies & \sqrt{1-4z} = 1 - 2\sum_{n\in\sizen_+}
			\frac{(2k-2)!}{k!(k-1)!} z^k \\
	\end{split}\end{equation*}
	$D_z$は次のようになることがわかる。
	\begin{equation*}\begin{split}
		D_z = \sum_{n\in\sizen_+} \frac{(2k-2)!}{k!(k-1)!} z^k
		= \sum_{n\in\sizen} \frac{1}{k+1} \binom{2k}{k} z^{k+1}
	\end{split}\end{equation*}
	この式より、$D_z=\sum_{k\in\sizen}|\Dyck_k|z^{k+1}$だから、
	$|\Dyck_k|=\frac{1}{k+1}\binom{2k}{k}$となることがわかる。

	$|\Dyck_k|=\frac{1}{k+1}\binom{2k}{k}$という式の形から、次のことが
	予想される。

	\begin{observation}[Dyck経路の数と単調経路の数]
	\label{obs:Dyck経路の数と単調経路の数} %{
		二項係数$\binom{2n}{n}$は$(0,0)$から$(n,n)$への単調経路の数に
		なっている。したがって、Dyck経路全体のつくる集合を何らかの方法で
		$n+1$回コピーすれば、単調経路全体のつくる集合が得られると予想される。
	\end{observation} %obs:Dyck経路の数と単調経路の数}

	この予想について考えてみる。まず、単調経路から生成される単語に対して
	使う記号を定義しておく。

	\begin{definition}[単調経路から生成される単語]
	\label{def:単調経路から生成される単語} %{
		文字$a$を$m$個、文字$b$を$n$個含む単語全体のつくる集合を$\Path_{m,n}$
		と書く。$a$と$b$を$m$個ずつ含む単語全体のつくる集合を
		$\Cyck_m:=\Path_{m,m}$と書く。
	\end{definition} %def:単調経路から生成される単語}

	$(0,0)$から$(m,n)$への単調経路はすべて$m+n$個の辺を持つ。そして、
	$m+n$個の辺の中から水平な辺を$m$個選ぶと経路が唯一つ定まる。
	したがって、単調経路の数は次の式で与えられる。
	\begin{equation*}\begin{split}
		|\Path_{m,n}| = \binom{m+n}{n} \quad\text{for all } m,n\in\sizen
	\end{split}\end{equation*}
	単調経路全体の中でDyck経路を特徴付けるパラメータを定義する。

	\begin{definition}[超過数（exceedance）]\label{def:超過数} %{
		単調経路$\gamma$で対角線より上にある上向きの辺の数を$\gamma$の超過数
		という。
	\end{definition} %def:超過数}

	次の図は、$(0,0)$から$(5,5)$への単調経路で、超過数に勘定する辺を二重線
	で示している。
	\begin{equation}\label{eq:超過数の例}\xymatrix@R=1em@C=1em{
		& & & & (4,5) \ar[r] & (5,5) \\
		& & & & (4,4) \ar@{=>}[u] \\
		& (1,3) \ar[r] & (2,3) \ar[r] & (3,3) \ar[r] & (4,3) \ar[u] \\
		& (1,2) \ar@{=>}[u] \\
		& (1,1) \ar@{=>}[u] \\
		(0,0) \ar[r] \ar@{.}[rrrrruuuuu] & (1,0) \ar[u] \\
	}\end{equation}
	Dyck経路の超過数は$0$となる。

	超過数が$0$に向かって変化するような経路の変形を考える。
	単調経路に対して次のような経路の変形$\phi$をすると、超過数が一つ減る。
	\begin{equation}\label{eq:Dyck経路への変形}\begin{split}
		\phi: \xymatrix@R=1em@C=1em{
			& & \ar@{-}[r] & \\
			\ar@{-}[r] & \ar[r]^\delta & \ar@{-}[r] \ar@{-}[u]_{}^{}="l" 
				& \ar@{-}[u]_{}^{}="r" \ar@{}"l";"r"|{\gamma_2} \\
			\\
			\ar@{-}[r] \ar@{-}[uu]_{}^{}="L" \ar@{.}[rrruuu] 
				& \ar@{-}[uu]_{}^{}="R" \ar@{}"L";"R"|{\gamma_1} \\
		} \quad\mapsto\quad \xymatrix@R=1em@C=1em{
			& & \ar@{-}[r] & \\
			\\
			\ar@{-}[r] & \ar[r]^\delta & \ar@{-}[r]\ar@{-}[uu]^{}_{}="L" 
				& \ar@{-}[uu]^{}_{}="R" \ar@{}"L";"R"|{\gamma_1} \\
			\ar@{-}[r] \ar@{-}[u]_{}^{}="l" \ar@{.}[rrruuu] 
				& \ar@{-}[u]_{}^{}="r" \ar@{}"l";"r"|{\gamma_2} \\
		}
	\end{split}\end{equation}
	この変形を繰り返すと、最終的に超過数が$0$になってDyck経路となる。
	Dyck経路には辺$\delta$が存在しないので、それ以上の変形はできない。
	ここで、辺$\delta$は最も左にある辺をとることにする。
	$\phi$と$\phi^{-1}$は辺$\delta$を次のようにして見つけて、
	その左右の経路を入れ替える操作となる。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $\phi$での$\delta$は、$\xymatrix@R=1em@C=1em{
			\ar@{-}[r] & \ar[r]^\delta & \\
			\\
			(0,0) \ar@{-}[r] \ar@{-}[uu]_{}^{}="L" \ar@{.}[rruu] 
				& \ar@{-}[uu]_{}^{}="R" \ar@{}"L";"R"|{\gamma_1} \\
		}$となる最小の$\gamma_1$によって定まる。
		\item $\phi^{-1}$での$\delta$は、$\xymatrix@R=1em@C=1em{
			& & \ar@{-}[r] & (n,n) \\
			\\
			& \ar[r]^\delta \ar@{.}[rruu]
				& \ar@{-}[r]\ar@{-}[uu]^{}_{}="L"
				& \ar@{-}[uu]^{}_{}="R" \ar@{}"L";"R"|{\gamma_1} \\
		}$となる最小の$\gamma_1$によって定まる。
	\end{itemize} %}

	経路\eqref{eq:超過数の例}の場合には、
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $\gamma_1$は経路$(0,0)\twoheadrightarrow(2,3)$、
		\item $\gamma_2$は経路$(3,3)\twoheadrightarrow(5,5)$、
		\item $\delta$は経路$(2,3)\to(3,3)$
	\end{itemize} %}
	となっている。経路\eqref{eq:超過数の例}を変形すると次のようになる。
	\begin{equation*}\begin{split}
		& \xymatrix@R=1ex@C=1em{
			& & & & (4,5) \ar[r] & (5,5) \\
			\\
			& (1,3) \ar[r] & (2,3) \ar[r] & (3,3) \ar[r] & (4,3) \ar@{>>}[uu] \\
			\\
			\\
			(0,0) \ar[r] \ar@{.}[rrrrruuuuu] & (1,0) \ar@{>>}[uuu] \\
		} \\
		\xmapsto{\phi} & \xymatrix@R=1ex@C=1em{
			& & & & (1,3) \ar[r] \ar[r] & (2,3) \\
			\\
			\\
			& (4,5) \ar[r] & (5,5) \ar[r] & (0,0) \ar[r] & (1,0) \ar@{>>}[uuu] \\
			\\
			(3,3) \ar[r] \ar@{.}[rrrrruuuuu] & (4,3) \ar@{>>}[uu] \\
		} \\
		\xmapsto{\phi} & \xymatrix@R=1ex@C=1em{
			& & & & & (4,5) \\
			\\
			& & (1,3) \ar[r] & (2,3) \ar[r] & (3,3) \ar[r] & (4,3) \ar@{>>}[uu] \\
			\\
			\\
			(5,5) \ar[r] \ar@{.}[rrrrruuuuu] & (0,0) \ar[r] & (1,0) \ar@{>>}[uuu] \\
		} \\
		\xmapsto{\phi} & \xymatrix@R=1ex@C=1em{
			& & & & & (1,3) \\
			\\
			\\
			& & (4,5) \ar[r] & (5,5) \ar[r] & (0,0) \ar[r] & (1,0) \ar@{>>}[uuu] \\
			\\
			(2,3) \ar[r] \ar@{.}[rrrrruuuuu] & (3,3) \ar[r] & (4,3) \ar@{>>}[uu] \\
		}
	\end{split}\end{equation*}
	$\Cyck_{n,k}$を超過数$k$の単調な路全体のつくる集合とすると、
	$\Cyck_n$は次のように分類される。
	\begin{equation*}\begin{split}
		\Cyck_n = \sum_{k\in0..n}\Cyck_{n,k} \quad\text{for all } n\in\sizen
	\end{split}\end{equation*}
	変形\eqref{eq:Dyck経路への変形}は、任意の$l=0..(n-1)$に対して、
	集合同型$\Cyck_{n,l+1}\simeq\Cyck_{n,l}$を与える。したがって、
	Dyck経路の数は$|\Dyck_n|=|\Cyck_n|/(n+1)$となることがわかる。
	予想\ref{obs:Dyck経路の数と単調経路の数}に対する回答の一つが得られた
	ことになる。

	単調経路の変形$\phi^{-1}$を$a,b$を文字とするDyck単語の変形としてみると
	次のようになっている。
	\begin{equation*}\begin{split}
		w_1aw_2b \xmapsto{\phi^{-1}} w_2baw_1
		\quad\text{for all } w_1,w_2\in\Dyck_*
	\end{split}\end{equation*}
	この式の中の文字$a$が経路の変形\eqref{eq:Dyck経路への変形}の辺$\delta$
	に相当する。

\subsubsection{試打}\label{s3:試打} %{
	$a$と$b$を文字とする単調な単語で、$a^mb^m=\alpha_m$、$b^ma^m=\beta_m$
	とすると、$a^2b^2a^3b^3=\alpha_2\alpha_3$となる。$\alpha_2\alpha_3$から
	単調経路の変形$\phi^{-1}$を適用していくと次のようになる。
	\begin{equation*}\begin{split}
		\alpha_2\alpha_3 \xmapsto{\phi^{-1}} \alpha_2\beta_1\alpha_2
		\xmapsto{\phi^{-1}} \alpha_1\beta_1\alpha_2\beta_1
		\xmapsto{\phi^{-1}} \alpha_1\beta_2\alpha_1\beta_1
		\xmapsto{\phi^{-1}} \beta_2\alpha_1\beta_2
		\xmapsto{\phi^{-1}} \beta_3\beta_2
	\end{split}\end{equation*}
	この単語の系列は
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item $\alpha_*$と$\beta_*$からなる文字列を反転して、
		\item $\alpha_*$と$\beta_*$の文字を入れ替える
	\end{itemize} %}
	と同一の単語の系列となる。
%s3:試打}
%s1:Dyck言語}

\section{可換環}\label{s1:可換環} %{
	この節を通して、$R=(R,+,0,\myspace,1)$を可換環とする。

	\begin{definition}[可換環のイデアル]\label{def:可換環のイデアル} %{
		部分環$A\subseteq R$が次の性質を満たすとき、$A$を$R$のイデアルという。
		\begin{equation*}\begin{split}
			ra\in A \quad\text{for all } a\in A,\; r\in R
			\quad\bigl(\iff RA\subseteq A \bigr)
		\end{split}\end{equation*}
	\end{definition} %def:可換環のイデアル}

	\begin{definition}[単項イデアル]\label{def:単項イデアル} %{
		任意の$r\in R$に対して$R$の部分集合$rR:=\set{rs\in R\bou s\in R}$は
		はイデアルとなる。
		このイデアル$rR$を$r$から生成された単項イデアルという。
	\end{definition} %def:単項イデアル}

	\begin{definition}[部分集合から生成されたイデアル]
	\label{def:部分集合から生成されたイデアル} %{
		任意の空でない部分集合$S\subseteq R$に対して$R$の部分集合
		$SR:=\set{sr\in R\bou s\in S,\; r\in R}$はイデアルとなる。
		このイデアル$SR$を$S$から生成されたイデアルという。
	\end{definition} %def:部分集合から生成されたイデアル}

	自明なイデアルといった場合は、自明な環や自明な群などとは'自明'の意味する
	ものが異なることに注意する。

	\begin{definition}[自明なイデアル]\label{def:自明なイデアル} %{
		加法の単位元のみからなるイデアル$\set{0}$と$R$自身を自明なイデアル
		という。
	\end{definition} %def:自明なイデアル}

	\begin{proposition}[体とイデアル]\label{prop:体とイデアル} %{
		$R$が体になる必要十分条件は、$R$のイデアルが自明なイデアルのみになること
		である。
	\end{proposition} %prop:体とイデアル}
	\begin{proof} 
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[必要] 体$F$のイデアルが自明なイデアルに限ることを示せばよい。
		$A$を$F=(F,+,0,\myspace,1)$のイデアルとする。
		$S$が$0$以外の元を含むとすると、イデアルの定義より、
		任意の$a\neq 0\in A$に対して$a^{-1}a=1\in A$となり、$1\in A$となる。
		したがって、イデアルの定義より、任意の$f\in F$に対して$f=f1\in A$
		となり、$A=F$となることが示される。
		%
		\item[十分] 環$R$のイデアルが$\set{0}$と$R$のみだとする。
		仮定から、任意の$r\neq0\in R$に対して単項イデアル$rR$は$rR=R$となる。
		したがって、$rR=R$から$1\in R$となり、$rs=1$となる$s\in R$が存在する
		ことがわかる。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $r\neq 1$の場合は、$rR=R$だから$rs=1$となる$s\in R$が存在する
			ことがわかる。
			\item $r=1$の場合は、$rr=1$となる。
		\end{itemize} %}
		よって、任意の$r\neq0\in R$に対して乗法の逆元が存在することがわかる。
	\end{description} %}
	\end{proof}
%s1:可換環}
\section{加群}\label{s1:加群} %{
	この節を通して、$R=(R,+,0,\myspace,1)$を可換環、$\Mod[R]$を小さな
	$R$-加群の圏とする。任意の対象$A,B\in\Mod[R]$に対して、$A$から$B$への
	$R$-準同型全体を$\Hom_R(A,B)$と書き、混乱の恐ればないときは、
	$A$から$B$への$R$-準同型$f$を単に射$f:A\to B$とか$A\xto{f}B\in\Mod[R]$
	と書く。

	任意の対象$A,B\in\Mod[R]$に対して$\Hom_R(A,B)$は次の畳み込みにより
	$R$-加群となる。
	\begin{equation*}\begin{array}{rcll}
		(f + g)a &:=&  (fa) + (ga)
			& \quad\text{for all } f,g\in\Hom_R(A,B),\; a\in A \\
		(rf)a &:=& rfa
			& \quad\text{for all } f\in\Hom_R(A,B),\; r\in R,\; a\in A \\
	\end{array}\end{equation*}
	また、$0$への恒等射を$0:a\mapsto 0\text{ for all }a\in A$と書くと、
	$0$は加法$+$の単位元となる。この畳み込みによる$\Hom_R(A,B)$の$R$-加群
	は、断りなしに使うことにする。

	\begin{note}[加群と表現]\label{note:加群と表現} %{
		$\Mod[R]$での射は$R$-線形写像となる。
		\begin{equation*}\begin{split}
			fr = rf \quad\text{for all arrows } f\in\Mod[R],\; r\in R
		\end{split}\end{equation*}
		係数環$R$を複素数上の代数$V$とすると、$\Mod[V]$の対象は$V$の表現空間、
		射はintertwinerとなる。Schurの補題から、既約表現の間のintertwinerは、
		互いに$\fukuso$-同型となる既約表現の間に限られる。
		圏$\Mod[V]$の様子を絵にすると次のようになる。
		\begin{equation*}\xymatrix{
			\text{可約表現} \ar[d] \ar[dr] \ar@<1ex>[rr] 
			&& \text{可約表現} \ar[d] \ar[dl] \ar[ll] \\
			\text{既約表現} \ar@<1ex>[u]
			& \text{既約表現} \ar@<1ex>[ul] \ar@<1ex>[ur]
			& \text{既約表現} \ar@<1ex>[u]
		}\end{equation*}
	\end{note} %note:加群と表現}

\subsection{加群の生成系}\label{s2:加群の生成系} %{
	まず、加群の自由直積を定義してから、加群の生成系と基底系を順に定義する。

	\begin{definition}[自由加群その一]\label{def:自由加群その一} %{
		$X$を空でない集合、$X$から$R$への写像全体の集合$\mybf{Set}(X,R)$の
		部分集合$\coprod_XR$を次のように定義する。
		\begin{equation*}\begin{split}
			\coprod_XR := \set{f:X\to R
			\bou fx\neq 0 \text{ only finitely many }x\in X}
		\end{split}\end{equation*}
		$\coprod_XR$に加法$+$と係数の作用$\myspace$を次のように定義する。
		\begin{equation*}\begin{array}{lrcll}
			\text{加法} & (f + g)x &:=& (fx) + (gx)
			& \quad\text{for all }f,g\in\coprod_XR,\; x\in X \\
			\text{係数} & (rf)x &:=& r(fx)
			& \quad\text{for all }f\in\coprod_XR,\; r\in R,\; x\in X \\
		\end{array}\end{equation*}
		すると、次の事が成り立つことがわかる。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $0\in R$への恒等写像$0\in\coprod_XR$が加法の単位元となる。
			\begin{equation*}\begin{split}
				f + 0 = f = 0 + f & \quad\text{for all } f\in\coprod_XR \\
				rf = 0 & \quad\text{for all } f\in\coprod_XR,\; r\in R
			\end{split}\end{equation*}
			\item 分配則が成り立つ
			\begin{equation*}\begin{split}
				r(f + g) = rf + rg \quad\text{for all } f,g\in \coprod_XR,\; r\in R
			\end{split}\end{equation*}
		\end{itemize} %}
		したがって、$(\prod_XR,\myspace,+,0)$は$R$-加群となる。
		$(\prod_XR,\myspace,+,0)$を$X$から生成された自由$R$-加群といい、
		$RX^\tran$と書く。
	\end{definition} %def:自由加群その一}

	\begin{definition}[自由加群その二]\label{def:自由加群その二} %{
		$A$を$R$-加群とする。$A$がある空でない集合$X$から生成された自由$R$-加群
		と$R$-加群同型になることき、$A$を自由$R$-加群という。
	\end{definition} %def:自由加群その二}

	$X$を集合とし、$x\in X$の双対元$x^\tran\in RX^\tran$を次のように
	定義すると、
	\begin{equation*}\begin{split}
		x^\tran y = \jump{x=y} \quad\text{for all } y\in X
	\end{split}\end{equation*}
	任意の写像$f:X\to R$は双対元の線形結合で書くことができる。
	\begin{equation*}\begin{split}
		f = \sum_{x\in X}(fx)x^\tran
	\end{split}\end{equation*}
	また、写像$-^\tran\in\mybf{Set}(X,RX^\tran)$を次のように定義すると、
	\begin{equation}\label{eq:転置の定義その一}\begin{split}
		(-^\tran)x = x^\tran \quad\text{for all } x\in X
	\end{split}\end{equation}
	$-^\tran$は$1:1$になる。また、$\vec{-}:\mybf{Set}(X,\Hom_R(RX^\tran,R))$
	を次のように定義すると、
	\begin{equation}\label{eq:転置の定義その二}\begin{split}
		\vec{x}f := fx \quad\text{for all } f\in RX^\tran,\; x\in X 
	\end{split}\end{equation}
	次の式が成り立つ。
	\begin{equation}\label{eq:自由加群の恒等射}\begin{split}
		\sum_{x\in X} (\vec{x}-)x^\tran = \id_{RX^\tran}
	\end{split}\end{equation}

	\begin{definition}[転置]\label{def:転置} %{
		$X$を集合とする。式\eqref{eq:転置の定義その一}で定義された写像
		$-^\tran:X\to RX^\tran$を転置ということにする。
		また、誤解の恐れがないときは、式\eqref{eq:転置の定義その二}で
		定義された写像$\vec{-}:X\to\Hom_R(RX^\tran,R)$を用いて、
		次の$R$-加群準同型$-^\tran:RX^\tran\tofrom\Hom_R(RX^\tran,R)$
		にも同じ記号を用いる。
		\begin{equation*}\begin{split}
			x \xto{-^\tran} x^\tran \udset{-^\tran}{-^\tran}{\tofrom} \vec{x}
			\quad\text{for all } x\in X
		\end{split}\end{equation*}
	\end{definition} %def:転置}

	\begin{proposition}[自由加群の普遍性]\label{prop:自由加群の普遍性} %{
		$X$を空でない集合、$A$を加群とすると、任意の写像$f:X\to A$に対して
		次の図を可換にする$R$-加群準同型$f_*:RX^\tran\to A$が唯一つ定まる。
		\begin{equation*}\xymatrix{
			X \ar[r]^{-^\tran} \ar[rd]_f & RX^\tran \ar@{.>}[d]^{f_*} \\
			& A
		}\end{equation*}
	\end{proposition} %prop:自由加群の普遍性}
	\begin{proof} 
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[存在] 写像$f_*\in\mybf{Set}(X^\tran,A)$を次のように定義する。
		\begin{equation*}\begin{split}
			f_*x^\tran := fx \quad\text{for all } x\in X
		\end{split}\end{equation*}
		$f_*$を$R$-線形に拡張して、$f_*\in\Hom_R(RX^\tran,A)$とすると、
		次のようになる。
		\begin{equation*}\begin{split}
			f_*g = \sum_{x\in X}(fx)(\vec{x}g) \quad\text{for all } g\in RX^\tran
		\end{split}\end{equation*}
		$f_*(-^\tran)=f$となるから、命題の$f_*$が存在することがわかる。
		\item[唯一] 写像$-^\tran:X\to RX^\tran$が$1:1$だから、
		任意の$f_*,g_*\in\Hom_R(RX^\tran,A)$に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			g_*(-^\tran) = f = f_*(-^\tran)
			\implies (f_* - g_*)(-^\tran) = 0
			\implies f_* = g_*
		\end{split}\end{equation*}
		したがって、命題の$f_*$が存在するならば唯一つであることがわかる。
	\end{description} %}
	\end{proof}

	\begin{definition}[加群の生成系]\label{def:加群の生成系} %{
		$A$を$R$-加群、$E$を$A$の空でない部分集合とする。
		$E$の有限の$R$-線形結合で張られる$A$の部分集合を$RE$と書く。
		\begin{equation*}\begin{split}
			RE := \set{\sum_{e\in E}r_ee\in A\bou r_e\in R \text{ and }
			r_e\neq 0 \text{ for only finitely many } e\in E}
		\end{split}\end{equation*}
		$RE=E$となるとき、$E$を$A$の生成系という。
	\end{definition} %def:加群の生成系}

	生成系に一意性の条件を課したものが基底系となる。

	\begin{definition}[加群での線形独立]\label{def:加群での線形独立} %{
		$A$を$R$-加群とする。$A$の空でない部分集合$E$が次の条件を満たすとき、
		$E$を$R$-線形独立な部分集合という。
		\begin{equation*}\begin{split}
			\sum_{e\in E}(fe)e = 0 \implies f = 0
			\quad\text{for all } f\in RE^\tran
		\end{split}\end{equation*}
	\end{definition} %def:加群での線形独立}

	\begin{definition}[加群の基底系]\label{def:加群の基底系} %{
		$A$を$R$-加群、$E$を$A$の生成系とする。$E$が$R$-線形独立なとき、
		$E$を$A$の基底系という。
	\end{definition} %def:加群の基底系}

	\begin{proposition}[基底系による一意的な表現]
	\label{prop:基底系による一意的な表現} %{
		$A$を$R$-加群、$E$を$A$の基底系とする。
		任意の$A$の元は$E$の元の線形結合で一意に書くことができる。
	\end{proposition} %prop:基底系による一意的な表現}
	\begin{proof} 次の式が成り立つ。
		\begin{equation*}\begin{split}
			\sum_{e\in E}(fe)e = \sum_{e\in E}(ge)e
			\implies \bigl((fe) - (ge)\bigr)e = 0 \implies f = g \\
			\quad\text{for all } f,g\in RE^\tran
		\end{split}\end{equation*}
	\end{proof}

	自由加群と基底系を持つことは同じことになる。

	\begin{proposition}[自由加群と基底系]\label{prop:自由加群と基底系} %{
		$A$を$R$-加群とする。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $A$が自由加群であることと、
			\item $A$が基底系を持つこと
		\end{itemize} %}
		は同値である。
	\end{proposition} %prop:自由加群と基底系}
	\begin{proof} 
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[自由$\implies$基底] $F$を集合$X$から生成された自由$R$-加群とし、
		同型射$\phi:F\to A$が成り立つとする。
		次の写像で$\phi X^\tran$が$A$の基底系となることを示す。
		\begin{equation*}\begin{split}
			X\xto{-^\tran} F\xto{\;\phi\;} A
		\end{split}\end{equation*}
		\begin{description}\setlength{\itemsep}{-1mm} %{
			\item[生成系] $\phi X^\tran$が$A$の生成系となることを示す。
			$\phi$が全射だから、任意の$a\in A$に対してある$f\in F$が存在して、
			$a=\phi f$とすることができる。すると、式\eqref{eq:自由加群の恒等射}
			より、次の式が成り立つことがわかる。
			\begin{equation*}\begin{split}
				a = \phi f = \phi \sum_{x\in X} (fx)x^\tran
				= \sum_{x\in X} (fx)(\phi x^\tran)
			\end{split}\end{equation*}
			したがって、$\phi X^\tran$が$A$の生成系となることがわかる。
			%
			\item[基底系] $\phi X^\tran$が$R$-線形独立となることを示す。
			$\phi$と$-^\tran$が単射だから、任意の$f\in RX^\tran$に対して
			次の式が成り立つ。
			\begin{equation*}\begin{array}{rcll}
				\sum_{x\in X} (fx)(\phi x^\tran) = 0
				&\implies& \phi\sum_{x\in X} (fx)x^\tran = 0
					& \quad\because\;\text{$\phi$ is morphism} \\
				&\implies& \sum_{x\in X} (fx)x^\tran = 0
					& \quad\because\;\text{$\phi$ is $1:1$} \\
				&\implies& f = 0
					& \quad\because\;\text{$-^\tran$ is $1:1$} \\
			\end{array}\end{equation*}
			したがって、$\phi X^\tran$が$R$-線形独立になることがわかる。
		\end{description} %}
		%
		\item[基底$\implies$自由] $X$を$A$の基底系とする。
		$R$-加群準同型$\phi:RX^\tran\to A$を次のように定義する。
		\begin{equation*}\begin{split}
			\phi f = \sum_{x\in X} (fx)x
		\end{split}\end{equation*}
		$X$が$A$の生成系であることから$\phi$が$\onto$になることが示され、
		$X$が$R$-線形独立であることから$\phi$が$1:1$になることが示される。
	\end{description} %}
	\end{proof}


	\begin{example}[生成系だが基底系でない例]
	\label{eg:生成系だが基底系でない例} %{
		加群の基底系でない生成系の例を挙げる。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $\sei$-加群$\sei_2$は、生成系$E:=\set{1_2\in\sei_2}$を持つが、
			$21_2=0$だから、$E$は基底系ではない。任意の$2\le n\in\sei$に対して、
			$\sei$-加群$\sei_n$も同様である。
			%
			\item $\sei$-加群$\bun$は、生成系
			$E:=\set{1/p^n\bou p\in\text{primes},\; n\in\sizen_+}$
			を持つが、$1\cdot1/1=2\cdot1/2$だから、$E$は基底系ではない。
			%
			\item $\sei_6$-加群$\sei_6$は、生成系$E:=\set{4_6,3_6}$を持つが、
			\begin{equation*}\begin{split}
				1_6 = 4_6 + 3_6 \implies n_6 = n_6\cdot4_6 + n_6\cdot3_6
				\quad\text{for all } n_6\in \sei_6
			\end{split}\end{equation*}
			$3_6\cdot4_6=2_6\cdot3_6=0_6$だから、$E$は生成系ではない。
		\end{itemize} %}
	\end{example} %eg:生成系だが基底系でない例}
%s2:加群の生成系}

\subsection{加群の直和}\label{s2:加群の直和} %{
	\begin{definition}[加群の直和]\label{def:加群の直和} %{
		$A,B$を$R$-加群とする。直積$A\times B$に次のように加法$+$と係数の作用
		$\myspace$を定義したものを$A$と$B$の直和といい、$A\oplus B$と書く。
		\begin{equation*}\begin{array}{rcll}
			(a_1,b_1) + (a_2,b_2) &=& (a_1+a_2,b_1+b_2)
				& \quad\text{for all }a_1,a_2\in A,\; b_1,b_2\in B \\
			r(a,b) &=& (ra,rb)
				& \quad\text{for all }a\in A,\; b\in B,\; r\in R \\
		\end{array}\end{equation*}
	\end{definition} %def:加群の直和}
%s2:加群の直和}

\subsection{加群のテンソル積}\label{s2:加群のテンソル積} %{
	加群のテンソル積を定義して、テンソル積を使ってテンソル代数を定義する。

	\begin{definition}[双線形写像]\label{def:双線形写像} %{
		$A,B$を$R$-加群とする。次の性質を満たす写像$f:A\times B\to R$を
		$A$から$B$への$R$-双線形写像という。
		\begin{equation*}\begin{array}{rcll}
			f(a_1+a_2,b) &=& f(a_1,b) + f(a_2,b)
				& \quad\text{for all }a_1,a_2\in A,\; b\in B \\
			f(a,b_1+b_2) &=& f(a,b_1) + f(a,b_2)
				& \quad\text{for all }a\in A,\; b_1,b_2\in B \\
			f(ra,b) &=& f(a,rb)
				& \quad\text{for all }a\in A,\; b\in B,\; r\in R \\
		\end{array}\end{equation*}
	\end{definition} %def:双線形写像}

	一般の加群に対するテンソル積の定義は面倒なことになる。

	\begin{definition}[テンソル積]\label{def:テンソル積} %{
		$A,B$を$R$-加群とする。
		\begin{enumerate}\setlength{\itemsep}{-1mm} %{
			\item\label{item:テンソル積その一} 
			$\sei(A\times B)$を直積$A\times B$から生成される自由アーベル群
			（形式和）とする。
			%
			\item\label{item:テンソル積その二} 
			$\sei(A\times B)$に次の同値関係$\sim$を定義する。
			\begin{equation*}\begin{array}{rcll}
				(a_1 + a_2, b) &\sim& (a_1, b) + (a_2, b)
					& \quad\text{for all }a_1,a_2\in A,\; b\in B \\
				(a, b_1 + b_2) &\sim& (a, b_1) + (a, b_2)
					& \quad\text{for all }a\in A,\; b_1,b_2\in B \\
				(ra, b) &\sim& (a,rb)
					& \quad\text{for all }a\in A,\; b\in B,\; r\in R \\
			\end{array}\end{equation*}
			%
			\item\label{item:テンソル積その三} 
			$\sei(A\times B)$を$\sim$で割ったアーベル群を
			$A\otimes B:=\sei(A\times B)/\sim$と書く。
			%
			\item\label{item:テンソル積その四} 
			$A\otimes B$に係数の作用を次のように定義すると、$A\otimes B$は
			$R$-加群となる。
			\begin{equation*}\begin{split}
				(ra,b) = r(a,b) = (a,rb)
				\quad\text{for all }a\in A,\; b\in B,\; r\in R \\
			\end{split}\end{equation*}
		\end{enumerate} %}
		$R$-加群$A\otimes B$を$A$と$B$のテンソル積という。また、慣習で
		\ref{item:テンソル積その三}のアーベル群準同型とその像も同一の記号
		$\otimes$を用いる。
		\begin{equation*}\begin{split}
			\otimes: A\times B &\to A\otimes B \\
			(a,b) &\mapsto  a\otimes b = \bigl[i_\sei(a,b)\bigr]
		\end{split}\end{equation*}
		ここで、$i_\sei: A\times B\to\sei(A\times B)$を標準入射、$[(a,b)]$を
		$(a,b)\in A\times B$を代表元とする$A\times B/\sim$の同値類とする。
	\end{definition} %def:テンソル積}

	\begin{proposition}[テンソル積の普遍性]\label{prop:テンソル積の普遍性} %{
		$A,B,C$を$R$-加群とする。任意の$R$-双線形写像$f:A\times B\to C$に
		対して次の図を可換にする$R$-加群準同型$f_*:A\otimes B\to C$が一意に
		定まる。
		\begin{equation*}\xymatrix{
			A\times B \ar[r]^{\otimes} \ar[dr]_f & A\otimes B \ar@{.>}[d]^{f_*} \\
			& C
		}\end{equation*}
	\end{proposition} %prop:テンソル積の普遍性}
	\begin{proof} テンソル積の定義より、写像$f_*:A\otimes B\to C$を、
		任意の$\in A,\;b\in B$に対して$f_*(a\otimes b):=f(a,b)$と定義することが
		できる。すると、$f$が$R$-双線形写像だから、は$R$加群準同型となる。
		\begin{equation*}\begin{split}
			f(a_1+a_2,b) = f(a_1,b) + f(a_2,b) \\
			\implies f_*\bigl((a_1 + a_2)\otimes b\bigr)
			=  f_*(a_1\otimes b + a_2\otimes b)
			= f_*(a_1\otimes b) + f_*(a_2\otimes b) \\
			\quad\text{for all } a_1,a_2\in A,\; b\in B \\
			f(ra,b) = rf(a,b) 
			\implies f_*\bigl((ra)\otimes b\bigr) 
			= f_*\bigl(r(a\otimes b)\bigr) = rf_*(a\otimes b) \\
			\quad\text{for all } a\in A,\; b\in B,\; r\in R \\
			\text{same as for $B$}
		\end{split}\end{equation*}
		また、
		$\phi:A\otimes B\to C$を$R$-加群準同型とすると、次の式が成り立つ。
		\begin{equation*}\begin{split}
			\biggl(\phi(a\otimes b) = f(a,b)
				\quad\text{for all }a\in A,\; b\in B \biggr) \\
			\implies \biggl( f_*(a\otimes b) = f(a,b) = \phi(a\otimes b)
				\quad\text{for all }a\in A,\; b\in B \biggr) \implies f_* = \phi
		\end{split}\end{equation*}
	\end{proof}

	次の命題はテンソル積の普遍性によってテンソル積の基底系を保証する。

	\begin{proposition}[テンソル積の基底系]\label{prop:テンソル積の基底系} %{
		$A,B$を$R$-加群とする。$E_A$を$A$の生成系、$E_B$を$B$の生成系
		とすると、次の部分集合$E_{AB}\subseteq A\otimes B$は$A\otimes B$の
		生成系となる。
		\begin{equation*}\begin{split}
			E_{AB} := \set{a\otimes b\in A\otimes B \bou a\in E_A,\; b\in E_B}
		\end{split}\end{equation*}
		特に、$E_A$と$E_B$がそれぞれ$A$と$B$の基底系となるとき、
		$E_{AB}$は$A\otimes B$の基底系となる。
	\end{proposition} %prop:テンソル積の基底系}
	\begin{proof} 
	\begin{description}\setlength{\itemsep}{-1mm} %{
		\item[生成系] $A\otimes B\subseteq RE_{AB}$を示す。
		$E_A$と$E_B$がの生成系だから、任意の$f\in A$と$g\in B$に対して、
		\begin{equation*}\begin{split}
			f = \sum_{a\in E_A} (f_*a)a,\quad g = \sum_{b\in E_B} (g_*b)b
		\end{split}\end{equation*}
		となる$f_*\in RE_A^\tran$と$g_*:RE_B^\tran$が存在する。したがって、
		次の式から$f\otimes g\in RE_{AB}$となることがわかる。
		\begin{equation*}\begin{split}
			f\otimes g = \biggl(\sum_{a\in E_A} (f_*a)a\biggr)
				\otimes \biggl(\sum_{b\in E_B} (g_*b)b\biggr)
			= \sum_{a\in E_A,\;b\in E_B}(f_*a)(g_*b)(a\otimes b)
		\end{split}\end{equation*}
		%
		\item[基底系] $E_A$と$E_B$が基底系であるとき、
		$E_{AB}$が$R$-線形独立であることが示せれば命題が証明される。
		つまり、任意の$\phi\in\myop{Set}(A\times B,R)$に対して
		次の式が成り立つことが示せればよい。
		\begin{equation*}\begin{split}
			\sum_{a\in E_A,\;b\in E_B}\bigl(\phi(a,b)\bigr)(a\otimes b) = 0 
			\implies \phi = 0
		\end{split}\end{equation*}
		$E_A$と$E_B$が共に基底系だから、任意の$a\in E_A$と$b\in E_B$に対して
		$R$-双線形写像$\psi_{ab}:A\times B\to R$を次のように定義する\footnote{
			$E_A,\;E_B$が共に基底系であるから、$R$-双線形写像$\psi_{ab}$
			\eqref{eq:双線形写像の基底系}を定義できる。
			例えば、$E_A$が基底系でなければ、ある$r\neq0\in R,\;a\neq0\in E_A$で
			$ra=0$となることがあり得る。このとき、次のようになり、
			$\psi_{ab}$は$R$-双線形写像とはならない。
			\begin{equation*}\begin{split}
				\psi_{ab}(ra,b) = 0 \neq r = r\psi_{ab}(a,b)
			\end{split}\end{equation*}
		}。
		\begin{equation}\label{eq:双線形写像の基底系}\begin{split}
			\psi_{ab}(a_1,b_1) = \jump{a=a_1}\jump{b=b_1}
			\quad\text{for all } a_1\in E_A,\; b_1\in E_B
		\end{split}\end{equation}
		すると、テンソル積の普遍性\ref{prop:テンソル積の普遍性}により、
		次の式を満たす$R$-加群準同型$(a\otimes b)^\tran:A\otimes B\to R$
		が唯一つ定まり、
		\begin{equation*}\begin{split}
			(a\otimes b)^\tran(-\otimes-) = \psi_{ab}
			\quad\text{for all } a\in E_A,\; b\in E_B
		\end{split}\end{equation*}
		任意の$\phi\in\myop{Set}(A\times B, R)$と$a_0\in E_A,\; b_0\in E_B$
		に対して次の式が成り立つ。
		\begin{equation*}\begin{split}
			& \sum_{a\in E_A,\;b\in E_B}\bigl(\phi(a,b)\bigr)(a\otimes b) = 0 \\
			& \implies (a_0\otimes b_0)^\tran
			\sum_{a\in E_A,\;b\in E_B}\bigl(\phi(a,b)\bigr)(a\otimes b) = 0 \\
			& \implies \bigl(\phi(a,b)\bigr)
			\sum_{a\in E_A,\;b\in E_B}\phi_{a_0b_0}(a,b) = 0 \\
			& \implies \phi(a_0,b_0) = 0 \\
		\end{split}\end{equation*}
		したがって、命題が成り立つことがわかる。
	\end{description} %}
	\end{proof}

	この命題と命題\ref{prop:自由加群と基底系}を使うと、
	任意の集合$X,Y$に対して次の可換図が成り立つことがわかる。
	\begin{equation*}\xymatrix{
		& X\times Y \ar[d]^{-^\tran} \ar[dl] \ar[dr] \\
		X \ar[d]_{-^\tran} & R(X\times Y)^\tran \ar@{<->}[d]^{\simeq}
			& Y \ar[d]^{-^\tran} \\
		RX^\tran & RX^\tran\otimes RY^\tran & RY^\tran \\
		& RX^\tran\times RY^\tran \ar[u]_\otimes \ar[ul] \ar[ur] \\
	}\end{equation*}

	直和とテンソル積は分配則を満たす。

	\begin{proposition}[直和とテンソル積の分配則]
	\label{prop:直和とテンソル積の分配則} %{
		任意の$R$-加群$A,B,C$に対して次の分配則が成り立つ。
		\begin{equation*}\begin{split}
			A\otimes(B\oplus C)\simeq(A\otimes B)\oplus(A\otimes B)
		\end{split}\end{equation*}
	\end{proposition} %prop:直和とテンソル積の分配則}
	\begin{proof} 次の射$p_A,p_B,i_A,i_B$を、
		\begin{equation}\label{eq:分配則の双積}\begin{split}
			A\otimes C \udset{p_A}{i_A}{\fromto} (A\oplus B)\otimes C
			\udset{p_B}{i_B}{\tofrom} B\otimes C \\
		\end{split}\end{equation}
		任意の$a\in A,\;b\in B,\;c\in C$に対して次のように定義する。
		\begin{equation*}\begin{array}{rclrcl}
			p_A(a\oplus b\otimes c) &=& a\otimes c
			,& p_B(a\oplus b\otimes c) &=& b\otimes c \\
			i_A(a\otimes c) &=& (a\oplus 0)\otimes c
			,& i_B(b\otimes c) &=& (0\oplus b)\otimes c \\\
		\end{array}\end{equation*}
		すると、$p_Ai_A=\id_{A\otimes C}$と$p_Bi_B=\id_{B\otimes C}$が成り立ち、
		任意の$a\in A,b\in B,c\in C$に対して次の式が成り立つから、
		\begin{equation*}\begin{split}
			(i_Ap_A + i_Bp_B)\bigl((a\oplus b)\otimes c\bigr)
			&= i_A\bigl(a\otimes c\bigr) + i_B\bigl(b\otimes c\bigr) \\
			&= \bigl((a\oplus 0)\otimes c\bigr)
				+ \bigl((0\oplus b)\otimes c\bigr) \\
			&= (a\oplus b)\otimes c \\
		\end{split}\end{equation*}
		$i_Ap_A+i_Bp_B=\id_{(A\oplus B)\otimes C}$が成り立つ。
		したがって、式\eqref{eq:分配則の双積}が双積となり、命題が成り立つこと
		がわかる。
	\end{proof}

	加群の直和とテンソル積は分配則を満たすから代数を定義することができる。

	\begin{definition}[テンソル代数]\label{def:テンソル代数} %{
		$A$を$R$-加群とする。$n\in\sizen$に対して$\T_nA$を次のように定義し、
		\begin{equation*}\begin{array}{rcll}
			\T_0A &:=& R \\
			\T_1A &:=& A \\
			\T_nA &:=& \underbrace{A\otimes A\otimes\cdots\otimes A}_{n\text{ times}}
				& \quad\text{for all } 2\le n\in\sizen \\
		\end{array}\end{equation*}
		$\T_*A\subset\oplus_{n\in\sizen} \T_nA$を次のように有限和で定義する。
		\begin{equation*}\begin{split}
			\T_*A := \Set{\sum_{n\in\sizen}t_n\in\oplus_{n\in\sizen} \T_nA
			\;\left|\; \begin{array}{l}
				t_n\in \T_n A \text{ for all } n\in \sizen \text{ and} \\
				t_n\neq 0\text{ for only finitely many } n\in \sizen
			\end{array}\right.}
		\end{split}\end{equation*}
		$\T_*A$は直和$\oplus$によって$R$-加群となり、テンソル積$\otimes$に
		よって$R$-代数となる。
		\begin{equation*}\begin{array}{lrcl}
			\text{加法} & t_1 + t_2 &:=& t_1\oplus t_2 \\
			\text{乗法} & t_1t_2 &:=& t_1\otimes t_2 \\
		\end{array}
		\quad\text{for all } t_1,t_2\in T_*A
		\end{equation*}
		この$R$-代数$\T_*A=(\T_*A,+,0,\myspace,R)$を$A$のテンソル代数という
		\footnote{
			通常は$A$のテンソル代数を$\T A$と書くが、ここでは$\T_1A$との混同を
			避けるために$\T_*A$と書く事にする。
		}。
	\end{definition} %def:テンソル代数}

	自由加群のテンソル代数はベクトル空間のテンソル代数とほぼ同じものになる。

	\begin{proposition}[自由加群のテンソル代数]
	\label{prop:自由加群のテンソル代数} %{
		$F$を自由$R$-加群とする、
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item $\T_*F$をのテンソル代数、
			\item $E$を$F$の基底系、
			\item $\W_*E$を$E$から生成された自由モノイド、
			\item $R\W_*E$を$\W_*E$から生成された自由加群
		\end{itemize} %}
		とすると、$R$-代数同型$\T_*F\simeq R\W_*F$が成り立ち、
		$\W_*F$の元が$\T_*F$の基底系となる。
	\end{proposition} %prop:自由加群のテンソル代数}
	\begin{proof} と$R\W_*F$が$R$-代数同型になることが示されれば、
		$R\W_*F$が$\W_*A$から生成された自由加群だから、命題が成り立つことが
		示される。写像$\ket{-}:\W E\to\T_*F$を次のように定義する。
		\begin{equation*}\begin{split}
			\ket{1} &= 1 \\
			\ket{e_1\cdots e_p} &= e_1\otimes\cdots\otimes e_p
			\quad\text{for all } e_1,\dots,e_p\in E
		\end{split}\end{equation*}
		すると、$\ket{-}$はモノイド準同型となることがわかる。
		\begin{equation*}\begin{split}
			\ket{w_1w_2} = \ket{w_1}\otimes\ket{w_2}
			\quad\text{for all } w_1,w_2\in\W_*E
		\end{split}\end{equation*}
		したがって、$\ket{-}$を$R$-線形に拡張すると$R$-代数準同型
		$\ket{-}:R\W_*E\to\T_*F$となる。
		\begin{equation*}\begin{array}{rcll}
			\ket{f_1 + f_2} &=& \ket{f_1} + \ket{f_2}
			&\quad\text{for all } f_1,f_2\in R\W_*E \\
			\ket{rf} &=& r\ket{f} &\quad\text{for all } f\in R\W_*E,\; r\in R
		\end{array}\end{equation*}
	\end{proof}
%s2:加群のテンソル積}

\subsection{加群の外積}\label{s2:加群の外積} %{
	加群のテンソル代数の剰余代数として外積代数を定義する。

	\begin{definition}[加群の外積代数]\label{def:加群の外積代数} %{
		$A$を$R$-加群とする。 部分集合$\dup A\subseteq A\otimes A$を
		次のように定義する。
		\begin{equation*}\begin{split}
			\dup A:=\set{a\otimes a\in A\otimes A\bou a\in A}
		\end{split}\end{equation*}
		$\dup A$から生成されたイデアル$\dup_*A:=(\dup A)\T_*A\subseteq\T_*A$
		による剰余代数を$A$の外積代数といい、$\Wedge_*A$と書く。
		\begin{equation*}\begin{split}
			\Wedge_*A := \T_*A/\dup_*A
		\end{split}\end{equation*}
	\end{definition} %def:加群の外積代数}

	自由加群の外積代数はほとんどベクトル空間の外積代数と同じものになる。

	\begin{proposition}[自由加群の外積代数]\label{prop:自由加群の外積代数} %{
		$F$を自由$R$-加群、$E=\set{e_1,\dots,e_n}$を$F$の基底系とする。
		$\Wedge F$を$F$の外積代数とすると、次の代数同型が成り立つ。
		\begin{equation*}\begin{split}
			\Wedge F\simeq R[x_1,\dots,x_n]/I
		\end{split}\end{equation*}
		ここで、$I$は部分集合
		$\set{x_ix_j\bou i,j\in1..n}\subset R[x_1,\dots,x_n]$から生成された
		イデアルとする。
	\end{proposition} %prop:自由加群の外積代数}
	\begin{proof} 
	\end{proof}

	\begin{proposition}[自由加群の外積]\label{prop:自由加群の外積} %{
		自由$R$-加群の外積空間は次のようになる。
		\begin{equation*}\begin{split}
			\Lambda_pR^m &\simeq \left\{\begin{split}
				p\le m &\implies R^{\binom{m}{p}} \\
				\text{else} &\implies 0 \\
			\end{split}\right. \quad\text{for all } p,m\in\sizen
		\end{split}\end{equation*}
	\end{proposition} %prop:自由加群の外積}
	\begin{proof} 帰納法で証明する。$m=0,1$のときは次の式より、命題が成り立つ
	ことがわかる。
	\begin{equation*}\begin{split}
		\Lambda_pR \simeq \left\{\begin{split}
			p=0,1 &\implies R \\
			\text{else} &\implies 0 \\
		\end{split}\right. \\ %\}
	\end{split}\end{equation*}
	ある$2\le m\in\sizen$かで命題が成り立つと仮定する。すると、
	$\Lambda_0R^{m+1}=R$が成り立ち、任意の$p\in0..m$に対して次の式が成り立つ。
	\begin{equation*}\begin{split}
		\Lambda_{p+1}R^{m+1} \simeq (\Lambda_{p+1}\oplus\Lambda_p)R^m
		\simeq R^{\binom{m}{p+1}}\oplus R^{\binom{m}{p}}
		\simeq R^{\binom{m}{p+1}+\binom{m}{p}}
	\end{split}\end{equation*}
	ここで、$\binom{m}{p+1}+\binom{m}{p}=\binom{m+1}{p+1}$となるから、
	$\Lambda_{p+1}R^{m+1}\simeq R^{\binom{m+1}{p+1}}$が成り立つことがわかり、
	$m+1$でも命題が成り立つことがわかる。
	\end{proof}

	この命題から、論文\cite{Grayson1978Gro}の次の式が導かれる。
	\begin{equation*}\begin{split}
		\lambda_t[R^m] := \sum_{p\in\sizen}t^p[\Lambda_pR^m] = (1 + t)^m[R] \\
		\because\; \sum_{p\in\sizen}t^p[\Lambda_pR^m]
		= \sum_{p=0}^mt^p[\Lambda_pR^m]
		= \sum_{p=0}^mt^p[R^{\binom{m}{p}}]
		= \sum_{p=0}^mt^p\binom{m}{p}[R]
	\end{split}\end{equation*}
%s2:加群の外積}
%s1:加群}
\section{自由加群の線形代数}\label{s1:自由加群の線形代数} %{
	この節を通して、$R=(R,+,0,\myspace,1)$を可換環とする。
	さらに次のような記号を使う。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 自由$R$-加群の間の射の集合を次のように書く。
		\begin{equation*}\begin{split}
			\Mat_{m,n}R := \Hom_R(R^m,R^n) ,\quad \Mat_{m}R := \Hom_R(R^m,R^m)
		\end{split}\end{equation*}
		%
		\item $\bld_k$を$k$番目の成分がでそれ以外はすべてのベクトルとする。
		\begin{equation*}\begin{split}
			\bld_k^\tran = (0,\dots,0,\underbrace{1}_{\text{$k$-th}},0,\dots)
		\end{split}\end{equation*}
		$\bld_k$は入れ物の自由$R$-加群の次元については考えないものとする。
		例えば、$\bld_2$という記号は$2$次元以上の自由$R$-加群について全て共通に
		使う。
		%
		\item 紙面の省略のために、基底系$\bld_i$のテンソル積をブラケット記法
		で書くことにする。
		\begin{equation*}\begin{array}{rcll}
			\ket{1} &=& 1 \\
			\ket{i_1\cdots i_p} &=& \bld_{i_1}\otimes\cdots\otimes \bld_{i_p} 
				& \quad\text{for all } i_1,\dots,i_p\in 1..m \\
		\end{array}\end{equation*}
		ケット同士のテンソル積は文字列の連結となる。
		\begin{equation*}\begin{split}
			\ket{i_1\cdots i_p}\otimes\ket{j_1\cdots j_q}
				= \ket{i_1\cdots i_pj_1\cdots j_q} \\
			\quad\text{for all } i_1,\dots,i_p,j_1,\dots,j_q\in 1..m \\
		\end{split}\end{equation*}
	\end{itemize} %}
\subsection{外積}\label{s2:外積} %{
	任意の$m\in\sizen$に対して$R$-加群準同型$\alpha:\T_*R^m\to\T_*R^m$
	を次のように定義する。
	\begin{equation*}\begin{array}{rcll}
		\alpha \ket{i_1\cdots i_k}
			&=& \frac{1}{k!}\sum_{\sigma\in S_k} (-)^\sigma 
			\ket{i_{\sigma1}\cdots i_{\sigma k}}
			& \quad\text{for all } i_1,\dots,i_k\in 1..m
	\end{array}\end{equation*}
	ここで、$S_k$は$k$次対称群、$(-)^\sigma$は$\sigma\in S_k$が偶置換か奇置換
	かの符号とする。$A_*R^m:=\alpha\T_*R^m$とおく。
	$R$-双線形写像$\owedge:A_*R^m\times A_*R^m\to A_*R^m$を次のように
	定義する。
	\begin{equation*}\begin{split}
		(\alpha t_1)\owedge(\alpha t_2) := \alpha(t_1\otimes t_2)
		\quad\text{for all } t_1,t_2\in \T_*R^m
	\end{split}\end{equation*}
	次の式が成り立てば、$\owedge$は結合的になり、$R$-代数準同型
	$\alpha:(\T_*R^m,\otimes,1)\to (A_*R^m,\owedge,1)$となる。
	\begin{equation}\label{eq:交代化が積になるための条件}\begin{split}
		\alpha\bigl(\alpha(t_1\otimes t_2)\otimes t_3\bigr)
		= \alpha\bigl(t_3\otimes \alpha(t_2\otimes t_3)\bigr)
		\quad\text{for all } t_1,t_2,t_3\in\T_*R^m
	\end{split}\end{equation}
	$R^m\otimes R^m\otimes T_*R^m$の場合では次のようになる。
	\begin{equation*}\begin{split}
		& \alpha\bigl((\alpha\ket{i_1i_2})\otimes\ket{i_3\cdots i_p}\bigr) \\
		& = \frac{1}{2}\alpha\bigl((\ket{i_1i_2}-\ket{i_2i_1})
			\otimes\ket{i_3\cdots i_p}\bigr) \\
		& = \frac{1}{2p!} \sum_{\sigma\in S_p} (-)^\sigma
			(\ket{i_{\sigma1}i_{\sigma2}} - \ket{i_{\sigma2}i_{\sigma1}})
			\otimes\ket{i_{\sigma3}\cdots i_{\sigma p}} \\
		& = \frac{1}{p!} \sum_{\sigma\in S_p} (-)^\sigma
			\ket{i_{\sigma1}i_{\sigma2}}
			\otimes\ket{i_{\sigma3}\cdots i_{\sigma p}} \\
		& = \alpha\ket{i_1i_2i_3\cdots i_p} \\
	\end{split}\end{equation*}
	これを一般化すると次のようになる。
	\begin{equation*}\begin{split}
		& \ket{i_1\cdots i_p}\times\ket{i_{p+1}\cdots i_{p+q}}
			\times\ket{i_{p+q+1}\cdots i_{p+q+r}} \\
		& \xmapsto{\alpha(\myhere\otimes\myhere)\times\id}
			\frac{1}{(p+q)!}\sum_{\sigma\in S_{p+q}} (-)^\sigma
			\ket{i_{\sigma1}\cdots i_{\sigma(p+q)}}
			\times\ket{i_{p+q+1}\cdots i_{p+q+r}} \\
		& \xmapsto{\alpha(\myhere\otimes\myhere)} \frac{1}{(p+q)!(p+q+r)!}
			\sum_{\substack{\sigma\in S_{p+q}\\\tau\in S_{p+q+r}}}
			(-)^{\sigma+\tau} \ket{i_{\tau\sigma1}\cdots i_{\tau\sigma(p+q)}
			i_{\tau(p+q+1)}\cdots i_{\tau(p+q+r)}} \\
		& = \frac{1}{(p+q+r)!} \sum_{\tau\in S_{p+q+r}} (-)^{\tau}
			\ket{i_{\tau1}\cdots i_{\tau(p+q)}
			i_{\tau(p+q+1)}\cdots i_{\tau(p+q+r)}} \\
		& = \alpha\ket{i_1\cdots i_{p+q+r}}
	\end{split}\end{equation*}
	$\alpha(\myhere\otimes\myhere)(\id\otimes\alpha(\myhere\otimes\myhere))$
	についても同様に計算すると、$\owedge$が結合的になるための式
	\eqref{eq:交代化が積になるための条件}が成り立つことがわかる。
	したがって、$\alpha$が$R$-代数準同型となることもわかる。
	\begin{equation*}\xymatrix{
		\T_*R^m\otimes \T_*R^m \ar[r]^{\alpha\otimes\alpha} \ar[d]^{\simeq}
			& A_*R^m\otimes A_*R^m \ar[d]^{\myhere\owedge\myhere} \\
		\T_*R^m \ar[r]^{\alpha} & A_*R^m \\
	}\end{equation*}

	任意の$1\le p\le m$に対して次の集合$E_p^m$は$A_pR^m$の基底系となる。
	\begin{equation*}\begin{split}
		E_p^m := \Set{\alpha\ket{i_1\cdots i_p}\bou i_1<\cdots<i_p\in 1..m}
	\end{split}\end{equation*}
	$R$-加群準同型$\phi:A_pR^m\to\Wedge_pR^m$を次のように定義すると、
	\begin{equation*}\begin{split}
		\phi\alpha\ket{1_1\cdots i_p} := \bld_{i_1}\wedge\cdots\wedge \bld_{i_p}
	\end{split}\end{equation*}
	$\phi$は$R$-加群同型となる。また、次の式より、$\phi$は$R$-代数同型
	$\phi:A_*R^m\simeq\Wedge_*R^m$となることもわかる。
	\begin{equation*}\begin{split}
		\phi\biggl(\bigl(\alpha\ket{i_1\cdots i_p}\bigr)
			\owedge\bigl(\alpha\ket{j_1\cdots j_q}\bigr)\biggr)
		&= \phi\alpha\ket{i_1\cdots i_pj_1\cdots j_q} \\
		&= \bigl(\phi\alpha\ket{i_1\cdots i_p}\bigr)
			\wedge\bigl(\phi\alpha\ket{j_1\cdots j_q}\bigr)
	\end{split}\end{equation*}
	よって、$(A_*R^m,\owedge,1)$と$(\Wedge_*R^m,\wedge,1)$を同一視しても
	構わない。以降、$(A_*R^m,\owedge,1)$と$(\Wedge_*R^m,\wedge,1)$を同一視して
	$R$-代数準同型$\alpha:(T_*R^m,\otimes,1)\to(\Wedge_*R^m,\wedge,1)$
	として扱い、$\Wedge_*R^m\subseteq \T_*R^m$とする。
	\begin{equation*}\begin{split}
		(\alpha t_1)\wedge (\alpha t_2) = \alpha(t_1\otimes t_2)
		\quad\text{for all } t_1,t_2\in T_*R^m
	\end{split}\end{equation*}

	$\wedge$を$\Wedge_*R^m$から$\T_*R^m$へ拡張することを考える。次の式から、
	\begin{equation*}\begin{split}
		(\alpha t)\wedge(\alpha v) = (\alpha t)\wedge v = \alpha(t\otimes v)
		\quad\text{for all } t\in T_*R^m,\; v\in R^m
		\implies \\
		\sum_{\sigma\in S_p} (-)^{\sigma}
			\ket{i_{\sigma1}\cdots i_{\sigma p}}\wedge\ket{i_{p+1}}
		= \frac{1}{p+1}\sum_{\sigma\in S_{p+1}} (-)^{\sigma}
			\ket{i_{\sigma1}\cdots i_{\sigma p}i_{\sigma(p+1)}} \\
	\end{split}\end{equation*}
	$\wedge$を次のように定義すればよいことがわかる（十分条件）。
	\begin{equation*}\begin{split}
		(p + 1) \ket{i_1\cdots i_p}\wedge\ket{i_{p+1}}
		& = \ket{i_1\cdots i_pi_{p+1}} \\
		& - \ket{i_1\cdots i_{p-1}i_{p+1}i_p} \\
		& +\cdots \\
		& + (-)^p \ket{i_{p+1}i_1\cdots i_p} \\
		& = \ket{i_1}\otimes
			\bigl(\ket{i_2\cdots i_p}\wedge\ket{i_{p+1}}\bigr)
			+ (-)^p \ket{i_{p+1}}\otimes\ket{i_1\cdots i_p} \\
	\end{split}\end{equation*}
	この式はシャッフル積を交代化したものになっている。
	$\T_*R^m$の二項演算$\Cap$を次の漸化式で定義する。
	\begin{itemize}\setlength{\itemsep}{-1mm} %{
		\item 任意の$t\in\T_*R^m$に対して
		\begin{equation*}\begin{split}
			t\Cap 1 = t = 1\Cap t
		\end{split}\end{equation*}
		\item 任意の$w_1,w_2\in\W_*\sizen_+$と$i_1,i_2\in\sizen_+$に対して
		\begin{equation*}\begin{split}
			\ket{i_1w_1}\Cap\ket{i_2w_2} 
			&= \frac{1}{|w_1| + |w_2| + 2} \bigl(x_1 - (-)^{|w_1|} x_2\bigr) \\
			x_1 &= \ket{i_1}\otimes\bigl(\ket{w_1}\Cap \ket{i_2w_2}\bigr) \\
			x_2 &= \ket{i_2}\otimes\bigl(\ket{i_1w_1}\Cap \ket{w_2}\bigr) \\
		\end{split}\end{equation*}
	\end{itemize} %}

\subsubsection{シャッフル置換（shuffle permutation）}
\label{s3:シャッフル置換} %{
	\begin{todo}[ここまで切り取り]\label{todo:ここまで切り取り} %{
	\end{todo} %todo:ここまで切り取り}
	さらに、$S^{p+q}_p(1)$

	したがって、$\shuffle$の可換性はシャッフル置換の可換性に帰着され、
	\begin{equation*}\begin{split}
		(\myhere\shuffle\myhere)
			\biggl([x_1\cdots x_p]\otimes[x_{p+1}\cdots x_{p+q}]\biggr)
		= \sum_{\sigma^{-1}\in S^{p+q}_p}
			[x_{\tau\sigma1}\cdots x_{\tau\sigma(p+q)}] \\
	\end{split}\end{equation*}
	$\shuffle$の結合性はシャッフル置換の結合性に帰着される。
	\begin{equation*}\begin{split}
		(\myhere\shuffle\myhere)(\myhere\shuffle\myhere\otimes\id)
		\biggl([x_1\cdots x_p]\otimes[x_{p+1}\cdots x_{p+q}]
			\otimes[x_{p+q+1}\cdots x_{p+q+r}]\biggr) \\
		= \sum_{\tau^{-1}\in S^{p+q+r}_{p+q},\;\sigma^{-1}\in S^{p+q}_p}
		[x_{\tau\sigma1}\cdots x_{\tau\sigma(p+q)}
			x_{\tau(p+q+1)}\cdots x_{\tau(p+q+r)}]
	\end{split}\end{equation*}
%s3:シャッフル置換}

	\begin{todo}[確かめること]\label{todo:確かめること} %{
		交代シャッフル積について確かめることを書いておく。
		\begin{itemize}\setlength{\itemsep}{-1mm} %{
			\item 自由Lie代数の双対がShuffle代数となる。
			\item 集合から生成される自由$R$-代数を定義すること。
			\begin{equation*}\xymatrix@R=1em{
				\text{自由モノイド} \W_*X \ar[r] 
					& \text{$R$-モノイド代数} R\W_*X \ar@{<->}[dd]^{\simeq} \\
				\text{集合} X \ar[u] \ar[d] \\
				\text{自由$R$-加群} RX^\tran \ar[r] 
					& \text{テンソル代数} \T_*X^\tran \\
			}\end{equation*}
			\item $\Cap$が結合的になること。
			\begin{itemize}\setlength{\itemsep}{-1mm} %{
				\item	シャッフル置換を用いて、交代シャッフル積を定義する。
				\begin{equation*}\begin{split}
					\ket{i_1\cdots i_p}\Cap\ket{i_{p+1}\cdots i_n}
					= \frac{1}{n!}\sum_{\sigma^{-1}\in S_{n:p}} (-)^{\sigma}
					\ket{i_{\sigma1}\cdots i_{\sigma n}}
				\end{split}\end{equation*}
			\end{itemize} %}
			%
			\item 交代シャッフル積を用いて外積が定義できること。
			\begin{equation*}\begin{split}
				(\alpha\ket{w_1})\Cap(\alpha\ket{w_2}) = \alpha\ket{w_1w_2}
			\end{split}\end{equation*}
		\end{itemize} %}
	\end{todo} %todo:確かめること}

////////////////////
	\begin{equation*}\begin{split}
		v_1\owedge v_2 = \alpha(v_1\otimes v_2)
			\implies v_1\owedge v_2
			= \frac{1}{2}(v_1\otimes v_2 - v_2\otimes v_1) \\
		v_1\owedge v_2\owedge v_3 = \alpha(v_1\otimes v_2\otimes v_3) \\
		\implies \sum_{\sigma\in S_2} (-)^\sigma
			(v_{\sigma1}\otimes v_{\sigma2})\owedge v_3
			= \frac{1}{3}\sum_{\sigma\in S_3} (-)^\sigma 
			v_{\sigma1}\otimes v_{\sigma2}\otimes v_{\sigma3} \\
	\end{split}\end{equation*}

	\begin{todo}[ここまで]\label{todo:ここまで} %{
	\end{todo} %todo:ここまで}

	$\owedge$は積となり、$\phi$は$R$-代数準同型
	$\T_*R^m\to A_*R^m$となる。

	$R$-双線形写像$\owedge:\T_*R^m\times \T_*R^m\to \T_*R^m$を次のように
	定義する。
	\begin{equation*}\begin{split}
		v\owedge w = \phi(v\otimes w) \quad\text{for all } v,w\in \T_*R^m
	\end{split}\end{equation*}
	\begin{equation*}\begin{split}
		\bigl(\phi (v_1\otimes\cdots\otimes v_p)\bigr)
			\owedge \bigl(\phi (w_1\otimes\cdots\otimes w_q)\bigr) \\
		= \frac{1}{p!q!} \sum_{\sigma\in S_p,\tau\in S_q} (-)^{\sigma+\tau}
			(v_{\sigma1}\otimes\cdots\otimes v_{\sigma p})
			\owedge (w_{\tau1}\otimes\cdots\otimes w_{\tau p}) \\
		= \frac{1}{p!q!(p+q)!} \sum_{\sigma\in S_p,\tau\in S_q,\mu\in S_{p+q}}
			(-)^{\sigma+\tau+\mu}
			v_{\mu\sigma1}\otimes\cdots\otimes v_{\mu\sigma p}\otimes
			w_{\mu\tau1}\otimes\cdots\otimes w_{\mu\tau p} \\
	\end{split}\end{equation*}
\subsubsection{行列式}\label{s3:行列式} %{
	行列$A\in\Mat_2R$を縦ベクトルで$A=[A_1,A_2]$と表すと、次のように
	行列式を反対称化したテンソル積によって表すことができる。
	\begin{equation*}\begin{split}
		A_1\otimes A_2 - A_2\otimes A_1
		& = \begin{pmatrix}
		A_{11} \\ A_{21}
		\end{pmatrix} \begin{pmatrix}
		A_{12} & A_{22}
		\end{pmatrix} - \begin{pmatrix}
		A_{12} \\ A_{22}
		\end{pmatrix} \begin{pmatrix}
		A_{11} & A_{21}
		\end{pmatrix} \\
		& = (\det A) (\bld_1\otimes\bld_2 - \bld_2\otimes\bld_1)
	\end{split}\end{equation*}
	この式を$2$次元から一般の次元に一般化する。
	行列$A\in\Mat_nR$を縦ベクトルで$A=[A_1,\dots,A_n]$と表して、
	反対称化したテンソル積を計算すると次のようになる。
	\begin{equation}\label{eq:反対称テンソルによる行列式}\begin{split}
		& \sum_{\sigma\in S_n} (-)^\sigma A_{\sigma1}
			\otimes\cdots\otimes A_{\sigma n} \\
		& = \sum_{\sigma\in S_n}\sum_{i_1,\dots,i_n\in1..n} 
			(-)^\sigma A_{(\sigma1)i_1}\cdots A_{(\sigma n)i_n}
			(\bld_{i_1}\otimes\cdots\otimes\bld_{i_n}) \\
		& = \sum_{\sigma,\tau\in S_n}
			(-)^\sigma A_{(\sigma1)(\tau1)}\cdots A_{(\sigma n)(\tau n)}
			(\bld_{\tau1}\otimes\cdots\otimes\bld_{\tau n}) \\
		& = (\det A) \sum_{\tau\in S_n} (-)^\tau
			(\bld_{\tau1}\otimes\cdots\otimes\bld_{\tau n}) \\
	\end{split}\end{equation}
	ここで、テンソル積の中に同じ添字が二つ以上現れると、
	置換の和をとると、置換の偶奇性よりその項は$0$になることを使った。
	例えば、
	$\cdots\otimes\bld_k\otimes\cdots\otimes\bld_k\otimes\cdots$
	のようなテンソル積を含む項は、次のように置換の和をとると$0$になる。
	\begin{equation*}\begin{split}
		A_{1k}A_{2k}(\bld_k\otimes\bld_k) - A_{2k}A_{1k}(\bld_k\otimes\bld_k)
		= 0
	\end{split}\end{equation*}
	外積を使うと、式\eqref{eq:反対称テンソルによる行列式}は、任意の
	$A=[A_1,\dots,A_n]\in \Mat_nR$に対して次のように簡潔に書くことができる。
	\begin{equation}\label{eq:外積による行列式}\begin{split}
		A_1\wedge\cdots\wedge A_n = (\det A)\;\bld_1\wedge\cdots\wedge \bld_n
	\end{split}\end{equation}
%s3:行列式}
%s2:外積}
%s1:自由加群の線形代数}
%
}\endgroup %}
